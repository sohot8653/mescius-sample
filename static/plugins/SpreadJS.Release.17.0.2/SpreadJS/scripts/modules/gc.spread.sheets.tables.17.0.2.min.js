/*!
 * 
 * SpreadJS Library 17.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var e,r,t;function i(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},e[t].call(n.exports,n,n.exports,i)),n.exports}e={"./dist/plugins/table/table-action.js":function(M,t,n){var e,b,t,r,D,w,l,v,B,r,d,i,c,m,h,s,o,u,a,f,g,y,C,p,S,T,U,n,t,E,V,_,H,G,R,x,J,P,Y,$,K,W,q,Z,Q,X,tt,nt,et;function j(t,n){n.message===E().Exp_TableAddRowIntersectTable&&t.jT(6,E().Exp_TableAddRowIntersectTable)}function F(t,n){var t=K.call(this,t)||this;return t.l4t=n,t.h4t=n.tableName,t.d4t=n.resizeToRange,t.lCe=n.backupTableResizedArgs,t.Cge=n.ignoreEventSuspend,t}function k(t,n){var t=W.call(this,t)||this;return t.v4t=n,t.h4t=n.tableName,t.Ky=n.row,t.DU=n.count,t.m4t=n.isAfter,t}function A(t,n){var t=q.call(this,t)||this;return t.v4t=n,t.h4t=n.tableName,t.Ky=n.row,t.DU=n.count,t.m4t=n.isAfter,t}function O(t,n){var t=Z.call(this,t)||this;return t.g4t=n,t.h4t=n.tableName,t.p4t=n.changeRows,t}function L(t,n){var t=Q.call(this,t)||this;return t.b4t=n,t.h4t=n.tableName,t.iw=n.col,t.DU=n.count,t.m4t=n.isAfter,t}function N(t,n){var t=X.call(this,t)||this;return t.y4t=n,t.h4t=n.tableName,t.iw=n.col,t.DU=n.count,t}function z(t,n){var t=tt.call(this,t)||this;return t.w4t=n,t.h4t=n.tableName,t}function I(t,n){var t,e,t=nt.call(this,t)||this,e=t;return e.M4t=n,e.Ky=n.row,e.iw=n.col,e.D5=n.newValue,t}function rt(t,n){var t,e,t=et.call(this,t)||this,e;return t.C4t=n,t.h4t=n.tableName,t}e=this&&this.__extends||($=function(t,n){return($=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}$(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),b=n("Core"),t=n("Common"),r=n("./dist/plugins/table/table-util.js"),D=r.Util.S4t,w=r.Util.jj,l=r.Util.Ej,v=r.Util._getTable,B=r.Util.T4t,r=b.Commands.ActionBase,d=t.Common.lt.ht,i="tableResize",c="tableInsertRows",m="tableDeleteRows",h="tableInsertColumns",s="tableDeleteColumns",o="tableToRange",u="tableTotalRowFormula",a="DoInsertRows",f="tableShowFooter",g="tableInsertRowsAboveForContextMenu",y="tableInsertRowsBelowForContextMenu",C="tableDeleteRowsForContextMenu",p="tableInsertColumnsLeftForContextMenu",S="tableInsertColumnsRightForContextMenu",T="tableDeleteColumnsForContextMenu",U=void 0,n=n("./dist/plugins/table/table.ns.js"),t=new t.Common.ResourceManager(n.SR,"Tables"),E=t.getResource.bind(t),e(F,K=r),F.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,l,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,o=t.l4t,r.startTransaction(),t.X5(e,!0);try{(u=e.tables.findByName(i))&&(a=u.range(),f=t.d4t,s=t.lCe,e.tables.resize(u,f),null!=s&&s.push({sheet:e,table:u,oldRange:f,newRange:a}),D(e,u,a,f,t.Cge),n=!0)}finally{t.q5(e,!0),o[l=b.Commands.TI(e.name())]=r.endTransaction()}}return n},F.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,t=this,n=t.Mf,e=t.h4t,r=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.l4t,o=n.Ut,u=n.tables.findByName(e),(f=i[a=b.Commands.TI(n.name())])&&(o.undo(f),D(n,u,i.resizeToRange,u.range(),t.Cge),r=!0)}finally{t.q5(n,!0)}}return r},V=F,b.Commands[i]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,V,n,e)}},e(k,W=r),k.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,t=this,n=!1;if(t.canExecute()){e=t.Mf,r=t.h4t,i=t.Ky,o=t.DU,u=t.m4t,b.Commands.II((0,b.hCe)(e)),t.X5(e,!0);try{(a=e.tables.findByName(r))&&(f=a.Sx,a.zpt(i,o,u),n=!0,(s=a.Sx)-f===o)&&w(e,a,c,i,o,u)}catch(t){j(e,t)}finally{t.q5(e,!0),b.Commands.xI(e.parent.i4(),t.v4t)}}return n},k.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,s,l,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{o=(r=t.v4t)[i=b.Commands.TI(n.name())],u=r.row,a=r.count,f=r.isAfter,o&&(b.Commands.NI(n.parent.i4(),r),(s=n.tables.findByName(t.h4t))&&(l=f?u+1:u,s.A4t(l,a),s.I4t(),s.x4t(l,a,B(!0)),w(n,s,m,u,a,U,s.tq())),e=!0)}finally{t.q5(n,!0)}}return e},_=k,b.Commands[c]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,_,n,e)}},e(A,q=r),A.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,o=t.Ky,u=t.DU,a=t.m4t,r.startTransaction(),t.X5(e,!0);try{(f=e.tables.findByName(i))&&(f.N4t(o,u,a,!1),w(e,f,c,o,u,a),t.v4t.row=o,t.v4t.count=u,n=!0)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.v4t[i]=r.endTransaction()}}return n},A.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,s,l,c,h,v,d,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.v4t,i=n.Ut,u=r[o=b.Commands.TI(n.name())],a=r.row,f=r.count,s=r.isAfter,u&&(c=(l=n.tables.findByName(t.h4t))&&l.z3(),h=void 0,v=s?a+1:a,c&&(d=l.dataRange(),h=c.slice(v-d.row,v-d.row+f)),i.undo(u),l&&(l.A4t(v,f),l.I4t(),l.x4t(v,f,B(!0)),w(n,l,m,a,f,s,h||l.tq())),e=!0)}finally{t.q5(n,!0)}}return e},H=A,b.Commands[a]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,H,n,e)}},e(O,Z=r),O.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,l,t=this,n=!1;if(t.canExecute()){e=t.Mf,r=t.h4t,i=t.p4t,b.Commands.II((0,b.hCe)(e)),t.X5(e,!0);try{if(o=e.tables.findByName(r))for(u=i.length-1;0<=u;u--)a=i[u].row,f=i[u].count,s=o.Sx,o.yE(a,f),n=!0,s-(l=o.Sx)===f&&w(e,o,m,a,f,U,o.tq())}catch(t){j(e,t)}finally{t.q5(e,!0),b.Commands.xI(e.parent.i4(),t.g4t)}}return n},O.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,s,l,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{if(o=(r=t.g4t)[i=b.Commands.TI(n.name())],u=t.p4t,o)for(b.Commands.NI(n.parent.i4(),r),(a=n.tables.findByName(t.h4t))&&a.I4t(),e=!0,f=u.length-1;0<=f;f--)s=u[f].row,l=u[f].count,w(n,a,c,s,l,!1)}finally{t.q5(n,!0)}}return e},G=O,b.Commands[m]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,G,n,e)}},e(L,Q=r),L.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,t=this,n=!1;if(t.canExecute()){e=t.Mf,r=t.h4t,i=t.iw,o=t.DU,u=t.m4t,b.Commands.II((0,b.hCe)(e)),t.X5(e,!0);try{(a=e.tables.findByName(r))&&(f=a.Tx,a.k4t(i,o,u),n=!0,(s=a.Tx)-f===o)&&l(e,a,h,i,o,u)}catch(t){j(e,t)}finally{t.q5(e,!0),b.Commands.xI(e.parent.i4(),t.b4t)}}return n},L.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{o=(r=t.b4t)[i=b.Commands.TI(n.name())],u=r.col,a=r.count,o&&(b.Commands.NI(n.parent.i4(),r),(f=n.tables.findByName(t.h4t))&&f.I4t(),e=!0,l(n,f,s,u,a))}finally{t.q5(n,!0)}}return e},R=L,b.Commands[h]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,R,n,e)}},e(N,X=r),N.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,t=this,n=!1;if(t.canExecute()){e=t.Mf,r=t.h4t,i=t.iw,o=t.DU,b.Commands.II((0,b.hCe)(e)),t.X5(e,!0);try{(u=e.tables.findByName(r))&&(a=u.Tx,u.wE(i,o),n=!0,a-(f=u.Tx)===o)&&l(e,u,s,i,o)}catch(t){j(e,t)}finally{t.q5(e,!0),b.Commands.xI(e.parent.i4(),t.y4t)}}return n},N.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{o=(r=t.y4t)[i=b.Commands.TI(n.name())],u=r.col,a=r.count,o&&(b.Commands.NI(n.parent.i4(),r),(f=n.tables.findByName(t.h4t))&&f.I4t(),l(n,f,h,u,a,!(e=!0)))}finally{t.q5(n,!0)}}return e},x=N,b.Commands[s]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,x,n,e)}},e(z,tt=r),z.prototype.execute=function(){var t,n,e,r,i,o,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,r.startTransaction(),t.X5(e,!0);try{(o=e.tables.findByName(i))&&(e.tables.remove(o,3),n=!0)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.w4t[i]=r.endTransaction()}}return n},z.prototype.undo=function(){var t,n,e,r,i,o,u,a,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.w4t,i=n.Ut,(u=r[o=b.Commands.TI(n.name())])&&(i.undo(u),(a=n.tables.findByName(t.h4t))&&a.I4t(),e=!0)}finally{t.q5(n,!0)}}return e},J=z,b.Commands[o]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,J,n,e)}},e(I,nt=r),I.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,l,u,t=this,n=!1;if(t.canExecute()){(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{i=t.Ky,o=t.iw,u=t.D5,e.setFormula(i,o,u),u?u.startsWith("=SUBTOTAL(103")||u.startsWith("=SUBTOTAL(102")||(a=e.getFormatter(i,o))&&"GENERAL"!==a.toUpperCase()||(l=(s=(f=e.tables.find(i,o))&&f.BSt[o-f.startColumn()])&&s.formatter(),(0,b.Ffe)(e,i,o,l)):e.setValue(i,o,null),n=!0}finally{t.q5(e,!0),u=b.Commands.TI(e.name()),t.M4t[u]=r.endTransaction()}}return n},I.prototype.undo=function(){var t,n,e,r,i,o,u,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.M4t,i=n.Ut,(u=r[o=b.Commands.TI(n.name())])&&(i.undo(u),e=!0)}finally{t.q5(n,!0)}}return e},P=I,b.Commands[u]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,P,n,e)}},e(rt,et=r),rt.prototype.execute=function(){var t,n,e,r,i,o,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,r.startTransaction(),t.X5(e,!0);try{(o=e.tables.findByName(i))&&(o.showFooter(!0),n=!0)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.C4t[i]=r.endTransaction()}}return n},rt.prototype.undo=function(){var t,n,e,r,i,o,u,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.C4t,i=n.Ut,(u=r[o=b.Commands.TI(n.name())])&&(i.undo(u),e=!0)}finally{t.q5(n,!0)}}return e},Y=rt,b.Commands[f]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,Y,n,e)}},b.Commands[g]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f,i;return n.cmd=g,d(n.row)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.row,f=o.rowCount,i=u.footerIndex()===a,n.row=i?a-1:a,n.count=f,n.tableName=u.name(),n.isAfter=i),b.Commands.zA(t,_,n,e))):b.Commands.zA(t,_,n,e)}},b.Commands[y]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f;return n.cmd=y,d(n.row)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.row,f=o.rowCount,n.row=a,n.count=f,n.tableName=u.name(),n.isAfter=!0),b.Commands.zA(t,_,n,e))):b.Commands.zA(t,_,n,e)}},b.Commands[C]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f,s,l,c,h;if(n.cmd=C,d(n.changeRows)){for(r=b.Commands.Tp(t,n),i=n.selections,a=u=o=void 0,n.changeRows=[],f=0;f<i.length;f++){if(s=i[f],!(l=v(r,s)))return!1;if(o){if(o!==l)return!1}else o=l}for(f=0;f<i.length;f++)for(c=f+1;c<i.length;c++){if(s=i[f],h=i[c],s.row>=h.row&&s.row<=h.row+h.rowCount-1)return!1;if(s.row+s.rowCount-1>=h.row&&s.row+s.rowCount-1<=h.row+h.rowCount-1)return!1;if(s.row<=o.Ky||s.row+s.rowCount>o.Ky+o.Sx)return!1;if(h.row<=o.Ky||h.row+h.rowCount>o.Ky+o.Sx)return!1}for(i.sort(function(t,n){return t.row-n.row}),f=0;f<i.length;f++)u=(s=i[f]).row,a=s.rowCount,n.changeRows.push({row:u,count:a});n.tableName=o.name()}return b.Commands.zA(t,G,n,e)}},b.Commands[p]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f;return n.cmd=p,d(n.col)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.col,f=o.colCount,n.col=a,n.count=f,n.tableName=u.name(),n.isAfter=!1),b.Commands.zA(t,R,n,e))):b.Commands.zA(t,R,n,e)}},b.Commands[S]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f;return n.cmd=S,d(n.col)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.col,f=o.colCount,n.col=a,n.count=f,n.tableName=u.name(),n.isAfter=!0),b.Commands.zA(t,R,n,e))):b.Commands.zA(t,R,n,e)}},b.Commands[T]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f;return n.cmd=T,d(n.col)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.col,f=o.colCount,n.col=a,n.count=f,n.tableName=u.name()),b.Commands.zA(t,x,n,e))):b.Commands.zA(t,x,n,e)}},b.Commands.D4t=function(t){t.register(i,b.Commands[i]),t.register(c,b.Commands[c]),t.register(a,b.Commands[a]),t.register(m,b.Commands[m]),t.register(h,b.Commands[h]),t.register(s,b.Commands[s]),t.register(o,b.Commands[o]),t.register(u,b.Commands[u]),t.register(f,b.Commands[f]),t.register(g,b.Commands[g]),t.register(y,b.Commands[y]),t.register(C,b.Commands[C]),t.register(p,b.Commands[p]),t.register(S,b.Commands[S]),t.register(T,b.Commands[T])}},"./dist/plugins/table/table-event.js":function(t,n,e){var w,n,m,r,e,l,h,f,i,o,n,g,y,C,u;Object.defineProperty(n,"__esModule",{value:!0}),w=e("Core"),n=e("Common"),m=e("./dist/plugins/table/table.js"),r=e("./dist/plugins/table/table.ns.js"),e=e("./dist/plugins/table/table-util.js"),l=n.Common.lt.ht,h=null,f=Math.abs,i=10,o="tableResize",n=new n.Common.ResourceManager(r.SR,"Tables"),g=n.getResource.bind(n),y=e.Util._4t,C=e.Util.E4t,u=e.Util.j4t,w.GC$.extend(w.nk.prototype,{mk:function(t,n){var t,e,t=this.Tk(t,n);t&&((e=this).I9=e.x9=n.Ut.getSelections(),n.setSelection(t.row,t.col,t.rowCount,t.colCount))},Tk:function(t,n){var e,r,i,o,u,a,r,n,n,f,s,n,e=n.getSelections(),r=t.tableSelectInfo,i=r.table,o=0,u=0;if(i.oL&&(o=1),i.jO&&(u=1),a=h,r=r.action,n=(n=n.Nde)&&n.Ymt(),!l(n)&&0<n.length&&(e=n),r===m.TableSelectionType.TABLE_ROW_SELECT)a=(0,w.Ec)(t.row,i.iw,1,i.Tx);else if(r===m.TableSelectionType.TABLE_COL_SELECT){for(f=0;f<e.length;f++)if((s=e[f]).col===t.col&&s.row===i.Ky+u&&1===s.colCount&&s.rowCount===i.Sx-u-o){a=(0,w.Ec)(i.Ky,t.col,i.Sx,1);break}n=!a&&-1===t.rowViewportIndex&&e&&e[0]&&e[0].col===t.col&&e[0].rowCount===i.Sx,l(a)&&!n&&(a=(0,w.Ec)(i.Ky+u,t.col,i.Sx-u-o,1))}else if(r===m.TableSelectionType.TABLE_CORNER_SELECT){for(f=0;f<e.length;f++)if((s=e[f]).col===i.iw&&s.row===i.Ky+u&&s.colCount===i.Tx&&s.rowCount===i.Sx-u-o){a=(0,w.Ec)(i.Ky,i.iw,i.Sx,i.Tx);break}l(a)&&(a=(0,w.Ec)(i.Ky+u,i.iw,i.Sx-u-o,i.Tx))}else r===m.TableSelectionType.TABLE_SELECT&&(a=(0,w.Ec)(i.Ky,i.iw,i.Sx,i.Tx));return a},KL:function(t,n){var e,r,i,o,u,a,f,t,s,l,s,l,e,i,c,f,o,e=this.Mf,r=h;return r=e&&!e.isActualProtected()&&!e.isEditing()&&n&&n.showResizeHandle()&&(i=t.row,o=t.col,u=t.x,a=t.y,f=t.rowViewportIndex,t=t.colViewportIndex,s=y(e,n),l=C(e,n),i===s)&&o===l&&(l=(s=e.getCellRect(i,o,f,t)).x,e=s.y,i=s.width,o=e+(c=s.height),(f=l+i)-10<=u)&&u<=f&&o-10<=a&&a<=o?{x:u,y:a,table:n}:r},Sk:function(t){var n,e,r,r,i,o,n=this;!0!==n.$k&&!0!==n.rb&&(e=n.Mf,r=(r=t.resizeTableHitInfo)&&r.table)&&!r.QL()&&(n.$k=!0,n.rb=!0,n.O4t=r,n.R4t=r.Ky,n.B4t=r.iw,n.L4t=r.Sx,n.F4t=r.Tx,i=n.R4t+n.L4t-1,o=n.B4t+n.F4t-1,n.P4t=e.getCellRect(i,o),n.G4t=r.range(),n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},t9:function(){var t,n,e,t=this,n=t.Mf;t.Rk&&t.$k&&t.rb&&t.O4t&&(t.U4t(),t.H4t()&&(t.z4t=t.V4t(),t.Y4t(),t.Z4t(),(e=(e=t.W4t)||t.Q4t()).equals(t.K4t)||(t.W4t=(0,w.Ec)(t.K4t.row,t.K4t.col,t.K4t.rowCount,t.K4t.colCount),u(n,t.O4t,t.Q4t(),t.K4t))),t.a9())},OD:function(){var t,n,e,t=this,n=t.Mf;t.l9(),t.$k&&t.rb&&t.K4t&&t.O4t?(t.$k=!1,t.rb=!1,t.J4t()?(e=t.Q4t(),t.X4t(),e.equals(t.K4t)?n.Dn.q4t():n.Qy().execute({cmd:o,sheetName:n.name(),tableName:t.O4t.name(),resizeToRange:t.K4t}),t.$4t()):(t.$4t(),n.Dn.q4t())):t.$4t()},Q4t:function(){var t=this.O4t;return(0,w.Ec)(t.Ky,t.iw,t.Sx,t.Tx)},U4t:function(){var t=this,n=t.Q9(),e=t.K9();t.tSt=n,t.nSt=e},H4t:function(){var t,n,e,r,i,o,u,a,f,t=this,n=t.R4t,e=t.B4t,r=t.tSt,i=t.nSt,o,u,a,f;return(t.O4t.jO?n+1:n)<=r&&e<=i},V4t:function(){var t,n,e,t,r,t,i,e,n,o,t=this,e=t.fk,t=t.P4t,r=t.x+t.width,t=t.y+t.height,i=e.x,e=e.y,n=f(t-e),o,n=f(r-i)<=n?e<t?2:3:i<r?0:1;return n},Y4t:function(){var t,n,e,r,i,o,u,a,t=this,n=t.R4t,e=t.B4t,r=t.tSt,i=t.nSt,o=t.z4t,u=t.L4t,a=t.F4t;switch(o){case 0:case 1:a=f(i-e)+1;break;case 2:case 3:u=f(r-n)+1}t.K4t?(t.K4t.rowCount=u,t.K4t.colCount=a):t.K4t=(0,w.Ec)(n,e,u,a)},Z4t:function(){var t=this,n;t.Mf.Dn.q4t(),t.G4t=t.eSt()},eSt:function(){var t,n,e,r,i,n,t,n=this.K4t,e=n.row,r=n.col,i=n.rowCount,n=n.colCount;return(0,w.Ec)(e,r,i,n)},X4t:function(){var t=this,n=t.O4t,e;2===t.z4t&&n.oL&&(t.K4t.rowCount+=1)},J4t:function(){var t,n,e,r,i,o,u,a,f,s,u,l,c,h,v,d,b,t=this,n=t.Mf,e=!1,r=n.Ut,i=n.tables,o=t.O4t,u=t.K4t,a=u.row,f=u.col,s=u.rowCount,u=u.colCount,l=t.tSt,c=t.nSt,h=y(n,o),v=C(n,o),d=t.z4t,b=o.IB;return h&&v&&((0,m.hasRowFilter)(n,new w.Range(a,f,s,u))||(r.eE(a,f,s,u)||r.GT(a,f,s,u)?n.jT(6,g().Exp_TableResizeToSpan):b&&b.isFiltered()?2===d?n.jT(6,g().Exp_TableResizeWithHidden):3===d&&o.oL?n.jT(6,g().Exp_TableResizeWithFilter):e=!0:2===d&&t.iSt(h,l)||0===d&&t.rSt(v,c)?n.jT(6,g().Exp_TableResizeWithHidden):1===d&&(i.Pl(a,v+1,s,c-v)||i.oSt(a,v+1,s,c-v))||3===d&&(i.Pl(h+1,f,l-h,u)||i.oSt(h+1,f,l-h,u))?n.jT(6,g().Exp_TableResizeToTable):e=!0)),e},iSt:function(t,n){for(var e,r=this.Mf,i,o=!1,i=t;n<i;i--)if(r.getRowHeight(i)<=0){o=!0;break}return o},rSt:function(t,n){var e,r=this.Mf,i,o=!1;if(!o)for(i=t;n<i;i--)if(r.getColumnWidth(i)<=0){o=!0;break}return o},$4t:function(){var t=this;t.$k=!1,t.rb=!1,t.Rk=h,t.K4t=h,t.W4t=h}})},"./dist/plugins/table/table-render.js":function(t,n,e){var e,r,n;function i(t,n,e,r){var i,o,e,i,o=t.rt.K4t,e=t.getRangeRect(e,r,o);n.strokeStyle=t.getSelectionBorderColor(),n.strokeRect(e.x,e.y,e.width,e.height)}Object.defineProperty(n,"__esModule",{value:!0}),n="tableRender",(r=(e=e("Core")).GC$.extend)(e.g7.prototype,{q4t:function(){var t,n,t=this,n;0<t.Mf.My||t.E1()}}),e.Worksheet.ch(n,{paintAdornment:function(t){var n,t,e,n=this,t=t.ctx,e=n.rt;e&&e.Rk&&e.$k&&i(n,t,e.nD(),e.eD())}})},"./dist/plugins/table/table-theme.js":function(M,t,D){var f,w,B,m,U,E,e,V,H,G,J,P,s,l,a,c,h,v,d,b,Y,g,$,K,W,q,Z,y,Q,X,tt,nt,C,D,et,rt,it,ot,ut,u,p,S,T,_,R,x,at,ft,j,F,k,A,O,n,st,r,i,o,o,r;function lt(){for(var t,n,t={},n=1;n<=28;n++)n<=21&&(t["TABLESTYLELIGHT"+n]=!0),n<=11&&(t["TABLESTYLEDARK"+n]=!0),t["TABLESTYLEMEDIUM"+n]=!0;return t}function L(t,n,e,r,i,o,u,a,f,s,l,c,h,v){var d=this,b=arguments;w(x,function(t,n){d[n]=1<t?b[t+1]:b[t]}),m(e)&&(d.font=e)}function ct(r,i){r.name(i.name()),w(C,function(t,n){r[n](i[n]())}),w(y,function(t,n){var e=i[n]();r[n](e?e.Gf():l)}),r.builtInName(i.builtInName(),!1)}function ht(){}function N(t,n){return isNaN(n)?n:new f.LineBorder(t,n)}function z(t,n,e,r,i,o,u,a,f,s){var l=new j;return n&&(l.backColor=n),e&&(l.foreColor=e),r&&(l.cpe=rt,l.lre=it,l.lpe=ot,l._font=et),i&&(l.borderLeft=N(t,i)),o&&(l.borderTop=N(t,o)),u&&(l.borderRight=N(t,u)),a&&(l.borderBottom=N(t,a)),f&&(l.borderHorizontal=N(t,f)),s&&(l.borderVertical=N(t,s)),l}function I(t){return 0===t?"Text 1":"Accent "+t}function vt(t){var t,n,e,t=I(t),n=t+" 80",e=new F;return e[a](z(t,0,t,1,0,0,0,1)),e[h](z(t,0,t,0,0,1,0,1)),e[b](z(t,n)),e[d](z(t,0,t,1)),e[v](z(t,0,t,1)),e[g](z(t,n)),e[c](z(t,0,t,1,0,1)),e}function dt(t){var t,n,t=I(t),n=new F;return n[a](z(t,t,k,1)),n[h](z(t,0,0,0,1,1,1,1)),n[b](z(t,0,0,0,0,1)),n[Y](z(t,0,0,0,0,1)),n[g](z(t,0,0,0,1)),n[$](z(t,0,0,0,1)),n[d](z(t,0,0,1)),n[v](z(t,0,0,1)),n[c](z(t,0,0,1,0,6)),n}function bt(t){var t,n,e,t=I(t),n=t+" 80",e=new F;return e[a](z(t,0,0,1,0,0,0,2)),e[h](z(t,0,0,0,1,1,1,1,1,1)),e[b](z(t,n)),e[g](z(t,n)),e[d](z(t,0,0,1)),e[v](z(t,0,0,1)),e[c](z(t,0,0,1,0,6)),e}function wt(t){var t,n,e,t,r,t=I(t),n=t+" 20",e=t,t=t+" 80",r=new F;return r[a](z(n,e,k,1)),r[h](z(n,0,0,0,1,1,1,1,1)),r[b](z(n,t)),r[g](z(n,t)),r[d](z(n,0,0,1)),r[v](z(n,0,0,1)),r[c](z(n,0,A,1,0,6)),r}function mt(t){var t,n,e,r,t,i,t=I(t),n=k,e=t,r=t+" 60",t=t+" 80",i=new F;return i[a](z(n,e,k,1,0,0,0,2,0,1)),i[h](z(n,t,0,0,0,0,0,0,1,1)),i[b](z(n,r)),i[g](z(n,r)),i[d](z(n,e,k,1)),i[v](z(n,e,k,1)),i[c](z(n,e,k,1,0,2,0,0,0,1)),i}function gt(t){var n,e,r,i,e,o,n,e="#D3D3D3",r=I(t),i=e,e=0===t?A:e,o=new F;return o[a](z(A,r,k,1,0,2,0,2)),o[h](z(e,0,0,0,1,new f.LineBorder(A,2),1,new f.LineBorder(A,2),0===t?1:0,1)),o[b](z(e,i)),o[g](z(e,i)),o[d](z(e,r,k)),o[v](z(e,r,k)),o[q](z(e,r,k,1)),o[Z](z(e,r,k,1)),o[c](z(A,0,A,0,0,6)),o}function yt(t){var t,n,e,r,i,t,o,t=I(t),n=t,e=t+" 40",r=t+" 80",i=t+" 60",t=t+" 80",o=new F;return o[a](z(e,r,A,1,1,1,1,1,0,1)),o[h](z(e,r,0,0,1,1,1,1,1,1)),o[b](z(e,i)),o[g](z(e,i)),o[d](z(e,0,0,1)),o[v](z(e,0,0,1)),o[c](z(e,t,A,1,1,new f.LineBorder(n,2),1,1,0,1)),o}function Ct(t){var n,e,r,i,t,o,n=I(t),e=A,r=0===t?n+" 25":n+" -25",i=0===t?n+" 50":n,t=0===t?n:n+" -50",o=new F;return o[a](z(k,e,k,1,0,0,0,2)),o[h](z(n,i,k)),o[b](z(n,r)),o[g](z(n,r)),o[d](z(k,r,k,1,0,0,2)),o[v](z(k,r,k,1,2)),o[c](z(k,t,k,1,0,2)),o}function pt(t){var n,e,r,t,i,o;function u(t,n){var e;return t<0||3<t?"":{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[n][t]}return n=I(t),e=u(t,"headerColor"),r=u(t,"stripColor"),i=t=u(t,"tableBackground"),(o=new F)[a](z(n,e,k)),o[h](z(n,t)),o[b](z(n,r)),o[g](z(n,r)),o[d](z(n,0,0,1)),o[v](z(n,0,0,1)),o[c](z(A,i,0,1,0,6)),o}function St(){}for(Object.defineProperty(t,"__esModule",{value:!0}),t.TableThemes=t.TableTheme=t.TableStyle=void 0,f=D("Core"),w=f.GC$.each,B=f.GC$.isEmptyObject,m=f.mt.T1,U=JSON.stringify,E=JSON.parse,e=f.mt.p0,V=f.mt.go,H=f.mt.vo,G=f.mt.n1,J=f.NodeHelper.sr,P=Math.floor,s=void 0,l=null,y=[a="headerRowStyle",c="footerRowStyle",h="wholeTableStyle",v="highlightLastColumnStyle",d="highlightFirstColumnStyle",b="firstRowStripStyle",Y="secondRowStripStyle",g="firstColumnStripStyle",$="secondColumnStripStyle",K="firstHeaderCellStyle",W="lastHeaderCellStyle",q="firstFooterCellStyle",Z="lastFooterCellStyle"],C=[Q="firstRowStripSize",X="secondRowStripSize",tt="firstColumnStripSize",nt="secondColumnStripSize"],D="name",et="bold 14.667px calibri",rt="bold",it="14.667px",ot="calibri",ut={wholeTable:"wholeTableStyle",headerRow:"headerRowStyle",totalRow:"footerRowStyle",firstColumn:"highlightFirstColumnStyle",lastColumn:"highlightLastColumnStyle",firstRowStripe:"firstRowStripStyle",secondRowStripe:"secondRowStripStyle",firstColumnStripe:"firstColumnStripStyle",secondColumnStripe:"secondColumnStripStyle",firstHeaderCell:"firstHeaderCellStyle",lastHeaderCell:"lastHeaderCellStyle",firstTotalCell:"firstFooterCellStyle",lastTotalCell:"lastFooterCellStyle"},x=["backColor","foreColor",u="borderLeft",p="borderTop",S="borderRight",T="borderBottom",_="borderHorizontal",R="borderVertical","textDecoration","fontStyle","fontWeight","fontSize","fontFamily","_fontVariant","_fontStretch","_lineHeight"],at=f.W.upe,ft=lt(),Object.defineProperty(L.prototype,"font",{get:function(){return this._font},set:function(t){f.W.oce(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"fontSize",{get:function(){return this.lre},set:function(t){f.W.dpe(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"fontStyle",{get:function(){return this.spe},set:function(t){var n=this;n.spe=t,n._font=at(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e)},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"fontWeight",{get:function(){return this.cpe},set:function(t){var n=this;n.cpe=t,n._font=at(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e)},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"fontFamily",{get:function(){return this.lpe},set:function(t){var n=this;n.lpe=t,n._font=at(n.spe,n.cpe,n.lre,n.lpe,n.b2e,n.y2e,n.w2e)},enumerable:!1,configurable:!0}),L.prototype.h5=function(e,t,n,r,i){var o=this;n&&m(o[u])&&!m(e[u])&&(e[u]=o[u],e[u].level=20),t&&m(o[p])&&!m(e[p])&&(e[p]=o[p],e[p].level=20),i&&m(o[S])&&!m(e[S])&&(e[S]=o[S],e[S].level=20),r&&m(o[T])&&!m(e[T])&&(e[T]=o[T],e[T].level=20),t||!m(o[_])||m(e[p])||(e[p]=o[_],e[p].level=20),r||!m(o[_])||m(e[T])||(e[T]=o[_],e[T].level=20),n||!m(o[R])||m(e[u])||(e[u]=o[R],e[u].level=20),i||!m(o[R])||m(e[S])||(e[S]=o[R],e[S].level=20),w(x,function(t,n){0<=n.indexOf("border")||m(o[n])&&!m(e[n])&&(e[n]=o[n])})},L.prototype.Gf=function(){var t,n,t=new L,n=U(this.toJSON());return t.fromJSON(E(n)),t},L.prototype.toJSON=function(){var r,i,r=this,i={};return w(x,function(t,n){var e,e,e=r[n],e=e&&e.toJSON?e.toJSON():e;i[n]=e!==l&&B(e)?s:e}),i.font=r.font,i},L.prototype.fromJSON=function(i,o){var u;i&&(u=this,w(x,function(t,n){var e,r,e=i[n];m(e)&&(0<=n.indexOf("border")?((r=new f.LineBorder).fromJSON(e,o),u[n]=r):u[n]=e)}),i.font)&&(u.font=i.font)},j=L,t.TableStyle=j,f.GC$.extend(f.StyleManager.prototype,{addTableTheme:function(t){var n=this,e,e;(e=(e=n.aSt)||(n.aSt={}))[t.name()]=t},getTableTheme:function(t){var n,e,r,i,n=this,e=n.aSt;return e=e||(n.aSt={}),ft[t.toUpperCase()]?e[r=t.substr(10).toLowerCase()]?e[r]:(ct(i=new F,O[r]),n.addTableTheme(i),i):e[t]}}),ht.prototype.toJSON=function(){var e,t,r,i,e=this,t=e.builtInName();return t?{buildInName:t}:(r={name:e.name()},w(y,function(t,n){(i=e[n]())&&(r[n]=i.toJSON())}),w(C,function(t,n){1!==(i=e[n]())&&(r[n]=i)}),B(r)?s:r)},ht.prototype.fromJSON=function(i,o){var u,t,t,t;i&&(u=this,(t=i.buildInName)?ct(u,O[t.toLowerCase()]):(t=i.name,t=m(t)?t:i.Zc,m(t)&&u.name(t,!1),w(C,function(t,n){var e=i[n]!==s?i[n]:i["_"+n];e&&u[n](e,!1)}),w(y,function(t,n){var e,r,e=i[n]!==s?i[n]:i["_"+n];e&&((r=new j).fromJSON(e,o),u[n](r,!1))})))},ht.prototype.yh=function(t,u){var a,n,e,r,i,o,a=this;for(a.name(G(t.name)),e=function(t){var n,e,r,i,o,n=J(t.dxfId,0),e=t.type,r=J(t.size,1),i=new j,o=ut[e||"wholeTable"];"function"==typeof a[o]&&void 0!==t.dxfId&&(u.getDxf(n,i,!0),w(x,function(t,n){0<=n.indexOf("border")&&i[n]===l&&(i[n]=new f.LineBorder)}),a[o](i,!1)),"firstRowStripe"!==e&&"secondRowStripe"!==e&&"firstColumnStripe"!==e&&"secondColumnStripe"!==e||a[e.substr(0,e.length-1)+"Size"](r,!1)},r=0,i=n=V(t,"tableStyleElement");r<i.length;r++)e(o=i[r]);u.addTableTheme(a)},ht.prototype.wh=function(r){var i,o,t,n,u,a,i=this,o=[],t={n_:"tableStyle",c_:o},n=i.builtInName();return n!==l&&n!==s?t.name="TableStyle"+n:(t.name=H(i.name()),u=0,w(y,function(t,n){var e;(a=i[n]())&&(e=r.getDxfIndex(a))!==s&&(u++,o.push({n_:"tableStyleElement",type:f.SJSStylePropsToStyleProps[n],dxfId:e}))}),w(C,function(t,n){(a=i[n]())&&(u++,o.push({n_:"tableStyleElement",type:n.replace("Size","e"),size:a}))}),t.count=u,t.pivot="0"),t},F=ht,(t.TableTheme=F).prototype.name=e(D),F.prototype.builtInName=e("builtInName"),w(y,function(t,n){F.prototype[n]=e(n)}),w(C,function(t,n){F.prototype[n]=e(n,1)}),k="white",A="black",O=St,t.TableThemes=O,n=1;n<=28;n++)r=P((st=n-1)/7),n<=21&&0<=r&&r<3&&(o="Light"+n,(i=[vt,dt,bt][r](st%7)).name&&i.name(o),i.builtInName&&i.builtInName(o),O["light"+n]=i),n<=11&&0<=r&&r<2&&((i=[Ct,pt][r](st%7)).name(o="Dark"+n),i.builtInName(o),O["dark"+n]=i),0<=r&&r<4&&((i=[wt,mt,gt,yt][r](st%7)).name(r="Medium"+n),i.builtInName(r),O["medium"+n]=i)},"./dist/plugins/table/table-util.js":function(M,t,n){var c,o,u,e,r,m,a,g,h,l,v,i,n,d;function b(t){throw new Error(t)}function f(t,n,e,r,i){u&&(!r&&i&&(r=k(t,i,n,e)),t.zI(n,e,r,i))}function s(t,n,e,r){t.setValue(n,e,r)}function w(t){t.suspendPaint()}function y(t){t.resumePaint()}function C(t){return t.op().Hyt()}function p(t){u&&t.suspendCalcService()}function S(t,n){u&&t.resumeCalcService(n)}function T(t){t&&(w(t),t.suspendEvent(),p(t))}function _(t){t&&(S(t),t.resumeEvent(),y(t))}function R(t){return t.rowCount}function x(t){return t.colCount}function j(t){return t&&!(/\d/.test(t[0])||/[\s\+\-\*\\:%!\[\]]/.test(t)||-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)}function F(t,n,e,r,i,o){var u,i;return n?((u=t.Uw())._wt=i,i=t.Lp.parse(u,n,e,r,!1,o,!1,t.options.keepUnknownFormulas),delete u._wt,i):g}function k(t,n,e,r,i){return i=i===h||i,t.Lp.unparse(t.Uw(),n,e,r,!1,i)}function A(t){var n,e,r,e;return!(!t||(j(t)||b(d().Exp_TableNameInvalid),e=(n=this).name(),r=n.jS,t===e)||r&&(e=r.findByName(t))&&n!==e)}function O(t,n,e,r,i){for(var o,u,a,f,o=e;n<=o;o--)for(a=r;a<=i;a++){if(N(u=t.Z_(o,a)))return o;if(L(t,o,a))return o;if(f=t.Ut.findSpan(o,a))return f.row+f.rowCount-1}return-1}function D(t,n,e,r,i){for(var o,u,a,f,u=i;r<=u;u--)for(o=n;o<=e;o++){if(N(a=t.Z_(o,u)))return u;if(L(t,o,u))return u;if(f=t.Ut.findSpan(o,u))return f.col+f.colCount-1}return-1}function L(t,n,e){var r=t.getValue(n,e),i,o;return r!==g&&a(r)||(i=t.getSparkline&&t.getSparkline(n,e))||N(o=t.Z_(n,e))}function N(t){return!(!t||!(t.backColor||t.backgroundImage||t.borderBottom||t.borderLeft||t.borderRight||t.borderTop||t.cellType||t.diagonalDown||t.diagonalUp))}function B(t,n,e,r,i,o,u,a){return i<=t&&!(n===u&&n+r-1===a)&&(n<u&&u<n+r||u<=n&&n<=a&&a<n+r-1)}function U(t,n,e,r,i,o,u,a){return u<=n&&!(t===i&&t+e-1===o)&&(t<i&&i<t+e||i<=t&&t<=o&&o<t+e-1)}function E(t,n,e){return{col:n,leadingCellRow:e,row:t}}function V(t,n,e){var r,i,o,r=g,i=n.Ky,o=n.endRow();for(e&&(o-=n.oL?1:0);i<=o&&t.getRowHeight(o)<=0;)o--;return r=i<=o?o:r}function H(t,n){for(var e,r,i,e=g,r=n.iw,i=n.endColumn();r<=i&&t.getColumnWidth(i)<=0;)i--;return e=r<=i?i:e}function G(t){for(var n,e,r,n,i,o,u,a,f,s,n=t.Ut,e=n.W_(3).dataTable,r=n.getLastNonNullRow(3,!0),n=t.getRowCount(),i=t.getColumnCount(),o=-1,f=n-1;-1<f;f--)if(u=e[f])for(s=0;s<i;s++)if((a=u[s])&&!v(a.value))return l(f,r);return l(-1,r)}function J(t,n){var e,r,i,o,u,n,a,f,s,f,o,e=n.jS,r,i,o=n.Ky+n.Sx-1,u=n.iw,n=u+n.Tx-1,a=G(t),f=e?e.uSt():-1;return(s=o)<(a=l(a,f))&&(o=new c.Range(f=1+o,u,a-o,n-u+1),s=l(O(t,f,a,u,n),e.uSt(o))),s}function P(t){for(var n,e,r,i,o,u,a,a,f,s,n=t.Ut,e=n.W_(3).dataTable,r=n.getLastNonNullCol(3,!0),i=t.getRowCount(),o,u=-1,f=t.getColumnCount()-1;-1<f;f--)for(s=0;s<i;s++)if((a=(a=e[s])&&a[f])&&!v(a.value))return l(f,r);return l(-1,r)}function Y(t,n){var e,r,i,o,u,n,a,f,s,f,n,e=n.jS,r=n.Ky,i=r+n.Sx-1,o,u,n=n.iw+n.Tx-1,a=P(t),f=e?e.sSt():-1;return(s=n)<(a=l(a,f))&&(n=new c.Range(r,f=1+n,i-r+1,a-n),s=l(D(t,r,i,f,a),e.sSt(n))),s}function $(t,n,i,o,u,a,e,r,f,s){var l,c,t,n,h,r,l=t.getRowCount()-1,c=t.getColumnCount()-1,t=t.Ut.getSpans(),n=n.jS&&n.jS.U3;return!r&&(!f&&l-o<e||f&&c-a<e)?(s||b(d().Exp_TableAddRowNoEnoughRoom),!0):(h=f?U:B,(r=t.some(function(t){var n=t.row,e=t.col,r=t.rowCount,t=t.colCount;return h(n,e,r,t,i,o,u,a)}))?s||b(d().Exp_TableAddRowIntersectSpan):n&&(r=n.some(function(t){var n=t.Ky,e=t.iw,r=t.Sx,t=t.Tx;return h(n,e,r,t,i,o,u,a)}))&&!s&&b(d().Exp_TableAddRowIntersectTable),r)}function K(t,n,e){for(var r,i,o,u,a,f,s,l,r=n.row,i=n.col,o=r+n.rowCount,u=i+n.colCount,a=r;a<o;a++)for(f=i;f<u;f++)if(l=(s=t.getCell(a,f)).value(),(!v(l)&&""!==l||t.Ut.findSpan(a,f))&&(!e||!e.equals(new c.Range(s.row,s.col,1,1))))return new c.Range(a,f,1,1);return h}function z(t,n,e,r,i,o,u){for(var a,f,s,a=n;a<=e;a++)for(f=r;f<=i;f++)if(s=t.l0(a,f,"locked"),o&&!s||u&&s)return;return 1}function W(t,n,e,r,i,o,u){var a,f,s,l,c,h,v,d,b,w;if(i){if(!o&&!u)return g;if(a=t.Mf,s=f=0,t.oL&&(f=1),t.jO&&(s=1),n===m.TableSelectionType.TABLE_ROW_SELECT){if(!z(a,e,e,t.iw,t.endColumn(),o,u))return g}else if(n===m.TableSelectionType.TABLE_COL_SELECT){for(c=!0,h=0,v=l=a.getSelections();h<v.length;h++)if((d=v[h]).col===r&&d.row===t.Ky+s&&1===d.colCount&&d.rowCount===t.Sx-s-f){if(!z(a,t.Ky,t.endRow(),r,r,o,u))return g;c=!1}if(c&&!z(a,t.Ky+s,t.endRow()-f,r,r,o,u))return g}else if(n===m.TableSelectionType.TABLE_CORNER_SELECT){for(c=!0,b=0,w=l=a.getSelections();b<w.length;b++)if((d=w[b]).col===t.iw&&d.row===t.Ky+s&&d.colCount===t.Tx&&d.rowCount===t.Sx-s-f){if(!z(a,t.Ky,t.endRow(),t.iw,t.endColumn(),o,u))return g;c=!1}if(c&&!z(a,t.Ky+s,t.endRow()-f,t.iw,t.endColumn(),o,u))return g}else if(n===m.TableSelectionType.TABLE_SELECT&&!z(a,t.Ky,t.endRow(),t.iw,t.endColumn(),o,u))return g}return{action:n,table:t}}function I(t,n){var e=t.Ky;return n-(t.jO?e+1:e)}function q(t,n){var e;return n-t.iw}function Z(t){var n=i;return t&&i++,n}function Q(t){return"string"==typeof t}function X(t,n,e,r){var i;t.ki(c.Events.TableResizing,{sheet:t,table:n,oldRange:e,newRange:r})}function tt(t,n,e,r,i){var o;t.ki(c.Events.TableResized,{sheet:t,table:n,oldRange:e,newRange:r},i)}function nt(t,n,e,r,i,o,u){var e={sheet:t,table:n,propertyName:e,row:I(n,r),count:i};v(o)||(e.isAfter=o),u&&(e.deletedItem=u),t.ki(c.Events.TableRowsChanged,e)}function et(t,n,e,r,i,o){var e={sheet:t,table:n,propertyName:e,col:r-n.iw,count:i};v(o)||(e.isAfter=o),t.ki(c.Events.TableColumnsChanged,e)}function rt(t,n,e){var r=0;if(t.cSt(n,e))for(r=2;t.cSt(n+r,r);)r++;return 0<r&&(n+=r),n}function it(t){return t&&"="===t[0]}function ot(t){var n,e,r,i,n=-1;if(t)for(e=t.arguments,r=void 0,i=0;i<e.length;i++)if((r=e[i])instanceof o.obt){n=i;break}return n}function ut(t,n,e){var t,r,t,i,t=t.dataRange(),r=t.row,t=t.col,i;return(e?r:t)+n}function at(t){var n=t;return n=t&&"="===t[0]?t.slice(1):n}function ft(t,n){for(var e,r,r=0;r<t.length;r++)if((e=t[r])&&n===e.col)return e;return g}function st(t,n){var e,r,i;if(n)for(e=n.row;e<n.row+n.rowCount;e++)for(r=n.col;r<n.col+n.colCount;r++)if(t.tables&&(i=t.tables.find(e,r)))return i;return null}function lt(t,n){return n?t.tables.AB(n.row,n.col,n.rowCount,n.colCount):null}function ct(t){return v(t)||("string"!=typeof t&&(t+=""),t=t.replace(/\r\n?/g,"\n")),t}function ht(t){return t===h}Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0,c=n("Core"),o=n("SheetsCalc"),u=n("CalcEngine"),e=n("Common"),r=n("./dist/plugins/table/table.ns.js"),m=n("./dist/plugins/table/table.js"),a=c.mt.T1,g=null,h=void 0,l=Math.max,v=e.Common.lt.ht,i=0,n=new e.Common.ResourceManager(r.SR,"Tables"),d=n.getResource.bind(n),t.Util={throwError:b,setFormulaToSheet:f,setValue:s,suspendPaint:w,resumePaint:y,Hyt:C,suspendCalcService:p,resumeCalcService:S,fSt:T,lSt:_,getRowCount:R,getColCount:x,isValidTableName:j,formulaToExpression:F,expressionToFormula:k,checkTableName:A,hSt:E,_4t:V,E4t:H,dSt:J,vSt:Y,mSt:$,gSt:K,pSt:W,bSt:I,ySt:q,T4t:Z,wSt:Q,j4t:X,S4t:tt,jj:nt,Ej:et,MSt:rt,kf:it,CSt:ot,SSt:ut,TSt:at,ASt:ft,_getTable:st,ISt:lt,xSt:ct,NSt:ht}},"./dist/plugins/table/table.entry.js":function(t,n,e){var r,i,r=this&&this.__createBinding||(Object.create?function(t,n,e,r){void 0===r&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);i&&("get"in i?n.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,r,i)}:function(t,n,e,r){t[r=void 0===r?e:r]=n[e]}),i=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||r(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),e("./dist/plugins/table/table.interface.js"),e("./dist/plugins/table/table-event.js"),e("./dist/plugins/table/table-render.js"),e("./dist/plugins/table/table-action.js"),e("./dist/plugins/table/table-util.js"),i(e("./dist/plugins/table/table-theme.js"),n),i(e("./dist/plugins/table/table.js"),n),i(e("./dist/plugins/table/table.ns.js"),n)},"./dist/plugins/table/table.interface.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(f,R,t){var s,l,O,Y,c,y,h,x,n,$,t,e,j,v,g,C,b,L,K,W,w,A,q,m,Z,Q,X,tt,nt,et,rt,it,ot,ut,at,ft,st,lt,ct,N,F,p,S,T,ht,vt,dt,z,I,r,bt,k,_,d,wt,mt,gt,yt,Ct,M,D,pt,St,Tt,_t,Rt,xt,jt,Ft,kt,At,Ot,Lt,Nt,zt,It,Mt,Dt,Bt,Ut,Et,Vt,B,U,E,Ht,Gt,Jt,Pt,Yt,$t,Kt,Wt,qt,Zt,Qt,Xt,tn,nn,en,rn,on,un,an,fn,sn,ln,cn,hn,vn,dn,bn,wn,mn,gn,yn,Cn,pn,Sn,i,Tn,_n,Rn,xn,t,jn,Fn,kn,An,On,Ln,Nn,zn,In,Mn,Dn,Bn,Un,En,Vn,Hn,Gn,Jn,Pn,Yn,$n,Kn,V,Wn,qn,Zn,Qn,Xn,te,ne,ee,re,ie,oe,ue,ae,fe,se,le,n,H,ce,he,ve,de,be,we,me,G,ge,n,ye,J,Ce,pe,Se,n,n,Te,r;function P(t){return typeof t===on}function _e(t,n){return t&&n&&t.color===n.color&&t.type===n.type||!t&&!n}function Re(t,n){var e,r,i,e=!1;if(L(t[n]))e=!0;else for(i=t.length-1;n<i;i--)if(L(t[r=i-1])){e=!0;break}return e}function xe(o,e,u){var t=o.parent,a=ht(o);function r(t,i){C(t,function(t,n){var e,r,e=n.getExpression(),r=Y.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(e,i,-1,-1,u);r!==e&&(n.SB(r),a.invalidName(o.Uw(),n.getName()))})}t?(r(t.getCustomNames(),e),C(t.sheets,function(t,n){r(n.getCustomNames(),e)})):r(o.getCustomNames(),e),a.onAfterRemoveTable(e,u)}function je(t,n){var e,r,n,i,e={position:O.ButtonPosition.right,imageType:O.ButtonImageType.dropdown,visibility:O.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},r,n={items:[{text:H().Table_None,value:null},{text:H().Table_Average,value:"=SUBTOTAL(101,[".concat(n,"])")},{text:H().Table_Count,value:"=SUBTOTAL(103,[".concat(n,"])")},{text:H().Table_Count_Numbers,value:"=SUBTOTAL(102,[".concat(n,"])")},{text:H().Table_Max,value:"=SUBTOTAL(104,[".concat(n,"])")},{text:H().Table_Min,value:"=SUBTOTAL(105,[".concat(n,"])")},{text:H().Table_Sum,value:"=SUBTOTAL(109,[".concat(n,"])")},{text:H().Table_StdDev,value:"=SUBTOTAL(107,[".concat(n,"])")},{text:H().Table_Var,value:"=SUBTOTAL(110,[".concat(n,"])")}]},i=new O.Style;return i.cellButtons=[e],i.dropDowns=[{type:O.DropDownType.list,option:n,submitCommand:"tableTotalRowFormula"}],i}function Fe(t){var n;t.tables.all().forEach(function(t){t.formulaFromJSON()})}function ke(t,n,e,r,i,o,u,a,f){var t,n;t&&0<t.length&&(t=t[n])&&(n=t[i]())&&("string"==typeof n&&e&&(n=e.u8(n)),e&&(0,O.composeParentStyle)(n,n,e,!1,10,!0),Ze(n,r,o,u,a,f))}function Ae(t){var t,n,n,e,t,t=t.c_[0],n=t&&t.c_&&t.c_[0];if(n)return n={kSt:{altText:n.altText,altTextSummary:n.altTextSummary}},e=t["xmlns:x14"],(t={kSt:{uri:t.uri}})["x14:table"]=n,t.kSt["xmlns:x14"]=e,{ext:t,attr:{}}}function Oe(t){if(t&&t.c_)return Ae(t)}function Le(t,n){var e,r;for(e in ve)!ve.hasOwnProperty(e)||L(t[e])||(0===(r=ve[e])?t[e]===n[e]&&(t[e]=U):1===r?_e(t[e],n[e])&&(t[e]=U):2===r&&O.util.rfe(t[e],n[e])&&(t[e]=U))}function Ne(t,n,e,r,i,o,u){var n,e,a,t;t.Ut&&(e=(n=t.Ut.sheetModels[3].J_(n,e))&&n.style)&&o&&"string"==typeof e&&(i[e]?n.style=i[e]:(a=o.i3(e))&&((a=Qe(t,a,!1,10,!0)).parentName=U,Le(a,r),t=u.Xd+u.$d+e,u.$d++,a.name=t,o.$p(a),n.style=t,i[e]=t))}function ze(t,n,e){if(t&&n){if("string"==typeof t){if(!e)return t;t=e.u8(t)}t&&((t=Qe(e,t,!1,10,!0)).parentName=U,Le(t,n))}return t}function Ie(t,n,e){return t[n]&&t[n][e]&&t[n][e].s}function Me(t,n,e,r){var i=t[n]&&t[n][e];t[n]||(t[n]={}),(i=t[n][e]?i:t[n][e]={}).s=r}function De(t,n,e,r,i,o,u,a,f){var s,l,c,f,s,h,s,a,s=t.getStyle(e,r),l=(s&&u.lv(s))+","+(a&&a._id)+","+(f&&f._id);if(o[l])Me(n,e,r,o[l]);else if(c=new O.Style,s||a||f){for(h in s&&c.compose(s),a&&c.compose(a),f&&c.compose(f),ve)ve.hasOwnProperty(h)&&L(c[h])&&(c[h]=i[h]);s=u.Xd+u.$d+c._id,u.$d++,c.name=s,Me(n,e,r,a=u.getStyleIndex(c)),o[l]=a}else f=!1,Ie(n,e,r)!==U&&(s=t.getValue(e,r),L(s)||(t.getStyle(-1,r)||t.getStyle(e,-1))&&(f=!0),f||Me(n,e,r,U))}function Be(t,n){var e,n;if(!t)return t;if(P(t)){if(!n)return U;e=(e=n.i3(t,!1))||(n=n.parent)&&n.i3(t,!1)}else e=t;return e}function Ue(t,n,e,r,i,o){n&&(n.table(t),(e=e||{lossless:{}})&&(e.lossless||(e.lossless={}),!1===t.showHeader()&&(e.lossless.showTableHeader=!1),e.ref||(e.lossless.showFilterButton=!1),e.lossless.range={row:t.Ky+1,col:t.iw,rowCount:t.Sx-1-(t.showFooter()?1:0),colCount:t.Tx},n.yh(e,r,i)),t.IB!==n&&(t.IB=n),o?t.IB.reFilter():(t.DSt=!0,t._St()))}function Ee(){var t=0;return function(){return++t}}function Ve(t,n){var e=t;return typeof n[t]===Qn?(n[t]++,e+="_".concat(n[e])):n[t]=0,e}function He(t,n,e){var n,r;n[e]&&(P(n=n[e])?t[e](n):((r=new O.Style).fromJSON(n,!1,void 0),t[e](r)))}function Ge(t,n,e,r,i){var o,u,a,f,s,l,c,h,v,d,b,w,m,e,n,o=e.id(),u=e.name(),a=e.dataField(),f=e.value(),s=e.footerValue(),l=e.dataAreaFormula(),c=e.footerFormula(),h=e.x5t,v=e.hTt,d=e.cellType(),b=e.formatter(),w=e.dataStyle(),m=e.headerStyle(),e=e.footerStyle(),n=At(n,u,i);r.id(o),r.name(n),r.dataField(a),r.footerValue(s),r.dataAreaFormula(l),r.footerFormula(c),r.x5t=h,r.hTt=v,r.value(f),r.headerStyle(m),r.footerStyle(e),(j(d)||j(b))&&(w?P(w)&&t&&(w=t.u8(w)):w=new O.Style,d!==U&&(w.cellType=d),b!==U)&&(w.formatter=b),r.dataStyle(w)}function Je(t){return t&&"string"!=typeof t&&t.clone?t.clone():t}function Pe(t,n,e,r){var i,i,r;t&&(i=t.getStyle(n,e))&&r&&(i=Qe(t,i),(r=Qe(t,r)).borderTop=i.borderTop!==U?r.borderTop:U,r.borderBottom=i.borderBottom!==U?r.borderBottom:U,r.borderLeft=i.borderLeft!==U?r.borderLeft:U,r.borderRight=i.borderRight!==U?r.borderRight:U,r.compose(i),t.setStyle(n,e,r))}function Ye(t,n,e,r,i,o){for(var u,a,f,s,l,c,h,a=o.layoutStyle(),f=o.headerIndex(),s=o.footerIndex(),l=o.startColumn(),c=e;c<=i;c++)for(u=o.columnLayoutStyle(c-l),h=n;h<=r;h++)h===f?(a.header&&Pe(t,h,c,a.header),null!=u&&u.header&&Pe(t,h,c,u.header)):h===s?(a.footer&&Pe(t,h,c,a.footer),null!=u&&u.footer&&Pe(t,h,c,u.footer)):(a.data&&Pe(t,h,c,a.data),null!=u&&u.data&&Pe(t,h,c,u.data))}function $e(t,n,e){var r;13===n.type&&(null==(r=n.baseTable)?void 0:r.name())===e&&(n.baseTable=t)}function Ke(n,t,e){var t;$e(n,t,e),null!=(t=t.arguments)&&t.forEach(function(t){Ke(n,t,e)})}function We(t,n,e,r,i,o,u){t.borderLeft=n,t.borderTop=e,t.borderRight=r,t.borderBottom=i,t.borderHorizontal=o,t.borderVertical=u}function qe(t,n,e){t[n]===U&&e!==U&&(t[n]=e)&&"object"==typeof e&&(t[n].level=20)}function Ze(t,n,e,r,i,o){var u=t[re],a=t[oe],f=t[ie],s=t[ue],l=t[ae],c=t[fe];We(t),n.h5(t),r&&qe(n,re,u),e&&qe(n,ie,f),o&&qe(n,oe,a),i&&qe(n,ue,s),qe(n,ie,l),qe(n,ue,l),qe(n,re,c),qe(n,oe,c),We(t,u,f,a,s,l,c)}function Qe(t,n,e,r,i){var o=new O.Style;return(n=n&&n.charAt?t.u8(n):n)&&(o.h5(n),(0,O.composeParentStyle)(n,o,t,e,r,i)),o}function Xe(t,n,e,r,i,o,u){r&&t?(P(t)&&(t=Qe(o,t)),(n=P(n)?Qe(o,n):n)?(n=n.clone()).compose(t):n=t,i[e+se]=u.getDxfIndex(n,!0)):n&&(P(n)?i[e+le]=n:(i[e+se]=u.getDxfIndex(n,!0),n.parentName&&(i[e+le]=n.parentName)))}function o(t,n,e,r,i,o,u){var a,f,a=this;for(a.jO=!u||u.showHeader===U||u.showHeader,a.oL=!(!u||u.showFooter===U)&&u.showFooter,a.ESt=!(!u||u.useFooterDropDownList===U)&&u.useFooterDropDownList,a.jSt=!(!u||u.showResizeHandle===U)&&u.showResizeHandle,a.OSt=[],a.H3=B,a.IB=B,a.jS=B,a.RSt=!1,j(t)&&a.name(t),a.Ky=j(n)?n:-1,a.iw=j(e)?e:-1,a.Sx=j(r)?r:-1,a.Tx=j(i)?i:-1,j(o)&&a.style(o),a.BSt=[],f=0;f<a.Tx;f++)a.BSt.push(new J(f+1));a.LSt=B,a.FSt={},a.PSt=[],a.aj=[],a.GSt=[],a.USt=[],a.HSt=[],a.zSt=[],a.VSt=!0}function tr(t,n){var t,e,t=t&&t.rowFilter&&t.rowFilter();return!L(t)&&(e=t.range).intersect(n.row,n.col,n.rowCount,n.colCount)}function nr(i){return function(t,n){var e=this,r=e.Mf;r&&t!==n&&(G.et(r,"tableNameChanged",{oldName:n,newName:t}),r.Ut.YSt(e,i,n,t),r.repaint())}}function er(t,n){var e=this;e.dl(),nr("style").call(e,t,n)}function rr(t,n,e,r,i){t.Qy().execute({cmd:Dn,sheetName:t.name(),tableName:n.name(),row:e,count:r,isAfter:i})}function ir(t,n,e,r,i){t.Qy().execute({cmd:Bn,sheetName:t.name(),tableName:n.name(),row:e,count:r,isAfter:i})}function or(t,n){t.Qy().execute({cmd:Un,sheetName:t.name(),tableName:n.name()})}function ur(t){var n,n;if(!L(t))return n=/\[\S[\S\s]*\S\]/,"SUBTOTAL("!==(t=t.trim()).substr(0,9)||!n.test(t)||t.indexOf("[[")?"custom":(n=t.substring(9,12),ge[n]||te)}function ar(t){return-1<t.indexOf("LET(")}function u(t){var n,e,n=Te.call(this)||this,e=n;return e.table(t),e.act=!1,n}function fr(t){var n=t.dataStyle();return n||(n=new O.Style,t.dataStyle(n)),n}function sr(t,n,e,r,i,o,u,a,f){var s=this;s.id(t),s.dataField(n),s.name(e||n||Tn+s.id()),s.dataStyle(a),j(r)&&s.formatter(r),j(i)&&s.cellType(i),s.value(o),s.headerStyle(u),s.footerStyle(f)}function lr(t,n){for(var e,r,e=n.row;e<n.row+n.rowCount;e++)for(r=n.col;r<n.col+n.colCount;r++)if(!L(t.getValue(e,r)))return;return 1}function a(t){this.Mf=t,this.U3=[],this.xl=[],this.Nl=[]}function cr(t,n){var t,e;return"Object"===n.constructor.name&&(t=t.findByName(n.tableName))&&(t.H3?n=t.H3:((e=new x.$$).fromJSON(n),t.H3=n=e)),n}function hr(t,n,e,r,i){for(var i,o,u,a,f,i=0===i,o=i?t.aj:t.GSt,u=-1,f=0;f<o.length;f++)if((a=o[f])&&a.key===r){u=f;break}-1<u&&o.splice(u,L(e)?1:e),i&&t.ZSt()}function vr(t,n){var n,e,r,t,n;n.refresh(),t&&(n=t.table,e=t.row,r=t.count,t=t.stateType,n=n.getSlicerData())&&(0===t?n.onRowsAdded(e,r):n.onRowsRemoved(e,r))}function dr(t,n,e){var r,i,o;if(n)for(r=n.length-1;0<=r;r--)o=cr(t,(i=n[r]).bindingManager),e?o.wtt(i):o.Mtt(i)}function br(t,n){var e=new G;return e.Sg(t),e.fromJSON(n),e}function wr(t,n){var e,r;if(n)for(e=0;e<n.length;e++)(r=n[e])&&"Object"===r.constructor.name&&(n[e]=t.findByName(r.name),n[e]||(n[e]=br(t,r)))}function mr(t,n){for(var e,r,e=0;e<n.length;e++)(r=n[e]).table&&"Object"===r.table.constructor.name&&(r.table=t.findByName(r.table.name)),wr(t,r.tableList),wr(t,r.changedTables)}s=this&&this.__extends||(Se=function(t,n){return(Se=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Se(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var n,e,r,i,e=1,r=arguments.length;e<r;e++)for(i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},Object.defineProperty(R,"__esModule",{value:!0}),R.TableRemoveOptions=R.TableManager=R.TableColumn=R.WSt=R.hasRowFilter=R.Table=R.TableSelectionType=void 0,O=t("Core"),Y=t("SheetsCalc"),c=t("Common"),y=t("CalcEngine"),h=t("Filters"),x=t("Bindings"),n=t("./dist/plugins/table/table.ns.js"),$=t("./dist/plugins/table/table-theme.js"),t=t("./dist/plugins/table/table-util.js"),e=O.mt.p0,j=O.mt.T1,v=O.mt.j,g=O.GC$.inArray,C=O.GC$.each,b=O.GC$.isEmptyObject,L=c.Common.lt.ht,K=c.Common.ct,W=c.Common.Uf.OS,w=c.Common.kh,A=O.mt.xr,q=O.mt.go,m=O.mt.c1,Z=O.mt.St,Q=O.CopyToOptions.all,X=O.StorageType.data|O.StorageType.style|O.StorageType.comment|O.StorageType.tag|O.StorageType.sparkline|O.StorageType.axis|O.StorageType.bindingPath|O.StorageType.hyperlink|O.StorageType.altText,tt=O.NodeHelper.sr,nt=O.NodeHelper.ur,et=O.mt.n1,rt=O.mt.vo,it=O.Util.gr,ot=O.Util.pr,ut=O.Util.mr,at=O.Util.addXLFNPrefix,ft=O.Util.wr,st=O.Util.Sr,lt=O.Util.po,ct=O.Util.yo,N=t.Util.throwError,F=t.Util.setFormulaToSheet,p=t.Util.setValue,S=t.Util.suspendPaint,T=t.Util.resumePaint,ht=t.Util.Hyt,vt=t.Util.suspendCalcService,dt=t.Util.resumeCalcService,z=t.Util.getRowCount,I=t.Util.getColCount,r=t.Util.checkTableName,bt=t.Util.isValidTableName,k=t.Util.formulaToExpression,_=t.Util.expressionToFormula,d=t.Util.hSt,wt=t.Util._4t,mt=t.Util.E4t,gt=t.Util.dSt,yt=t.Util.vSt,Ct=t.Util.mSt,M=t.Util.gSt,D=t.Util.pSt,pt=t.Util.bSt,St=t.Util.ySt,Tt=t.Util.T4t,_t=t.Util.wSt,Rt=t.Util.fSt,xt=t.Util.lSt,jt=t.Util.jj,Ft=t.Util.Ej,kt=t.Util.S4t,At=t.Util.MSt,Ot=t.Util.kf,Lt=t.Util.CSt,Nt=t.Util.SSt,zt=t.Util.TSt,It=t.Util.ASt,Mt=t.Util.ISt,Dt=t.Util.xSt,Bt=t.Util.NSt,Ut=O.range_parser.getRangeString,Et=O.range_parser.Dc,Vt=O.range_parser.jc,B=null,U=void 0,E=Math.min,Ht=Math.ceil,Gt=Math.max,Jt=JSON.stringify,Pt=JSON.parse,qt="highlightFirstColumn",Zt="highlightLastColumn",Qt="bandRows",Xt="bandColumns",tn="autoGenerateColumns",un="headerRowStyle",an="footerRowStyle",fn="wholeTableStyle",sn="highlightLastColumnStyle",ln="highlightFirstColumnStyle",cn="firstRowStripStyle",hn="secondRowStripStyle",vn="firstColumnStripStyle",dn="secondColumnStripStyle",bn="firstHeaderCellStyle",wn="lastHeaderCellStyle",mn="firstFooterCellStyle",gn="lastFooterCellStyle",yn="firstRowStripSize",Cn="secondRowStripSize",pn="firstColumnStripSize",Sn="secondColumnStripSize",i=".table",Tn="Column",t="dataAreaFormulaStr",jn="isArrayFormula",An="footerRowStyles",On=[_n="id",Yt="name",$t="cellType",Kt="value",Wt="formatter",Rn="dataField",xn="footerFormula",Fn="dataAreaFormula",kn="footerValue",en="headerStyle",nn="dataStyle",rn="footerStyle"],Ln=4,Nn=2,zn="table",In="tableResize",Mn="#485DB1",Dn="tableInsertRows",Bn="DoInsertRows",Un="tableShowFooter",En="tableDeleteRows",Vn="tableInsertColumns",Hn="tableDeleteColumns",Gn="collection",Jn="tableColumn",Pn="property",Yn="dataSource",$n="rowsChange",Kn="showFooter",V="range",Wn="columns",qn="tableExpression",Zn="sheetExpression",Qn="number",Xn=on="string",te="custom",ne=O.XFileConstants.Ki,ee=O.XFileConstants.Bu,re="borderLeft",ie="borderTop",oe="borderRight",ue="borderBottom",ae="borderHorizontal",fe="borderVertical",se="DxfId",le="CellStyle",n=new c.Common.ResourceManager(n.SR,"Tables"),H=n.getResource.bind(n),ce=O.UsedRangeUtil.hh,he=O.UsedRangeUtil.vh,ve={backColor:2,foreColor:0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},de=O.W.upe,(n=be=R.TableSelectionType||(R.TableSelectionType={})).TABLE_ROW_SELECT="tableRowSelect",n.TABLE_COL_SELECT="tableColSelect",n.TABLE_CORNER_SELECT="tableCornerSelect",n.TABLE_SELECT="tableSelect",(n=we=we||{})[n.deleted=0]="deleted",n[n.dirty=1]="dirty",O.Worksheet.ch(zn,{priority:2e3,getUsedRange:function(t){var n,e,r;t.type&O.UsedRangeType.table&&(r=(e=(n=this).tables).getUsedRange(),he(t.range,r))},init:function(){var v=this;v.tables=v.Ut.QSt,v.unbind(i),v.bind(O.Events.BeforeDragDrop+i,function(t,n){var e,r,i,o,u,a,f,e,s,e,l,c,h,l,e=v,r=v.tables,i=H().Exp_DragDropChangePartOfTable,o=n.fromRow,u=n.fromColumn,a=z(n),f=n.columnCount,e=e.rt.q6,s=e.row,e=e.col,l=n.isDragInsert,c=n.isDragCopy,h=B;!l||-1!==o&&-1!==u||(0<=u?(v.isDragCopy&&(e<=u||u+f<=e)||!c&&(e<u||u+f<e))&&(l=!1,r.oSt(-1,e,-1,1)&&(l=!0,h=H().Exp_DragDropShiftTableCell),l||c||!r.oSt(-1,u,-1,f)||(h=i)):0<=o&&u<0&&(c&&(s<=o||o+a<=s)||!c&&(s<o||o+a<s))&&!c&&r.oSt(o,-1,a,-1)&&(h=i)),n.invalidMessage=h}),v.bind(O.Events.RowChanged+i,function(t,n){var e,r,i,e=v.tables,r=e.xl,i=n.propertyName;"isVisible"===i?(!1===n.newValue?r[n.row]=0:r[n.row]=U,e.KSt(n.row)):"height"===i&&(r[n.row]=U,e.KSt(n.row))}),v.bind(O.Events.RowHeightChanged+i,function(t,n){for(var e,r,i,o,u,a,f,e=v.tables,r=e.xl,i=0,o=n.rowList;i<o.length;i++)r[u=o[i]]=U,f=(a=n.sheet).getRowHeight(u),e.KSt(u,0<f)}),v.bind(O.Events.ColumnChanged+i,function(t,n){var e,r,e=v.tables,r=e.Nl;"isVisible"===n.propertyName?(!1===n.newValue?r[n.col]=0:r[n.col]=U,e.JSt(n.col)):"width"===n.propertyName&&(r[n.col]=U,e.JSt(n.col))}),v.bind(O.Events.ColumnWidthChanged+i,function(t,n){for(var e,r,i,o,u,e=v.tables,r=e.Nl,i=0,o=n.colList;i<o.length;i++)r[u=o[i]]=U,e.JSt(u)}),v.bind(O.Events.RangeFiltered+i,function(t,n){for(var e,r,i,o,e=v.tables,r=e.xl,i=n.sheet.IB.range,o=0;o<i.rowCount;o++)r[i.row+o]=U,e.KSt(i.row+o)}),v.bind(O.Events.TableFiltered+i,function(t,n){for(var e,r,i,o,e=v.tables,r=e.xl,i=n.table.range(),o=0;o<i.rowCount;o++)r[i.row+o]=U,e.KSt(i.row+o)}),v.bind(O.Events.TableFilterCleared+i,function(t,n){var e;v.tables.dl()}),v.Q1i&&v.bind(O.Events.RangeChanged+i,function(t,n){var e,r,i,e=n.changedCells;if(e){if(v.pmi(),1500<e.length)v.tSe(e);else for(r=0;r<e.length;r++)i=e[r],v.Q1i(i.row,i.col,1,1,i.sheetArea);v.Smi()}})},resetBinding:function(t){this.tables.XSt()},initBinding:function(t){var n,e,r,i,o,u,n=this,e=n.tables;for(e.XSt(),vt(n),i=0,o=(r=e.all()).length;i<o;i++)(u=r[i])&&u.qSt();dt(n)},dispose:function(t){!1!==t.clearCache&&(this.unbind(i),this.tables)&&(this.tables.L0(),this.tables=null)},clearPendingChanges:function(){var t=this.tables;t&&t.$St()},onGroupChanged:function(t){var n,e,r,i,n,e=this.tables;if(t.fromSetCollapsed)for(r=t.isRow?e.xl:e.Nl,i=t.start;i<=t.end;i++)r[i]=U,t.isRow?e.KSt(i):e.JSt(i)},onLayoutChanged:function(t){var n,e,r,i,o,u,a,f,n=t.changeType,e=t.row,r=t.rowCount,i=t.col,o=t.colCount,u=t.sheetArea,a,f=this.tables;"setRowCount"===n||"setColumnCount"===n?f.dl():!L(u)&&3!==u||("addRows"===n?(f.JO(e,r),f.dl()):"addRows2"===n?f.t5t(e,r):"deleteRows"===n?(f.xP(e,r),f.dl()):"addColumns"===n?(f.qO(i,o),f.dl()):"deleteColumns"===n?(f.NP(i,o),f.dl()):"addColumns2"===n||"deleteColumns2"===n?f.n5t(i):"clear"!==n||t.ignoreTable||f.d5(e,i,r,o,t.type))},toJson:function(t,n){var e,r,i,o,i;function u(t,n){for(var e,r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,g,y,y,e=t.tables.all(),r=0,i=e.length;r<i;r++)if(u=(o=e[r]).z3(),f=(a=o.dataRange()).row,s=a.col,l=f+z(a)-1,c=s+I(a)-1,u){if(h=[],(v=o.BSt)&&0<v.length)for(d=0;d<v.length;d++)w=(b=v[d]).formatter(),L(w)||Z(w)||((m=new O.Style).formatter=w,h[d]=m);for(g=f;g<=l;g++)for(d=s;d<=c;d++)(y=o.Sl(g,d)).e5t&&(y=y.y4,K.W0(y)&&(y=K.Q0(y)),t.s8(n,g,d,y,U,h[d-s]))}}r=(e=this).tables,i=n&&n.ignoreStyle,o=n&&n.newWorkSheetName,i||(r&&(t.tables=r.toJSON(o,n)),n&&n.includeBindingSource&&((i=t.data).dataTable=i.dataTable||{},u(e,i.dataTable)))},wh:function(t,n,e){var r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,g,y,C,p,S,T,_,_,R,x,j,F,k,r=this,i=r.tables,o=e&&!1===e.includeStyles,u=n.styleManager;if(i&&!o){if(i.wh(t),e&&e.includeBindingSource)for(f=0,s=(a=i.all()).length;f<s;f++)if(c=(l=a[f]).z3(),v=(h=l.dataRange()).row,d=h.col,b=v+z(h)-1,w=d+I(h)-1,c){if(m=[],(g=l.BSt)&&0<g.length)for(y=0;y<g.length;y++)p=(C=g[y]).formatter(),L(p)||Z(p)||((S=new O.Style).formatter=p,m[y]=u.getStyleIndex(S));for(T=v;T<=b;T++)for(y=d;y<=w;y++)(_=l.Sl(T,y)).e5t&&(_=_.y4,K.W0(_)&&(_=K.Q0(_)),r.c8(t,T,y,_,n.sharedStrings,R=m[y-d]))}if(e&&O.OpenSaveFileType.excel===e.fileType&&(j=(x=i.U3).length,F=A(t,"sheetData"),k=n.defaultStyle,F)&&k)for(f=0;f<j;f++)(l=x[f]).M1e(F,k,u,r)}},fromJson:function(t,n,e){var r,i,o,o,e,r,i=this.tables,o=t.tableManager,o=n?o&&o.tables:t.tables,e=e&&e.ignoreStyle;j(o)&&!e&&i&&i.fromJSON(o,n,t.isApplyRefilter)},fromJsonAfterFormula:function(t,n,e){Fe(this)},fromJsonAfterSJSFormula:function(t){Fe(this)},yh:function(t,n,e){var r,i=e&&!1===e.includeStyles,o=this.tables,u=A(t,ee),t=t.rels;j(u)&&j(t)&&!i&&o&&o.yh(u,t,n,e)},lastNonNullRowAndCol:function(){var t,n,e,r,i,o,u,a,a,f,f,t,n,e=0,r=0,i=this.tables.all();if(i)for(o=0,u=i.length;o<u;o++)(a=i[o])&&(e<(f=(a=a.range()).row+z(a)-1)&&(e=f),r<(f=a.col+I(a)-1))&&(r=f);return{lastNonNullRow:e,lastNonNullCol:r}},paintCell:function(t){var n,e,r,t,i,o,e,u,e,i,u,o,e,t,n,t,a,f,n=this;t.isPrinting||t.sheetArea!==O.SheetArea.viewport||n.isActualProtected()||(e=n.tables,r=t.ctx,i=(t=t.cell).row,o=t.col,(e=e.find(i,o))&&e.showResizeHandle()&&!e.QL()&&(u=wt(n,e),e=mt(n,e),i===u)&&o===e&&(i=t.x,u=t.y,o=t.width,e=t.height,t=n.zoom(),n=Ht(4*t),t=Ht(2*t),a=i+o,f=u+e,r)&&0<o&&0<e&&(r.save(),r.rect(i,u,o,e),r.clip(),r.fillStyle=Mn,r.beginPath(),r.moveTo(a-n,f),r.lineTo(a,f),r.lineTo(a,f-t),r.lineTo(a-n,f-t),r.fill(),r.beginPath(),r.moveTo(a,f-t),r.lineTo(a-t,f-t),r.lineTo(a-t,f-n),r.lineTo(a,f-n),r.fill(),r.restore()))},composeTableFooterList:function(t){var n=t.table,e=t.row,r=t.col,t=t.style;n.i5t(e,r,t)},refSheetLazyLoaded:function(t,o,u){var n,e,t,r,a,n,e=this.tables.all();0<e.length&&R.WSt&&(t=t.rels.c_.filter(function(t){return t.Type===O.RelationshipConstants.lc}).map(function(t){return O.Util.vr(t.Target)}),r=o.tables,a={},O.GC$.each(t,function(t,n){var n=r[n];n&&(a[n.name]=n)}),O.GC$.each(e,function(t,n){var e,r,e,i,e=a[n.name()];e&&(r=A(e,"autoFilter"),e=A(e,"sortState"),Ue(n,i=n.IB||new R.WSt,r,e,o.styleManager),u.isApplyRefilter)&&n.IB.reFilter()}))}}),O.Worksheet.prototype.jj=function(t,n,e,r,i,o){var o=o?U:t.tq();jt(this,t,n,e,r,i,o)},O.Worksheet.prototype.Ej=function(t,n,e,r,i){Ft(this,t,n,e,r,i)},O.Worksheet.prototype.S4t=function(t,n,e){kt(this,t,n,e,!0)},O.Workbook.prototype.r5t=function(t){var n,e,e,r,n=this.sheets;if(n)for(r=0;r<n.length;r++)if((e=n[r].tables)&&(e=e.findByName(t)))return e;return B},me=Ee(),o.prototype.L0=function(){var t=this;t.BSt=[],t.OSt=[],t.aj=[],t.GSt=[],t.USt=[],t.FSt={},t.PSt=[],t.Mf=B,t.jS=B,t.IB&&(t.IB.L0(),t.IB=B),t.dl()},o.prototype.dl=function(){this.HSt=[],this.zSt=[]},o.prototype.range=function(){var t=this;return(0,O.Ec)(t.Ky,t.iw,t.Sx,t.Tx)},o.prototype.dataRange=function(){var t,n,e,t=this,n=t.jO?t.Ky+1:t.Ky,e=t.jO?t.Sx-1:t.Sx;return t.oL&&e--,(0,O.Ec)(n,t.iw,e,t.Tx)},o.prototype.headerIndex=function(){return this.jO?this.Ky:-1},o.prototype.footerIndex=function(){return this.oL?this.Ky+this.Sx-1:-1},o.prototype.showHeader=function(t){var n,e,n=this;return 0===arguments.length?n.jO:(n.jO!==t&&((e=n.Mf)&&e.suspendPaint(),n.o5t(t),e)&&e.resumePaint(),n)},o.prototype.layoutStyle=function(t){var n,e,r,i,o,u,a,t,f,s,n=this,e=n.Kpe,r=n.Jpe,i=n.Xpe;return 0===arguments.length?{data:Je(e),header:Je(r),footer:Je(i)}:((o=n.Mf).suspendPaint(),t=t?(a=t.data,u=t.header,t.footer):u=a=B,!o||r===u&&e===a&&i===t||(o.Ut.YSt(n,"layoutStyle",f={data:e,header:r,footer:i},s={data:a,header:u,footer:t}),n.Jpe=u,n.Kpe=a,n.Xpe=t),o.resumePaint(),n)},o.prototype.o5t=function(t){var n,e,r,i,n=this,e=n.Mf;e&&e.Ut.YSt(n,"showHeader",n.jO,t),(r=n.jO=t)?(0<n.Ky&&(n.Ky=n.Ky-1,n.Sx+=1),n.a5t()):(i=n.Ky,n.Ky=n.Ky+1,--n.Sx,n.u5t(i),n.s5t()),e&&y&&e.recalcRange(n.Ky+(t?0:-1),n.iw,1,n.Tx)},o.prototype.showFooter=function(t,n){var e,r,e=this;if(0===arguments.length)return e.oL;if(e.oL!==t){(r=e.Mf)&&r.suspendPaint();try{e.c5t(t,n||!1)}finally{r&&r.resumePaint()}}return e},o.prototype.expandBoundRows=function(t){var n=this;return 0===arguments.length?n.RSt:(n.RSt!==t&&(n.RSt=t),n)},o.prototype.c5t=function(t,n){var e,r,i,o,u,a,f,s,l,c,h,v,d,e=this,r=e.Mf;if(r&&r.Ut.YSt(e,Kn,e.oL,t),i=e.Sx,t){if((!r||e.Ky+i<r.getRowCount())&&(!n||e.f5t(!0,i)))for(e.oL=t,e.Sx+=1,u=(o=e.BSt).length,a=e.footerIndex(),f=e.iw,s=0;s<u;s++)h=f+s,(c=(l=o[s])&&l.footerFormula())&&(v=_(r,c,a,h))&&(c=k(r,v,a,h),l.footerFormula(c));e.l5t()}else e.oL=t,d=e.Ky+i-1,--e.Sx,e.u5t(d),e.I4t(),e.cL(0),n&&e.f5t(!1,i);r&&y&&r.recalcRange(e.Ky+e.Sx+(t?-1:0),e.iw,1,e.Tx)},o.prototype.f5t=function(t,n){var e,r,n,i,o,u,a,f,s,e=this,r=e.Mf,n=e.Ky+n,i=e.iw,o=e.Tx,u=i+o-1,a=gt(r,e),f=n<=a;return!(t&&Ct(r,e,n,a,i,u,1)||(f&&r.moveTo(n,i,s=t?n+1:n-1,i,a-n+1,o,Q),0))},o.prototype.h5t=function(t){for(var n,e,r,i,o,u,a,f,s,l,n=this,e=n.BSt,r=e.length,i=n.iw,o=[],u=n.name(),a=0;a<r;a++)f=i+a,s=n.getColumnName(a),o.push(je(u,s)),t||(0===a?n.d5t(f,H().Table_Total,!0):a!==r-1||(l=e[a].footerFormula())||(n.v5t(f)?n.m5t(a,"=SUBTOTAL(109,".concat(u,"[").concat(s,"])")):n.m5t(a,"=SUBTOTAL(103,".concat(u,"[").concat(s,"])"))));n.OSt=o},o.prototype.v5t=function(t){for(var n,e,n,r,i,o,u,a,n=this,e=n.Mf,n=n.dataRange(),r=!0,i=n.rowCount,o=n.row,u=0;u<i;u++)if(a=e.getValue(o+u,t),!L(a)&&typeof a!==Qn){r=!1;break}return r},o.prototype.g5t=function(){return this.OSt&&0<this.OSt.length},o.prototype.p5t=function(t,n,e){var r=this,i=this.Mf;r.g5t()&&(i&&i.Ut.YSt(r,An,r.b5t(),e),0<=n)&&(e?r.OSt.splice(t,n,e):r.OSt.splice(t,n))},o.prototype.b5t=function(){var t,n=this.OSt,e=[];return n.forEach(function(t){t&&e.push(t.clone())}),e},o.prototype.y5t=function(t,n,e){var r=this,e=j(e)?je(r.name(),e):B;r.g5t()&&r.p5t(t,n,e)},o.prototype.useFooterDropDownList=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.ESt:(e&&(e.suspendPaint(),n.ESt!==t&&(e.Ut.YSt(n,"useFooterDropDownList",n.ESt,t),n.ESt=t,n.ESt)&&!n.g5t()&&(n.h5t(),n.w5t()),e.resumePaint()),n)},o.prototype.showResizeHandle=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.jSt:(e&&(e.suspendPaint(),n.jSt!==t&&(e.Ut.YSt(n,"showResizeHandle",n.jSt,t),n.jSt=t),e.resumePaint()),n)},o.prototype.rowFilter=function(){var t=this;return!t.IB&&R.WSt&&(t.IB=new R.WSt(t),t.IB.Uct(t.dataRange())),t.IB},o.prototype.bindColumns=function(t){var n,e,r,i,o,u,a,f,n=this,e=n.Mf,r=[];if(t){for(i=t.length,n.autoGenerateColumns()||(i=E(n.Tx,t.length)),n.jO&&e.KI(n.Ky,n.iw,1,i,3,17,U,!0),o=0;o<i;o++)(u=n.BSt[o])||(u=new J(n.M5t()),n.BSt[o]=u),Ge(e,n,t[o],u,o),a=u.dataField(),f={name:u.name(),value:u.value(),dataField:a},a&&r.push(f),n.y5t(o,1,u.name());n.vTt()}n.C5t=r,n.H3&&(n.H3.J$=r)},o.prototype.bindingPath=function(t){var n=this;return 0===arguments.length?n.S5t:(n.S5t=t,n.qSt(),n)},o.prototype.bind=function(t,n,e){var r,i,r=this,i=e;return L(t)||r.bindColumns(t),L(e)&&(i=r.z3()),n&&(r.S5t=n,i=(0,x.q$)(i,n)),x.$$&&i&&r.T5t(i),r},o.prototype.getColumn=function(n){return this.BSt.find(function(t){return t.name()===n})},o.prototype.getColumnName=function(t){var n,n,t,n=this.BSt;return n&&0<=t&&t<n.length&&(n=n[t])?(t=n.name())!==B?v(t):t:B},o.prototype.setColumnName=function(t,n){var e,r,r,i,o,e=this;return e.cSt(n)||(r=e.BSt)&&0<=t&&t<r.length&&(i=(r=(r=r[t])||(e.BSt[t]=new J(e.M5t()))).name(),o=e.Mf,i!==n&&o&&(o.Ut.A5t(e,r,"name",i,n),r.name(n)),e.jO&&o&&o.setText(e.headerIndex(),e.iw+t,n),e.I5t(i,r.name(),t)),e},o.prototype.I5t=function(t,n,e){var r,i,o,r,r=this,i,o=r.BSt[e];r.y5t(e,1,o.name()),(r=this.LSt)&&r.onColumnNameChanged(t,n)},o.prototype.autoBind=function(){var t=this,n=t.z3();t.H3&&(t.H3.J$=B),x.$$&&n&&t.T5t(n)},o.prototype.refreshBinding=function(){var t,n,e,e,r,r,t=this;t.QL()&&(n=t.dataRange(),0<(e=t.pTt()))&&e!==z(n)&&(e=e,t.showHeader()&&(e+=1),t.showFooter()&&(e+=1),r=t.range(),r=(0,O.Ec)(r.row,r.col,e,I(n)),t.K5t(r,!0))},o.prototype.setColumnDataField=function(t,n){var e,r,r,t,i,t,e=this,r=e.BSt;return r&&0<=t&&t<r.length&&(r=(r=r[t])||(e.BSt[t]=new J(e.M5t())),t=e.Mf,i=r.dataField(),t&&n!==i&&t.Ut.A5t(e,r,"dataField",i,n),r.dataField(n),t=e.z3(),x.$$)&&t&&e.T5t(t),e},o.prototype.getColumnDataField=function(t){var n,n,t,n=this.BSt;return n&&0<=t&&t<n.length&&(n=n[t])?(t=n.dataField())!==B?v(t):t:B},o.prototype.getColumnFormula=function(t){var n,e,n,r,t,n,n=this.BSt,e=this.Mf;return n&&e&&0<=t&&t<n.length&&(n=n[t])?(r=this.footerIndex(),t=this.iw+t,(n=n.footerFormula())&&_(e,n,r,t,!1)):B},o.prototype.setColumnFormula=function(t,n){return this.m5t(t,n),this},o.prototype.setColumnDataFormula=function(t,n){var e,r,r,i,o,u,a,f,s,l,c,h,t;if(y){if((r=(e=this).BSt)&&0<=t&&t<r.length&&(r=r[t])){for(i=e.Mf,S(i),vt(i),o=t+e.iw,u=e.Ky,a=e.Sx,e.showHeader()&&(u++,a--),e.showFooter()&&a--,f=k(i,n,u,o,!0),s=r.dataAreaFormula(),i&&f!==s&&i.Ut.A5t(e,r,"dataAreaFormula",s,f),r.x5t(n),r.dataAreaFormula(f),l=u;l<u+a;l++)c=i.getFormula(l,o),F(i,l,o,n,f),n||(h=s&&_(i,s,l,o),(c=c&&_(i,k(i,c,l,o),l,o))===h&&i.Ut.setValue(l,o,B));i.Lp.resume(!(t=function(t){return t.w3===i.oMt&&t.row>=u&&t.row<u+a&&t.column===o}),U,t),T(i)}return e}},o.prototype.getColumnValue=function(t){var n,e,e,r,n=this,e=n.BSt;return e&&0<=t&&t<e.length&&(e=e[t])?n.oL&&e.footerFormula()&&(r=n.Mf)?r.getValue(n.footerIndex(),n.iw+t):e.footerValue():B},o.prototype.setColumnValue=function(t,n){var e,r,i,r,o,e=this,r=e.BSt,i=e.Mf;return r&&0<=t&&t<r.length&&((r=r[t])&&(o=r.footerValue(),i&&n!==o&&i.Ut.A5t(e,r,"footerValue",o,n),r.footerValue(n)),e.oL)&&i&&p(i,e.footerIndex(),e.iw+t,n),e},o.prototype.columnLayoutStyle=function(t,n){var e,r,r,t,i,o,u,a,f,s,e=this,r=e.BSt;return!(L(t)||t<0||t>=r.length)&&(r=r&&r[t])?(t=r.headerStyle(),i=r.dataStyle(),o=r.footerStyle(),n===U?{header:Je(t),data:Je(i),footer:Je(o)}:(s=f=a=void 0,(u=e.Mf).suspendPaint(),s=n?(a=n.header,f=n.data,n.footer):f=a=n,!u||t===a&&i===f&&o===s||(u.Ut.A5t(e,r,en,t,a),u.Ut.A5t(e,r,nn,i,f),u.Ut.A5t(e,r,rn,o,s),r.headerStyle(a),r.dataStyle(f),r.footerStyle(s)),u.resumePaint(),e)):e},o.prototype.filterButtonVisible=function(t,n){var e,r,i,o,u,a,f,s,l,e=this,r=e.Mf,i=e.rowFilter(),o=e.Tx,u=arguments;switch(u.length){case 0:return i&&i.filterButtonVisible();case 1:if("number"==(f=typeof(a=u[0])))return a<0||o<=a?void 0:i&&i.filterButtonVisible(a);if("boolean"==f&&i){for(S(r),s=0;s<e.Tx;s++)i.filterButtonVisible(s,a);T(r)}return e;case 2:return t<0||o<=t?void 0:(i&&i.filterButtonVisible(t,n),e)}},o.prototype.allowAutoExpand=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.VSt:(n.VSt!==t&&(e.Ut.YSt(n,"allowAutoExpand",n.VSt,t),n.VSt=t),n)},o.prototype.N5t=function(){return!!this.LSt},o.prototype.Sg=function(t){var n=this,e=n.jS;n.k5t(t),n.Mf&&n.Mf.Ut&&n.Mf.Ut.D5t(n,e)},o.prototype.k5t=function(t){var n,e,n=this;n.jS=t,n.Mf=t&&t.Mf,e=n.IB,t&&e&&e.Mf!==t.Mf&&e.table(n)},o.prototype._5t=function(t){for(var n,e,r,i,o,u,a,f,s,l,c,h,v,d,n=this,e=n.Mf,r=e.getDefaultStyle(),i=n.Ky,o=n.iw,u=n.Sx,a=n.Tx,f={},s=e.parent,l=n.jO?1:0,c=l+(n.oL?1:0),h=0;h<a;h++)for(v=h+o,n.jO&&Ne(e,i,v,r,f,s,t),n.oL&&Ne(e,n.footerIndex(),v,r,f,s,t),d=0;d<u-c;d++)Ne(e,d+i+l,v,r,f,s,t)},o.prototype.M1e=function(t,n,e,r){var i,o,u,a,f,s,l,c,h,v,d,b,w,m,g,y,C,p,S,i=this,o=i.Ky,u=i.iw,a=i.Sx,f=i.Tx,s={},l=i.jO?1:0,c=l+(i.oL?1:0),h=i.layoutStyle();for(h&&(v=Be(h.header,r),d=Be(h.data,r),b=Be(h.footer,r)),w=0;w<f;w++)for(m=w+u,p=C=y=void 0,(g=i.columnLayoutStyle(w))&&(y=Be(g.header,r),C=Be(g.data,r),p=Be(g.footer,r)),i.jO&&De(r,t,o,m,n,s,e,y,v),i.oL&&De(r,t,i.footerIndex(),m,n,s,e,p,b),S=0;S<a-c;S++)De(r,t,S+o+l,m,n,s,e,C,d)},o.prototype.E5t=function(t){var n=this,r=[];C(n.BSt,function(t,n){var e=n.dataField();e&&r.push({name:n.name(),value:n.value(),dataField:e})}),0<r.length&&(n.C5t=r,t.J$=n.C5t)},o.prototype.Woe=function(t){var n,e,r,i,r,t,o,n=this,e=n.Mf,r=n.dataRange(),i=r.row,r=z(r),t=t.getRowCount();r<t?n.RSt?(n.cue=!0,e.addRows(i+r,t-r),delete n.cue):((o=e.H3)&&o.Ctt&&(o.Stt=!0),n.mTt=!0,0===r?n.zpt(i,t,U,!0,!0):n.zpt(i+r-1,t-r,!0,!0,!0),delete n.mTt):t<r&&(n.RSt?e.deleteRows(i+t,r-t):(n.mTt=!0,n.yE(i+t,r-t,!0),delete n.mTt))},o.prototype.D3=function(t){var n,e,r,i,o,u,a,a,f,s,l,c,e,n=this,e=n.autoGenerateColumns(),r=n.IB&&n.IB.srt;if(n.s5t(),(i=n.Mf)&&(o=n.dataRange(),u=i.Ut,e?u.RCe(o.row,o.col,z(o),I(o),17,3):C(n.BSt,function(t,n){var e;n.dataField()&&u.RCe(o.row,o.col+t,z(o),1,17,3)})),e&&(a=n.range(),n.d5(a.row,a.col,z(a),I(a)),n.l5t(a.col,I(a),!0)),e||n.E5t(t),t){if(a={row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx},n.Woe(t),n.H3=t,e){for(n.Tx=t.getColumnCount(),n.BSt=[],f=t.ltt(),s=0;s<n.Tx;s++)l=new J(s+1),n.BSt[s]=l,f&&(l.name(f[s]),l.dataField(f[s]));n.ESt&&(n.OSt=[],n.j5t(n.iw))}else c=[],n.BSt.forEach(function(t){var t=t.dataField();t&&c.push(t)}),t.htt(c);i&&((e=i.Ut).YSt(n,V,a,{row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx}),e.yge(n.Ky,n.iw,n.Sx,n.Tx))}else n.H3=t;n.IB&&(n.IB.Uct(n.dataRange()),n.IB.srt=r)},o.prototype.O5t=function(t){var n,e,r,e,i,o,u,n=this,e=n.H3;if(e&&(r=e.ltt()))for(i=(e=n.BSt[t-n.startColumn()])&&e.dataField(),o=0,u=r.length;o<u;o++)if(r[o]===i)return o;return-1},o.prototype.Sl=function(t,n){var e,r,i,o,t,i,e=!1,r=U,i=this,o=i.H3,t=t-i.dataRange().row;return o&&t<o.getRowCount()&&0<=(i=i.O5t(n))&&(e=!0,r=o.getValue(t,i).value),{e5t:e,y4:r}},o.prototype.Kbt=function(t,n,e,r){var i,o,u,a,f,s,a,r,l,l,r,i=this,o=i.H3,u=pt(i,t),a=i.IB,s=!1;return o&&0<=(f=i.O5t(n))&&(r&&a&&a.isRowFilteredOut(t)||(a=(r=o.getValue(u,f)).value,(l=(l=i.Mf)&&l.Ut)&&r.hasBinding&&a!==e&&(r=Tt(!0),i.R5t(t,u,r),l.B5t(i,t,B,r,we.dirty),l.dE(t,n,{d6:a})),o.setValue(u,f,e,l&&l.G8)),s=!0),i.DSt=!0,s},o.prototype.ML=function(t,n,e){var r=new O.Style;return this.h5(t,n,r,e),r},o.prototype.L5t=function(t){var n,e,r,n=this.jS.xl,e=n[t];return e===U&&(r=this.Mf,e=n[t]=r.getRowHeight(t)),e},o.prototype.F5t=function(t){var n;return this.Mf.getColumnWidth(t)},o.prototype.qpe=function(t,n,e,r,i,o,u){var a,f,s,l,a=this,f=a.Mf,s;ke(a.BSt,t-a.iw,f,n,e,r,!0,o,!0),e===en?l=a.Jpe:e===nn?l=a.Kpe:e===rn&&(l=a.Xpe),(l=l&&("string"==typeof l&&f?f.u8(l):l))&&Ze(l,n,r,i,o,u)},o.prototype.h5=function(t,n,e,r){var i,o,u,a,f,s,l,c,h,v,d,b,w,m,l,g,y,C,a,a,a,a,f,a,f,a,b,g,w,y,p,S,s,T,_,R,x,j,r,i=this,o=i.style(),u=i.Mf,a=i.headerIndex(),f=i.footerIndex(),s=i.jO,l=i.oL,c=s?t===i.Ky+1:t===i.Ky,h=l?t===i.Ky+i.Sx-2:t===i.Ky+i.Sx-1,v=n===i.iw,d=n===i.iw+i.Tx-1;if(a!==t&&f!==t?i.qpe(n,e,nn,c,v,h,d):t===a?i.qpe(n,e,en,!0,v,!0,d):t===f&&i.qpe(n,e,rn,!0,v,!0,d),o){if(b=i.highlightLastColumn(),w=i.highlightFirstColumn(),m=s?t===a:t===i.Ky,l=l?t===f:t===i.Ky+i.Sx-1,g=o[sn](),y=o[ln](),C=new O.Style,a===t)a=o[wn](),d&&b&&a&&a.h5(C,!0,!0,!0,!0),a=o[bn](),v&&w&&a&&a.h5(C,!0,!0,!0,!0),(a=o[un]())&&a.h5(C,!0,v,!0,d),d&&b&&g&&g.h5(C,!0,!0,!1,!0),v&&w&&y&&y.h5(C,!0,!0,!1,!0);else if(f===t)a=o[gn](),d&&b&&a&&a.h5(C,!0,!0,!0,!0),f=o[mn](),v&&w&&f&&f.h5(C,!0,!0,!0,!0),(a=o[an]())&&a.h5(C,!0,v,!0,d),d&&b&&g&&g.h5(C,!1,!0,!0,!0),v&&w&&y&&y.h5(C,!1,!0,!0,!0);else{if(d&&b&&g&&g.h5(C,m,!0,l,!0),v&&w&&y&&y.h5(C,m,!0,l,!0),f=s?t-i.Ky-1:t-i.Ky,S=p=y=w=g=b=a=void 0,s=!r||"cellType"!==r&&"formatter"!==r,i.bandRows()&&s&&0<(b=(a=o[yn]())+o[Cn]())){if(void 0===(g=i.HSt[t])){if(O.Be.Fl&&O.Be.Gl){for(T=O.Be.Gl,_=i.dataRange().row;-1===T[_];)_++;if(t<_)return;f=T[t]-T[_]}else if(u){for(R=0,_=i.dataRange().row;_<t;_++)0<i.L5t(_)&&R++;f=R}g=i.HSt[t]=f%b}w=o[cn](),y=o[hn](),g<a&&w?w.h5(C,p=0===g,v,S=h||g===a-1,d):a<=g&&y&&y.h5(C,p=g===a,v,S=h||g===b-1,d)}if(i.bandColumns()&&s&&0<(b=(a=o[pn]())+o[Sn]())){if(void 0===(g=i.zSt[n])){if(x=0,u)for(j=i.iw;j<n;j++)0<i.F5t(j)&&x++;g=i.zSt[n]=x%b}w=o[vn](),y=o[dn](),g<a&&w?w.h5(C,c,p=0===g,h,S=d||g===a-1):a<=g&&y&&y.h5(C,c,p=g===a,h,S=d||g===b-1)}}(r=o[fn]())&&r.h5(C,m,v,l,d),i.P5t(e,C)}},o.prototype.i5t=function(t,n,e){var r,i,o,u,a,t,i,n,r=this,i=r.oL,o=r.ESt,u,a;r.footerIndex()===t&&i&&r.g5t()&&(t=r.OSt[n-r.iw])&&o&&(i=e.cellButtons,n=e.dropDowns,L(i)&&(i=[]),e.cellButtons=i.concat(t.cellButtons),L(n)&&(n=[]),e.dropDowns=n.concat(t.dropDowns))},o.prototype.P5t=function(t,n){var t=t,e=20,r,r,r,r;L(t.backColor)&&(t.backColor=n.backColor),Bt(t.foreColor)&&(t.foreColor=n.foreColor),L(t.themeFont)&&L(t.lpe)&&(t.themeFont=n.themeFont),L(t.lpe)&&(t.lpe=n.lpe),Bt(t.lre)&&(t.lre=n.lre,t.Uge=n.Uge,t.fpe=n.fpe),Bt(t.spe)&&(t.spe=n.spe),Bt(t.cpe)&&(t.cpe=n.cpe),t.b2e===U&&(t.b2e=n.b2e),t.y2e===U&&(t.y2e=n.y2e),t.w2e===U&&(t.w2e=n.w2e),t._font=de(t.spe,t.cpe,t.lre,t.lpe,t.b2e,t.y2e,t.w2e),L(t.borderLeft)&&(r=n.borderLeft,t.borderLeft=r&&r.Gf()||r,t.borderLeft)&&(t.borderLeft.level=20),L(t.borderTop)&&(r=n.borderTop,t.borderTop=r&&r.Gf()||r,t.borderTop)&&(t.borderTop.level=20),L(t.borderRight)&&(r=n.borderRight,t.borderRight=r&&r.Gf()||r,t.borderRight)&&(t.borderRight.level=20),L(t.borderBottom)&&(r=n.borderBottom,t.borderBottom=r&&r.Gf()||r,t.borderBottom)&&(t.borderBottom.level=20),L(t.textDecoration)&&(t.textDecoration=n.textDecoration),L(t.cellType)&&(t.cellType=n.cellType),L(t.formatter)&&(t.formatter=n.formatter)},o.prototype.G5t=function(t,n){var e,r,i,o,u,a,e=this;if((t!==e.Ky||n!==e.iw)&&(r=e.Mf)){if((t<0||r.getRowCount()<t+e.Sx||n<0||r.getColumnCount()<n+e.Tx)&&N(H().Exp_TableMoveOutOfRange),u=o=void 0,i=e.jS)for(u=0,a=(o=i.U3).length;u<a;u++)if(o[u]===e){o.splice(u,1),e.U5t();break}r.moveTo(e.Ky,e.iw,t,n,e.Sx,e.Tx,3),o&&u<=a&&(e.H5t(t,n),o.splice(u,0,e),e.z5t()),this.cL(1)}},o.prototype.H5t=function(t,n){var e,r,e=this,r=e.Mf;r&&r.Ut.YSt(e,V,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},{row:t,col:n,rowCount:e.Sx,colCount:e.Tx}),e.Ky=t,e.iw=n,e.V5t(),e.dl()},o.prototype.U5t=function(t,n,e){var r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,g,r=this,i=r.Mf;if(i&&y){for(o=r.BSt,u=r.footerIndex(),a=r.range(),s=(f=r.dataRange()).row,l=z(f),L(t)&&(t=0,n=o.length);t<n;t++)if(c=o[t],h=a.col+t,c){for(c.footerFormula()&&0<=u&&(F(i,u,h,B),p(i,u,h,B)),v=c.x5t(),d=zt(v),w=b=void 0,m=0;m<l;m++)b=i.getFormula(w=s+m,h),L(b)||(L(r.Y5t)&&(r.Y5t=[]),F(i,w,h,B),r.Y5t.push({row:w,col:h,formula:b})),L(b)||!L(d)&&_(i,k(i,d,r.Ky,h),w,h)===b||(L(r.Z5t)&&(r.Z5t=[]),g=It(r.Z5t,h),L(g)?((g={}).col=h,g.rowIndexes=[],g.rowIndexes.push(w),r.Z5t.push(g)):g.rowIndexes.push(w));if(c.x5t(U),c.dataAreaFormula())for(m=0;m<l;m++)F(i,w=s+m,h,B),p(i,w,h,B)}!0===e&&(r.Y5t=[])}},o.prototype.W5t=function(t,n,e){var r,i,o,u,a,f,s,l,a,r=this,i=r.Mf,o=r.Y5t;if(o&&0<o.length){for(f=0;f<o.length;f++)u=!0,(a=o[f])&&(s=a.row,l=a.col,a=a.formula,t<=s&&(!0===e&&(s+=n),!1===e)&&(s<t+n?u=!1:s-=n),u)&&F(i,s,l,a);r.Y5t=[]}r.Xyt(t,n,!0,e)},o.prototype.Q5t=function(t,n,e){var r,i,o,u,a,f,s,l,a,c,h,v,d,b,w,m,g,y,C,p,S,T,_,R,w,r=this,i=r.Mf,o=r.Y5t;if(o&&0<o.length){for(f=0;f<o.length;f++)u=!0,(a=o[f])&&(s=a.row,l=a.col,a=a.formula,t<=l&&(!0===e&&(l+=n),!1===e)&&(l<t+n?u=!1:l-=n),u)&&F(i,s,l,a);for(c=r.Z5t||[],h=void 0,f=0;f<c.length;f++)(h=c[f])&&t<=(v=h.col)&&(!0===e&&(h.col+=n),!1===e)&&t+n<=v&&(h.col-=n);for(r.Xyt(t,n,!1,e),b=(d=r.BSt).length,m=(w=r.dataRange()).row,g=w.col,y=w.rowCount,_=T=S=p=C=void 0,f=0;f<b;f++)if(_=g+f,(p=d[f])&&(S=p.dataAreaFormula())){for(C=m,R=0;R<c.length;R++)if((h=c[R])&&h.col===_){for(;-1<h.rowIndexes.indexOf(C)&&C<m+y;)C++;break}C<m+y&&(T=i.getFormula(C,_))&&p.dataAreaFormula(k(i,T,m,_))}r.Y5t=[],r.Z5t=[]}else(w=i.b8&&(i.parent||i).xyt())&&0<w.length&&r.Xyt(t,n,!1,e,U,!0)},o.prototype.Xyt=function(t,n,e,r,i,o){var u,a,f,s,l,c,h,v,d,b,w,w,m,g,y,C,p,S,T,u=this,a=u.Mf,f=u.BSt,s=u.footerIndex(),l=u.dataRange(),c=l.row,h=l.col,v=l.rowCount,d=l.colCount,b=a.b3(),w=a.Lp;if(w&&b&&(w=w.Hyt()))if(p=b.rT,S=function(t,n){return e?t=c:n=h,l.contains(t,n)},o)p.Iyt=!0,w.Xyt(p,t,n,e,r,S),delete p.Iyt;else if(i||(w.Zyt(b,c,h,v,d),w.Xyt(p,t,n,e,r,S)),u.oL)for(i||(w.Zyt(b,s,h,1,d),w.Xyt(b.rT,t,n,e,r,!1)),T=0;T<d;T++)(m=f[T])&&(g=m.footerFormula(),C=h+T,g)&&(y=a.getFormula(s,C))&&(a&&a.Ut.A5t(u,m,"footerFormula",g,y),m.footerFormula(k(a,y,s,C)))},o.prototype.z5t=function(){var t,a,f,s,l,t=this,a=t.Mf;a&&y&&(f=t.footerIndex(),s=t.range(),l=t.dataRange(),C(t.BSt,function(t,n){var e,t,r,i,o,u,e=s.col+t,t=n.footerFormula(),r=n.dataAreaFormula();if(t&&0<=f&&F(a,f,e,B,t),r)for(i=0,o=z(l);i<o;i++)u=l.row+i,F(a,u,e,B,r)}))},o.prototype.K5t=function(t,n){var e,r,i,o,u,a,f,s,l,c,h,v,d,b,w,c,m,g,i,y,o,a,C,C,p,S,T,f,o,a,C,l,y,i,o,f,o,i,e=this,r=e.dataRange();if(!t.equals(e.range())){if(i=t.row,o=t.col,u=z(t),a=I(t),f=e.jO,s=e.oL,l=e.ESt,c=0,h=1,f&&(c+=1),s&&(c+=1),(b=e.Mf)&&((u<c||a<1||i+u>b.getRowCount()||o+a>b.getColumnCount())&&N(H().Exp_TableResizeOutOfRange),i===e.Ky&&t.intersect(e.Ky,e.iw,e.Sx,e.Tx)||N(H().Exp_TableResizeInvalidRange),d={row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},v=e.BSt.slice()),w=e.BSt,m=(c=o)+a-1,g=e.iw,i=e.iw+e.Tx-1,y=e.Tx,e.iw=o,e.Tx=a,o=e.layoutStyle(),a=d.row===e.headerIndex()?d.row+1:d.row,C=(C=d.row+d.rowCount-1)===e.footerIndex()?C-1:C,c<g){for(p=0,S=c;S<g;S++)T=new J(e.M5t()),w.splice(p,0,T),p++;f&&e.a5t(0,g-c,U,U,!0),s&&e.l5t(0,g-c,U,!0),d&&o.data&&Ye(b,a,c,C,g-1,e)}else c<=i&&(e.U5t(g,c),w.splice(0,c-g));if(i<m){for(S=1+i;S<=m;S++)T=new J(e.M5t()),w.push(T);f&&e.a5t(y,m-i,U,U,!0),s&&e.l5t(y,m-i,U,!0),d&&o.data&&Ye(b,a,1+i,C,m,e),l&&e.j5t(y)}else g<=m&&(e.U5t(m,i),w.splice(w.length-(i-m),i-m));u!==e.Sx&&(f=e.H3,a=(o=e.dataRange()).row,C=z(o),f?u>e.Sx?(l=a+C-1,y=u-e.Sx,b&&((o=M(b,new O.Range(i=l+y+1,c,b.getRowCount()-i,m)))&&o.row<i||e.N4t(l,y,!0,!1,B,B,n),Ye(b,l,c,l+y-1,m,e))):b&&(f=e.Sx-u,e.yE(a+C-f,f)):(o=void 0,s&&(e.l5t(),o=e.footerIndex()),i=e.Sx,e.Sx=u,d&&(d.row>t.row&&Ye(b,t.row,c,d.row-1,m,e),d.row+d.rowCount-1<t.row+t.rowCount-1)&&Ye(b,d.row+d.rowCount,c,t.row+t.rowCount-1,m,e),e.J5t(U,U,i<u),s&&(e.w5t(),e.u5t(o)))),b&&(b.Ut.YSt(e,V,d,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx}),b.Ut.YSt(e,Wn,v,e.BSt.slice())),e.dl(),e.V5t(!1),e.X5t(r,e.dataRange()),e.I4t(),e.cL(0)}},o.prototype.X5t=function(t,n){var e,r,i,o,u,a,f,s,t,l,n,c,e,r=this.LSt;r&&(i=t.col,o=z(t),u=I(t),a=n.col,f=z(n),s=I(n),t=t.row+o,l=i+u,c=a+s,(n=n.row+f)<t&&r.onRowsRemoved(f,t-n),t<n&&r.onRowsAdded(o,n-t),i<a&&r.onColumnsRemoved(0,a-i),c<l&&r.onColumnsRemoved(s,l-c),a<i&&r.onColumnsAdded(0,i-a),l<c)&&r.onColumnsAdded(i+u-a,c-l)},o.prototype.V5t=function(t){var n=this,e=n.IB;e&&(e.Uct(n.dataRange()),!1!==t)&&e.reFilter()},o.prototype.s5t=function(){var t=this.IB;t&&(t.unfilter(),t.reset())},o.prototype.cSt=function(t,n){var e,r;for(t!==B&&(t=v(t)),e=0;e<this.Tx;e++)if(e!==n&&t===(r=this.getColumnName(e)))return!0;return!1},o.prototype.q5t=function(t){var n,e,t,n,e,n=this,e=n.BSt;return n.jO&&e&&0<=(t=t-n.iw)&&t<e.length&&(n=e[t])?(e=n.name(),L(e)?e:v(e)):B},o.prototype.$5t=function(t,n){var e,r,i,t,i,r,o,e=this,r=e.BSt;e.jO&&r&&(i=r.length,0<=(t=t-e.iw))&&t<i&&(i=r[t])&&(r=i.name(),(o=e.Mf)&&n!==r&&o.Ut.A5t(e,i,"name",r,n),i.name(n),e.I5t(r,i.name(),t))},o.prototype.m5t=function(t,n,e){var r,i,o,u,a,i,t,r=this,i=r.BSt,o=r.footerIndex(),u=r.iw+t,a=r.Mf;y&&0<=t&&t<i.length&&(i=i[t],n&&!e&&a&&(e=k(a,n,o,u),r.oL)&&F(a,o,u,n,e),i)&&(t=i.footerFormula(),a&&e!==t&&a.Ut.A5t(r,i,"footerFormula",t,n),i.footerFormula(e))},o.prototype.d5t=function(t,n,e){var r,i,e,i,e,o,r=this,i=r.BSt;(e||r.oL)&&i&&0<=(e=t-r.iw)&&e<i.length&&(i=i[e])&&(n!==(e=i.footerValue())&&(o=r.Mf)&&(o.Ut.A5t(r,i,"footerValue",e,n),o.Ut.dE(r.Ky+r.Sx-1,t,{d6:i.footerValue()})),i.footerValue(n))},o.prototype.M5t=function(){for(var t,n,e,r,i,t=this.BSt,n=t&&t.length,e=[],i=0;i<n;i++)(r=t[i])&&r.tTt()&&e.push(r.id());if(e.sort(function(t,n){return t-n}),0<(n=e.length)){for(i=0;i<n;i++)if(e[i]!==i+1)return i+1;return n+1}return 1},o.prototype.nTt=function(t,n){var e,r,i,n;if(!L(t)&&!this.cSt(t,n))return t;if(r=Tn,i=0,t)r=t,i=1;else if(0<n&&(t=this.BSt[n-1].name(),n=/[0-9]+$/.exec(t))){if(r=t.substr(0,n.index),i=parseInt(t.substr(n.index),10),!this.cSt(e=r+(i+1)))return e;r=t,i=1}for(;;)if(!this.cSt(e=r+ ++i))return e},o.prototype.a5t=function(t,n,e,r,i){var o,u,a,f,o,s,l,c,h,v,d,b,w,m,w,u=this,a=u.BSt,f=u.Mf;if(u.jO&&a&&f)for(o=a.length,s=u.headerIndex(),l=u.iw,L(t)&&(t=0),L(n)&&(n=o),h=E(o,t+n),d=null==(o=u.layoutStyle())?void 0:o.header,b=t;b<h;b++)(c=a[b])&&(w=u.jS.U3,-1<(m=g(u,w))&&w.splice(m,1),v=Dt(f.getValue(s,l+b)),-1<m&&w.splice(m,0,u),F(f,s,l+b,B),v&&(e?(u.eTt=e,f.setText(s,l+b,c.name()),delete u.eTt):((w=r?v:u.nTt(v,b))===v?(f.Ut.A5t(u,c,"name",c.name(),v),c.name(v)):f.setText(s,l+b,w),y&&f.gL(s,l+b))),i)&&Pe(f,s,l+b,d)},o.prototype.j5t=function(t){for(var n,e,r,n=this.BSt,e=t;e<n.length;e++)r=je(this.name(),n[e].name()),this.OSt.push(r)},o.prototype.l5t=function(t,n,e,r){var i,o,u,a,i,f,s,l,c,h,v,d,b,h,v,w,o=this,u=o.BSt,a=o.Mf;if(o.oL&&u&&a)for(o.useFooterDropDownList()&&!o.g5t()&&o.h5t(),i=u.length,f=o.footerIndex(),s=o.iw,L(t)&&(t=0),L(n)&&(n=i),L(e)&&(e=o.iTt),c=E(i,t+n),d=null==(i=o.layoutStyle())?void 0:i.footer,b=t;b<c;b++)(l=u[b])&&(v=a.getValue(f,s+b),L(v)||e?(o.eTt=e,p(a,f,s+b,l.footerValue()),delete o.eTt):(v!==(h=l.footerValue())&&a.Ut.A5t(o,l,"footerValue",h,v),l.footerValue(v)),(h=a.bMt&&a.bMt(f,s+b))&&!e?(h!==(v=l.dataAreaFormula())&&(w=_(a,h,f,s+b),a.Ut.A5t(o,l,"dataAreaFormula",v,w)),l.footerFormula(h)):o.rTt||(o.eTt=e,F(a,f,s+b,B,l.footerFormula()),delete o.eTt),r)&&Pe(a,f,s+b,d)},o.prototype.oTt=function(t,n){var e,r,i,o,u,a,f,s,e=this,r=e.BSt;if(e.jO&&r)for(i=r.length,L(t)&&(t=0),L(n)&&(n=i),u=E(i,t+n),a=t;a<u;a++)(o=r[a])&&(f=o.name(),(s=e.Mf)&&f!==B&&s.Ut.A5t(e,o,"name",f),o.name(B),e.I5t(f,o.name(),a))},o.prototype.aTt=function(t){var n,e,r,i,o,u,a,f,s,t,n=this,e=n.dataRange();if(e.containsRange(t)){for(r=t.row,i=t.col,o=z(t),u=I(t),a=[],f=0;f<o;f++)for(s=0;s<u;s++)n.Kbt(r+f,i+s,B,!0),a.push({columnName:n.getColumnName(i+s-e.col),row:r+f-e.row,data:""});(t=n.LSt)&&t.onDataChanged(a)}},o.prototype.uTt=function(t,n){var e,r,i,o,u,a,f,f,e=this,r=e.BSt;if(e.oL&&r)for(L(t)&&(t=0),L(n)&&(n=r.length),o=E(r.length,t+n),u=t;u<o;u++)(i=r[u])&&(a=e.Mf,f=i.footerFormula(),a&&B!==f&&a.Ut.A5t(e,i,"footerFormula",f),i.footerFormula(B),f=i.footerValue(),a&&B!==f&&a.Ut.A5t(e,i,"footerValue",f),i.footerValue(B))},o.prototype.w5t=function(){var t,n,e,r,i,o,u,a,f,t=this,n=t.BSt;if(t.oL&&n&&(e=t.Mf))for(r=n.length,o=t.iw,a=t.footerIndex(),f=0;f<r;f++)(i=n[f])&&(p(e,a,u=o+f,i.footerValue()),F(e,a,u,B,i.footerFormula()))},o.prototype.u5t=function(t){var n,e,r,i,o,u,n=this,e=n.Mf;if(e&&!(t<0||e.getRowCount()<=t))for(r=n.iw,i=n.Tx,u=0;u<i;u++)F(e,t,o=r+u,B),p(e,t,o,B)},o.prototype.JO=function(t,n,e,r,i,o){var u,a,e,f,s,l,c,o,e,u=this,a=!1,e=e?1:0,f=u.jO&&1===u.Sx;return!f&&t>=u.Ky+u.Sx+e||((s=u.Mf)&&(l=s.Ut,c={row:u.Ky,col:u.iw,rowCount:u.Sx,colCount:u.Tx}),o||u.sTt(t,n,!1),o=u.Ky,e=u.Ky+u.Sx-1+e,t<=o&&!i?u.Ky+=n:(t<=e||f)&&(r||(a=u.cTt(t,n)),u.Sx+=n),s&&l.YSt(u,V,c,{row:u.Ky,col:u.iw,rowCount:u.Sx,colCount:u.Tx})),a},o.prototype.t5t=function(t,n,e){var r,i,i,o,e,u,u,r=this,i=r.Ky+r.Sx-1;!e&&t>=r.Ky&&t<=i&&r.J5t(t,n,!0),e||(r.Xyt(t,n,!0,!0,!0),r.fTt()),i=r.LSt,e=(o=r.dataRange()).row,u=r.endRow(),e<=t&&t<=u&&i&&i.onRowsAdded(t-e,n),(u=r.IB)&&(r.DSt=!0,u.JO(t,n),r.lTt)&&r.Mf.filterRowsVisibleInfo.rE(t,n)},o.prototype.cTt=function(t,n){var e,r,i,i,o,e=this,r=e.H3;return!!r&&(o=void 0,(i=(i=this.Mf)&&i.Ut.G8)&&!(o=i.tableChanges)&&(i.tableChanges=o=[]),r.kE(pt(e,t),n,o),!0)},o.prototype.J5t=function(o,u,a){var f,s,t;y&&(s=(f=this).Mf,t=f.dataRange(),L(o)&&(o=t.row),L(u)&&(u=t.rowCount),vt(s),C(f.BSt,function(t,n){var e,r,i,e=n.dataAreaFormula();if(e)for(r=t+f.iw,i=o;i<o+u;i++)(a&&o<=i&&i<o+u||!L(s.getValue(i,r)))&&F(s,i,r,B,e)}),dt(s,!1))},o.prototype.fTt=function(){var u,t,a,n,f,s;y&&(t=(u=this).Mf,a=t.b3(),n=u.dataRange(),L(f)&&(f=n.row),L(s)&&(s=n.rowCount),vt(t),C(u.BSt,function(t,n){var n,e,r,i,o,n=n.hTt();if(n&&n.isArrayFormula)for(e=n.isDynamicArray,r=t+u.iw,i=f;i<f+s;i++)L(a.sT(i,r))&&a.Uyt(i,r,o={row:i,col:r,rowCount:1,colCount:1,isDynamicArray:e})}),dt(t,!1))},o.prototype.qO=function(t,n,e,r,i){var o,e,u,a,f,s,l,c,h,v,d,b,d,d,i,o=this,e=e?1:0;if(!(t>=o.iw+o.Tx+e)){if(a=o.iw,(l=o.Mf)&&(s={row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx},f=o.BSt.slice()),t<=o.iw&&!i)o.iw+=n;else if(t<o.iw+o.Tx+e&&(u=!0,o.Tx+=n,c=o.BSt)){for(h=t-o.iw,v=0;v<n;v++)d=o.M5t(),b=h+v,(d=new J(d)).name(o.nTt(B,b)),c.splice(b,0,d),d=o.getColumnName(b),o.y5t(b,0,d);r&&o.a5t(h,U,!0,!1)}o.IB&&o.IB.qO(t,n,u),a<=t&&(i=o.LSt)&&i.onColumnsAdded(t-a,n),l&&(l.Ut.YSt(o,V,s,{row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx}),l.Ut.YSt(o,Wn,f,o.BSt.slice()))}},o.prototype.n5t=function(){var t,n,e,r,i,o,u,t=this,n,e=t.Mf.b3();e&&t.oL&&(r=t.BSt,i=t.footerIndex(),o=t.iw,r.forEach(function(t,n){u=e.pB(i,o+n),L(u)||t.footerFormula(u)}))},o.prototype.xP=function(t,n,e,r,i){var o,u,a,f,a,s,l,c,h,c,v,d,b,w,m,c,g,y,C,o=this,u=!1;if(!(t>=o.Ky+o.Sx)&&(f=(a=o.dataRange()).row,a=z(a),s=o.Ky,l=o.Ky+o.Sx-1,c=o.Mf,h=o.H3,b=[],m="_backupRowsChange",c&&(v=c.Ut)&&(w={row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx},b.push(V),c=v.G8)&&!(d=c.tableChanges)&&(c.tableChanges=d=[]),i||o.sTt(t,n,!0),t<s?t+n<=s&&(o.Ky-=n):t===s?o.jO||(o.Sx-=E(l-t+1,n),!e&&h&&(b.push(m),h.btt(pt(o,t),E(l-t+1,n),d),u=!0)):t<=l&&(o.Sx-=E(l-t+1,n),!e&&h&&(b.push(m),h.btt(pt(o,t),E(l-t+1,n),d),u=!0),t===l)&&o.oL&&(b.push(Kn),o.oL=!1),o.IB&&(o.DSt=!0,o.IB.xP(t,n)),f<=t&&t<f+a&&(c=o.LSt)&&c.onRowsRemoved(t-f,n),v)&&b&&0<b.length)for(g=0,y=b;g<y.length;g++)switch(C=y[g]){case V:v.YSt(o,V,w,{row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx});break;case Kn:v.YSt(o,Kn,o.oL);break;case m:v.B5t(o,t,n,r,we.deleted)}return u},o.prototype.NP=function(t,n){var e,r,i,o,u,a,f,s,r,e=this,r=e.BSt;t>=e.iw+e.Tx||((i=e.Mf)&&(o={row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},u=e.BSt.slice()),a=e.iw,f=e.iw,s=e.iw+e.Tx-1,t<f?t+n<=f?e.iw-=n:(e.iw=t,e.Tx-=t+n-f,r&&(r.splice(0,t+n-f),e.y5t(0,t+n-f))):(e.Tx-=E(s-t+1,n),r&&(r.splice(t-f,E(s-t+1,n)),e.y5t(t-f,E(s-t+1,n)))),e.IB&&e.IB.NP(t,n),a<=t&&(r=e.LSt)&&r.onColumnsRemoved(t-a,n),i&&(i.Ut.YSt(e,V,o,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx}),i.Ut.YSt(e,Wn,u,e.BSt.slice())))},o.prototype.d5=function(t,n,e,r){var i,o,u,a,a,f,s,l,c,h,h,v,h,h,h,a,i=this,o=e,u=r,a=i.Mf;a&&(o=a.getRowCount(),u=a.getColumnCount()),c=(0,O.Ec)(a=t<0?0:t,f=n<0?0:n,s=t<0?o:e,l=n<0?u:r),h=i.headerIndex(),i.jO&&a<=h&&h<a+s&&(h=(0,O.Ec)(h,i.iw,1,i.Tx),v=c.getIntersect(h,o,u))&&i.oTt(v.col-i.iw,I(v)),h=i.dataRange(),(h=c.getIntersect(h,o,u))&&i.aTt(h),h=i.footerIndex(),i.oL&&a<=h&&h<a+s&&(a=(0,O.Ec)(h,i.iw,1,i.Tx),v=c.getIntersect(a,o,u))&&i.uTt(v.col-i.iw,I(v)),i.IB&&i.IB.d5(t,n,e,r)},o.prototype.toJSON=function(t,n){var e,r,i,o,u,a,f,s,l,c,h,v,d,e=this,r=e.style(),i=e.rowFilter(),o="columns";for(L(t)?u=e.name():e.Gwt=u=t,a={name:[u,B],row:[e.Ky,-1],col:[e.iw,-1],rowCount:[e.Sx,-1],colCount:[e.Tx,-1],showHeader:[e.jO,!0],showFooter:[e.oL,!1],useFooterDropDownList:[e.ESt,!1],showResizeHandle:[e.jSt,!1],highlightFirstColumn:[e.highlightFirstColumn(),!1],highlightLastColumn:[e.highlightLastColumn(),!1],bandRows:[e.bandRows(),!0],expandBoundRows:[e.expandBoundRows(),!1],bandColumns:[e.bandColumns(),!1],style:[r?r.toJSON():B,B],autoGenerateColumns:[e.autoGenerateColumns(),!0],bindingPath:[e.bindingPath(),U],rowFilter:[i?i.toJSON():B,B],reservedElement:[Oe(e.dTt),B],allowAutoExpand:[e.VSt,!0],headerStyle:[e.Jpe&&e.Jpe.toJSON?e.Jpe.toJSON():e.Jpe,U],dataStyle:[e.Kpe&&e.Kpe.toJSON?e.Kpe.toJSON():e.Kpe,U],footerStyle:[e.Xpe&&e.Xpe.toJSON?e.Xpe.toJSON():e.Xpe,U],columns:[[]]},f=0;f<e.BSt.length;f++)l=(s=e.BSt[f].toJSON())[xn],c=s[Fn],l&&(n&&n.ignoreFormula?(delete s[xn],s[kn]=e.Mf.getValue(e.Ky+e.Sx-1,e.iw+f)):s[xn]=_(e.Mf,l,e.footerIndex(),f+e.iw)),c&&(s[Fn]=_(e.Mf,c,e.dataRange().row,f+e.iw)),a[o][0][f]=s;for(v in a[o][1]=B,h={},a)(d=a[v])[0]!==d[1]&&(h[v]=d[0]);return b(h)?U:h},o.prototype.wh=function(t,n,e,r,i){var o,u,a,f,s,l,c,h,v,e,d,b,w,m,g,y,C,p,S,S,p,e,T,i,s,e,f,_,R,o=this,u=o.Mf,a=u.name(),f=o.style(),s=o.rowFilter(),l=o.BSt,c=e.styleManager,h=e.sharedStrings,v=!O.Util.ko(r);if(t.xmlns=O.XFileConstants.Qu,t.id=o._id,t.c_=[],t.n_=O.XFileConstants.du,(e=o.name()||B)&&(e=e.split(" ").join("_"),t.name=e,t.displayName=Ve(e.split("-").join("_"),i)),t.ref=Ut([o.range()]),!0!==o.jO&&(t.headerRowCount=0),!1!==o.oL&&(t.totalsRowCount=1),s&&!u.NMi&&s.wh(t,c,r),l&&0<l.length){for(d=[],b=o.footerIndex(),w=o.dataRange().row,m=o.iw,y=g=void 0,C=0;C<l.length&&!(v&&C>=o.Tx);C++)S=(p=l[C]).name(),y=C+o.iw,o.jO&&!L(S)&&(L(g)&&(g=lt(n,a)),ct(g,o.Ky,y,""+S,h)),d.push(p.wh(u,o,w,b,C+m,r,S={},c,o.jO)),p=S.v,o.oL&&!L(p)&&(L(g)&&(g=lt(n,a)),ct(g,o.Ky+o.Sx-1,y,""+p,h));r&&r.fileType===O.OpenSaveFileType.excel&&g&&g.colCount<y+1&&(g.colCount=y+1),e={n_:"tableColumns",count:l.length,c_:d},t.c_.push(e)}f&&(f.builtInName()?T="TableStyle"+f.builtInName():(T=f.name(),L(T)&&(T="CustomTableStyle_"+me(),f.name(T)))),i=o.Kpe,L(i)||("string"==typeof i?t.dataCellStyle=i:(t.dataDxfId=c.getDxfIndex(i),i.parentName&&(t.dataCellStyle=i.parentName))),s=o.Jpe,L(s)||("string"==typeof s?t.headerRowCellStyle=s:(t.headerRowDxfId=c.getDxfIndex(s),s.parentName&&(t.headerRowCellStyle=s.parentName))),e=o.Xpe,L(e)||("string"==typeof e?t.totalsRowCellStyle=e:(t.totalsRowDxfId=c.getDxfIndex(e),e.parentName&&(t.totalsRowCellStyle=e.parentName))),(f={n_:"tableStyleInfo",name:rt(T)}).showFirstColumn=!1!==o.highlightFirstColumn()?"1":"0",f.showLastColumn=!1!==o.highlightLastColumn()?"1":"0",f.showRowStripes=!0!==o.bandRows()?"0":"1",f.showColumnStripes=!1!==o.bandColumns()?"1":"0",t.c_.push(f),_={useFooterDropDownList:[o.ESt,!1],showResizeHandle:[o.jSt,!1],expandBoundRows:[o.expandBoundRows(),!1],autoGenerateColumns:[o.autoGenerateColumns(),!0],bindingPath:[o.bindingPath(),U],extLst:[o.dTt,B],allowAutoExpand:[o.VSt,!0]},R=t.lossless={},Object.keys(_).forEach(function(t){var n=_[t];n[0]!==n[1]&&(R[t]=n[0])})},o.prototype.fromJSON=function(e,t,n){var r,i,o,u,a,f,o,u,a,f,o,u,s,a,f,o,u,a,f,s,o,u,a,l,c,h,v,d,b,w,m,g,f,o,s,u;if(e){if(i=(r=this).Mf,C([Yt,qt,Zt,Qt,Xt,tn],function(t,n){j(e[n])&&r[n](e[n],!1)}),o=e.row,j(o)&&(r.Ky=o),u=e.col,j(u)&&(r.iw=u),a=e.rowCount,j(a)&&(r.Sx=a),f=e.colCount,j(f)&&(r.Tx=f),tr(i,new O.Range(o,u,a,f))&&(i.rowFilter().reset(),i.rowFilter(void 0)),o=e.showHeader,j(o)&&(r.jO=o),u=e.showFooter,j(u)&&(r.oL=u),a=e.expandBoundRows,j(a)&&(r.RSt=a),f=e.useFooterDropDownList,j(f)&&(r.ESt=f),o=e.showResizeHandle,j(o)&&(r.jSt=o),u=e.headerStyle,j(u)&&(P(u)?r.Jpe=u:((s=new O.Style).fromJSON(u,U,U),r.Jpe=s)),a=e.dataStyle,j(a)&&(P(a)?r.Kpe=a:((s=new O.Style).fromJSON(a,U,U),r.Kpe=s)),f=e.footerStyle,j(f)&&(P(f)?r.Xpe=f:((s=new O.Style).fromJSON(f,U,U),r.Xpe=s)),(o=e.style)&&((u=new $.TableTheme).fromJSON(o,t),r.style(u)),a=e.dataSource,f=e.dataBinding,s=e.bindingPath,t?(a&&x.$$&&(r.H3=new x.$$,r.H3.bind(a)),f&&x.$$&&(r.H3=new x.$$,r.H3.fromJSON(f))):s&&(r.S5t=s,o=i&&i.getDataSource&&i.getDataSource(),x.CellBindingSource)&&o instanceof x.CellBindingSource&&(u=(0,x.q$)(o.getSource(),s))&&(r.H3=new x.$$,r.H3.bind(u)),a=e.columns){for(c=(l=a).length,h=r.BSt=[],b=d=v=void 0,w=0;w<c;w++)b=l[w],v=new J,d=new J(r.M5t()),v.fromJSON(b),Ge(i,r,v,d,w),m=d.name(),g=r.nTt(m,w),h.push(d),g!==m&&r.setColumnName(w,g);r.vTt()}r.ESt&&r.h5t(!0),(f=e.rowFilter)&&(o=R.WSt&&new R.WSt)&&(o.table(r),o.fromJSON(f,t),r.IB=o,n?r.IB.reFilter():(r.DSt=!0,r._St())),(s=e.reservedElement)&&(r.dTt=s),u=e.allowAutoExpand,j(u)&&(r.VSt=u)}},o.prototype.yh=function(t,n,e){var r,i,o,e,u,i,i,a,f,s,l,c,c,c,s,s,s,c,s,t,h,v,d,c,b,b,w,m,g,y,C,p,S,S,T,_;if(t){if(i=t.ref,o=e&&e.onlyTableData,e=e&&e.isApplyRefilter,u=(r=this).Mf,r.name(t.name),L(i)||(i=Et(i,!0)[0],r.Ky=i.row,r.iw=i.col,r.Sx=i.rowCount,r.Tx=i.colCount),r.jO=1<=tt(t.headerRowCount,1),r.oL=1<=tt(t.totalsRowCount,-1),i=A(t,"tableColumns"),a=A(t,"autoFilter"),f=A(t,"sortState"),s=A(t,"tableStyleInfo"),l=A(t,"extLst"),o||(s&&(c=et(s.name),L(c)||(c=n.getTableTheme(c),r.style(c)),L(s.showFirstColumn)||r.highlightFirstColumn(nt(s.showFirstColumn,!1)),L(s.showLastColumn)||r.highlightLastColumn(nt(s.showLastColumn,!1)),L(s.showRowStripes)||r.bandRows(nt(s.showRowStripes,!1)),L(s.showColumnStripes)||r.bandColumns(nt(s.showColumnStripes,!1))),c=u.getDefaultStyle(),s=void 0,!L(t.dataDxfId)&&n&&(s=n.getDxf(+t.dataDxfId,U,!0,!0)),L(t.dataCellStyle)||(s?s.parentName=t.dataCellStyle:s=t.dataCellStyle),s=s&&ze(s,c,u),r.Kpe=s,s=void 0,!L(t.headerRowDxfId)&&n&&(s=n.getDxf(+t.headerRowDxfId,U,!0,!0)),L(t.headerRowCellStyle)||(s?s.parentName=t.headerRowCellStyle:s=t.headerRowCellStyle),s=s&&ze(s,c,u),r.Jpe=s,s=void 0,!L(t.totalsRowDxfId)&&n&&(s=n.getDxf(+t.totalsRowDxfId,U,!0,!0)),L(t.totalsRowCellStyle)||(s?s.parentName=t.totalsRowCellStyle:s=t.totalsRowCellStyle),s=s&&ze(s,c,u),r.Xpe=s),c=t.lossless,o||L(c)||(s=c.bindingPath,t=c.autoGenerateColumns,h=c.expandBoundRows,v=c.useFooterDropDownList,d=c.showResizeHandle,c=c.allowAutoExpand,s&&(r.S5t=s,b=u&&u.getDataSource&&u.getDataSource(),x.CellBindingSource)&&b instanceof x.CellBindingSource&&(b=(0,x.q$)(b.getSource(),s))&&(r.H3=new x.$$,r.H3.bind(b)),j(t)&&r.autoGenerateColumns(t),j(h)&&(r.RSt=h),j(v)&&(r.ESt=v),j(d)&&(r.jSt=d),j(c)&&(r.VSt=c)),i&&(w=q(i,"tableColumn"),!L(w))){for(m=r.BSt=[],y=g=void 0,C=0,p=w.length;C<p;C++)S=w[C],y=new J(r.M5t()),(g=new J).yh(S,o,n,u),Ge(u,r,g,y,C),S=y.name(),(T=r.nTt(S,C))!==S&&y.name(T),m.push(y);r.vTt()}o||(r.ESt&&r.h5t(!0),Ue(r,_=R.WSt&&new R.WSt,a,f,n,e),l&&(r.dTt=l))}},o.prototype._St=function(){var t,n,e,r,i,o,u,a,t=this,n=t.IB,e=t.Mf.filterRowsVisibleInfo.rowsVisibleInfo,r=n.range;if(!L(r))for(i=0;i<r.rowCount;i++)if(!1!==e[o=r.row+i])for(u=0;u<r.colCount;u++)a=r.col+u,n.isFiltered(a)&&n.jct(o,a)},o.prototype.formulaFromJSON=function(){for(var t,n,e,r,i,o,u,a,f,s,l,l,c,t=this,n=t.Mf,e=n.b3(),r=t.BSt,o=t.footerIndex(),u=t.dataRange().row,a=t.iw,s=0;s<r.length;s++)f=s+a,(l=(i=r[s]).footerFormula())&&typeof l==Xn&&i.footerFormula(k(n,l,o,f,U,!0)),(l=i.dataAreaFormula())&&e&&(c=e.sT(u,f),L(c)||i.hTt({isArrayFormula:!0,isDynamicArray:c.isDynamicArray})),l&&typeof l==Xn&&i.dataAreaFormula(k(n,l,u,f,U,!0))},o.prototype.vTt=function(){for(var t,n,e,r,i,o,t=this,n=t.BSt,e=n.length,o=0;o<e;o++)(i=(r=n[o]).id())<1&&r.id(t.M5t())},o.prototype.startRow=function(){return this.Ky},o.prototype.startColumn=function(){return this.iw},o.prototype.endRow=function(){return this.Ky+this.Sx-1},o.prototype.endColumn=function(){return this.iw+this.Tx-1},o.prototype.hasHeadersRow=function(){return this.jO},o.prototype.hasTotalsRow=function(){return this.oL},o.prototype.tableName=function(){return this.name()},o.prototype.getColumnIndexInTable=function(e){e=e.toLowerCase().replace(/\u00A0/g," ");var r=-1,i=c.Common.zf.Vi(e,"\r\n","\n");return L(e)||C(this.BSt,function(t,n){var n=n.name().toString().toLowerCase().replace(/\u00A0/g," ");if(n===e||n===i)return r=t,!1}),r},o.prototype.source=function(){var t=this.Mf;return t&&t.Uw&&t.Uw()},o.prototype.qSt=function(){var t,n,e,n,n,t=this,n=t.Mf;n&&(e=t.bindingPath())&&(n=n.getDataSource&&n.getDataSource(),x.CellBindingSource)&&n instanceof x.CellBindingSource&&(n=(0,x.q$)(n.getSource(),e),t.T5t(n))},o.prototype.T5t=function(t){var n,e,r,i,o,u,a,n,a,f,e=this,r=e.Mf;if(t&&!(e.autoGenerateColumns()&&(i=Object.keys(t[0]||[]).length)!==(o=e.BSt.length)&&(u=e.Sx,a=(0,O.Ec)(e.Ky,e.iw,u,i),1<(null==(n=null==(n=e.jS)?void 0:n.AB(a.row,a.col,u,i))?void 0:n.length)))){(a=new x.$$).bind(t,r.Ut.G8);try{S(r),e.H3=B,e.D3(a),(f=y&&r.op())&&!f.IsSuspended()&&r.recalcAll()}finally{T(r)}}},o.prototype.clone=function(){var t,n,e,t=this,n=new o,e=Jt(t.toJSON());return n.Sg(t.jS),n.fromJSON(Pt(e)),n},o.prototype.V3=function(t){var n=new x.$$;n.bind(t),this.H3=n},o.prototype.gTt=function(t){var t;t&&!t.bindingPath()&&(t=t.H3)&&this.V3(t.getSource())},o.prototype.z3=function(){var t=this.H3;return t?t.getSource():B},o.prototype.pTt=function(){var t=this.H3;return t?t.getRowCount():0},o.prototype.bTt=function(t,n){var e,n,e=this.PSt;n?e.push(t):-1!==(n=e.indexOf(t))&&e.splice(n,1)},o.prototype.cL=function(n){var e=this;e.PSt.forEach(function(t){t.Pen(e,n)}),2===n&&(e.PSt=[])},o.prototype.Pwt=function(t,n,e){var r,r,i,o,r=this;r.yTt||((i=(i=(r=r.FSt)[e])||(r[e]={}))[o=[t,n].join(",")]=!0)},o.prototype.I4t=function(t,n,e){var r,i,o,u,a,f,s,l,c,h,v,h,d,r=this,i=r.Mf,o=i&&i.getCalcService&&i.getCalcService();if(r.yTt=!0,o)for(a in a=void 0,u=r.FSt)if(f=o.rO[a])for(c in s=f.pj(),l=u[a])v=+(h=c.split(","))[0],h=+h[1],(d=f.pB(v,h))?(r.wTt(v,h)||r.MTt(d,t,n,e,!1,v,h),f.SB(v,h,d,void 0,!1,s)):delete l[c];else delete u[a];delete r.yTt},o.prototype.CTt=function(t,n,e){var r,i,o,u,a,f,s,l,c,h,c,v,h,r=this,i=r.Mf,o=i&&i.getCalcService();if(r.yTt=!0,o)for(a in a=void 0,u=r.FSt)for(l in f=o.rO[a],s=u[a])h=+(c=l.split(","))[0],c=+c[1],(v=f.pB(h,c))&&t===h&&n===c&&-1<(h=Lt(v))&&(v.arguments[h]=e);delete r.yTt},o.prototype.wTt=function(t,n){var e,r,i,t,r,e=this,r=e.footerIndex(),i=!1;return-1<r&&t===r&&(r=(t=e.iw)+e.Tx,i=t<=n&&n<r),i},o.prototype.sort=function(t,n){var e=this,r=e.Mf,i=e.dataRange(),e=e.rowFilter();r&&0<=t&&t<i.colCount&&(r.suspendPaint(),r.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:t+i.col,ascending:n}]),e&&(e.nrt={index:t+i.col,ascending:n}),r.resumePaint())},o.prototype.QL=function(){return!!this.H3},o.prototype.N4t=function(t,n,e,r,i,o,u){var a,f,s,l,c,h,v,d,b,w,m,g,y,C,p,S,T,_,R,x,j,F,a=this,f=a.Mf,s=a.jS,l=a.Ky,c=a.iw,h=a.Sx,v=a.Tx,d=l+h-1,b=e?t+1:t,w=b+n,m=a.dataRange();Rt(f);try{g=a.QL(),a.lTt=!0,a.sL(!1),a.STt(),(s.zB=a).JO(b,n,e,!!u,!0,o),a.I4t(),y=O.CopyToOptions.value|O.CopyToOptions.formula|O.CopyToOptions.comment|O.CopyToOptions.outline|O.CopyToOptions.sparkline|O.CopyToOptions.span|O.CopyToOptions.style|O.CopyToOptions.tag|O.CopyToOptions.bindingPath|O.CopyToOptions.hyperlink|O.CopyToOptions.altText,r&&!a.TTt&&(p=(C=1+d)+n,S=i-C+1,f.moveTo(C,c,p,c,S,v,y)),T=d-b+1,(!e||t!==d)&&0<T&&(f.EB=!0,f.Nyt=m,g&&!a.oL?a.BSt.forEach(function(t,n){var n=c+n;t.dataField()?f.moveTo(b,n,w,n,T,1,O.CopyToOptions.style):f.moveTo(b,n,w,n,T,1,y)}):f.moveTo(b,c,w,c,T,v,y),delete f.Nyt,delete f.EB),_=e?1:0,R=a.jO&&1===h,(b<=(x=l+h-1+_)||R)&&Ye(f,b,a.iw,b+n-1,a.iw+a.Tx-1,a),j=f.Ut,F=a.dataRange(),j.bJ&&j.bJ(b,n,[F],!0),j.ATt&&j.ATt(b,n,[F],!0),s.zB=U,a.ITt(),a.t5t(b,n,!0),a.J5t(b,n,!0),a.W5t(b,n,!0),a.fTt(),a.jS.dl()}finally{a.lTt=U,a.sL(!0),xt(f),a.cL(0),f.recalcAll(!0)}},o.prototype.sL=function(t){this.Mf.sL(t)},o.prototype.insertRows=function(t,n,e){var r;L(t)||L(n)||n<=0||(t=Nt(r=this,t,!0),r.zpt(t,n,e))},o.prototype.zpt=function(t,n,e,r,i){var o,u,a,f,a,s,f,a,l,c,f,h,l,v;L(t)||L(n)||n<=0||(u=(o=this).Mf,f=(a=o.dataRange()).row,0===(a=a.rowCount)&&t===f||!(t<f||(s=f+a)<=t)||N(H().Exp_RowParamOutOfRange),f=o.Ky,a=o.iw,l=o.Sx,h=a+(c=o.Tx)-1,v=(f=f+l-1)<(l=gt(u,o)),Ct(u,o,1+f,l,a,h,n))||o.N4t(t,n,e,v,l,r,i)},o.prototype.deleteRows=function(t,n){var e;L(t)||L(n)||n<=0||(t=Nt(e=this,t,!0),e.yE(t,n))},o.prototype.yE=function(e,r,t){var n,i,o,u,o,a,f,s,l,c,h,u,o,v,d,b,w,m,g,y,C,p,S,T;if(!(L(e)||L(r)||r<=0||(i=(n=this).Mf,u=(o=n.dataRange()).row,o=o.rowCount,(e<u||u+o<=e)&&N(H().Exp_RowParamOutOfRange),a=n.Ky,f=n.iw,s=n.Sx,l=n.Tx,c=a+s-1,h=f+l-1,(s<=1||e===u&&!n.jO&&!n.oL&&o<=r)&&N(H().Exp_TableDeleteCountInvalid),o=c<(u=gt(i,n)),Ct(i,n,1+c,u,f,h,r,!0)))){Rt(i);try{n.sL(!1),v=n.QL(),d=void 0,v&&(d=Tt(!0),n.x4t(e,r,d)),n.STt(),(b=n.jS).zB=n,b.zB.VB=new O.Range(a,f,s,l),n.xP(e,r,U,d,t),n.I4t(),w=E(r,c-e+1),i.clear(e,f,w,l,3,X),m=O.CopyToOptions.value|O.CopyToOptions.formula|O.CopyToOptions.comment|O.CopyToOptions.outline|O.CopyToOptions.sparkline|O.CopyToOptions.span|O.CopyToOptions.style|O.CopyToOptions.tag|O.CopyToOptions.bindingPath|O.CopyToOptions.hyperlink|O.CopyToOptions.altText,e+r<=c&&(g=c-r-e+1,v&&!n.oL?n.BSt.forEach(function(t,n){var n=f+n;t.dataField()?i.moveTo(e+r,n,e,n,g,1,O.CopyToOptions.style):i.moveTo(e+r,n,e,n,g,1,m)}):i.moveTo(e+r,f,e,f,g,l,m)),o&&(C=(y=1+c)-w,p=u-y+1,i.moveTo(y,f,C,f,p,l,m)),S=i.Ut,T=n.dataRange(),S.yJ&&S.yJ(e,r,[T],!0),delete b.zB.VB,b.zB=U,n.ITt(),n.J5t(),n.W5t(e,r,!1),n.jS.dl()}finally{n.sL(!0),xt(i),n.cL(0),i.recalcAll(!0)}}},o.prototype.insertColumns=function(t,n,e){var r;L(t)||L(n)||n<=0||(t=Nt(r=this,t,!1),r.k4t(t,n,e))},o.prototype.k4t=function(t,n,e){var r,i,o,u,a,f,s,a,l,s,c,h,v,d,b,w,h,m,g,y,C,p,S,T,_,R,x,j,F,k,A;if(!(L(t)||L(n)||n<=0||(i=(r=this).Mf,u=(o=r.dataRange()).row,a=o.col,f=o.rowCount,s=o.colCount,(t<a||a+s<=t)&&N(H().Exp_ColParamOutOfRange),a=r.Ky,l=r.iw,h=a+(s=r.Sx)-1,b=(v=l+(c=r.Tx)-1)<(d=yt(i,r)),Ct(i,r,a,h,1+v,d,n,!1,!0)))){h=(w=e?t+1:t)+n,Rt(i);try{if(r.sL(!1),r.STt(),y=!(g=((m=r.jS).zB=r).QL()),p=(C=1+v)+n,S=d-C+1,T=O.CopyToOptions.value|O.CopyToOptions.formula|O.CopyToOptions.comment|O.CopyToOptions.outline|O.CopyToOptions.sparkline|O.CopyToOptions.span|O.CopyToOptions.style|O.CopyToOptions.tag|O.CopyToOptions.bindingPath|O.CopyToOptions.hyperlink|O.CopyToOptions.altText,b&&i.moveTo(a,C,a,p,s,S,T),r.qO(w,n,e,y,!0),r.xTt(w,n,!0),r.I4t(w,n,!0),!e||t!==v){if(i.EB=!0,_=r.oL?1:0,g&&!r.oL)for(R=r.BSt,x=c-1;w-l<=x;x--)j=R[x],F=l+x,j.dataField()?i.moveTo(u,F,u,F+n,f+_,1,O.CopyToOptions.style):i.moveTo(u,F,u,F+n,f+_,1,T);else i.moveTo(u,w,u,h,f+_,v-w+1,T);delete i.EB}k=i.Ut,A=r.dataRange(),k.wJ&&k.wJ(w,n,[A],!0),k.NTt&&k.NTt(w,n,[A]),m.zB=U,r.ITt(U,!0),r.J5t(),r.Q5t(w,n,!0),(0,Y.hMt)(i,w,n,!0,!1,o),r.jS.dl()}finally{r.sL(!0),xt(i),r.cL(0),i.recalcAll(!0)}}},o.prototype.deleteColumns=function(t,n){var e;L(t)||L(n)||n<=0||(t=Nt(e=this,t,!1),e.wE(t,n))},o.prototype.wE=function(t,n){var e,r,i,o,u,a,f,s,u,o,l,c,h,v,d,b,w,m,g,y,C,p,S,T,_,R,x;if(!(L(t)||L(n)||n<=0||(r=(e=this).Mf,o=(i=e.dataRange()).col,u=i.colCount,(t<o||o+u<=t)&&N(H().Exp_ColParamOutOfRange),a=e.Ky,f=e.iw,o=a+(s=e.Sx)-1,l=f+(u=e.Tx)-1,c=e.oL?1:0,(u<=1||t===f&&u<=n)&&N(H().Exp_TableDeleteCountInvalid),v=l<(h=yt(r,e)),Ct(r,e,a,o,1+l,h,n,!0,!0)))){Rt(r);try{if(e.sL(!1),e.STt(),d=e.jS,b=e.QL(),d.zB=e,d.zB.VB=new O.Range(a,f,s,u),e.NP(t,n),e.xTt(t,n,!1),e.I4t(t,n,!1),w=E(n,l-t+1),r.clear(a,t,s,w,3,X),m=O.CopyToOptions.value|O.CopyToOptions.formula|O.CopyToOptions.comment|O.CopyToOptions.outline|O.CopyToOptions.sparkline|O.CopyToOptions.span|O.CopyToOptions.style|O.CopyToOptions.tag|O.CopyToOptions.bindingPath|O.CopyToOptions.hyperlink|O.CopyToOptions.altText,t+n<=l){if(r.EB=!0,b&&!e.oL)for(g=e.BSt,y=t-f+n-1;y<e.Tx;y++)C=g[y],p=f+y,C.dataField()?r.moveTo(a,p,a,p-n,s-c,1,O.CopyToOptions.style):r.moveTo(a,p,a,p-n,s-c,1,m);else r.moveTo(a,t+n,a,t,s-c,l-n-t+1,m);delete r.EB}v&&(T=(S=1+l)-w,_=h-S+1,r.moveTo(a,S,a,T,s,_,m)),R=r.Ut,x=e.dataRange(),R.MJ&&R.MJ(t,n,[x],!0),R.kTt&&R.kTt(t,n),delete d.zB.VB,d.zB=U,e.ITt(!0),e.J5t(),e.Q5t(t,n,!1),(0,Y.hMt)(r,t,n,!1,!1,i),e.jS.dl()}finally{e.sL(!0),xt(r),e.cL(0),r.recalcAll(!0)}}},o.prototype.STt=function(){try{var t=this,n=t.Mf,e,r=t.jS.U3;n&&n.Ut.DTt([t],[],2),r.splice(r.indexOf(t),1),t.U5t()}catch(t){}},o.prototype.ITt=function(t,n){var e=this;e.mTt=!0,e.iTt=t,e.jS.WB(e,U,n),delete e.iTt,delete e.mTt},o.prototype.xTt=function(t,n,e){for(var r,i,o,u,a,f,s,l,r=this,i=r.BSt,o=i.length,u=St(r,t),s=u;s<o;s++)l=void 0,e?u+n-1<s&&(l=s-n):u<=s&&(l=s+n),(f=(a=i[s]).footerFormula())&&r.MTt(f,t,n,e,!0,l)},o.prototype.MTt=function(t,n,e,r,i,o,u){var a,f,s,l,c,h,v,d,b,a=this,f=a.Mf;if(0<e&&t&&t.arguments)for(s=t.arguments,c=l=void 0,h=0;h<s.length;h++)(l=s[h])instanceof Y.obt&&(f&&(i?f.Ut._Tt(this,l,o):f.Ut.ETt(a,l,o,u)),l._K(),c=l.offsetWhenInsertRemoveColumn(n,e,r,i),s[h]=c)},o.prototype.rCe=function(n){var e=this,t;e.BSt.forEach(function(t){var t=t.footerFormula();t&&Ke(e,t,n)})},o.prototype.ftt=function(t){var n,e,r,i,o,u,a,f,s,l,c,h,v,n=this,e=n.H3,r=n.Mf,i=n.jO?1:0,o=n.Ky+i+t,u=n.iw;if(!e||0===e.getRowCount())return B;if(a=n.Tx,f={},s=e.ftt(t))for(l in s)w(s,l)&&"function"!=typeof l&&(f[l]=s[l]);for(c=0;c<a;c++)v=(h=n.BSt[c])&&h.dataField(),h&&v&&0<v.length&&L(f[v])&&(f[v]=r.getValue(o,u+c));return f},o.prototype.x4t=function(t,n,e){var r,i,o,u,a,f,s,l,r=this,i=[],o=r.H3;if(o)for(f=o.getRowCount(),s=0;s<n;s++)l=B,(a=pt(r,u=t+s))<f&&(l=r.ftt(a)),i.push({key:e,data:l});r.aj=i},o.prototype.tq=function(){var e=[],t=this.aj;return t&&C(t,function(t,n){n&&!O.GC$.isFunction(n)&&e.push(n.data)}),e},o.prototype.R5t=function(t,n,e){var r,i,o,u,a,f,r=this;0<r.Mf.lE||(i=r.GSt,(o=r.H3)&&(u=B,n<(a=o.getRowCount())&&(u=r.ftt(n)),i[t]=f={key:e,data:u}))},o.prototype.sTt=function(t,n,e){var r,i,e,o,r=this;if(!(0<r.Mf.lE))if(i=r.GSt,e)e=i.splice(t,n),r.USt.push({rowIndex:t,count:n,deletedDirtyItems:e});else for(o=0;o<n;o++)i.splice(t,0,B)},o.prototype.A4t=function(t,n){this.GSt.splice(t,n)},o.prototype.ZSt=function(){var t,n,n,e,r,i,o,u,t=this,n=t.USt;if(n&&0<n.length)for(e=(n=n.pop()).rowIndex,r=n.count,i=n.deletedDirtyItems,o=0;o<r;o++)u=i[o],t.GSt[e+o]=l({},u)},o.prototype.getDirtyRows=function(){for(var t,n,e,r,i,o,t=this,n=t.GSt,e=[],o=0;o<n.length;o++)r=n[o],L(r)||(i=pt(t,o),e.push({row:i,originalItem:r.data,item:t.ftt(i)}));return e},o.prototype.clearPendingChanges=function(){this.GSt=[]},o.prototype.footerRowDropDowns=function(t,n){var e,t,t,r,i,n,e=this,t=e.OSt[t];if(t)return 1===arguments.length?t.dropDowns&&t.dropDowns.slice():(t=t.dropDowns[0],n?(r=n.listOption,i=n.submitCommand,n=n.type,r&&(t.option=r),i&&(t.submitCommand=i),j(n)&&(t.type=n),e):void 0)},o.prototype.checkTableLastRow=function(t){var n=this,e=n.dataRange();return n.headerIndex()===t||e.row+e.rowCount-1!==t},o.prototype.checkTableLastCol=function(t){var n,e=this.dataRange();return e.col+e.colCount-1!==t},o.prototype.jj=function(t,n,e,r,i){var o,u,r,i,u,o=this,u=o.Mf;jt(u,o,e?En:Dn,t,n,r,i),r=u.Ut,i=e?Dn:En,u=!e&&U,r&&r.ZI(["tableRowsChanged",o,i,t,n,u,e])},o.prototype.Ej=function(t,n,e,r){var i,o,r,u,o,i=this,o=i.Mf;Ft(o,i,e?Hn:Vn,t,n,r),r=o.Ut,o=!e&&U,r&&r.ZI(["tableColumnsChanged",i,u=e?Vn:Hn,t,n,o])},G=o,R.Table=G,R.hasRowFilter=tr,(0,O.$e)(G),ge={101:"average",102:"countNums",103:"count",104:"max",105:"min",107:"stdDev",109:"sum",110:"let"},G.prototype.name=e(Yt,"",nr(Yt),r),G.prototype.bandRows=e(Qt,!0,nr(Qt)),G.prototype.bandColumns=e(Xt,!1,nr(Xt)),G.prototype.highlightFirstColumn=e(qt,!1,nr(qt)),G.prototype.highlightLastColumn=e(Zt,!1,nr(Zt)),G.prototype.style=e("style",U,er),G.prototype.autoGenerateColumns=e(tn,!0,nr(tn)),h&&h.HideRowFilter&&(n=h.HideRowFilter,s(u,Te=n),u.prototype.pct=function(){return 0},u.prototype.bct=function(){return this.range.colCount},u.prototype.table=function(t){var n=this;if(0===arguments.length)return n.nM;(n.nM=t)&&(n.Mf=t.Mf)},u.prototype.unfilter=function(t,n){var e,r,t,e=this,r=e.Mf;r&&r.suspendPaint(),Te.prototype.unfilter.call(this,t,n),(t=e.nM)&&t.jS&&t.jS.dl(),r&&r.resumePaint()},u.prototype.JO=function(t,n){var e=this,r=e.nM;Te.prototype.JO.call(this,t,n),r&&e.Fct(r.dataRange())},u.prototype.xP=function(t,n){var e=this,r=e.nM;Te.prototype.xP.call(this,t,n),r&&e.Fct(r.dataRange())},u.prototype.ert=function(t,n,e,r,i){var o,u,a,o,u=this.nM;Te.prototype.ert.call(this,t,n,e,r,i),u&&u.N5t()&&(a=u.getSlicerData()).refresh()},u.prototype.toJSON=function(){var t,n,t,t=this,n=Te.prototype.toJSON.call(t),t=t.nM;return t&&(n.tableName=t.name()),n},u.prototype.L0=function(){this.nM=B,this.Mf=B},R.WSt=u),sr.prototype.tTt=function(){return 0<this.id()},sr.prototype.toJSON=function(){var r,i,o,r=this,i={};return j(r.cellType())&&P(o=fr(r))&&(o.cellType=r.cellType()),j(r.formatter())&&!P(o=fr(r))&&(o.formatter=r.formatter()),C(On,function(t,n){var e=r[n]();L(e)||(!o||P(o)||n!==$t&&n!==Wt)&&(e.toJSON&&"function"==typeof e.toJSON?i[n]=e.toJSON():i[n]=e)}),b(i)?U:i},sr.prototype.wh=function(t,n,e,r,i,o,u,a,f){var s,l,l,c,h,v,d,r,c,d,u,h,b,e,i,c,s=this,l=s.name();return l=it(l,"\r",""),l={n_:"tableColumn",id:s.id(),name:rt(it(l,"\n","_x000a_"))},c=s.footerFormula(),h=s.footerValue(),c&&(o&&!1===o.includeFormulas?(c=U,h=t.getValue(r,i)):d=ur(v=_(t,c,r,i))),(r=d===te)?l.totalsRowFunction=te:c?l.totalsRowFunction=d:L(h)||(l.totalsRowLabel=rt(ot(h.toString(),!0)),u.v=h),c=s.dataAreaFormula(),L(c)||ar(c=_(t,c,e,i))||(L(l.c_)&&(l.c_=[]),d={n_:"calculatedColumnFormula",c_:[rt(at(c))]},l.c_.push(d)),r&&!L(v)&&(u={n_:"totalsRowFormula",c_:[rt(v)]},L(l.c_)&&(l.c_=[]),l.c_.push(u)),h=l.lossless,L(s.value())||((h=L(h)?l.lossless={}:h)[Kt]=s.value()),L(s.dataField())||((h=L(h)?l.lossless={}:h)[Rn]=s.dataField()),e=s.cellType(),i=s.formatter(),j(e)&&(b=fr(s),(h=L(h)?l.lossless={}:h)[$t]=null!=e&&e.toJSON?e.toJSON():e,P(b)||(b.cellType=e)),j(i)&&(P(b=fr(s))?(h=L(h)?l.lossless={}:h)[Wt]=i:b.formatter=i),c=!O.Util.ko(o),Xe(n.Kpe,s.dataStyle(),"data",c,l,t,a),c&&!1!==f||Xe(n.Jpe,s.headerStyle(),"headerRow",c,l,t,a),Xe(n.Xpe,s.footerStyle(),"totalsRow",c,l,t,a),l},sr.prototype.fromJSON=function(o){var u;o&&(u=this,C(On,function(t,n){var e,r,i,i,r,e=o[n]!==U?o[n]:o["_"+n];L(e)||(n===$t?(r=e.typeName,(i=(i=O.CellTypes&&O.CellTypes.ti)&&i[r]||i[e.type]||(0,O.getTypeFromString)(r))&&((r=new i).fromJSON(e,!1),e=r),j(e)&&u.cellType(e)):n===Wt&&j(e)&&u.formatter(e),u[n](e,!1))}),He(u,o,nn),He(u,o,en),He(u,o,rn))},sr.prototype.yh=function(t,n,e,r){var i,o,o,o,o,n,o,o,e,n,r,o,e,n,r,o,t,t,o,t,o,r;t&&((i=this).id(tt(t.id,0)),o=t[Yt],L(o)||(o=it(o,"_x000d__x000a_","\n"),i.name(et(it(o,"_x000a_","\n")))),o=t.totalsRowLabel,L(o)||i.footerValue(et(o)),n||(o=void 0,n=r&&r.getDefaultStyle(),!L(t.dataDxfId)&&e&&(o=e.getDxf(+t.dataDxfId,U,!0,!0)),L(t.dataCellStyle)||(o?o.parentName=t.dataCellStyle:o=t.dataCellStyle),o=o&&ze(o,n,r),i.dataStyle(o),o=void 0,!L(t.headerRowDxfId)&&e&&(o=e.getDxf(+t.headerRowDxfId,U,!0,!0)),L(t.headerRowCellStyle)||(o?o.parentName=t.headerRowCellStyle:o=t.headerRowCellStyle),o=o&&ze(o,n,r),i.headerStyle(o),o=void 0,!L(t.totalsRowDxfId)&&e&&(o=e.getDxf(+t.totalsRowDxfId,U,!0,!0)),L(t.totalsRowCellStyle)||(o?o.parentName=t.totalsRowCellStyle:o=t.totalsRowCellStyle),o=o&&ze(o,n,r),i.footerStyle(o),e=t.totalsRowFunction,L(e)||((n=e)===te&&(n=et(m(A(t,"totalsRowFormula")))),i.footerFormula(n)),r=A(t,"calculatedColumnFormula"),L(r)||(o=""+m(r),i.dataAreaFormula(et(ut(o)))),e=t.lossless,n=void 0,L(e))||(r=e[$t],L(r)||(o=r.typeName,(t=(t=O.CellTypes&&O.CellTypes.ti)&&t[o]||t[r.type]||(0,O.getTypeFromString)(o))&&((o=new t).fromJSON(r),r=o),L(r))||(P(n=fr(i))?i.cellType(r):n.cellType=r),t=e[Kt],L(t)||i.value(t),o=e[Wt],L(o)||(P(n=fr(i))?i.formatter(o):n.formatter=o),r=e[Rn],L(r))||i.dataField(r))},sr.prototype.cellType=function(t){var n=this,e=n.dataStyle();if(0===arguments.length)return e&&e.cellType;e||(e=new O.Style,n.dataStyle(e)),e.cellType=t},sr.prototype.formatter=function(t){var n=this,e=n.dataStyle();if(0===arguments.length)return e&&e.formatter;e||(e=new O.Style,n.dataStyle(e)),e.formatter=t},J=sr,(R.TableColumn=J).prototype.id=function(t){var n=e(_n,U,function(t){var n=this;n.name()||n.name(Tn+t)});return 0===arguments.length?n.call(this):L(t)?this:n.call(this,t)},J.prototype.name=e(Yt,U,function(t){var n,e,n=this;t?(e=O.util.V0(t="string"!=typeof t?""+t:t))!==t&&e.toLocaleDateString&&n.name(e.toLocaleDateString()):n.name(Tn+n.id())}),J.prototype.dataStyle=e(nn),J.prototype.headerStyle=e(en),J.prototype.footerStyle=e(rn),J.prototype.value=e(Kt),J.prototype.dataField=e(Rn),J.prototype.footerValue=e(kn),J.prototype.dataAreaFormula=e(Fn),J.prototype.footerFormula=e(xn),J.prototype.x5t=e(t),J.prototype.hTt=e(jn),a.prototype.getUsedRange=function(){var t,n,e,r,i,o,u,t,n=this.all(),e={};if(n)for(r=void 0,i=0,o=n;i<o.length;i++)u=o[i],he(e,ce(u.range()));return e},a.prototype.L0=function(){for(var t,n,e,r,i,t=this,n=t.U3,e=n.length,i=0;i<e;i++)(r=n[i])&&r.L0();t.U3=[],t.zB=U,t.dl(),t.Mf=B},a.prototype.dl=function(){var t,n,e,r,i,t=this;for(t.xl=[],t.Nl=[],e=(n=t.U3).length,i=0;i<e;i++)(r=n[i]).dl()},a.prototype.KSt=function(t,n){for(var e,r,i,o,u,e,r=this.U3,i=r.length,u=0;u<i;u++)o=r[u],!n&&Re(o.HSt,t)?o.HSt=[]:L(o.HSt[t])||(o.HSt[t]=U)},a.prototype.JSt=function(t){for(var n,e,r,i,o,n,e=this.U3,r=e.length,o=0;o<r;o++)Re((i=e[o]).zSt,t)?i.zSt=[]:L(i.zSt[t])||(i.zSt[t]=U)},a.prototype.add=function(t,n,e,r,i,o,u){return this._Qt(t,n,e,r,i,o,u)},a.prototype._Qt=function(t,n,e,r,i,o,u,a){var f=this;return f.jTt(f.Mf,t,n,e,r,i,!0),f.WB(new G(t,n,e,r,i,o||$.TableThemes.medium2,u),U,U,a)},a.prototype.addFromDataSource=function(t,n,e,r,i,o){var u,a,f,r,s,u;if(r||N(H().Exp_TableDataSourceNullError),x.$$)return(a=(u=this).Mf).suspendPaint(),vt(a),(f=new x.$$).bind(r),r=f.getRowCount()+1,s=f.getColumnCount(),(u=u.add(t,n,e,r,s,i,o)).D3(f),a.clearPendingChanges(),dt(a),a.resumePaint(),u},a.prototype.find=function(t,n){return this.Hq(t,n)},a.prototype.Hq=function(t,n,e){for(var r,i,o,u,a,f,r=this,i=r.U3,o=(i=!0===e&&r.zB?i.concat([r.zB]):i).length,a=0;a<o;a++)if((f=(u=i[a]).range()).row<=t&&t<f.row+z(f)&&f.col<=n&&n<f.col+I(f))return u;return B},a.prototype.findByName=function(t){return this._bt(t)},a.prototype._bt=function(t,n){for(var e,r,i,o,u,e=this,r=e.U3,i=(r=!0===n&&e.zB?r.concat([e.zB]):r).length,u=0;u<i;u++)if((o=r[u]).name().toLowerCase()===t.toLowerCase())return o;return B},a.prototype.pP=function(t,n,e,r){for(var i,o,u,a,f,s,i=this.U3,o=i.length,u=(0,O.Ec)(t,e,n,r),a=[],s=0;s<o;s++)f=i[s],u.containsRange(f.range())&&a.push(f);return a},a.prototype.AB=function(t,n,e,r){for(var i,o,u,a,f,i=this.U3,o=i.length,u=[],f=0;f<o;f++)(a=i[f]).range().intersect(t,n,e,r)&&u.push(a);return u},a.prototype.Uue=function(t){for(var n,e,r,i,o,u,a,f,n=this.U3,e=n.length,r=t.row,i=t.col,o=t.rowCount,u=t.colCount,f=0;f<e;f++)if((a=n[f]).range().intersect(r,i,o,u))return a},a.prototype.Dy=function(){var t,n,t,t=this,n=t.Mf,t=t.find(n.ui,n.ci);if(t)return n.j1(new O.Range(-1,t.iw,-1,t.Tx))},a.prototype.WB=function(t,n,e,r){var i,o;if(t)return(i=this).findByName(t.name())&&N(H().Exp_TableHasSameNameError),(o=i.Mf).suspendPaint(),t.Sg(i),o.Ut.DTt([],[t],1),i.U3.push(t),t.mTt||t.qSt(),!n&&t.showHeader()&&t.a5t(U,U,e,r),!n&&t.showFooter()&&t.l5t(),i.OTt(t),o.resumePaint(),o.Ut.Spe(),t},a.prototype.DK=function(t){var n,e,r,n=this,e=g(t,n.U3);return-1<e?((r=n.Mf)&&r.Ut.DTt([t],[],2),n.U3.splice(e,1),n.RTt([t],!1),n.U3.length<1&&r.Ut.Spe(),t):B},a.prototype.remove=function(t,n){var e,r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,g,y,e=this;if((t=_t(t)?e.findByName(t):t)&&(n=n||0,t.s5t(),t=e.DK(t))){r=t.range(),i=e.Mf;try{if(S(i),o=r.row,u=r.row+z(r),a=r.col,f=r.col+I(r),l=s=void 0,c=t.showHeader(),h=t.headerIndex(),1!=(1&n))for(s=o;s<u;s++)for(l=a;l<f;l++)F(i,s,l,B),p(i,s,l,B);else if(t.QL()){if(c)for(s=h,l=a;l<f;l++)i.setValue(s,l,t.getColumnName(l-r.col));for(b=(d=(v=t.dataRange()).row)+z(v),g=m=w=void 0,s=d;s<b;s++)for(l=a;l<f;l++)(m=t.BSt[St(t,l)])&&(g=(w=t.ftt(pt(t,s)))[m.dataField()],L(g)||i.setValue(s,l,g))}else if(c)for(s=h,l=a;l<f;l++)i.setValue(s,l,t.getColumnName(l-r.col));if(2==(2&n))for(s=o;s<u;s++)for(l=a;l<f;l++)y=i.Z_(s,l)||new O.Style,t.h5(s,l,y),i.setStyle(s,l,y)}finally{T(i)}t.cL(2)}return t},a.prototype.move=function(t,n,e){var r,i,o,r,o,r=this,i=r.Mf;if((t=_t(t)?r.findByName(t):t)&&0<=n&&0<=e&&(o=t.range(),0===(o=(r=r.AB(n,e,z(o),I(o))).length)||1===o&&r[0]===t)){S(i);try{t.G5t(n,e)}finally{T(i)}}},a.prototype.resize=function(t,n){var e,r,i,o,u,n,u,a,f,s,l,c,e=this,r=e.Mf;if((t=_t(t)?e.findByName(t):t)&&(i=t.range(),o=t.dataRange(),n=n,n=3===(u=arguments).length?(0,O.Ec)(i.row,i.col,u[1],u[2]):n)&&(u=z(n),a=I(n),0<=u)&&0<=a&&(f=e.AB(n.row,n.col,u,a)).length<=1){Rt(r);try{t.K5t(n),t.QL()||(s=r.conditionalFormats,l=r.b8,c=n.rowCount-i.rowCount,s&&s.qJ(i,o,c),l&&l.qJ(i,o,c))}finally{xt(r)}}},a.prototype.all=function(){var e=[];return C(this.U3,function(t,n){e.push(n)}),e},a.prototype.$St=function(t){for(var n,e,r,n=t||this.U3,e=n.length,r=0;r<e;r++)n[r].clearPendingChanges()},a.prototype.Yj=function(t,n,e,r){for(var i,o,u,a,f,i=[],o=this.U3,u=o.length,a=0;a<u;a++)(f=o[a]).Ky>=t&&f.iw>=n&&f.Ky+f.Sx<=t+e&&f.iw+f.Tx<=n+r&&i.push(f);return i},a.prototype.Zj=function(t,n,e,r){var i,o,u,a,i=this,o=i.AB(t,n,e,r),u=i.Yj(t,n,e,r),a=[];return 0<u.length?o.forEach(function(t){-1===u.indexOf(t)&&a.push(t)}):a=o,a},a.prototype.Wj=function(t,n,e){for(var r,i,o,u,r=t.length,o=0;o<r;o++)if((u=(i=t[o]).range()).row<=n&&n<u.row+z(u)&&(e<0||u.col<=e&&e<u.col+I(u)))return!0;return!1},a.prototype.jTt=function(t,n,e,r,i,o,u){var a,a,n,f;return n?bt(n)?e<0||i<1||e+i>t.getRowCount()?(u&&N(H().Exp_TableInvalidRow),!1):r<0||o<1||r+o>t.getColumnCount()?(u&&N(H().Exp_TableInvalidColumn),!1):(a=t.tables).Pl(e,r,i,o)?(u&&N(H().Exp_TableIntersectError),!1):a.findByName(n)?(u&&N(H().Exp_TableHasSameNameError),!1):tr(t,new O.Range(e,r,i,o))?(u&&N(H().Exp_TableRangeHasFilterError),!1):(n=(a=y&&t.iT(e,r,i,o))&&a.ranges,f=!0,n&&C(a,function(t,n){if(1<z(n)||1<I(n))return u&&N(H().Exp_ArrayFormulaTable),f=!1}),f):(u&&N(H().Exp_TableNameInvalid),!1):(u&&N(H().Exp_TableEmptyNameError),!1)},a.prototype.WI=function(t,n,e,r){for(var i,o,u,a,i=[],o=this.U3,u=0;u<o.length;u++)(a=o[u]).Ky>=t&&a.iw>=n&&a.Ky+a.Sx<=t+e&&a.iw+a.Tx<=n+r&&i.push(a.name());return i},a.prototype.oSt=function(t,n,e,r){var i,o,u,a,f,i=this.all();if(i)for(o=(0,O.Ec)(t,n,e,r),u=i.length,a=void 0,f=0;f<u;f++)if(a=i[f].range(),o.intersect(a.row,a.col,z(a),I(a))&&!o.containsRange(a))return!0;return!1},a.prototype.Pl=function(t,n,e,r){for(var i,o,u,a,i=this.U3,o=i.length,a=0;a<o;a++)if((u=i[a]).range().intersect(t,n,e,r))return!0;return!1},a.prototype._getTable=function(t,n,e,r,i){for(var o,u,a,f,s,l,o=t.tables.all(),u=o.length,f=[],s=0;s<u;s++)(l=(a=o[s]).range()).row>=n&&l.col>=e&&l.row+l.rowCount<=n+r&&l.colCount+l.col<=e+i&&f.push({table:a,index:s});return f},a.prototype.mx=function(t,n,e,r,i){var o,u,a,f,s,l,c,h,v,v,o=e.tables.all(),u=o.length;if(!L(n)&&(f=r.row-n.row,s=r.col-n.col,0!==(l=this._getTable(t,n.row,n.col,n.rowCount,n.colCount)).length))for(c=0;c<u;c++)for(a=o[c],h=0;h<l.length;h++)if(v=l[h],(!i||c!==v.index)&&(v=v.table.range(),a.range().intersect(v.row+f,v.col+s,v.rowCount,v.colCount)))return e.jT(6,H().Exp_TableIntersectError),!0;return!1},a.prototype.t5t=function(t,n){for(var e,r,i,o,e=this,r=e.U3,i=0,o=r.length;i<o;i++)r[i].t5t(t,n);e.Mf.filterRowsVisibleInfo.rE(t,n)},a.prototype.JO=function(t,n){for(var e,r,i,o,u,a,f,s,l,c,e,h,v,d,b,w,e=this,r=e.U3,i=[],o=0,u=r.length;o<u;o++)f=(a=r[o]).z3(),l=(s=a.cue&&!(a.jO&&1===a.Sx))?t-1:t,W(i,f)?a.JO(l,n,!0,!0):(c=a.JO(l,n,s,U,a.cue))&&i.push(f);e=e.Mf;try{for(S(e),v=h=void 0,o=0,u=r.length;o<u;o++)h=(a=r[o]).pTt(),v=a.dataRange(),0<h&&h!==z(v)&&(d=h,a.showHeader()&&(d+=1),a.showFooter()&&(d+=1),b=a.range(),w=(0,O.Ec)(b.row,b.col,d,I(v)),a.K5t(w,!0))}finally{T(e)}},a.prototype.qO=function(t,n){for(var e,r,i,o,e=this.U3,r=e.length,o=0;o<r;o++)(i=e[o]).qO(t,n)},a.prototype.n5t=function(t){for(var n,e,r,i,o,u,n=this.U3,e=n.length,u=0;u<e;u++)i=(r=n[u]).iw,o=r.endColumn(),i<=t&&t<=o&&r.n5t()},a.prototype.$pe=function(t){var n=this,e=n.Mf;(n.U3.length<1&&0<t.length||0<n.U3.length&&t.length<1)&&e.Ut.Spe(),n.U3=t},a.prototype.xP=function(t,n){for(var e,r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,g,y,e=this,r=e.U3,i=[],o=[],u=[],a=0,f=r.length;a<f;a++)l=(s=r[a]).z3(),((h=t<=(c=s.range()).row&&c.row+z(c)<=t+n)?u:(W(i,l)?s.xP(t,n,!0):(s.QL()&&s.x4t(t,n,Tt(!0)),(v=s.xP(t,n))&&i.push(l)),o)).push(s);e.Mf.filterRowsVisibleInfo.aE(t,n),e.Mf.Ut.DTt(u,[],2),e.$pe(o),e.RTt(u,!0),d=e.Mf;try{for(S(d),r=e.U3,w=b=void 0,a=0,f=r.length;a<f;a++)b=(s=r[a]).pTt(),w=s.dataRange(),0<b&&b!==z(w)&&(m=b,s.showHeader()&&(m+=1),s.showFooter()&&(m+=1),g=s.range(),y=(0,O.Ec)(g.row,g.col,m,I(w)),s.K5t(y,!0))}finally{T(d)}},a.prototype.NP=function(t,n){for(var e,r,i,o,u,a,f,s,l,e=this,r=e.U3,i=[],o=[],u=r.length,f=0;f<u;f++)((l=t<=(s=(a=r[f]).range()).col&&s.col+I(s)<=t+n)?o:(a.NP(t,n),i)).push(a);e.Mf.Ut.DTt(o,[],2),e.$pe(i),e.RTt(o,!0)},a.prototype.d5=function(t,n,e,r,i){var o,u,a,f,s,l,c,h,v,o=this,u=(0,O.Ec)(t,n,e,r),l=[],c=o.Mf;if(1==(1&i)){for(h=[],f=(a=o.U3).length,v=0;v<f;v++)s=a[v],(u.containsRange(s.range())?l:h).push(s);for(f=h.length,v=0;v<f;v++)(s=h[v]).d5(t,n,e,r);c&&c.Ut.DTt(l,[],2),o.$pe(h)}if(2==(2&i))for(f=(a=o.U3).length,v=0;v<f;v++)s=a[v],u.containsRange(s.range())&&(c&&c.Ut.YSt(s,"style",s.style()),s.style(B));return o.RTt(l,!0),l},a.prototype.RTt=function(t,n){var e;t&&0!==t.length&&(e=this.Mf,O.GC$.each(t,function(t,n){n.N5t()&&n.getSlicerData().onTableRemoved(n),n.g5t()&&(e&&e.Ut.YSt(n,An,n.b5t()),n.OSt=[])}),y)&&xe(this.Mf,t,n)},a.prototype.OTt=function(t){t&&t.N5t()&&t.getSlicerData().onTableAdded(t)},a.prototype.BTt=function(t){for(var n,e,r,i,n=1,e,r=t,i=this.LTt();!this.FTt(r,i);)r=t+(3<t.length?"":"_")+n,n++;return r},a.prototype.LTt=function(){for(var t,n,e,r,i,o,u,a,f,s,t=[],n,e,i=0,o=this.Mf.parent.sheets;i<o.length;i++)for(a=0,f=r=(u=o[i]).tables.all();a<f.length;a++)s=f[a],t.push(s);return t},a.prototype.FTt=function(t,n){for(var e,r,i,e=0,r=n;e<r.length;e++)if((i=r[e]).name().toLowerCase()===t.toLowerCase())return!1;return!0},a.prototype.Sl=function(t,n){var e,r,i,o,e,r=!1,i=B,o=this.find(t,n);return o&&(o.showHeader()&&t===o.headerIndex()?(i=o.q5t(n),L(i)||(i=v(i)),r=!0):(r=(i=o.Sl(t,n)).e5t,i=i.y4)),{e5t:r,y4:i}},a.prototype.Kbt=function(t,n,e){var r,i,o,u,r,i=!1,o=!0,u=this.find(t,n);return u&&!0!==u.eTt&&(u.showHeader()&&t===u.headerIndex()?(L(e)||(e=u.nTt(v(e),n-u.iw)),u.$5t(n,e)):u.showFooter()&&t===u.footerIndex()?u.d5t(n,e):i=u.Kbt(t,n,e)),i||!1},a.prototype.pMt=function(t,n,e,r,i,o){var u=this.find(t,n);if(y&&u){if(1<e||1<r)return this.Mf.jT(0,H().Exp_ArrayFormulaTable),!1;if(u.showHeader()&&t===u.headerIndex()&&i)return!1;!u.eTt&&u.showFooter()&&t===u.footerIndex()&&(L(i)||u.d5t(n,B),u.m5t(n-u.iw,i,o))}return!0},a.prototype.XSt=function(){for(var t,n,e,r,t=this.all(),n=0,e=t.length;n<e;n++)(r=t[n]).bindingPath()&&(r.H3=B)},a.prototype.KB=function(t,n){var e,r,i,o,u,e=[],r=this;if(r&&(i=r.all()))for(u=i.length-1;0<=u;u--)o=i[u],t.containsRange(o.range())&&(n&&(this.Mf&&this.Mf.Ut.DTt([o],[],2),r.U3.splice(u,1),o.U5t(U,U,n)),e.push(o));return e},a.prototype.JB=function(t,n,e,r,i,o){for(var u,a,f,s,l,c,h,l,l,v,u=this,a=[],f=0,s=t.length;f<s;f++)l=t[f],h=c=void 0,o?h=l:(c=l.bindingPath()?U:l.z3(),(h=new G).Sg(u),h.fromJSON(Pt(Jt(l.toJSON()))),h.name(u.BTt(h.name())),a.push(h)),l=h.range(),h.rTt=!0,h.H5t(r+l.row-n,i+l.col-e),u.WB(h,o),o?(l=h.LSt)&&(l.Mf=u.Mf,l.refresh()):c&&h.V3(c),h.rTt=!1;for(f=0;f<a.length;f++)(v=a[f]).formulaFromJSON(),o||v.rCe(t[f].name())},a.prototype.qB=function(t){for(var n=0,e=t.length;n<e;n++)t[n].z5t()},a.prototype.toJSON=function(t,n){var e,r,i,o,e=this.U3,r=[];if(e)for(i=0;i<e.length;i++)o=t?this.BTt(e[i].name()):U,r.push(e[i].toJSON(o,n));return 0===r.length?U:r},a.prototype.wh=function(t){var n,e,r,i,o,u,a,a,u;if(t&&(n=t.rels,r=(e=this.U3).length,n)&&0<r){for(i=[],o=0;o<r;o++)u=e[o],a=ft(n),a=O.XFileConstants.Rr+a,u=u._id,n.c_.push({n_:O.XFileConstants.Lr,Id:a,Type:O.RelationshipConstants.lc,Target:"../tables/"+O.XFileConstants.du+u+"."+O.XFileConstants.Cr}),i.push({n_:"tablePart","r:id":a});t.c_||(t.c_=[]),t.c_.push({n_:ee,count:r,c_:i})}},a.prototype.fromJSON=function(t,n,e){var r,i,o,u;if(t)for(this.U3=[],this.dl(),r=0,i=t.length;r<i;r++)o=t[r],(u=new G).Sg(this),this.U3.push(u),u.fromJSON(o,n,e)},a.prototype.yh=function(t,n,e,r){var i,o,u,a,f,s,l,c,h,v,v,v,v,d,b,i=t&&t.c_,o=!O.Util.ko(r);if(i&&n){for((a=O.Util.wo(r,(u=this).Mf.parent&&u.Mf.parent.v2))||(u.U3=[]),u.dl(),f=e.tables,s=e.styleManager,l=[],c=0,h=i.length;c<h;c++)v=i[c][ne],(v=(v=st(n.c_,v))&&v.Target)&&(d=(v=f[v=v.split("/").pop().slice(0,-4)]).name,b=void 0,(b=a?u.findByName(d):b)||((b=new G(d)).Sg(u),u.U3.push(b)),b.yh(v,s,r),l.push(b.range()),o)&&b._5t(s);O.Util.Co(r)&&O.Util.Ao(u.Mf,l,U,e)}},a.prototype.containTableHeaderTotalRowForSheet=function(){var t,n,t,e,r,i,o,u,a,f,s,l,c,t=this.Mf;if(t&&(n=t.getSelections(),i=r=e=void 0,t=t.tables)&&n)for(o=t.U3,s=f=a=u=void 0,l=0;l<n.length;l++)for(i=(r=(e=n[l]).row)+e.rowCount-1,c=0;c<o.length;c++)if(a=(u=o[c]).range(),f=u.headerIndex(),s=u.footerIndex(),!e.containsRange(a)&&(r<=f&&f<=i||r<=s&&s<=i))return!0;return!1},a.prototype.containTableHeaderTotalRow=function(){var t,n,e,r,i,o,e,t,u,a,f,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),o=i=void 0,r=t.tables)&&e){if(1<e.length)return n;e=e[0],f=a=u=void 0,(t=Mt(t,e))&&1===t.length&&(o=(i=e.row)+e.rowCount-1,a=(u=t[0]).headerIndex(),f=u.footerIndex(),i<=a&&a<=o||i<=f&&f<=o)&&(n=!0)}return n},a.prototype.noRoomToInsertColumn=function(){var t,n,e,n,r,i,n,e,r,t=this.Mf;return!!(t&&(n=t.getSelections(),e=t.tables)&&n&&1===n.length&&(r=(n=n[0]).row,i=n.col,n=n.colCount,e=e.find(r,i),r=t.getColumnCount(3),e)&&e.endColumn()+n>=r)},a.prototype.noRoomToInsertRow=function(){var t,n,e,n,r,i,n,e,r,t=this.Mf;return!!(t&&(n=t.getSelections(),e=t.tables)&&n&&1===n.length&&(r=(n=n[0]).row,i=n.col,n=n.rowCount,e=e.find(r,i),r=t.getRowCount(3),e)&&e.endRow()+n>=r)},a.prototype.checkTableRow=function(){var t,n,t,n,e,n,t,e,t=this.Mf;return!(!(t&&(n=t.getSelections(),t=t.tables)&&n&&1===n.length&&(e=(n=n[0]).row,n=n.col,e=(t=t.find(e,n))&&t.range(),t)&&e)||t.jO||t.oL||1!==e.rowCount)},a.prototype.checkTableCol=function(){var t,n,t,n,e,n,t,e,t=this.Mf;return!!(t&&(n=t.getSelections(),t=t.tables)&&n&&1===n.length&&(e=(n=n[0]).row,n=n.col,e=(t=t.find(e,n))&&t.range())&&1===e.colCount)},a.prototype.isAcrossTables=function(){var t,n,e,r,e,t,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),r=t.tables)&&e){if(1<e.length)return n;e=e[0],(t=Mt(t,e))&&(n=1<t.length)}return n},a.prototype.isWholeTableCol=function(){var t,n,e,r,e,t,t,i,t,o,e,t=this.Mf,n=!1;return t&&(e=t.getSelections(),r=t.tables)&&e&&(1<e.length?n=!0:(e=e[0],1===(t=Mt(t,e)).length&&(i=(t=t[0]).iw,t=t.Tx,o=e.col,e=e.colCount,n=i===o&&t===e))),n},a.prototype.containTableHeader=function(){var t,n,e,r,i,o,e,t,u,t,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),o=i=void 0,r=t.tables)&&e){if(1<e.length)return n;e=e[0],(t=Mt(t,e))&&1===t.length&&(t=(u=t[0]).headerIndex(),o=(i=e.row)+e.rowCount-1,i<=t)&&t<=o&&(n=!0)}return n},a.prototype.eq=function(){var t,n,e,r,i,t,o,u,a,f,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),r=t.tables)&&e){if(i=t.getActiveRowIndex(),t=t.getActiveColumnIndex(),1<e.length||!r.find(i,t))return n;for(o=r.U3,u=e[0],a=void 0,f=0;f<o.length;f++)a=o[f],u&&u.intersect(a.Ky,a.iw,a.Sx,a.Tx)&&(n=!0)}return n},a.prototype.uSt=function(t){var n,e,r,i,o,u,a,f,s,n=-1,e,r=this.U3;if(r)for(i=r.length,f=a=u=o=void 0,s=0;s<i;s++)o=r[s].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||n<(f=(u=o.row)+(a=o.rowCount)-1)&&(n=f);return n},a.prototype.sSt=function(t){var n,e,r,i,o,u,a,f,s,n=-1,e,r=this.U3;if(r)for(i=r.length,f=a=u=o=void 0,s=0;s<i;s++)o=r[s].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||n<(f=(u=o.col)+(a=o.colCount)-1)&&(n=f);return n},a.prototype.yx=function(t,n,e,r,i,o,u){var a,f,s,l,c,h,v,d,b,w,u,m,g,n,y,C,p,S,T,_,R,a=this;if(!(a.Mf.isActualProtected()||t&&e&&lr(t,e)||0===(f=a.all()).length||(s=e&&f.some(function(t){return e.equals(t.range())}))))for(u&&(d=u.shiftInfo,b=u.applyDragFillAfterTableExpand,w=u.backupTableResizedArgs,d)&&(l=d.shiftCells,c=d.isCopy,h=d.isFirst,v=d.isHeaderPaste),u=n.row,m=n.col,g=n.rowCount,n=n.colCount,v&&(-1===u&&(u=0),-1===m&&(m=0),-1===g&&(g=t.getRowCount()),-1===n)&&(n=t.getColumnCount()),y=new O.Range(u,m,g,n),S=0,T=f;S<T.length;S++)(C=T[S]).VSt&&(p=C.range(),_=e&&e.equals(p),R=e&&0!==a.Mf.Ut.getSpans(e,3).length,l?c&&h&&y.col===p.col&&y.colCount===p.colCount&&y.row>p.row&&e.col===p.col&&e.colCount===p.colCount&&e.row>p.row&&y&&p.contains(y.row,y.col,1,y.colCount)&&e&&p.containsRange(e)&&(a.PTt(C,p,y),d.ignoreFooterShiftIndex=C.footerIndex()):e&&(_||R)||(C.TTt=i,a.GTt(C,p,y,r,o,w,b),delete C.TTt))},a.prototype.GTt=function(t,n,e,r,i,o,u){var a,f,s,l,c,h,v,d,b,w,m,m,i,m,g,y,C,p,S,T,_,b,R,w,x,v,j,F,p,a=this,f=a.Mf,s=null,l=!1,c=n.row,h=n.col,v=n.rowCount,d=n.colCount,b=c+v-1,w=new O.Range(c,h,v,d);if(t.showFooter()){if(m=new O.Range(c+v-1,h,1,d),e.row===m.row&&e.col>=h&&e.col+e.colCount<=h+d)return;l=!0,w.rowCount--}if(i&&(m=t.showHeader()?v-1:v,i.push(new O.Range(c,h,m,d))),i=e.row,m=e.col,g=e.row+e.rowCount-1,y=e.col+e.colCount-1,C=c+v-1-(l?1:0),p=h+d-1,S=U,T=f.getRowCount(),_=w.contains(i-1,m)&&!w.contains(i,m),l||(_=_&&y<=p&&h<=m),b=w.contains(i,m-1)&&!w.contains(i,m)&&g<=b&&i>=n.row,R=w.contains(i,m)&&!w.contains(g,y)){if(w=Gt(C,g)-c+1,x=Gt(p,y)-h+1,p<y&&(v=M(f,new O.Range(c,1+p,v,y-p)))&&y>v.col&&(x=d),s=new O.Range(c,h,w,x),l&&(s.rowCount++,g++,C++),(S=C<g?M(f,new O.Range(C+1,h,s.row+s.rowCount-1,d)):S)&&0<(j=g-S.row+1)){if(M(f,new O.Range(T-Math.abs(j),h,Math.abs(j),d)))return void f.jT(6,H().Exp_TableAddRowNoEnoughRoom);!0!==u&&f.moveTo(S.row,h,s.row+s.rowCount,h,T-s.row-s.rowCount,d,Q)}}else if(_&&!l){if(s=new O.Range(i,h,e.rowCount,d),(F=M(f,s,e))&&!e.containsRange(F))return}else if(b&&(s=new O.Range(c,m,n.rowCount,e.colCount),F=M(f,s,e))&&!e.containsRange(F))return;_&&!l&&Ot(r)&&(t.useFooterDropDownList(!0),or(f,t),n=t.range()),s&&!n.containsRange(s)&&(p=n.union(s),a.UTt(t,p,o,!0))},a.prototype.PTt=function(t,n,e){var r,i,o,u,n,a,i,r=this,i=n.row,o=n.col,u=n.rowCount,n=n.colCount,a;new O.Range(i+(t.showHeader()?1:0),o,u-(t.showHeader()?1:0),n).contains(e.row,e.col,1,e.colCount)&&(i=new O.Range(i,o,u+e.rowCount,n),r.UTt(t,i))},a.prototype.UTt=function(t,n,e,r){var i=this.Mf,o=i.getParent();o&&o.commandManager().execute({cmd:In,sheetName:i.name(),tableName:t.name(),resizeToRange:n,backupTableResizedArgs:e,ignoreEventSuspend:r})},a.prototype.HL=function(t,n,e){var r,i,o,u,o,a,f,s,l,c,h,v,d,b,w,o,m,g,y,C,p,S,T,_,R,x,j,_,S,r,C,p,p,r,m,y,r=this,i=this.Mf,o=i.options,u=i.isActualProtected(),o=o.protectionOptions,a=!1!==o.allowSelectLockedCells,f=!1!==o.allowSelectUnlockedCells;if(!u||a||f){if(s=e.col,l=e.row,c=2,v=h=18,d=5,b=10,w=6,o=be.TABLE_SELECT,m=be.TABLE_CORNER_SELECT,g=be.TABLE_COL_SELECT,y=be.TABLE_ROW_SELECT,C=i.getActiveRowIndex(),p=i.getActiveColumnIndex(),-1===e.rowViewportIndex&&-1!==e.colViewportIndex&&(S=i.getCellRect(l,s,e.rowViewportIndex,e.colViewportIndex),(T=r.find(C,p))instanceof G)&&(_=i.Tb-i.frozenRowCount(),T.showHeader())&&C>=T.Ky&&C<T.Ky+T.Sx&&p>=T.iw&&p<T.iw+T.Tx&&T.Ky<_&&T.Ky+T.Sx>_&&e.col<T.iw+T.Tx&&e.col>=T.iw)if(t>S.x+5&&t<S.x+S.width-18&&n<S.height-5){for(R=i.getSelections(),x=0;x<R.length;x++)if(!((j=R[x]).col===e.col&&1===j.colCount&&j.row===T.Ky&&j.rowCount===T.Sx||j.col===e.col&&1===j.colCount&&-1===j.row&&j.rowCount===i.getRowCount()))return D(T,g,l,s,u,a,f)}else if(t>S.x+18)return D(T,"default",l,s,u,a,f);if(_=i.getCellRect(l,s),r.find(l,s)instanceof G&&-1!==e.colViewportIndex&&-1!==e.rowViewportIndex){if(S=!1,T=r.find(l,s),r=r.find(C,p),C=!0,1===(R=i.getSelections()).length&&(p=R[0]).row<=l&&p.row+p.rowCount>l&&p.col<=s&&p.col+p.colCount>s&&(C=!1),T===r&&(S=!0),s===T.iw&&l===T.Ky){if(C&&S&&(t<=_.x+2||n<=_.y+2))return D(T,o,l,s,u,a,f);if(t>_.x+2&&t<_.x+18&&n>_.y+2&&n<_.y+6)return D(T,m,l,s,u,a,f);if(t>_.x+18&&n>_.y+2&&n<_.y+6)return D(T,g,l,s,u,a,f);if(t>_.x+2&&t<_.x+18&&n>_.y+6)return D(T,y,l,s,u,a,f)}if(s===T.iw+T.Tx-1&&l===T.Ky){if(C&&S&&(t>=_.x+i.getColumnWidth(s)-2||n<=_.y+2))return D(T,o,l,s,u,a,f);if(t<_.x+i.getColumnWidth(s)-2&&n>_.y+2&&n<_.y+6)return D(T,g,l,s,u,a,f)}if(s===T.iw&&l===T.Ky+T.Sx-1){if(C&&S&&(t<=_.x+2||n>=_.y+i.getRowHeight(l)-2))return D(T,o,l,s,u,a,f);if(t>_.x+2&&t<_.x+18&&n<_.y+i.getRowHeight(l)-2)return D(T,y,l,s,u,a,f)}if(C&&S&&s>T.iw&&s<T.iw+T.Tx&&l===T.Ky&&n<=_.y+2)return D(T,o,l,s,u,a,f);if(s>T.iw&&s<T.iw+T.Tx&&l===T.Ky&&n>_.y+2&&n<_.y+6)return D(T,g,l,s,u,a,f);if(C&&S&&l>T.Ky&&l<T.Ky+T.Sx&&s===T.iw&&t<=_.x+2)return D(T,o,l,s,u,a,f);if(l>T.Ky&&l<T.Ky+T.Sx&&s===T.iw&&t>_.x+2&&t<_.x+18)return D(T,y,l,s,u,a,f);if(p=i.getColumnWidth(T.iw+T.Tx-1),r=i.getRowHeight(T.Ky+T.Sx-1),m=_.x+p,y=_.y+r,S&&(l>T.Ky&&l<T.Ky+T.Sx&&s===T.iw+T.Tx-1&&m-2<=t&&t<=m||s>T.iw&&s<T.iw+T.Tx&&l===T.Ky+T.Sx-1&&y-2<=n&&n<=y)){if(s===T.iw+T.Tx-1&&l===T.Ky+T.Sx-1&&y-10<=n&&m-10<=t)return B;if(C)return D(T,o,l,s,u,a,f)}}}return B},a.prototype.wR=function(t,n){var e,r,e,i,o,u,e=this,r=e.Mf;if(e.find(t,n)instanceof G){for(i=0,(e=e.find(t,n)).oL&&(i=1),o=0,e.jO&&(o=1);0<t&&0===r.getRowHeight(t-1);)t--;if(1===o&&n===e.iw&&t===e.Ky)return u=wt(r,e,!0),d(u,e.iw+e.Tx-1,u);if(n===e.iw&&t===e.Ky)return u=wt(r,e,!0),d(u,e.iw+e.Tx-1,u);if(t>e.Ky&&t<e.Ky+e.Sx-i&&n===e.iw)return t===e.Ky+o?(t=wt(r,e,!0),d(t,e.iw+e.Tx-1,t)):d(t-1,e.iw+e.Tx-1,t-1)}return null},a.prototype.xR=function(t,n){var e,r,e,i,o,u,u,a,f,s,l,c,c,h,a,v,e=this,r=e.Mf;if(e.find(t,n)instanceof G){for(i=0,(e=e.find(t,n)).oL&&(i=1),o=0,e.jO&&(o=1),u=r.getRowCount()-1;t+1<r.getRowCount()&&0===r.getRowHeight(t+1);)t++;if(u!==t&&n===e.iw+e.Tx-1&&t<e.Ky+e.Sx-i)return u=e.Ky+e.Sx,s=(a=e.iw)+(f=e.Tx)-1,l=d(t+1,e.iw,t+1),t===u-i-1&&(e.VSt?(c=gt(r,e),1===i&&Ct(r,e,u,c,a,s,1,!0,!1,!0)||(a=(h=(c=M(r,new O.Range(u,a,c-u+1,s-a+1)))&&c.row)===u,u!==r.getRowCount()&&(a?rr:ir)(r,e,t,1,!0))):l=d(t,1+s,t)),l;if(r.getRowCount()-1===t&&n===e.iw+e.Tx-1&&0===i){for(v=e.Ky+o;v+1<r.getRowCount()&&0===r.getRowHeight(v);)v++;return v+1===r.getRowCount()&&0===r.getRowHeight(v)?d(e.Ky,e.iw,e.Ky):d(v,e.iw,v)}}return null},a.prototype.fR=function(t,n){var e,r,e,i,o,u,e=this,r=e.Mf;if(e.find(t,n)instanceof G){for(i=0,(e=e.find(t,n)).oL&&(i=1),o=0,e.jO&&(o=1);0<n&&0===r.getColumnWidth(n-1);)n--;if(n===e.iw&&(t===e.Ky||t===e.Ky+o))return{col:u=mt(r,e),leadingCellCol:u,row:e.Ky+e.Sx-1-i};if(n===e.iw&&(t===e.Ky||t===e.Ky+o))return{col:u=mt(r,e),leadingCellCol:u,row:e.Ky+e.Sx-1-i};if(n>e.iw&&n<e.iw+e.Tx&&(t===e.Ky||t===e.Ky+o))return n===e.iw?{col:n=mt(r,e),leadingCellCol:n+1,row:e.Ky+e.Sx-1-i}:{col:n-1,leadingCellCol:n-1,row:e.Ky+e.Sx-1-i}}return null},a.prototype.SB=function(){for(var t,n,e,r,i,t,n=this.U3,e=n.length,i=0;i<e;i++)(r=n[i]).w5t()},a.prototype.cL=function(t,n){for(var e,r,i,o,u,a,f,a,f,e,r=this.U3,i=r.length,o=0;o<i;o++)u=r[o],t?(a=u.Ky,f=u.Ky+u.Sx-1,a<=n&&n<=f&&u.cL(0)):(a=u.iw,f=u.iw+u.Tx-1,a<=n&&n<=f&&u.cL(0))},a.prototype.AJ=function(t,n,e,r,i){for(var o,u,a,f,s,o=this.AB(t,n,e,r),u=[],a=0,f=o.length;a<f;a++)s=o[a].dataRange(),i?s.rowCount+=e:s.colCount+=r,u.push(s);return u},Ce=a,R.TableManager=Ce,(r=pe=R.TableRemoveOptions||(R.TableRemoveOptions={}))[r.none=0]="none",r[r.keepData=1]="keepData",r[r.keepStyle=2]="keepStyle",O.GC$.extend(O.Y8.prototype,{D5t:function(t,n){var e,r,r,e,r=this.G8;r&&(r.tableChanges||(r.tableChanges=[]),delete(r=r.tableChanges).isRestored,r.push({type:"changeTableManager",table:t,oldTableManager:n}))},YSt:function(t,n,e,r){var i,o,o,i,o=this.G8;o&&(o.tableChanges||(o.tableChanges=[]),delete(o=o.tableChanges).isRestored,o.push({type:Pn,table:t,name:n,value:e,newValue:r}))},DTt:function(t,n,e){var r,i,i,r,r=this,i=r.G8;i&&(i.tableChanges||(i.tableChanges=[]),i=i.tableChanges,r=r.QSt,delete i.isRestored,i.push({type:Gn,tableList:r.U3.slice(),changedTables:t,addedTables:n,changeType:e}))},A5t:function(t,n,e,r,i){var o,u,u,o,u=this.G8;u&&(u.tableChanges||(u.tableChanges=[]),delete(u=u.tableChanges).isRestored,u.push({tableName:t.name(),type:Jn,tableColumn:n,name:e,value:r,newValue:i}))},HTt:function(t,n,e){var r,i,o,r,r,r=this,i,o=t.getValue(n,e).value,r=r.G8;r&&(r.tableChanges||(r.tableChanges=[]),delete(r=r.tableChanges).isRestored,r.push({type:Yn,bindingManager:t,row:n,col:e,oldValue:o}))},B5t:function(t,n,e,r,i){var o,u,u,o,u=this.G8;u&&(u.tableChanges||(u.tableChanges=[]),delete(u=u.tableChanges).isRestored,u.push({type:$n,table:t,key:r,row:n,count:e,stateType:i}))},_Tt:function(t,n,e){var r,i,o,r,i=this.G8;i&&(i.tableExpressionChanges||(i.tableExpressionChanges=[]),(o=i.tableExpressionChanges).push({type:qn,table:t,expression:n,col:e}))},ETt:function(t,n,e,r){var i,o,u,i,o=this.G8;o&&(o.sheetExpressionChanges||(o.sheetExpressionChanges=[]),(u=o.sheetExpressionChanges).push({type:Zn,table:t,expression:n,row:e,col:r}))},zTt:function(h){var v,d,t,n,e,r,i;if(h){for(v=null,dr(d=this.QSt,h._bindingChanges,!0),t=function(t){var e,n,r,i,o,u,a,f,s,f,l,c,e=h[t],n=void 0;switch(e.type){case Gn:if(2===e.changeType)for(r=function(t){var n,t,n=e.changedTables[t],t=d.U3.findIndex(function(t){return t.name===n.name});0<=t&&d.U3.splice(t,1)},i=0;i<e.changedTables.length;i++)r(i);else if(1===e.changeType&&e.addedTables)for(o=e.addedTables,i=0;i<o.length;i++)(u=o[i])&&"Object"===u.constructor.name&&(u=br(d,u),d.U3.push(u));break;case Jn:n=d.findByName(e.tableName),a=e.tableColumn,"name"===e.name&&(a=e.value),0<=(f=n.BSt.findIndex(function(t){return t.name()===a}))&&((s=n.BSt[f])[e.name](e.newValue),"name"===e.name)&&n.I5t(a,e.newValue,f);break;case Pn:(n=e.table)?(f=e.name,l=e.newValue,f===V?(n.Ky=l.row,n.iw=l.col,n.Sx=l.rowCount,n.Tx=l.colCount):f===Wn?(l=l&&l.map(function(t){var n;return t&&"Object"===t.constructor.name?((n=new J).fromJSON(t),n):t}),n.BSt=l):f===An?(l=l&&l.map(function(t){var n;return t&&"Object"===t.constructor.name?((n=new O.Style).fromJSON(t,!1,null),n):t}),n.OSt=l):("style"===f&&l&&l.buildInName&&(l=$.TableThemes[l.buildInName.toLowerCase()]),n[f](l))):"name"===e.name&&(n=d.findByName(e.value))&&n.name(e.newValue);break;case"changeTableManager":break;case Yn:(c=cr(d,e.bindingManager)).setValue(e.row,e.col,e.oldValue);break;case $n:v=n=e.table,hr(n="Object"===n.constructor.name?d.findByName(n.name):n,e.row,e.count,e.key,e.stateType)}},n=0;n<h.length;n++)t(n);if(v)for(v.LSt&&v.LSt.refresh(),e=this.Mf.slicers&&this.Mf.slicers.all(),n=0;n<e.length;n++)if((r=e[n]).LSt===v.LSt&&r.gmi)for(i=0;i<r.gmi.length;i++)r.gmi[i].onDataChanged()}},VTt:function(t){var n,e,r,i,o,u,a,a,f,s,s;if(t)for(n=this.QSt,e=void 0,r=!1,dr(n,t.bindingChanges),i=t.length-1;0<=i;i--)switch(u=void 0,(o=t[i]).type){case Gn:a=o.changedTables,n.$pe(o.tableList),a&&0<a.length&&a.forEach(function(t){t&&(r=!0,t.w5t(),t.qSt())});break;case Jn:o.tableColumn[o.name](o.value);break;case Pn:u=o.table,a=o.name,f=o.value,a===V?(s=u.footerIndex(),u.Ky=f.row,u.iw=f.col,u.Sx=f.rowCount,u.Tx=f.colCount,u.LSt&&vr(e,u.LSt),r&&-1!==s&&u.u5t(s)):a===Wn?u.BSt=f:a===An?u.OSt=f:u[a](f),u.cL(0);break;case"changeTableManager":u=o.table,s=o.oldTableManager,u.k5t(s);break;case Yn:o.bindingManager.setValue(o.row,o.col,o.oldValue);break;case $n:hr(o.table,o.row,o.count,o.key,o.stateType),e=o}},YTt:function(t){var n,e,r,i,r,o,r;if(t){for(n=void 0,e=t.length-1;0<=e;e--)(r=t[e]).type===qn&&(n=r.table,i=r.expression,r=r.col,o=void 0,o=n.BSt[r].footerFormula())&&-1<(r=Lt(o))&&(o.arguments[r]=i);n&&n.w5t()}},ZTt:function(t){var n,e,r,i,o;if(t)for(n=t.length-1;0<=n;n--)(e=t[n]).type===Zn&&(r=e.expression,i=e.row,o=e.col,e.table.CTt(i,o,r))}}),O.Y8.ch(zn,{priority:7e3,isValid:function(t){var n,n,t,n,t=-1<["getValue","setValue"].indexOf(t),n=0<(null==(n=null==(n=this.Mf.tables)?void 0:n.U3)?void 0:n.length);return!t||n},init:function(){this.QSt=new Ce(this.Mf)},clearPendingChanges:function(t){var n=this.tables;n&&n.$St(t.tableList)},undoAddRows:function(t){var n,e,n,r,i,o,n=t.sheetArea;!L(n)&&n!==O.SheetArea.viewport||(n=(e=this).Mf,r=t.row,i=t.rowCount,(o=n.tables.AB(r,-1,i,-1)).forEach(function(t){t.x4t(r,i,Tt(!0))}))},getValue:function(t){var n,n,n,e,r,i,o,u;0<(null==(n=null==(n=this.Mf.tables)?void 0:n.U3)?void 0:n.length)&&(n=t.row,e=t.col,r=t.sheetArea,i=this.Mf.tables,u=o=void 0,3===r)&&i&&(o=i.find(n,e))&&(u=i.Sl(n,e),t.isValueGet=u.e5t,t.value=u.y4)},setValue:function(t){var n,e,r,i,o,u,i,a,n=t.row,e=t.col,r=t.value,i=t.sheetArea,o=this.Mf.tables;3===i&&o&&(u=o.find(n,e))&&(a=void 0,(i=t.changes)&&!(a=i.tableChanges)&&(i.tableChanges=[]),t.isValueSet=o.Kbt(n,e,r))},applyChanges:function(t){var n,e,t,r,i,e,n=this,e=t.changes,t=t.isUndo;e&&(r=e.tableChanges,i=e.tableExpressionChanges,e=e.sheetExpressionChanges,r&&(mr(n.QSt,r),t?n.VTt(r):n.zTt(r)),t)&&(i&&n.YTt(i),e)&&n.ZTt(e),n.QSt.dl()},undo:function(t){var n=t.tableChanges,e=t.tableExpressionChanges,t=t.sheetExpressionChanges;n&&!n.isRestored&&this.VTt(n),e&&this.YTt(e),t&&this.ZTt(t),this.QSt.dl()}}),O.Workbook.ch(zn,{init:function(){O.Commands.D4t(this.commandManager())},onCultureChanged:function(){H()},preFromSJSFormat:function(t,n,e){var e,e,t,r,i,o,u,a,f,s,e=e&&!1===e.includeStyles;if(!e&&(t=(e=t.styles)&&e.tableStyles,r=n.styleManager,t)&&(r.addDefaultStyleName("defaultTableStyle",t.defaultTableStyle||"TableStyleMedium2"),0<(i=tt(t.count,0)))&&(o=q(t,"tableStyle")))for(u=0,a=o;u<a.length;u++)(f=a[u])&&0==+f.pivot&&0<f.count&&(s=new $.TableTheme).yh(f,r)},preToSJSFormat:function(t,n,e){var r,e,i,o,u,a,f,s,l,r=e&&e.fileType===O.OpenSaveFileType.excel,e=e&&!1===e.includeStyles;if(r&&!e)for(o=0,u=i=this.mp;o<u.length;o++)s=(f=(a=u[o]).Mf).getRowCount(),l=f.getColumnCount(),(a._gi===O.SheetType.tableSheet||a._gi===O.SheetType.ganttSheet)&&0<s&&0<l&&f.tables.WB(new G(f.name().replace(/ /g,"")+"Table",0,0,s,l,a.hl,{showHeader:!1}))},wh:function(t,n,e){var r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,m,r=this,i=t.tables,o=n&&n.styleManager,u=e&&e.fileType===O.OpenSaveFileType.excel,a=e&&!1===e.includeStyles;if(!a)for(f={},l=(s=0,O.Ap)(r);s<l;s++)if((c=(0,O.Tp)(r,s))&&(v=(h=c.tables)&&h.all())&&0<v.length)for(d=0,b=v;d<b.length;d++)w=b[d],m=(i=i||(t.tables={}))[O.XFileConstants.du+w._id]={},w.wh(m,t,n,e,f),(m=w.style())&&!m.builtInName()&&o.addTableStyle(m.wh(o)),u&&!a&&c.NMi&&h.DK(w)}})},"./dist/plugins/table/table.ns.js":function(t,n,e){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/table/table.res.en.js");n.SR={en:e}},"./dist/plugins/table/table.res.en.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Table_Var=n.Table_StdDev=n.Table_Sum=n.Table_Min=n.Table_Max=n.Table_Count_Numbers=n.Table_Count=n.Table_Average=n.Table_None=n.Table_Total=n.Exp_TableAddRowNoEnoughRoom=n.Exp_TableAddRowIntersectTable=n.Exp_TableAddRowIntersectSpan=n.Exp_TableDeleteCountInvalid=n.Exp_ColParamOutOfRange=n.Exp_RowParamOutOfRange=n.Exp_TableResizeToTable=n.Exp_TableResizeWithHidden=n.Exp_TableResizeWithFilter=n.Exp_TableResizeToSpan=n.Exp_TableResizeInvalidRange=n.Exp_ArrayFormulaTable=n.Exp_TableResizeOutOfRange=n.Exp_TableMoveOutOfRange=n.Exp_TableDataSourceNullError=n.Exp_TableRangeHasFilterError=n.Exp_TableHasSameNameError=n.Exp_TableIntersectError=n.Exp_TableInvalidColumn=n.Exp_TableInvalidRow=n.Exp_TableNameInvalid=n.Exp_TableEmptyNameError=n.Exp_DragDropChangePartOfTable=n.Exp_DragDropShiftTableCell=void 0,n.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",n.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",n.Exp_TableEmptyNameError="The table name cannot be empty.",n.Exp_TableNameInvalid="The table name is not valid.",n.Exp_TableInvalidRow="Invalid row index or row count.",n.Exp_TableInvalidColumn="Invalid column index or column count.",n.Exp_TableIntersectError="The tables cannot be intersected.",n.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",n.Exp_TableRangeHasFilterError="The current table range contains a filter range.",n.Exp_TableDataSourceNullError="Table datasource cannot be null.",n.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",n.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",n.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",n.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",n.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",n.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",n.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",n.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",n.Exp_RowParamOutOfRange="The param row out of data range of table.",n.Exp_ColParamOutOfRange="The param col out of data range of table.",n.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",n.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",n.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",n.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",n.Table_Total="Total",n.Table_None="None",n.Table_Average="Average",n.Table_Count="Count",n.Table_Count_Numbers="Count Numbers",n.Table_Max="Max",n.Table_Min="Min",n.Table_Sum="Sum",n.Table_StdDev="StdDev",n.Table_Var="Var"},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},Bindings:function(t){t.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},Filters:function(t){t.exports=GC.Spread.Sheets.Filter}},r={},t=i("./dist/plugins/table/table.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Tables=t}();