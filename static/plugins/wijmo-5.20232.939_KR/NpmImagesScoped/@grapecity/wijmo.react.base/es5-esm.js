/*!
    *
    * Wijmo Library 5.20232.939
    * https://developer.mescius.com/wijmo
    *
    * Copyright(c) MESCIUS inc. All rights reserved.
    *
    * Licensed under the End-User License Agreement For MESCIUS Wijmo Software.
    * us.sales@mescius.com
    * https://developer.mescius.com/wijmo/licensing
    *
    */

var __extends=this&&this.__extends||function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){extendStatics(t,e);function __(){this.constructor=t}t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),__awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function fulfilled(t){try{step(o.next(t))}catch(t){r(t)}}function rejected(t){try{step(o.throw(t))}catch(t){r(t)}}function step(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(fulfilled,rejected)}step((o=o.apply(t,e||[])).next())}))},__generator=this&&this.__generator||function(t,e){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function verb(r){return function(a){return function step(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;(o=0,i)&&(r=[2&r[0],i.value]);switch(r[0]){case 0:case 1:i=r;break;case 4:s.label++;return{value:r[1],done:!1};case 5:s.label++;o=r[1];r=[0];continue;case 7:r=s.ops.pop();s.trys.pop();continue;default:if(!(i=s.trys,i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1];i=r;break}if(i&&s.label<i[2]){s.label=i[2];s.ops.push(r);break}i[2]&&s.ops.pop();s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t];o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};import{Control,Event,isArray,addClass,removeClass,setCss,isFunction,isPrimitive,isObject,DateTime,isUndefined,isSafari}from"@grapecity/wijmo";import*as ReactDOM from"react-dom";import*as React from"react";var flushSyncPolyfill=function(t){t()},createRootPolyfill=function(){throw"Wijmo: React dependencies not loaded properly"},ReactDomPolyfill={flushSync:flushSyncPolyfill,createRoot:createRootPolyfill},reactDomClient=ReactDOM||ReactDomPolyfill,flushSync=reactDomClient.flushSync;function lazyImportDomClient(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){try{t=require("react-dom/client");reactDomClient=t||ReactDOM||ReactDomPolyfill;flushSync=t.flushSync||flushSync}catch(t){reactDomClient=ReactDOM||ReactDomPolyfill}return[2]}))}))}var ComponentBase=function(t){__extends(ComponentBase,t);function ComponentBase(e,n,o){var i=t.call(this,e)||this;i._objPropHash={};i._isMounted=!1;i._mountedCBs=[];i._hostRef=function(t){return i._hostRefValue=t};i._beforeRender=new Event;i._afterRender=new Event;i._beforeWillUnmount=new Event;i._afterWillUnmount=new Event;i._beforeDidUpdate=new Event;i._afterDidUpdate=new Event;if(i._isMounted&&!i._isChild()){clearTimeout(i.timer);return i}if(!ComponentBase._reactMajorVersion){var r=parseInt(React.version);ComponentBase._reactMajorVersion=r;r>=18&&lazyImportDomClient()}i.props=e;i.controlType=n;for(var s=0,a=o&&o.objectProps||[];s<a.length;s++){var p=a[s];i._objPropHash[p]=!0}return i}ComponentBase.prototype.render=function(){this._onBeforeRender();var t=this._renderImpl();this._onAfterRender();this.renderResult=t;if(this._isMounted&&!this._isChild()){clearTimeout(this.timer);return this.renderResult}return t};ComponentBase.prototype.componentDidMount=function(){var t=this;if(this._isMounted){clearTimeout(this.timer);return this.control}if(this._isChild()){var e=this.props[ComponentBase._propsParent];e&&e._mountedCB((function(){t._setParent(e)}))}else this._prepareControl();this._isMounted=!0;return this.control};ComponentBase.selectiveDomRender=function(t,e,n){void 0===n&&(n=!0);if(ComponentBase._reactMajorVersion<18)ReactDOM.render(t,e);else{var o,i=ComponentBase.elemRootMap.findIndex((function(t){return t.host===e}));if(-1===i){o=reactDomClient.createRoot(e);ComponentBase.elemRootMap.push({host:e,root:o})}else o=ComponentBase.elemRootMap[i].root;flushSync((function(){o.render(t)}))}return e};ComponentBase.selectiveDomUnmount=function(t){if(ComponentBase._reactMajorVersion<18)ReactDOM.unmountComponentAtNode(t);else{var e=ComponentBase.elemRootMap.findIndex((function(e){return e.host===t}));if(-1!==e){var n=ComponentBase.elemRootMap[e].root;flushSync((function(){n.unmount();ComponentBase.elemRootMap.splice(e,1)}))}}};ComponentBase.prototype.componentWillUnmount=function(){this._onBeforeWillUnmount();this._siblingInsertedMO&&this._siblingInsertedMO.disconnect();var t=this.control;if(t)if(this._isChild()){var e=this._getParentProp();if(e){var n=this.parent.control[e];if(isArray(n)){var o=n.indexOf(t);if(o>-1){var i=n[o];"Sheet"===i.constructor.name&&i._isEmptyGrid||n.splice(o,1)}}}}else t instanceof Control&&(this.timer=setTimeout((function(){if(t.hostElement){t._orgOuter=null;t.dispose()}}),5));this._onAfterWillUnmount()};ComponentBase.prototype.shouldComponentUpdate=function(t){return!0};ComponentBase.prototype.componentDidUpdate=function(t){this._onBeforeDidUpdate();var e=this.control;this._copy(e,this.props,t);this._onAfterDidUpdate()};ComponentBase.prototype._mountedCB=function(t){var e=this;this._isMounted&&!this._isChild()?t():this._isMounted||this._mountedCBs.push(t);setTimeout((function(){e._mountedCBs.includes(t)||e._mountedCBs.push(t)}),isSafari?200:10)};ComponentBase.prototype._renderImpl=function(){var t={};t[ComponentBase._propsParent]=this;var e=React.Children.map(this.props.children,(function(e){return e&&React.cloneElement(e,t)})),n={ref:this._hostRef};this._isChild()&&(n.style={display:"none"});return React.createElement("div",n,e)};ComponentBase.prototype._onBeforeRender=function(t){this._beforeRender.raise(this,t)};ComponentBase.prototype._onAfterRender=function(t){this._afterRender.raise(this,t)};ComponentBase.prototype._onBeforeWillUnmount=function(t){this._beforeWillUnmount.raise(this,t)};ComponentBase.prototype._onAfterWillUnmount=function(t){this._afterWillUnmount.raise(this,t)};ComponentBase.prototype._onBeforeDidUpdate=function(t){this._beforeDidUpdate.raise(this,t)};ComponentBase.prototype._onAfterDidUpdate=function(t){this._afterDidUpdate.raise(this,t)};ComponentBase.prototype._createControl=function(){var t=this._isChild()?this._isParentInCtor()?this.parent.control:void 0:this._getElement();t instanceof Element&&this.props.id&&t.setAttribute("id",this.props.id);var e=new this.controlType(t);e.workingAs="React";return e};ComponentBase.prototype._prepareControl=function(){var t=this;this._renderImpl();var e=this._getElement(),n=this.props;e&&!this._isChild()&&ComponentBase._copyAttrs(e,n,Control._rxInputAtts);var o=this.control=this._createControl(),i=o instanceof Control,r=ComponentBase;e=this._getElement();if(!this._siblingId){null==this.constructor[r._typeSiblingIdProp]&&(this.constructor[r._typeSiblingIdProp]=++r._siblingDirId+"");this._siblingId=this.constructor[r._typeSiblingIdProp]}if(e){e.setAttribute(r._typeSiblingIdProp,this._siblingId);var s={};for(var a in n){var p=n[a];this._ignoreProp(a)||isUndefined(p)||(a in o?s[a]=p:this._setHostAttribute(e,a,p))}i?o.initialize(s):this._copy(o,s,null,!0);setTimeout((function(){var e=t._mountedCBs;for(var i in e){e[i]();delete e[i]}isFunction(n.initialized)&&n.initialized(o);t._isMounted=!0}),isSafari?201:100)}};ComponentBase.prototype._initParent=function(){if(this._getElement()){var t=this._getParentProp();if(t){var e=this.parent.control,n=e[t];if(isArray(n)){var o=this._getSiblingIndex();(o<0||o>=n.length)&&(o=n.length);n.splice(o,0,this.control);var i=this._getElement();this._siblingInsertedMO=new MutationObserver(this._siblingInserted.bind(this));this._siblingInsertedMO.observe(i,{childList:!0})}else e[t]=this.control}}};ComponentBase.prototype._setParent=function(t){if(t!==this.parent){if(this.parent)throw"Wijmo child component is already attached to a different parent.";this.parent=t;this._prepareControl();this._initParent()}};ComponentBase.prototype._isChild=function(){return null!=this._parentProp||null!=this._parentInCtor};ComponentBase.prototype._isParentInCtor=function(){return!0===this._parentInCtor};ComponentBase.prototype._getParentProp=function(){return this.props.wjProperty||this._parentProp};ComponentBase.prototype._getSiblingIndex=function(){var t=this._getElement(),e=t.parentElement;if(!e)return-1;for(var n=e.childNodes,o=-1,i=this._siblingId,r=0;r<n.length;r++){var s=n[r];if(1==s.nodeType&&s.getAttribute(ComponentBase._typeSiblingIdProp)==i){++o;if(s===t)return o}}return-1};ComponentBase.prototype._siblingInserted=function(t){for(var e=this,n=0,o=t;n<o.length;n++){var i=o[n];if("childList"===i.type&&i.addedNodes.length>0){if(Array.from(i.addedNodes).some((function(t){return t===e._getElement()}))){var r=this._getSiblingIndex(),s=this.control,a=this.parent.control[this._getParentProp()],p=a.indexOf(s);if(r>=0&&p>=0&&r!==p){a.splice(p,1);var l=Math.min(r,a.length);a.splice(l,0,s)}}}}};ComponentBase.prototype._copy=function(t,e,n,o){void 0===o&&(o=!1);if(t&&e){var i,r=t===this.control;for(var s in e)if(!this._ignoreProp(s)||!r){var a=e[s];if(s in t){if(this._isEvent(t,s))o&&isFunction(a)&&t[s].addHandler(a);else if(!n||!this._sameValue(n[s],a))if(null==a)t[s]=a;else if(isPrimitive(a)||isFunction(a)||this._objPropHash[s]&&t===(i||(i=this.control)))t[s]=a;else if(isArray(a)&&isArray(t[s])){var p=t[s],l=a;if(l.length==p.length)for(var c=0;c<l.length;c++){if(l[c]!==p[c])return!1;this._copy(p[c],l[c])}}else isObject(a)&&this._copy(t[s],e[s])}else this._setHostAttribute(t.hostElement,s,e[s])}}};ComponentBase.prototype._setHostAttribute=function(t,e,n){if(t)switch(e){case"className":var o=this._appliedClassName;if(o!==n){removeClass(t,o);addClass(t,n);this._appliedClassName=n}break;case"style":setCss(t,n);break;default:null!=t[e]?t[e]=n:"string"==typeof n&&"$"!==e[0]&&t.setAttribute(e,n)}};ComponentBase.prototype._sameValue=function(t,e){return t==e||DateTime.equals(t,e)};ComponentBase.prototype._isEvent=function(t,e){var n=t&&t[e];return null!=n&&n instanceof Event};ComponentBase.prototype._getElement=function(){return this._hostRefValue};ComponentBase.prototype._ignoreProp=function(t){return"children"===t};ComponentBase._copyAttrs=function(t,e,n){if(t)for(var o in e)o.match(n)&&t.setAttribute(o,e[o])};ComponentBase.isInStrictMode=function(t){return!!(t.hasOwnProperty("_reactInternalFiber")&&1&t._reactInternalFiber.mode)};ComponentBase._propsParent="$parent";ComponentBase._typeSiblingIdProp="_wjSiblingIdProp";ComponentBase._siblingDirId=0;ComponentBase.elemRootMap=[];return ComponentBase}(React.Component);export{ComponentBase};