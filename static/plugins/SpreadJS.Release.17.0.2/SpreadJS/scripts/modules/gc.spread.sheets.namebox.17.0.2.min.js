/*!
 * 
 * SpreadJS Library 17.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var e,i,n;function o(n){var t,t,t=i[n];return void 0!==t||(t=i[n]={exports:{}},e[n].call(t.exports,t,t.exports,o)),t.exports}e={"./dist/plugins/namebox/namebox-actions.js":function(n,t,e){var i,t,l,v,h,e,o,m,d,t,b,x,r,u,a,c,s,f,g;function C(n,t){return f.call(this,n,t)||this}function p(n,t){return g.call(this,n,t)||this}i=this&&this.__extends||(s=function(n,t){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}s(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t=e("Common"),l=e("Core"),v=e("SheetsCalc"),h=e("./dist/plugins/namebox/namebox.js"),e=e("./dist/plugins/namebox/namebox.ns.js"),o=l.Commands.ActionBase,m=t.Common.zf,d=t.Common.lt.ht,t=new t.Common.ResourceManager(e.SR,"NameBox"),b=t.getResource.bind(t),x=void 0,r="addCustomName",u="navigateToRange",i(C,f=o),C.prototype.execute=function(){var n,t,e,i,n,o,n,r,u,a,c,s,f,l,n=this,t=!1;if(n.canExecute()){i=(e=n.Mf).getParent(),o=(n=n.tT).nameBox,n=n.selectorValue;try{if(r=e.getSelections(),d(r)||0===r.length)return;if(n.toLowerCase()===h.PRINT_AREA&&e.printInfo)return u=r[0],(a=e.printInfo()).rowStart(u.row),a.rowEnd(u.row+u.rowCount-1),a.columnStart(u.col),a.columnEnd(u.col+u.colCount-1),!0;for(c=e.name(),m.fJ(c,"'")&&m.dT(c,"'")||(c="'"+c+"'"),s=[],f=void 0,l=0;l<r.length;l++)s.push(c+"!"+(0,v.rangeToFormula)(r[l],e.getActiveRowIndex(),e.getActiveColumnIndex(),x,!!i.options.referenceStyle));f=s.join(","),i.addCustomName(n,f,e.getActiveRowIndex(),e.getActiveColumnIndex(),""),t=!0}catch(n){e.jT(15,b().invalidName),o.updateNameRangeSelectorValue()}}return t},a=C,l.Commands[r]={canUndo:!1,execute:function(n,t){l.Commands.zA(n,a,t)}},i(p,g=o),p.prototype.execute=function(){var n,t,e,i,n,o,r,u,n,a,c,s,f,i,n=this,t=!1;if(n.canExecute()){if(i=(e=n.Mf).getParent(),o=(n=n.tT).nameBox,r=n.selectorValue,u=n.selections,n=n.sheetName,a=i.getSheetFromName(n),(c=i.getActiveSheet())!==a&&(i.I2(i.getSheetIndex(n),1,!1,!0),c.b2(!1,!0),a.b2(!0,!0)),a.clearSelection(),s=u[0],d(s))return;for(a.setSelection(s.row,s.col,s.rowCount,s.colCount),f=1;f<u.length;f++)s=u[f],a.addSelection(s.row,s.col,s.rowCount,s.colCount);o.selector.val(r),o.cpt=o.selector.val(),i={sheet:e,sheetName:e.name(),row:s.row,col:s.col},e.ki(l.Events.EnterCellInternal,i),t=!0}return t},c=p,l.Commands[u]={canUndo:!1,execute:function(n,t){l.Commands.zA(n,c,t)}},l.Commands.fpt=function(n){n.register(r,l.Commands[r]),n.register(u,l.Commands[u])}},"./dist/plugins/namebox/namebox-list.js":function(n,t,e){var i,e,o,r,u;function a(n,t){var n=u.call(this,n)||this;return t&&n.setNameList(t),n}i=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),t.NameBoxList=void 0,e=e("CellTypes"),u=e.List,i(a,u),a.prototype.setNameList=function(n){var t=this;t.setOptions({items:t.lpt(n),textEllipsis:!0})},a.prototype.lpt=function(n){return n.map(function(n){return{text:n,value:n}})},a.CustomNameChange="CustomNameChange",t.NameBoxList=a},"./dist/plugins/namebox/namebox.entry.js":function(n,t,e){var i,o,r,u,a,i=this&&this.__createBinding||(Object.create?function(n,t,e,i){void 0===i&&(i=e);var o=Object.getOwnPropertyDescriptor(t,e);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,i,o)}:function(n,t,e,i){n[i=void 0===i?e:i]=t[e]}),o=this&&this.__exportStar||function(n,t){for(var e in n)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||i(t,n,e)};Object.defineProperty(t,"__esModule",{value:!0}),t.findControl=t.NameBox=void 0,e("./dist/plugins/namebox/namebox-actions.js"),r=e("Core"),u=e("./dist/plugins/namebox/namebox.js"),Object.defineProperty(t,"NameBox",{enumerable:!0,get:function(){return u.NameBox}}),o(e("./dist/plugins/namebox/namebox.ns.js"),t),t.findControl=a=function(n){return"string"==typeof n&&(n=document.getElementById(n)),(0,r.GC$)(n).data("name-box")}},"./dist/plugins/namebox/namebox.js":function(F,v,n){var h,c,m,r,u,o,n,a,t,d,s,e,f,l,b,i,x,g,C,p,j,w,_,y,O,n,N,E,G,H;function T(n,t,e){var i,o;this.addCustomNameCommand="addCustomName",this.navigateToRangeCommand="navigateToRange",this.cpt="",this.hpt=!1,n&&t&&(n instanceof HTMLElement?i=n:"string"==typeof n&&(i=document.getElementById(n)),i)&&((o=this).hpt=!0,o.Ti=i,a(i).data(b,o),o.options=O(G,function(n,t,e){o.Ob(n,t,e)}),o.Zp(e),o.dpt(),o.hpt=!1,o.bind(t))}function R(n,t){var e,i,o,r,t,r,e="",i=t.rowCount,o=t.colCount,r=t.row+1,t=t.col+1;return 1===i&&1===o?e=A(n,r,t):i<0&&0<o?e=o+"C":o<0&&0<i?e=i+"R":i<0&&o<0?(r=k(n))&&(e=r.getRowCount()+"R x "+r.getColumnCount()+"C"):e=i+"R x "+o+"C",e}function M(n,t){var e,i,o,e=!1,i=t.getSpans();if(i)for(o=0;o<i.length;o++)if(i[o].row===n.row&&i[o].col===n.col&&i[o].rowCount===n.rowCount&&i[o].colCount===n.colCount){e=!0;break}return e}function A(n,t,e,i){var o,r,u,a,c,s,f,l,v;if(t<1||e<1)return null;if(o="",u=(r=k(n))&&r.name(),i&&r){if(a=M(i,r),(c=n.getCustomNames())!==d)for(s=0;s<c.length;s++)if((f=c[s].getExpression())&&f.type===h.ExpressionType.reference&&f.source&&f.source.getName&&u===f.source.getName()&&null!==(l=f.getRange(0,0))&&l!==d&&(l.row===i.row&&l.col===i.col&&l.row+l.rowCount===i.row+i.rowCount&&l.col+l.columnCount===i.col+i.colCount||l.row===i.row&&l.col===i.col&&a)){o=c[s].getName();break}if(""===o&&c!==d)for(s=0;s<c.length;s++)(f=c[s].getExpression())&&f.type===h.ExpressionType.reference&&((l=f.getRange(0,0)).row===i.row&&l.column===i.col&&l.row+l.rowCount===i.row+i.rowCount&&l.column+l.columnCount===i.col+i.colCount||l.row===i.row&&l.column===i.col&&a)&&(o=c[s].getName())}if(""===o)switch(n.options.referenceStyle){case 0:for(;0<e;)0==(v=e%26)?(o="Z"+o,e--):o=String.fromCharCode("A".charCodeAt(0)+v-1)+o,e=parseInt((e/26).toString(),10);o+=t.toString();break;case 1:o="R"+t.toString()+"C"+e.toString()}return o}function B(n,t,e){var i,o,o;if(void 0===e&&(e=!1),!(i=t.getActiveSheet())){if((o=t.getActiveSheetTab())&&o._gi===c.SheetType.reportSheet)return!1;i=o.getSheet&&o.getSheet()||o.Mf}return!!i&&!(!(o=n.getExpression())||e&&!I(o,t,i))&&(-1<E.indexOf(o.type)||o.type===h.ExpressionType.operator&&16===o.operatorType)}function D(n){var t=n.row,e=n.col,i=n.rowCount,n=n.colCount;return-1!==t&&-1!==i||(i=t=-1),-1!==e&&-1!==n||(n=e=-1),new c.Range(t,e,i,n)}function S(n){if(n)return n.row+i+n.col+i+n.rowCount+i+n.colCount}function L(t,e){var i,n;try{i=(n=o.Common.CultureManager.getCultureInfo()).localeCompare?n.localeCompare(t,e):t.localeCompare(e,"en")}catch(n){i=t.localeCompare(e)}return i}function I(n,t,e){var i,o,r,u,a;try{if(i=!!t.options.referenceStyle,!(o=(0,m.formulaToRanges)(e,(0,m.expressionToFormula)(t,n,e.getActiveRowIndex(),e.getActiveColumnIndex(),i),d,d,d,i))||o.length<1)return;for(r=0,u=o;r<u.length;r++)if(a=u[r],!(t.getSheetFromName(a.sheetName)||t.getSheetTab(a.sheetName)&&t.getSheetTab(a.sheetName)._gi!==c.SheetType.reportSheet))return}catch(n){return}return 1}function U(n){return new RegExp(/[^A-Za-z0-9_.!?'",:\u0080-\uFFFF\\$]+/g).test(n)}function k(n){var t,n,t=n.getActiveSheet();return t=t||(n=n.getActiveSheetTab())&&(n.getSheet&&n.getSheet()||n.Mf)}Object.defineProperty(v,"__esModule",{value:!0}),v.getActiveSheet=v.NameBox=v.PRINT_AREA=void 0,h=n("CalcEngine"),c=n("Core"),m=n("SheetsCalc"),r=n("CellTypes"),u=n("./dist/plugins/namebox/namebox-list.js"),o=n("Common"),n=n("./dist/plugins/namebox/namebox.ns.js"),a=c.GC$,t=null,d=void 0,s="A1",e=".gc-name-box",f="div",l="input",b="name-box",i="_",x="invalid",g="gc-name-box-",C="container",p="selector",j="dropdown",w=o.Common.lt.ht,_=o.Common.zf,y=c.util.En,O=c.util.b0,n=new o.Common.ResourceManager(n.SR,"NameBox"),N=n.getResource.bind(n),v.PRINT_AREA="print_area",E=[h.ExpressionType.reference,h.ExpressionType.name,h.ExpressionType.structReference],G={enableAddCustomName:!0,enableNavigateToRange:!0,showCustomNameList:!0,dropDownMaxHeight:500},Object.defineProperty(T.prototype,"selector",{get:function(){return a("."+g+p,this.Ti)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"dropdown",{get:function(){return a("."+g+j,this.Ti)},enumerable:!1,configurable:!0}),T.prototype.getHost=function(){return this.Ti},T.prototype.getCustomNameList=function(n){var t,e,e,i,o,r,e,u,a,c,s,f,l,v,h,m,d;if(void 0===n&&(n=!1),!(e=(t=this).vpt))return[];if(!(e=k(e)))return[];for(i=[],o=t.mpt(e,n),r=t.gpt(n),e=o,u=function(n){return n.getName().toLowerCase()},a=function(n){var t=r[n];o.find(function(n){return u(n)===u(t)})&&r.splice(n,1)},c=r.length-1;-1<c;c--)a(c);for(s=0,f=e=e.concat(r);s<f.length;s++)l=f[s],i.push(l.getName());for(h=0,m=v=t.ppt();h<m.length;h++)d=m[h],i.push(d.name);return i},T.prototype.bind=function(n){var t=this;t.unbind(),n&&(t.vpt=n,t._id=n.bpt()),t.rebuild()},T.prototype.unbind=function(){var n=this;n.ypt(),n.wY=t,n.wpt(),n.vpt=t,n._id=t},T.prototype.refresh=function(){this.updateNameRangeSelectorValue()},T.prototype.rebuild=function(){var n=this;n.hpt||(n.wpt(),n.dpt(),n.v7(),n.Mpt(),n.refresh())},T.prototype.executeCommand=function(n,t,e){var i,o,r,i=this,o=i.vpt,r=k(o);r&&o.commandManager().execute({cmd:n,sheetName:e||r.name(),nameBox:i,selectorValue:i.selector.val(),selections:t||r.getSelections()})},T.prototype.dispose=function(){var n=this;n.unbind(),n.wY&&n.wY.dispose(),n.wY=t,n.Cpt&&n.Cpt.close(),n.Cpt=t,a(n.Ti).data(b,t),n.Ti.innerHTML="",n.Ti=t},T.prototype.Ob=function(n,t,e){var i=this;if(t!==e&&(i.options[n]=t,!i.hpt))switch(n){case"dropDownMaxHeight":case"showCustomNameList":i.rebuild();break;case"enableAddCustomName":case"enableNavigateToRange":case"addCustomNameCommand":case"navigateToRangeCommand":i.refresh()}},T.prototype.Zp=function(n){var e,n,e=this.options,n=n||{};n=a.extend(!0,{},G,n),a.each(n,function(n,t){e.hasOwnProperty(n)&&(e[n]=t)})},T.prototype.Mpt=function(){var n=this;n.wY&&n.wY.setNameList(n.Spt())},T.prototype.Spt=function(){var e=this.getCustomNameList(!0),e;return e=e.filter(function(n,t){return e.indexOf(n)===t}).sort(L)},T.prototype.ypt=function(){var n=this;n.Cpt&&(n.Cpt.close(),n.Cpt=t,n.wY=t)},T.prototype.Tpt=function(){var n,t,e,e,e,i,o,n=this;n.ypt(),(e=k(t=n.vpt))&&!e.isReportTemplateSheet&&(e=y(f),e=new u.NameBoxList(e,n.Spt()),i=new r.PopupControl(e.getContainer(),n.Ti,{align:c.DropDownAlignment.Near,hostElement:n.vpt.getHost(),direction:c.DropDownDirection.Down,Oue:n.vpt&&n.vpt.options.enableAccessibility}),o=+n.options.dropDownMaxHeight||G.dropDownMaxHeight,a(e.getContainer()).css(["width","maxHeight"],[a(n.Ti).width(),o+"px"]).addClass("gc-name-box-list"),i.open(),n.wY=e,n.Cpt=i)},T.prototype.dpt=function(){var n,t,e,i,o,n=this,t=n.Ti;t.innerHTML="",(e=y(f)).classList.add(g+C),i=y(l),n.vpt&&n.vpt.options.enableAccessibility&&(i.setAttribute("aria-label",N().nameBox),i.setAttribute("role","combobox"),i.setAttribute("aria-expanded","false"),i.setAttribute("aria-autocomplete","list")),i.classList.add(g+p),n.options.showCustomNameList&&(o=y(f)).classList.add(g+j),e.appendChild(i),o&&e.appendChild(o),t.appendChild(e)},T.prototype.jf=function(n){var t;if(n=n||this.vpt)return(t=k(n))||void 0},T.prototype.Apt=function(){return e+(this._id||"")},T.prototype.v7=function(){var i,e,n,t,i=this,e=i.vpt,n=i.Ti,t=i.Apt();e.bind(c.Events.SelectionChanging+t,n,function(){var n,n,n,n,n=i.jf();n&&n.getSelections&&null!==(n=(n=n.getSelections())[n.length-1])&&n!==d&&(n=R(e,n),i.selector.val(n||""),i.cpt=n||"")}),e.bind(c.Events.InternalSelectionChanging+t,n,function(n,t){var t,t,t=t.newSelections;null!==t&&t!==d&&(t=R(e,t),i.selector.val(t||""),i.cpt=t||"")}),e.bind(c.Events.SelectionChanged+t,function(n,t){var e=i.Ipt();i.updateNameRangeSelectorValue(e,t.shiftKey)}),e.bind(c.Events.DragDropBlockCompleted+t,function(){i.updateNameRangeSelectorValue()}),e.bind(c.Events.ActiveSheetChanged+t,function(){i.updateNameRangeSelectorValue()}),e.bind(c.Events.ActiveSheetChangedInternal+t,function(){i.updateNameRangeSelectorValue()}),e.bind(c.Events.EnterCellInternal+t,function(){i.updateNameRangeSelectorValue()}),e.bind(c.Events.ClipboardPasted+t,function(){i.updateNameRangeSelectorValue()}),e.bind(c.Events.ShapeSelectionChanged+t,function(){i.I2t||i.updateNameRangeSelectorValue()}),e.bind(c.Events.FloatingObjectSelectionChanged+t,function(){i.I2t||i.updateNameRangeSelectorValue()}),i.selector.bind("blur"+t,i.xpt.bind(i)),i.selector.bind("keydown"+t,i.Npt.bind(i)),i.selector.bind("focus"+t,function(){i.selector[0].select()}),i.dropdown.bind("mousedown"+t,i.kpt.bind(i))},T.prototype.wpt=function(){var n,t,e,n=this,t=n.vpt,e=n.Apt();t&&t.unbind(e),n.selector.unbind(e),n.dropdown.unbind(e),a(document).unbind(e)},T.prototype.updateNameRangeSelectorValue=function(n,t){var e,i,n,i,n,i,o,r,u,e=this;!w(n)&&e.selector?(e.selector.val(n||""),e.cpt=e.selector.val()):0<(i=(n=e.Dpt()).length)?(i=1===i?n[0].name():"",e.selector&&(e.selector.val(i),e.cpt=e.selector.val())):(n=e.Ipt(),w(n)?(o=k(i=e.vpt))?null!==(r=o.getSelections()[o.getSelections().length-1])&&r!==d&&(u=void 0,u=t?R(i,r):A(i,o.getActiveRowIndex()+1,o.getActiveColumnIndex()+1,r),e.selector)&&(e.selector.val(u||""),e.cpt=e.selector.val()):e.selector.val(s):(e.selector.val(n),e.cpt=e.selector.val()))},T.prototype.Ipt=function(){var n,t,e,i,o,r,o,u,n=this,t,e=k(n.vpt),i="";if(e)return o=e.getSelections(),r=e.name(),1===o.length?(i=S(D(o=o[0])),u="",M(o,e)&&(u=S(new c.Range(o.row,o.col,1,1))),n._pt(i)||n.Ept(i,u,r)):void 0},T.prototype.Ept=function(n,t,e){var i,o,r,u,a,c,s,f,l,f,l;if(n||t)for(u=0,a=r=(i=this).mpt().concat(i.gpt());u<a.length;u++)if(f=(s=(c=a[u]).getName()).toLowerCase()===v.PRINT_AREA,l=(o=c.WK)&&o.source,(f&&!l||l&&l instanceof m.SheetSource&&l.getName()===e)&&(f=o.getRange(c.FY||0,c.jpt||0))&&(n===(l=S(f))||t===l))return s},T.prototype._pt=function(n){var t,e,i,o;if(n)for(e=0,i=t=this.ppt();e<i.length;e++)if(n===S((o=i[e]).range))return o.name},T.prototype.mpt=function(n,t){var e,i;return void 0===t&&(t=!1),e=this.vpt,i=[],(i=(n=n||e&&k(e))?n.getCustomNames():i).filter(function(n){return B(n,e,t)})},T.prototype.gpt=function(t){var e,n;return void 0===t&&(t=!1),n=[],(n=(e=this.vpt)&&e.getCustomNames()).filter(function(n){return B(n,e,t)})},T.prototype.ppt=function(){for(var n,t,e,i,o,r,u,a,c,s,n,t,e=[],i=[],o=0,r=this.vpt.sheets;o<r.length;o++)(u=r[o]).tables&&(i=i.concat(u.tables.all()));for(a=0,c=i;a<c.length;a++)s=c[a],e.push({name:s.name(),range:s.dataRange()});return e},T.prototype.Dpt=function(){var t,n,e,t=[],n,e;return this.Opt().forEach(function(n){n.isSelected()&&t.push(n)}),t},T.prototype.Opt=function(n){var t,n,t,e,i,n,t=this.vpt,n=n||k(t);return n?(t=n.shapes&&n.shapes.all()||[],e=n.floatingObjects&&n.floatingObjects.all()||[],i=[],n.charts&&n.charts.tIe&&(i=n.charts.all()),n=n.pictures&&n.pictures.all()||[],t.concat(i).concat(n).concat(e)):[]},T.prototype.Kfe=function(n){var t,e,i,o,r,u,a;if(n){for(e=(t=this).Opt(),i=n.split(",").map(function(n){return n.trim()}),r=function(n){var t,n,t=i[n],n=e.find(function(n){return n.name()===t});if(!n)return{value:void 0};(o=o||[]).includes(n)||o.push(n)},u=0;u<i.length;u++)if("object"==typeof(a=r(u)))return a.value;return o}},T.prototype.xpt=function(){var n,t,e,i,o,i,n=this,t=n.selector.val(),i=n.Kfe(t);if(i)n.Bpt(),i.forEach(function(n){return n.isSelected(!0)});else if(!t||0<n.Dpt().length)n.Jfe||n.I2t||n.Bpt(),n.updateNameRangeSelectorValue(t);else if(n.cpt.toLocaleUpperCase()!==t.toLocaleUpperCase()){i=k(o=n.vpt);try{e=n.Lpt()}catch(n){if(n.message===x&&i)return void i.jT(15,N().invalidName)}e&&e.sheetName?n.options.enableNavigateToRange&&0<e.ranges.length&&(n.Bpt(e.sheetName),n.executeCommand(n.navigateToRangeCommand,e.ranges,e.sheetName)):n.options.enableAddCustomName&&!i.isReportTemplateSheet&&n.executeCommand(n.addCustomNameCommand)}},T.prototype.Npt=function(n){var t,e,i,t=this,e=t.selector.val();"Enter"===n.key&&(t.Jfe=!1,(i=t.Kfe(e))?(t.Bpt(),t.I2t=!0,i.forEach(function(n){return n.isSelected(!0)}),t.updateNameRangeSelectorValue(),t.I2t=!1,t.Jfe=!0):0<t.Dpt().length&&e&&(t.Dpt()[0].name(e),t.Jfe=!0),n.currentTarget.blur(),t.Jfe=!1,t.vpt)&&t.vpt.focus(!0),n&&n.stopPropagation&&n.stopPropagation()},T.prototype.kpt=function(){var e=this;e.Tpt(),e.wY&&e.wY.on("ValueChangedEvent",function(n){var n,t,n=n.value;w(n)&&!n||(t=e.selector.val(),e.updateNameRangeSelectorValue(n),e.cpt=t,e.xpt()),e.ypt()})},T.prototype.Bpt=function(n){var t,e,n,i,o,r,u,t=this,e=t.vpt,n=e.getSheetFromName(n)||k(e);if(n)for(o=0,r=i=t.Opt(n);o<r.length;o++)(u=r[o]).isSelected()&&u.isSelected(!1)},T.prototype.Lpt=function(){var n,t,e,i,o,r,u,a,c,s,s,f,s,n=this,t=n.selector.val(),i=n.vpt,o=k(i);if(U(t=t.replace(/, /g,",")))throw new Error(x);if(r=t.split(","),u={ranges:[],sheetName:""},o)for(a=0,c=r;a<c.length;a++)if(s=c[a],e=(0,m.formulaToRanges)(o,s,o.getActiveRowIndex(),o.getActiveColumnIndex()),w(e)||0===e.length){if(1<r.length)throw new Error(x);o.isReportTemplateSheet&&(f=(s=i.getCustomName(s))&&s.WK)&&(u.ranges.push(f.getRange(s.getRow()||0,s.getColumn()||0)),u.sheetName=f.source.getName())}else if(1===e.length){if(s=e[0],u.sheetName&&s.sheetName!==u.sheetName)throw new Error(x);if(!i.getSheetFromName(s.sheetName))throw new Error(x);u.ranges=u.ranges.concat(s.ranges),u.sheetName=s.sheetName}return u},v.NameBox=T,c.Workbook.ch("nameBox",{init:function(){c.Commands.fpt(this.commandManager()),this.curNameBoxId=0},onCultureChanged:function(){N()}}),a.extend(c.Workbook.prototype,{bpt:function(){var n=this.curNameBoxId+(new Date).getTime().toString();return this.curNameBoxId+=1,n}}),v.getActiveSheet=k},"./dist/plugins/namebox/namebox.ns.js":function(n,t,e){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var e=e("./dist/plugins/namebox/namebox.res.en.js");t.SR={en:e}},"./dist/plugins/namebox/namebox.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.nameBox=t.invalidName=void 0,t.invalidName="You must enter a valid reference you want to go to, or type a valid name for the selection.",t.nameBox="Name Box"},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine},CellTypes:function(n){n.exports=GC.Spread.Sheets.CellTypes}},i={},n=o("./dist/plugins/namebox/namebox.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).NameBox=n}();