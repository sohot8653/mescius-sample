/*!
 * 
 * SpreadJS Library 17.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var o,i,n;function e(n){var t,t,t=i[n];return void 0!==t||(t=i[n]={exports:{}},o[n].call(t.exports,t,t.exports,e)),t.exports}o={"./dist/plugins/comment/comment-actions.js":function(R,n,t){var o,i,c,a,e,u,r,t,s,f,h,l,v,m,d,p,w,g,b,_,C,y,k,x,S,M,N,j,F;function z(n,t,o){var i,e,r,i=!1,e=n.Ut.pI.pZ();return e?(r=e.location(),n.Qy().execute({cmd:v,sheetName:n.name(),row:e.bZ,col:e.yZ,oldValue:r.clone(),newValue:new c.Point(r.x+t,r.y+o),propertyName:"location"})):i}function T(n){var t=n.comment;t&&(r(n.row)||r(n.col))&&(n.row=t.bZ,n.col=t.yZ)}function D(n,t){var o=N.call(this)||this;return T(t),o.Mf=n,o.tT=t,o}function V(n,t){var o=j.call(this)||this;return T(t),o.Mf=n,o.tT=t,o}function I(n,t){var o,i,e;if((t?n.canUndo():n.canExecute())&&(o=n.wZ)){for(i=0;i<o.length;i++)(e=o[i])&&(t?e.undo():e.execute());return!0}return!1}function O(n,t){var o,i,e,r,o=F.call(this)||this,i=o;if(i.wZ=[],i.Mf=n,e=(i.tT=t).commands)for(r=0;r<e.length;r++)i.add(e[r]);return o}o=this&&this.__extends||(M=function(n,t){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=n}M(n,t),n.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CommentPropertyUndoAction=n.CommentDeleteUndoAction=void 0,i=t("Common"),c=t("Core"),a=t("Core"),e=c.GC$,u=c.Events,r=i.Common.lt.ht,t=a.Commands.ActionBase,s="deleteComment",f="deleteCommentByKey",h="deleteCommentByBackspaceKey",l="deactivateComment",v="moveComment",m="moveCommentUp",d="moveCommentDown",p="moveCommentLeft",w="moveCommentRight",g="changeComment",b="changeCommentTransaction",_=null,C=a.Commands.zA,o(D,N=t),D.prototype.execute=function(){var n,t,o,i,e,r,r,n=this;return!!n.canExecute()&&(t=n.Mf,n.X5(t,!0),o=t.comments.get(n.tT.row,n.tT.col),e=(i=t.Ut).pI,r={sheet:t,sheetName:t.name(),comment:o,cancel:!1},t.ki(u.CommentRemoving,r),r.cancel||(i.startTransaction(),e.remove(o.bZ,o.yZ),e.MZ=_,t.cR(),t.ki(u.CommentRemoved,{sheet:t,sheetName:t.name(),comment:o}),r=a.Commands.TI(t.name()),n.tT[r]=i.endTransaction()),n.q5(t,!0),!0)},D.prototype.undo=function(){var n,t,o,n=this,t=n.Mf;return n.X5(t,!0),o=a.Commands.TI(t.name()),t.Ut.undo(n.tT[o]),t.e4(),n.q5(t,!0),!0},n.CommentDeleteUndoAction=y=D,o(V,j=t),V.prototype.execute=function(){var n,t,o,i,e,n=this,t=n.tT,o=n.Mf,i=o.comments.get(t.row,t.col);return!(!n.canExecute()||!i||(n.X5(o,!0),i[e=t.propertyName](t.newValue),"location"===e&&(t.displayMode?i.displayMode(t.displayMode):t.displayMode=i.displayMode()),n.q5(o,!0),0))},V.prototype.undo=function(){var n,t,o,i,n=this,t=n.tT,o=n.Mf;return n.X5(o,!0),!!(i=o.comments.get(t.row,t.col))&&(i[t.propertyName](t.oldValue),n.q5(o,!0),!0)},V.prototype.toJSON=function(){return this.tT},n.CommentPropertyUndoAction=k=V,a.Commands.ChangeComment=k,o(O,F=t),O.prototype.execute=function(){return I(this,!1)},O.prototype.undo=function(){return I(this,!0)},O.prototype.add=function(n){this.wZ.push(n)},x=O,a.Commands[f]={canUndo:!1,execute:function(n,t){var n,t,n=a.Commands.Tp(n,t),t=n.Ut.pI.pZ();return!!t&&n.Qy().execute({cmd:s,sheetName:n.name(),row:t.bZ,col:t.yZ})}},a.Commands[l]={canUndo:!1,execute:function(n,t){var n,t,n=a.Commands.Tp(n,t),t=n.Ut.pI;return!!t.pZ()&&(t.CZ(),n.cR(),n.repaint(),!0)}},a.Commands[m]={canUndo:!1,execute:function(n,t){var o;return z(a.Commands.Tp(n,t),0,-1)}},a.Commands[d]={canUndo:!1,execute:function(n,t){var o;return z(a.Commands.Tp(n,t),0,1)}},a.Commands[p]={canUndo:!1,execute:function(n,t){var o;return z(a.Commands.Tp(n,t),-1,0)}},a.Commands[w]={canUndo:!1,execute:function(n,t){var o;return z(a.Commands.Tp(n,t),1,0)}},a.Commands[s]={canUndo:!0,execute:function(n,t,o){return C(n,y,t,o)}},a.Commands[v]={canUndo:!0,execute:function(n,t,o){return C(n,k,t,o)}},a.Commands[g]={canUndo:!0,execute:function(n,t,o){return C(n,k,t,o)}},a.Commands[b]={canUndo:!0,execute:function(n,t,o){return C(n,x,t,o)}},a.Commands.SZ=S=function(n){n.register(f,a.Commands[f],46,!1,!1,!1,!1),n.register(h,a.Commands[f],8,!1,!1,!1,!1),n.register(l,a.Commands[l],27,!1,!1,!1,!1),n.register(m,a.Commands[m],38,!1,!1,!1,!1),n.register(d,a.Commands[d],40,!1,!1,!1,!1),n.register(p,a.Commands[p],37,!1,!1,!1,!1),n.register(w,a.Commands[w],39,!1,!1,!1,!1),n.register(s,a.Commands[s]),n.register(g,a.Commands[g]),n.register(b,a.Commands[b]),n.register(v,a.Commands[v])}},"./dist/plugins/comment/comment-touch.js":function(n,t,o){var i,t,e,c,r,a,u,o,s,f,h,l,v,m,d;function p(n,t){return v.call(this,n,t)||this}function w(n,t,o){return m.call(this,n,t,o,new h(n,t))||this}function g(n,t,o){return d.call(this,n,t,o,new u(n,t))||this}function b(n,t,o,i){var e,r,t,e=this,r=e.TZ=t.TZ;e.AZ=new c.IZ(e),e.xZ=new c.NZ(n,"Comment"+r.bZ+r.yZ,e.AZ,2,200),e.kZ=o,e.DZ=i,(t=e.xZ)._Z=function(){return 3!==r.commentState()},t.EZ=function(){return!0},t.jZ=function(n){return i.OZ(n)},t.RZ=function(n){return i.BZ(n)},t.LZ=function(n){return i.FZ(n)},t.PZ=function(n){return i.GZ(n)},t.UZ=function(n){return i.HZ(n)}}function _(n,t){var o=this;o.zZ=n,o.VZ=t,o.TZ=t.TZ,o.Mf=o.TZ.Mf,o.YZ=new c.ZZ(o.Mf)}i=this&&this.__extends||(l=function(n,t){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=n}l(n,t),n.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),Object.defineProperty(t,"__esModule",{value:!0}),t=o("Core"),e=o("./dist/plugins/comment/comment.js"),c=o("Touch"),t.Of.touch&&(r=t.GC$,a=t.mt.vi,_.prototype.WZ=function(n){var n,t,o,n=new c.QZ(n.X,n.Y),t=r(this.zZ).offset();return t&&(o=document.body,n.X+=t.left+o.clientLeft||0,n.Y+=t.top+o.clientTop||0),n},_.prototype.OZ=function(n){n.KZ=35},_.prototype.BZ=function(n){var t,o,t=this,o=t.WZ(n.JZ);t.VZ.XZ({target:n.qZ,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),t.YZ.$Z()},_.prototype.FZ=function(n){var t,o,i,e,e,i,t=this,o=n.nW.tW,i=t.Mf,e=i.parent;1!==o&&e&&e.options.allowUserZoom?(i.rt.s9=!1,e=t.VZ,r(e.eW).remove(),t.YZ.iW(o)):(i=t.WZ(n.JZ),t.VZ.pg({target:n.qZ,isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}}))},_.prototype.GZ=function(n){var t,o,i,e,e,t=this,o=n.nW.tW,i,e=t.Mf.parent;1!==o&&e&&e.options.allowUserZoom?t.YZ.rW(o):(e=t.WZ(n.JZ),t.VZ.bg({target:n.qZ,isTouch:!0,button:0,pageX:e.X,pageY:e.Y,stopPropagation:function(){}}))},_.prototype.HZ=function(n){var t=this,o=t.TZ,t=t.Mf;try{t.suspendPaint(),3===o.commentState()?o.commentState(1):1===o.commentState()&&o.commentState(2)}finally{t.resumePaint()}},u=_,b.prototype.oW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!0)},b.prototype.uW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!1)},b.prototype.sW=function(n){return this.AZ.sW()},b.prototype.cW=function(n){return this.AZ.cW()},b.prototype.fW=function(n){return this.AZ.fW()},i(g,d=o=b),s=g,i(w,m=o),f=w,i(p,v=u),p.prototype.BZ=function(n){var t,o,t=this,o=t.WZ(n.JZ);t.VZ.lW({target:n.qZ,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),t.YZ.$Z()},h=p,e.hW.ch("touch",{init:function(n){var t,o,i,t=this,o,i=t.TZ.Mf.parent.kZ;t.dW=new s(n[0],t,i),t.dW.oW(),t.vW=new f(n[1],t,i),t.vW.oW()},detachEditor:function(n){var t=this,o=t.TZ.Mf;t.vW=new f(n,t,o.parent.kZ),t.vW.oW()},preProcessMouseDownEdit:function(n){var t,o,t=n.e,o=this.vW;o&&!t.isTouch&&o.sW(t)&&(a(t),n.r=!0)},preProcessMouseDownDragResize:function(n){var t,o,t=n.e,o=this.dW;o&&!t.isTouch&&o.sW(t)&&(a(t),n.r=!0)},preProcessMouseMove:function(n){var t,o,i,e,t=n.e,o=t.isTouch,i=this.dW,e=this.vW;i&&!o&&i.fW(t)&&(a(t),n.r=!0),e&&!o&&e.fW(t)&&(a(t),n.r=!0)},preProcessMouseUp:function(n){var t,o,i,e,t=n.e,o=t.isTouch,i=this.dW,e=this.vW;i&&!o&&i.cW(t)&&(a(t),n.r=!0),e&&!o&&e.cW(t)&&(a(t),n.r=!0)},dispose:function(){var n=this;n.dW.uW(),n.dW=null,n.vW.uW(),n.vW=null}}))},"./dist/plugins/comment/comment.entry.js":function(n,t,o){var i,e,i=this&&this.__createBinding||(Object.create?function(n,t,o,i){void 0===i&&(i=o);var e=Object.getOwnPropertyDescriptor(t,o);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(n,i,e)}:function(n,t,o,i){n[i=void 0===i?o:i]=t[o]}),e=this&&this.__exportStar||function(n,t){for(var o in n)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||i(t,n,o)};Object.defineProperty(t,"__esModule",{value:!0}),e(o("./dist/plugins/comment/comment.js"),t),e(o("./dist/plugins/comment/comment-actions.js"),t),o("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(i,n,P){var U,u,S,L,l,v,A,M,N,E,x,G,P,e,W,B,J,p,H,s,X,j,Y,K,q,$,Q,Z,nn,h,tn,on,k,en,rn,cn,an,un,sn,fn,hn,ln,vn,mn,dn,pn,wn,gn,bn,_n,Cn,yn,kn,w,g,xn,Sn,m,d,r,c,a,Mn,Nn,jn,Fn,zn,Tn,Dn,f,b,Vn,In,On,_,C,y,F,Rn,Pn,Un,Ln,An,En,Gn,Wn,Bn,Jn,Hn,Xn,Yn,Kn,qn,$n,Qn,Zn,z,nt,tt,ot,it,et,rt,ct,at,ut,st,ft,ht,lt,vt,T,mt,dt,pt,wt,gt,bt,_t,Ct,yt,kt,xt,t,St,Mt,t,t,t;function D(n,t){return new S.Point(n,t)}function V(n,t,o,i){return new S.Rect(n,t,o,i)}function I(n){return n.height}function O(n){return n.width}function Nt(n,t){var o=n.options;return!n.isActualProtected()||o.protectionOptions.allowEditObjects||t&&!t.locked()}function jt(n,t){var o=n.options;return!n.isActualProtected()||o.protectionOptions.allowEditObjects||t&&!t.lockText()}function Ft(n){var t=96,o=72,i=37.7952755905512;try{return-1!==n.indexOf("pt")?parseFloat(n.replace("pt","")):-1!==n.indexOf("in")?72*parseFloat(n.replace("in","")):-1!==n.indexOf("cm")?parseFloat(n.replace("cm",""))*i*72/96:parseFloat(n)}catch(n){return 0}}function zt(n){var t,o,i,e,r,c,a,u,s,f,h,t=n.itemsData,o=n.collapseIndexMap={},i=t.length,s=!1;if(0===n.direction){for(e=i-1;0<=e;e--)if((r=t[e])&&1===r.count&&r.info&&r.info.collapsed){for(c=r.index+r.count,a=e+1;a<i;a++)(u=t[a])&&u.info&&u.info.level>r.info.level&&u.index===c&&(c=u.index+u.count);for(f=r.index+1;f<c;f++)o[f]=!0}}else for(e=0;e<i;e++)if((r=t[e])&&1===r.count&&r.info&&r.info.collapsed){if((c=r.index-1)<0&&-1===r.info.level)break;for(h=e-1;0<=h;h--)(u=t[h])&&u.info&&u.info.level>r.info.level&&u.index+u.count-1===c&&(c=u.index-1);for(f=c+1;f<r.index;f++)o[f]=!0}}function Tt(n,t){var o;return t&&(t.items?t.items[n]&&t.items[n].viewCollapsed:t.itemsData&&(t.collapseIndexMap||zt(t),t.collapseIndexMap[n]))}function Dt(n,t,o,i){var n=n[t];return!n||i&&Tt(t,i)?void 0:!1===n.visible||n.size}function Vt(n,t,o,i){var n=n[t];return!n||i&&Tt(t,i)?void 0:!1===n.visible||n.size}function It(n,o,i){function t(n){var n,t,n,n=k(n,"ClientData");return(!n||"Note"===n.ObjectType)&&(t=parseInt(k(n,"Row").c_[0],10),n=parseInt(k(n,"Column").c_[0],10),t===o)&&n===i}return n.filter(t)[0]}function Ot(n,t){for(var o,i,e,r,c,a,o=n.defaults.rowHeight,i=0,e=0,c=n.getRowCount()||S.XmlConstants.Io;i<t&&e<c;)i+=r=n.Ut.getSize(!0,3,e)||o,e++;return 0<(a=i-t)?(e--,(a=r-a)<0&&(e+=1)):(a=t-i,e+=1),{row:e,rowOffset:a}}function Rt(n,t){for(var o,i,e,r,c,a,o=n.defaults.colWidth,i=0,e=0,c=n.getColumnCount()||S.XmlConstants.xo;i<t&&e<c;)i+=r=n.Ut.getSize(!1,3,e)||o,e++;return 0<(a=i-t)?(e--,(a=r-a)<0&&(e+=1)):(a=t-i,e+=1),{col:e,colOffset:a}}function Pt(n,t){if(!on(t))return"double";if(n)switch(n.toLowerCase()){case"solid":return"solid";case"1 1":return"dotted";case"dash":case"dashdot":case"longdash":case"longdashdot":case"longdashdotdot":return"dashed"}return"solid"}function Ut(n){var t,o;if(n)switch(n.toLowerCase()){case"solid":t="solid";break;case"dotted":t="1 1";break;case"dashed":t="dash";break;case"double":o="thinThin"}return{dashStyle:t,lineStyle:o}}function Lt(n,t){var o,i,e,r,r,e,n,i,o=t.location()||{x:9,y:-18},i=t.bZ,e=t.yZ,r=n.getSpan(i,e);return r&&(e=r.col+r.colCount-1),r=Z(n,0,e+1),e=tn(n,0,i),n=["position:absolute"],0<=(i=h(r+o.x+7))&&n.push("margin-left:"+i+"pt"),0<=(i=h(e+o.y+7))&&n.push("margin-top:"+i+"pt"),(i=h(t.width()-14)+"pt")&&n.push("width:"+i),(i=h(t.height()-14)+"pt")&&n.push("height:"+i),n.push("z-index:"+t.zIndex()),n.push("visibility:"+(1===t.displayMode()?"visible":"hidden")),n.join(";")}function At(n){var t=S.ColorHelper.convertColorToHex(n);return t&&"string"==typeof t&&2<t.length?"#"+t.substring(2).toLowerCase():n}function Et(n,t){var n=(n||"").trim().split(t);return{key:n[0],value:n[1]}}function Gt(n,t,o,i,e){var r,c,a,u,s,f,h,n,r,c=this.Ut.pI;if(n&&c)for(u=c.all(),s=0;s<u.length;s++)f=(a=u[s]).bZ,h=a.yZ,f===t&&h===o||t<=f&&f<t+i&&o<=h&&h<o+e&&c.remove(f,h);(a=c.get(t,o))&&(n=c.mW(a))&&n.gW()}function Wt(){var n=this,t=n.pW&&n.pW();t&&t.bW(n)}function Bt(n,t,o){var i=this,i=i.pW&&i.pW();i&&i.yW(n,t,o)}function Jt(n,t){var o,i,t,o=-1,i=-1;t&&0<=t.rowViewportIndex&&0<=t.colViewportIndex&&(o=t.row,i=t.col),!n.parent||o<0||i<0||(t=n.Ut.pI.get(o,i),n.Ut.pI.wW(t))}function Ht(n,t){return n&&n.getRowHeight(t)}function Xt(n,t){return n&&n.getColumnWidth(t)}function Yt(n,t){return n&&n.getViewportLeftColumn(t)}function Kt(n,t){return n&&n.getViewportTopRow(t)}function qt(n,t,o,i){var e=this;arguments.length<=1?e.top=e.right=e.bottom=e.left=n||0:(e.top=n,e.right=t,e.bottom=o,e.left=i)}function $t(n){var t=this;t.bZ=-1,t.yZ=-1,t.text(n||""),t.zIndex(Ln)}function Qt(n,t,o){return gt.push(n),u.mt.p0(n,t,Zt(n),o)}function Zt(n){var e=n;return function(n,t){var o=this,i=o.Mf;i&&(i.Ut.MW({type:"property",comment:o,name:e,value:t,newValue:n}),i.hP()&&i.My<=0&&(i.CW(),"indicatorColor"!==e&&"indicatorSize"!==e||i.repaint(i.getCellRect(o.bZ,o.yZ))),i.ki(s.CommentChanged,{sheet:i,sheetName:i.name(),comment:o,propertyName:e}))}}function no(n,t,o,i,e){var t=V(t,o,i,i);t.cursor=e,n.push(t)}function to(n,t,o,i){(0,S.GC$)(n.SW).css(t,o),(0,S.GC$)(n.TW).css(t,i)}function oo(n,t){for(var o,i,e,o=n.length,i=0,e=0;e<o;e++)i+=K(n[e],t);return i}function io(n,t){n&&n.P_(t)}function eo(n){var n=n;if(n){if("number"==typeof n)return 400<n;if("string"==typeof n)return-1!==n.toLowerCase().indexOf("bold")||400<parseInt(n,10)}}function ro(n){var n=n;return n&&-1!==["italic","oblique"].indexOf(n.toLowerCase().trim())}function R(n,t){var o,i,i,o=this,i=n&&n.Mf;o.AW=1,o.IW=1,o.TZ=n,o.xW(),o._zoomFactor=i.zoom(),o.NW=t,o.li=t.kW,o.Hc(),i=o.DW(o._W(),n.width(),n.height()),o.EW=D(i.x,i.y),o.jW(),o.OW()}function o(n){var t=this;t.Mf=n,t.RW={BW:!1,x:0,y:0,LW:l,FW:-1},t.kW=l,t.PW=l,t.MZ=l,t.wB=[],t.GW=0,t.UW=[],t.HW(),t.zW(),t.cE={}}function co(n){var t=this;t.Mf=l,t.VW=!0,t.YW=t.ZW(),n.appendChild(t.YW)}function ao(n,t){if(n){var n=n.trim().toLowerCase();if(-1!==["false"].indexOf(n))return!1;if(-1!==["true"].indexOf(n))return!0}return t}Object.defineProperty(n,"__esModule",{value:!0}),n.hW=n.Comment=n.Padding=n.DisplayMode=n.CommentState=void 0,U=P("Common"),u=P("Core"),S=P("Core"),L=u.Commands,l=null,v=void 0,A=Math.max,M=Math.min,N=Math.floor,E=Math.atan2,x=Math.abs,G="default",P=u.GC$.extend,e=u.mt.En,W=U.Common.Uf,B="comment",J=u.hi,p=u.Bf,H=u.mt,s=u.Events,X=H.vi,j=H.w0,Y=H.M0,K=H.bi,q=parseFloat,$=U.Common.zf,Q=u.Lf,Z=S.ExcelHelper.getActualColumnWidth,nn=S.ExcelHelper.pointToPixel,h=S.ExcelHelper.pixelToPoint,tn=S.ExcelHelper.getActualRowHeight,on=U.Common.lt.ht,k=S.mt.xr,en=S.mt.go,rn=S.mt.c1,cn=S.mt.n1,an=S.mt.vo,un=S.mt.d1,sn=S.mt.h1,fn=S.IndexHelper.nr,hn=S.Util.wr,ln=S.Util.ho,vn=7,mn=document,dn=window,pn=S.UsedRangeUtil.vh,wn=S.XFileConstants.Rr,gn=S.XFileConstants.Lr,bn=S.XFileConstants.ou,Cn="mouse",yn="move",kn="DOMMouseScroll",w="left",g="top",xn="right",Sn="bottom",m="width",d="height",r="position",c="absolute",a="overflow",Mn="visible",Nn="z-index",jn="hidden",Fn="box-sizing",zn="content-box",Tn="padding",Dn="px",f="div",b=".comment",Vn=".floatBlockCanvas",In=".hostContainer",On=".lineCanvasContainer",_=".host",C=".editor",y="gc-spread-",F="className",Rn="cursor",Pn="text",Un=701,Ln=898,An="gc-no-user-select",En=" ",Gn="unselectable",Wn="on",Bn="comment_editor",Jn="comment_indicator",Hn="font-family",Xn="font-style",Yn="font-size",Kn="font-weight",qn="color",$n="textArea",Qn=".lineCanvas",Zn=".commentDocument",z="-resize",nt="line-height",tt="background-color",ot="text-align",it="mousedown",et="mousemove",rt="mouseup",ct="mousewheel",at="text-decoration",ut="black",(t=st=st||{})[t.none=0]="none",t[t.single=1]="single",t[t.double=2]="double",t[t.singleaccounting=3]="singleaccounting",t[t.doubleaccounting=4]="doubleaccounting",u.GC$.extend(S.Worksheet.prototype,{CW:function(n){var t,o,i,e,r,c,a,t=this,o=t.pW&&t.pW();if(t.hP()&&!t.D_)for(i=t.Fi(),e=void 0,r=0;r<=2;r++)for(c=0;c<=2;c++)!(e=i.c9(r,c))||0===O(e)||0===I(e)||n&&!e.intersectRect(n)||(a=t.Ut.pI,o&&a&&o.WW(a))}}),(ft=u.CellRange).prototype.comment=function(n){var t=this,o=t.sheet,i=t.row,e=t.col;return 0===arguments.length?o.Ut.pI.get(i,e):(n instanceof pt&&o.Ut.pI.WB(i,e,n),t)},ht=function(n,t){var o,t;!n.Ut.pI.Oy()&&(o=n.uw(),t=n.hitTest(t.pageX-o.left,t.pageY-o.top))&&Jt(n,t)},lt=function(n,o){o.bind(s.FloatingElementSelected+b,function(n,t){var t;"comments"!==t.type&&((t=o.Ut.pI).CZ(),t.wW(l))}),n.bind(it+b,function(n){o.Ut.pI.CZ(),ht(o,n)}).bind(ct+b,function(n){ht(o,n)}).bind(et+b,function(n){ht(o,n)})},vt=function(n,t){t.unbind(b),n.unbind(b)},s.CommentChanged="CommentChanged",(t=T=n.CommentState||(n.CommentState={}))[t.active=1]="active",t[t.edit=2]="edit",t[t.normal=3]="normal",(t=mt=n.DisplayMode||(n.DisplayMode={}))[t.alwaysShown=1]="alwaysShown",t[t.hoverShown=2]="hoverShown",qt.prototype.clone=function(){var n=this;return new qt(n.top,n.right,n.bottom,n.left)},qt.prototype.toString=function(){var t=this,o="",n;return[g,xn,Sn,w].forEach(function(n){o+=t[n]+Dn+En}),o.trim()},dt=qt,n.Padding=dt,$t.prototype.clone=function(){var o,i,o=this,i=new $t;return gt.forEach(function(n){var t=o[n]();o[n].isDefault&&o[n].isDefault(t)||i[n](t&&t.clone?t.clone():t)}),i.Mf=o.Mf,i.bZ=o.bZ,i.yZ=o.yZ,i},$t.prototype.toJSON=function(){var o,i,o=this,i={rowIndex:o.bZ,colIndex:o.yZ};return gt.forEach(function(n){var t=o[n]();o[n].isDefault&&o[n].isDefault(t)||(i[n]=t&&t.clone?t.clone():t)}),i},$t.prototype.wh=function(n){var t,o,i,e,r,r,r,c,a,u,a,r,n,o,e,i,c,a,u,s,f,t=this,o=t.Mf,i={n_:"fill",color2:"#ffffe1"},e={n_:"stroke"},r=Ut(t.borderStyle());return r.dashStyle?e.dashStyle=r.dashStyle:r.lineStyle&&(e.lineStyle=r.lineStyle),r=t.opacity(),on(r)||1===r||(i.opacity=Math.floor(65535*r)+"f"),r=["Left","Center","Right"][t.horizontalAlign()||0]||"Left",!(c={n_:"ClientData",ObjectType:"Note",c_:[{n_:"Row",c_:[t.bZ]},{n_:"Column",c_:[t.yZ]},{n_:"AutoFill",c_:["False"]}]})===t.dynamicMove()&&c.c_.push({n_:"MoveWithCells"}),!1===t.dynamicSize()&&c.c_.push({n_:"SizeWithCells"}),!1===t.locked()&&c.c_.push({n_:"Locked",c_:["False"]}),!1===t.lockText()&&c.c_.push({n_:"LockText",c_:["False"]}),"Left"!==r&&c.c_.push({n_:"TextHAlign",c_:[r]}),1===t.displayMode()&&c.c_.push({n_:"Visible"}),(a=t.padding())&&(u=[h(a.left)+"pt",h(a.top)+"pt",h(a.right)+"pt",h(a.bottom)+"pt"].join(",")),a={n_:"textbox",style:"mso-direction-alt:auto"+(t.autoSize()?";mso-fit-shape-to-text:t":""),c_:[{n_:"div",style:"text-align:"+r}]},r={n_:"shape",id:"_x0000_s"+n,type:"#_x0000_t202",style:Lt(o,t),fillcolor:At(t.backColor()),strokecolor:At(t.borderColor()),strokeweight:h(t.borderWidth()||1)+"pt",c_:[e,i,{n_:"shadow",color:"black",obscured:"t"},{n_:"path","o:connecttype":"none"},a,c]},u?a.inset=u:r["o:insetmode"]="auto",n=[],eo(t.fontWeight())&&n.push({n_:"b"}),ro(t.fontStyle())&&n.push({n_:"i"}),1&(o=t.textDecoration())?n.push({n_:"u"}):8&o?n.push({n_:"u",val:"double"}):2&o&&n.push({n_:"strike"}),(e=-1!==(e=t.fontSize()||"9pt").indexOf("px")?h(parseFloat(e)):e.replace("pt",""))&&n.push({n_:"sz",val:e}),(i=t.foreColor())?(i=sn(i),n.push(i)):n.push({n_:"color",indexed:"81"}),t.fontFamily()&&n.push({n_:"rFont",val:t.fontFamily()}),n.push({n_:"family",val:"2"}),c={n_:"t"},a=t.text(),(s=(u=on(a)?"":a).length!==u.trim().length)&&(c["xml:space"]="preserve"),c.c_=[an(u)],{vmlDrawingData:r,commentData:f={n_:"comment",ref:fn(t.yZ)+(t.bZ+1),authorId:"0",c_:[{n_:"text",c_:[{n_:"r",c_:[{n_:"rPr",c_:n},c]}]}]}}},$t.prototype.fromJSON=function(o,n){var i;o&&(i=this,gt.forEach(function(n){var t=o[n];t!==v&&("location"===n?i.location(new S.Point(t.x,t.y),!1):"padding"===n?i.padding(new dt(t.top,t.right,t.bottom,t.left),!1):i[n](t,!1))}),o.rowIndex!==v&&(i.bZ=o.rowIndex),o.colIndex!==v)&&(i.yZ=o.colIndex)},$t.prototype.yh=function(f,n,h,l,v){var m,d,p,t,n,w,g,b,_,C,y;n&&(d=Z(f,0,(m=this).yZ+1),p=tn(f,0,m.bZ),n=(t=k(n,"text")).c_)&&(w=1===n.length,g=[],n.forEach(function(n){var t,o,i,i,e,e,r,e,r,c,i,e,a,t,r,u,s,n,i,e,r,t,o,r,t=k(n,"rPr");t&&w&&((o=(i=k(t,"rFont"))?i.val:o)&&m.fontFamily(o),i=0,(e=k(t,"u"))&&(r=1,i|=2===(r=(e=e.val)?st[e]:r)?8:1),k(t,"strike")&&(i|=2),i&&m.textDecoration(i),k(t,"b")&&m.fontWeight("bold"),k(t,"i")&&m.fontStyle("italic"),(o=k(t,"color"))&&(e=un(o),m.foreColor(e)),o=k(t,"sz").val)&&m.fontSize(o+"pt"),(r=k(n,"t"))?r.c_&&g.push(r.c_[0]):"t"===n.n_&&n.c_&&g.push(n.c_[0]),(o=h.fillcolor)&&m.backColor(o.split(" ")[0]),(o=h.strokecolor)&&m.borderColor(o.split(" ")[0]),(o=h.strokeweight)&&m.borderWidth(nn(parseFloat(o.replace("pt","")))),(o=h.style)&&(c=o.split(";")).forEach(function(n){var n=Et(n,":"),t=n.key,o=n.value;if(!on(o))switch(t){case"margin-left":b=Ft(o);break;case"margin-top":_=Ft(o);break;case"width":C=o;break;case"height":y=o;break;case"z-index":m.zIndex(parseInt(o,10))}}),(o=k(h,"fill"))&&(i=o.opacity)&&("f"===i.substr(-1)?m.opacity(parseFloat(i.substr(0,i.length-1))/65535):m.opacity(parseFloat(i))),(o=k(h,"stroke"))&&m.borderStyle(Pt(o.dashStyle,o.lineStyle)),(o=k(h,"textbox"))&&((e=o.style)&&-1!==e.indexOf("mso-fit-shape-to-text:t")&&m.autoSize(!0),a=[0,0,0,0],o.inset&&o.inset.trim().split(",").forEach(function(n,t){var n=n||["0.1in","0.05in"][t%2];a[t]=nn(parseFloat(n.replace("pt","")))}),m.padding(new dt(a[1],a[2],a[3],a[0]))),t=k(h,"ClientData"),k(t,"SizeWithCells")&&m.dynamicSize(!1),k(t,"MoveWithCells")&&m.dynamicMove(!1),(o=k(t,"Locked"))&&m.locked(ao(o.c_[0],!0)),(o=k(t,"LockText"))&&m.lockText(ao(o.c_[0],!0)),(o=rn(k(t,"TextHAlign")))&&-1!==(r=["left","center","right"].indexOf(o.toLowerCase()))&&m.horizontalAlign(r),k(t,"Visible")&&m.displayMode(1),(o=rn(k(t,"Anchor")))?(n=o.split(",").map(function(n){return parseInt(n,10)}),i=Z(f,0,n[0])+n[1]-7,e=tn(f,0,n[2])+n[3]-7,r=Z(f,0,n[4])+n[5]+7,t=tn(f,0,n[6])+n[7]+7,m.location(new S.Point(i-d,e-p),!1),m.width(r-i),m.height(t-e),n&&(u=n[6]+1,s=n[4]+1)):(o=nn(b)-d-7,r=nn(_)-p-7,m.location(new S.Point(o,r)),m.width(nn(parseFloat(C.replace("pt","")))+14),m.height(nn(parseFloat(y.replace("pt","")))+14),u=Ot(f,m.location().y+p+m.height()).row+1,s=Rt(f,m.location().x+d+m.width()).col+1),S.Util.Co(l)&&S.Util.So(f,u,s,v)}),m.text(cn(g.join(""))))},pt=$t,n.Comment=pt,wt={},gt=[],(bt=[[Pn,""],["location",D(9,-18)],[m,160,function(n){return 0<n}],[d,100,function(n){return 0<n}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(n){return/^\d+pt$/.test(n)&&0<parseInt(n,10)}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(n){return"boolean"==typeof n&&this.dynamicMove()}],["dynamicMove",!0,function(n){return n||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(n){return 0<=n&&n<=1}],["borderWidth",1,function(n){return 1<=n}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1],["indicatorColor","red",function(n){return"string"==typeof n}],["indicatorSize",6,function(n){return"number"==typeof n&&1<n}]]).forEach(function(n){wt[n[0]]=Qt(n[0],n[1],n[2])}),_t=wt.zIndex,wt.zIndex=function(){var n,t,o,n=_t.apply(this,arguments);return 0===arguments.length&&n===Ln&&(t=this.Mf.comments.GW,o=this.lp,n=Ln-(t-1-o)),n},Ct=wt.commentState,wt.commentState=function(n,t){var o,i,o=Ct.apply(this,arguments);return t&&(i=this.Mf).Rj("comment",null,null,S.SheetArea.viewport,this,this),o},P(pt.prototype,wt),R.prototype.Hc=function(){var n=this,t=n.TZ.Mf;n.QW=y+"floatBlockCanvas",n.KW=y+"host-container",n.JW=y+"host",n.XW=y+"lineCanvas",n.qW=e(f),(0,S.GC$)(n.qW).addClass(y+"floatBlockCanvas-container").css([r,a,Fn],[c,jn,zn]),n.SW=e("canvas"),p.Wl(n.SW,null,t),(0,S.GC$)(n.SW).addClass(n.QW).css([w,g,r],[0,0,c]),n.TW=e(f),(0,S.GC$)(n.TW).addClass(n.KW).css([r,Fn,a],[c,zn,jn]),n.Ti=e(f),(0,S.GC$)(n.Ti).addClass(n.JW+En+An).css([w,g,m,d,r,"word-wrap","word-break","white-space",a,Fn,Gn,nt],[0,0,"100%","100%",c,"break-word","normal","pre-wrap",jn,zn,Wn,"normal"]),(0,S.GC$)(n.TW).append(n.Ti),(0,S.GC$)(n.qW).append(n.SW).append(n.TW),n.$W=e(f),(0,S.GC$)(n.$W).addClass(y+"lineCanvas-container").css([r,a,"pointer-events"],[c,jn,"none"]),n.tQ=e("canvas"),p.Wl(n.tQ,l,t),(0,S.GC$)(n.tQ).addClass(n.XW).css([w,xn,r],[0,0,c]),(0,S.GC$)(n.$W).append(n.tQ),n.nQ=[],n.eQ=7,n.iQ=!1,n.Eb=!1,R.et(n,"init",[n.SW,n.Ti])},R.prototype.rQ=function(){var n=this,t=n.TZ.Mf;!n.YW&&t&&t.pW&&(n.YW=t.pW().YW),n.YW&&(n.YW.appendChild(n.$W),n.oQ(),n.YW.appendChild(n.qW),n.aQ(n.SW,Vn),n.aQ(n.TW,In),n.uQ()?n.sQ():n.cQ(),n.EW=n._W(),n.fQ())},R.prototype.lQ=function(){var n=this;n.qW&&n.$W&&n.YW&&(n.hQ(n.SW,Vn),n.hQ(n.TW,In),n.dQ(),n.vQ(),n.mQ(),(0,S.GC$)(n.qW).remove(),(0,S.GC$)(n.$W).remove())},R.prototype.gQ=function(){return this.TZ.width()*this._zoomFactor},R.prototype.pQ=function(){return this.TZ.height()*this._zoomFactor},R.prototype._W=function(){var n=this,t=n.TZ;return t!==n.NW.PW||t.commentState()!==T.normal||t.ignoreDefaultLocation()?n.bQ(t.location()):(t.yQ=n.bQ(D(9,-18)),t.yQ)},R.prototype.bQ=function(n){var t,o,i,e,r,o,t,t=this,o=t.TZ,i=o&&o.Mf,e=t._zoomFactor,r=D(0,0);return i&&(o=t.wQ(i,o.bZ,o.yZ,t.AW,t.IW)).x!==l&&void 0!==o.x&&o.y!==l&&void 0!==o.y&&O(o)&&I(o)&&(t=i.Fi(),r.x=o.x+O(o)+n.x*e-t.XC,r.y=o.y+n.y*e-t.qC),r},R.prototype.wQ=function(n,t,o,i,e){var r,c,a,u,s,f,h,r,u,h,s,r=this,c=V(0,0,0,0),a=n.Fi(),u=Kt(n,i),s=Yt(n,e),r=r._zoomFactor,f=j(n,s,o,!1,v,v,!0);return s===n.Ab&&(f+=n.my),h=j(n,u,t,!0,v,v,!0),u===n.Tb&&(h+=n.ly),c.y=u<=t?h:-h,c.x=s<=o?f:-f,(u=n.getSpan(t,o))!==v&&u!==l?(c.height=0===i&&Y(n,t,t+u.rowCount,!0)||j(n,t,t+u.rowCount,!0),c.width=0===e&&Y(n,o,o+u.colCount,!1)||j(n,o,o+u.colCount,!1)):(c[d]=Ht(n,t)*r,c[m]=Xt(n,o)*r),c.x+=a.XC,c.y+=a.qC,h=a.F6,s=a.L6,1===i?c.y+=s:2===i&&(c.y+=s+n.Sy(a)),1===e?c.x+=h:2===e&&(c.x+=h+n.Gy(a)),c},R.prototype.MQ=function(n){var t,o,i,e,r,o,t,t=this,o=t.TZ,i=o&&o.Mf,e=t._zoomFactor,r=D(0,0);return i&&(o=t.wQ(i,o.bZ,o.yZ,t.AW,t.IW)).x!==l&&o.x!==v&&o.y!==l&&o.y!==v&&O(o)&&I(o)&&(t=i.Fi(),r.x=(n.x-(o.x+O(o)-t.XC))/e,r.y=(n.y-(o.y-t.qC))/e),r},R.prototype.CQ=function(){var n=this;n.EW=n._W(),n.jW(),n.OW(),n.fQ()},R.prototype.SQ=function(){var n,t,n=this,t=n.DW(n._W(),n.TZ.width(),n.TZ.height());n.EW=D(t.x,t.y),n.OW()},R.prototype.TQ=function(){var n,t,n,n=this,t=n.TZ;t.dynamicMove()?t.dynamicSize()?n.AQ():(n.IQ(),n.OW()):(n.jW(),n.OW(),n=n.MQ(n.EW===t.yQ?n._W():n.EW),t.location(n))},R.prototype.gW=function(){var n=this;n.EW=n._W(),n.fQ()},R.prototype.IQ=function(){var n,t,o,n=this,t=n.TZ,o=n.xQ();n.EW=o,t.location(n.MQ(o),!1),n.fQ()},R.prototype.xQ=function(){for(var n,t,o,t,i,e,r,c,a,i,u,s,a,i,n=this,t=n.TZ,o=t&&t.Mf,t=n._zoomFactor,i=Yt(o,n.IW),e=Kt(o,n.AW),r=0,c=0;c<n.IW;c++)r+=o.getViewportWidth(c);for(a=j(o,i,n.NQ,!1,v,v,!0),i<n.NQ?r+=a:r-=a,(i=Xt(o,n.NQ))<n.kQ&&(n.kQ=i),r+=n.kQ*t,s=u=0;s<n.IW;s++)u+=o.getViewportHeight(s);return a=j(o,e,n.DQ,!0,v,v,!0),e<n.DQ?u+=a:u-=a,(i=Ht(o,n.DQ))<n._Q&&(n._Q=i),D(r,u+=n._Q*t)},R.prototype.EQ=function(){var n,t,o,i,e,e,e,r,r,n=this,t=n.TZ,o=t&&t.Mf,i=j(o,n.NQ,n.jQ,!1,v,!0),e=Xt(o,n.NQ);e<n.kQ&&(n.kQ=e),(e=Xt(o,n.jQ))<n.OQ&&(n.OQ=e),i=i-n.kQ+n.OQ,e=j(o,n.DQ,n.RQ,!0,v,!0),(r=Ht(o,n.DQ))<n._Q&&(n._Q=r),(r=Ht(o,n.RQ))<n.BQ&&(n.BQ=r),e=e-n._Q+n.BQ,t.width(i),t.height(e)},R.prototype.AQ=function(){var n=this;n.EQ(),n.IQ()},R.prototype.jW=function(){var n,t,o,i,t,e,r,c,a,u,s,f,h,l,v,n=this,t=n.TZ,o=t&&t.Mf,i=n._zoomFactor;if(n.EW){for(t=Yt(o,n.IW),e=Kt(o,n.AW),0===n.IW?r=n.EW.x:1===n.IW?r=n.EW.x-o.getViewportWidth(0):2===n.IW&&(r=n.EW.x-(o.getViewportWidth(0)+o.getViewportWidth(1))),0===n.AW?c=n.EW.y:1===n.AW?c=n.EW.y-o.getViewportHeight(0):2===n.AW&&(c=n.EW.y-(o.getViewportHeight(0)+o.getViewportHeight(1))),a=D(r,c),s=u=0,f=t;f<o.getColumnCount();f++){if(!(u+(h=Xt(o,f)*i)<a.x)){n.NQ=f,n.kQ=(a.x-u)/i;break}u+=h}for(l=e;l<o.getRowCount();l++){if(!(s+(v=Ht(o,l)*i)<a.y)){n.DQ=l,n._Q=(a.y-s)/i;break}s+=v}}},R.prototype.OW=function(){var n,t,o,i,t,e,r,c,a,u,s,f,h,l,v,n=this,t=n.TZ,o=t&&t.Mf,i=n._zoomFactor;if(n.EW){for(t=Yt(o,n.IW),e=Kt(o,n.AW),0===n.IW?r=n.EW.x+n.gQ():1===n.IW?r=n.EW.x+n.gQ()-o.getViewportWidth(0):2===n.IW&&(r=n.EW.x+n.gQ()-(o.getViewportWidth(0)+o.getViewportWidth(1))),0===n.AW?c=n.EW.y+n.pQ():1===n.AW?c=n.EW.y+n.pQ()-o.getViewportHeight(0):2===n.AW&&(c=n.EW.y+n.pQ()-(o.getViewportHeight(0)+o.getViewportHeight(1))),a=D(r,c),s=u=0,f=t;f<o.getColumnCount();f++){if(!(u+(h=Xt(o,f)*i)<a.x)){n.jQ=f,n.OQ=(a.x-u)/i;break}u+=h}for(l=e;l<o.getRowCount();l++){if(!(s+(v=Ht(o,l)*i)<a.y)){n.RQ=l,n.BQ=(a.y-s)/i;break}s+=v}}},R.prototype.JO=function(n,t){var o=this,i=o.TZ;n<=o.DQ?i.dynamicMove()&&(o.DQ+=t,o.RQ+=t):n>o.DQ&&n<=o.RQ&&i.dynamicSize()&&(o.RQ+=t),o.AQ()},R.prototype.qO=function(n,t){var o=this,i=o.TZ;n<=o.NQ?i.dynamicMove()&&(o.NQ+=t,o.jQ+=t):n>o.NQ&&n<=o.jQ&&i.dynamicSize()&&(o.jQ+=t),o.AQ()},R.prototype.xP=function(n,t){var o,i,e,o=this,i=o.TZ,e=n+t-1;n<o.DQ?e<o.DQ?i.dynamicMove()&&(o.DQ-=t,o.RQ-=t):e<o.RQ&&i.dynamicMove()&&(i.dynamicSize()?o.RQ-=t:o.RQ-=o.DQ-n+1,o.DQ=n,o._Q=0):n<=o.RQ&&(e<o.RQ?i.dynamicSize()&&(o.RQ-=t):i.dynamicSize()&&(o.RQ=n,o.BQ=0)),o.AQ()},R.prototype.NP=function(n,t){var o,i,e,o=this,i=o.TZ,e=n+t-1;n<o.NQ?e<o.NQ?i.dynamicMove()&&(o.NQ-=t,o.jQ-=t):e<o.jQ&&i.dynamicMove()&&(i.dynamicSize()?o.jQ-=t:o.jQ-=o.NQ-n+1,o.NQ=n,o.kQ=0):n<=o.jQ&&(e<o.jQ?i.dynamicSize()&&(o.jQ-=t):i.dynamicSize()&&(o.jQ=n,o.OQ=0)),o.AQ()},R.prototype.fQ=function(){var n,t,o,o,n=this,t=n.TZ,o=t.Mf;n.LQ()&&(o=o.zoom(),n._zoomFactor!==o?(n._zoomFactor=o,n.EW=n.xQ()):(n._zoomFactor=o,n.EW!==t.yQ||1!==t.displayMode()&&2!==t.commentState()||(n.EW=n._W())),n.xW(),n.FQ(),n.PQ(),n.GQ(),n.UQ(),H.Tt.chrome)&&n.HQ()},R.prototype.FQ=function(){var n,t,t,n=this,t=n.TZ.Mf,t=t.parent&&t.parent.options.useTouchLayout;n.eQ=t?11:7},R.prototype.xW=function(){var n=this,t=n.TZ,o=t.Mf;n.AW=o.C0(t.bZ),n.IW=o.S0(t.yZ)},R.prototype.PQ=function(){var n,t,o,n=this,t,o=2===n.TZ.commentState()?n.li:n.Ti;n.zQ(),n.VQ(o),n.YQ(o),n.ZQ(o),n.WQ()},R.prototype.YQ=function(n){var t=this,o=t.TZ;n===t.Ti&&(n.innerHTML=$.j0(o.text()))},R.prototype.ZQ=function(n,t){var o,i,e,r,e,c,r,a,e,u,s,f,h,l,u,v,m,d,u,m,v,f,d,s,h,a,e,t,f,m,v,u,s,c,o=this,i=o.TZ,e=t||2===i.commentState()||1===i.displayMode()?o._W():o.EW,r=o._zoomFactor;e&&(e=o.Eb?o.DW(e,i.width(),i.height()):o.DW(e),o.QQ(e),c=O(e)*r,r=I(e)*r,u=(a=e.x)+c,s=(e=e.y)+r,f=o.eQ,h=o.KQ(o.AW,o.IW),l=2*(f+i.borderWidth()),a<h.x?(to(o,w,a-h.x,a+f-h.x),c+=a-h.x,a=h.x):(to(o,w,0,f),u>h.x+O(h)&&(c+=h.x+O(h)-1-u)),(c=M(O(h)-1,c))<0&&(u=i.Mf,v=i.yZ,m=u.r6(u.getColumnCount()-u.lL),d=u.getViewportRightColumn(1),!1===u.Vy)&&v===m&&v===d&&(a=h.x+O(h)-1-i.width(),c=i.width()),e<h.y?(to(o,g,e-h.y,e+f-h.y),r+=e-h.y,e=h.y):(to(o,g,0,f),s>h.y+I(h)&&(r+=h.y+I(h)-1-s)),r=M(I(h)-1,r),(u=(0,S.GC$)(o.qW)).css({left:a,top:e}),m=u.height(),v=u.width(),d=!1,(f=o.JQ(c,r))&&(c=f.adjustedWidth,r=f.adjustedHeight,d=!t&&f.needReposition),r<=0&&m<=0||c<=0&&v<=0||((1<x(r-m)||1<x(c-v))&&(u.css({width:c,height:r}),p.$l(o.SW,c,r)),h=(s=(0,S.GC$)(o.TW)).width(),a=s.height(),e=A(0,c-l),t=A(0,r-l),(1<x(a-t)||1<x(h-e))&&(0,S.GC$)(o.TW).css({width:e,height:t}),m=(f=(0,S.GC$)(n)).width(),v=f.height(),u=e,s=t,(c=i.padding())&&(u-=Math.ceil(q(c.left)+q(c.right)),s-=Math.ceil(q(c.top)+q(c.bottom))),(1<x(v-s)||1<x(m-u))&&(0,S.GC$)(n).css({width:A(0,u),height:A(0,s)}),d&&o.ZQ(n,!0)))},R.prototype.QQ=function(n){var t,o,i,i,e,r,c,t=this,o=t.TZ,i=t.EW;n.x===i.x&&n.y===i.y&&O(n)===o.width()&&I(n)===o.height()||(i=t.MQ(D(n.x,n.y)),e=O(n),r=I(n),c=o.location(),i.x===c.x&&i.y===c.y||o.location(i,!1),e!==o.width()&&o.width(e,!1),r!==o.height()&&o.height(r,!1),o.dynamicMove()&&(t.EW=D(n.x,n.y)))},R.prototype.WQ=function(){var n=this,t=n.TZ,o;Nt(t&&t.Mf)?(n.aQ(n.SW,Vn),n.aQ(n.TW,In),n.oQ(),n.cQ(),n.sQ()):(t.locked()?(n.hQ(n.SW,Vn),n.XQ(n.SW),n.hQ(n.TW,In),n.XQ(n.TW),n.SW.style.cursor=G,n.TW.style.cursor=G):(n.aQ(n.SW,Vn),n.aQ(n.TW,In)),t.lockText()?(n.dQ(),n.XQ(n.Ti),n.mQ(),n.XQ(n.li),!t.locked()&&t.commentState()===T.active||t.commentState(3),n.Ti.style.cursor=t.locked()?G:yn):(n.cQ(),n.sQ()),n.oQ())},R.prototype.zQ=function(){var n=this,t=n.TZ,o=n.NW,i=t&&t.Mf;switch(t.commentState()){case T.active:o.qQ(t),n.uQ()&&n.$Q(),0<i.getSelections().length&&i.e4(),J.F1(i);break;case T.edit:o.qQ(t),n.uQ()||n.tK(),0<i.getSelections().length&&i.e4(),J.F1(l);break;case T.normal:t===o.pZ()&&(o.CZ(),0===i.getSelections().length)&&i.cR()}},R.prototype.VQ=function(n){var t,o,i,e,i;function r(n,t,o){var o,i;return o?((i=(o=U.Common.ft)._(n)).a=t,o.j(i)):n}o=(t=this).TZ,(i=(0,S.GC$)(n)).css("font-family",o.fontFamily()).css("font-style",o.fontStyle()).css("font-size",parseInt(o.fontSize(),10)*t._zoomFactor+"pt").css("font-weight",o.fontWeight()),i.css("text-decoration",u.W.A5(o.textDecoration())),i.css("text-align",(e={0:"left",1:"center",2:"right",3:"general"})[o.horizontalAlign()]),o.padding()?i.css(Tn,o.padding().toString()):i.css(Tn,"0px"),i.css("background-color",r(o.backColor(),o.opacity(),n===t.Ti)).css("color",o.foreColor()),(0,S.GC$)(t.TW).css("border-width",o.borderWidth()).css("border-style",o.borderStyle()).css("border-color",o.borderColor()),i=t.NW.nK(o),(0,S.GC$)(t.$W).css(Nn,i),(0,S.GC$)(t.qW).css(Nn,i)},R.prototype.HQ=function(){var n,t,o,t,i,t,n,t=this.TZ.Mf,o=(0,S.GC$)(this.TW);t&&o&&(i=.5<=(t=t.uw()).left-N(t.left)?.5:0,t=.5<=t.top-N(t.top)?.5:0,o.css(w,q(o.css(w))+i),o.css(g,q(o.css(g))+t))},R.prototype.GQ=function(){var n,t,o,t,o,i,e,t,r,o,c,r,o,c,a,u,o,s,f,h,n=this,t=n.TZ,o=t.Mf,t=n.wQ(o,t.bZ,t.yZ,n.AW,n.IW),o=o.Fi(),i,e,t=D(t.x+O(t)-o.XC,t.y-o.qC),o=(0,S.GC$)(n.qW).position(),c=(0,S.GC$)(n.TW).position(),r=(0,S.GC$)(n.TW),r=o.left+c.left>t.x?D(o.left+c.left,o.top+c.top):o.top+c.top+r.height()<t.y?D(o.left+c.left+r.width(),o.top+c.top+r.height()):D(o.left+c.left+r.width(),o.top+c.top),o=n.eQ,c=x(t.x-r.x)+2*o,a=x(t.y-r.y)+2*o,u=M(t.x,r.x)-o,o=M(t.y,r.y)-o,s=u+c,f=o+a,h=n.KQ(n.AW,n.IW);u<h.x&&(c-=h.x-u,u=h.x),s>h.x+O(h)&&(c-=s-(h.x+O(h))),c=M(O(h),c),o<h.y&&(a-=h.y-o,o=h.y),f>h.y+I(h)&&(a-=f-(h.y+I(h))),a=M(I(h),a),(0,S.GC$)(n.$W).css(w,u).css(g,o).css(m,c).css(d,a),p.$l(n.tQ,c,a),t.x=t.x-u,t.y=t.y-o,r.x=r.x-u,r.y=r.y-o,n.eK(t,r)},R.prototype.eK=function(n,t){var o,i,e,o,o=this;o.iK||(o.iK=o.tQ.getContext("2d")),i=o.iK,e=o.TZ.borderColor(),i.strokeStyle=e,i.clearRect(0,0,p.Xl(o.tQ),p.ql(o.tQ)),i.beginPath(),i.moveTo(n.x,n.y),i.lineTo(t.x,t.y),i.stroke(),i.save(),Q.Yl(i,n.x,n.y),i.fillStyle=e,i.beginPath(),o=E(t.y-n.y,t.x-n.x),i.rotate(o),i.moveTo(0,0),i.lineTo(7,-4),i.lineTo(7,4),i.lineTo(0,0),i.fill(),Q.Yl(i,-n.x,-n.y),i.closePath(),i.restore()},R.prototype.UQ=function(){var n,t,o,i,e,r,c,a,u,s,n=this,t=n.TZ,o=t.Mf;n.rK=n.TZ.commentState(),n.oK||(n.oK=n.SW.getContext("2d")),i=n.oK,e=p.Xl(n.SW),r=p.ql(n.SW),c=(0,S.GC$)(n.TW).outerWidth(),a=(0,S.GC$)(n.TW).outerHeight(),u=n.eQ,i.clearRect(0,0,e,r),n.TZ.showShadow()&&(n.aK(i,e,r),i.clearRect(u,u,e-(s=2*(u+2)),r-s),n.uK(i,u,c,a)),Nt(o,t)&&n.sK(i,u,e,r,c,a),i.restore()},R.prototype.uK=function(n,t,o,i){n.save(),n.fillStyle=ut,n.fillRect(t+2,i+t,o,2),n.fillRect(o+t,t+2,2,i),n.restore()},R.prototype.aK=function(n,t,o){var i,e,r;switch(n.save(),n.strokeStyle=ut,this.rK){case T.active:for(n.beginPath(),e=0;e<o;e++)for(i=e%2==0?1:3;i<t;)n.moveTo(i,e),n.lineTo(i+1,e+1),i+=4;n.stroke(),n.closePath();break;case T.edit:for(n.beginPath(),e=i=0,r=4;i<t+o;)n.moveTo(i+4,0),n.lineTo(0,e+4),i+=4,e+=4;n.stroke(),n.closePath()}n.restore()},R.prototype.sK=function(r,n,t,o,i,e){var c=this,a=c.nQ;c.rK!==T.active&&c.rK!==T.edit||(a.splice(0,a.length),no(a,0,0,n,"nw"+z),no(a,t-n,0,n,"ne"+z),no(a,0,o-n,n,"sw"+z),no(a,t-n,o-n,n,"se"+z),3*n<=e?(no(a,0,N(o/2-n/2),n,"w"+z),no(a,t-n,N(o/2-n/2),n,"e"+z)):(a.push(l),a.push(l)),3*n<=i?(no(a,N(t/2-n/2),0,n,"n"+z),no(a,N(t/2-n/2),o-n,n,"s"+z)):(a.push(l),a.push(l)),r.restore(),r.fillStyle="white",r.strokeStyle="#939393",r.lineWidth=1,Q.Yl(r,.5,.5),S.GC$.each(a,function(n,t){var o,i,e,t;t&&(o=t.x,i=t.y,e=O(t),t=I(t),r.beginPath(),r.fillRect(o,i,e-1,t-1),r.strokeRect(o,i,e-1,t-1),r.stroke(),r.closePath())}),Q.Yl(r,-.5,-.5))},R.prototype.cK=function(){var t,n,o,i,o,t=this,n=t.KQ(t.AW,t.IW);t.eW?(0,S.GC$)(t.eW).remove():t.eW=e(f),o=(0,S.GC$)(t.eW),i=(0,S.GC$)(t.TW),o.addClass("gc-spread-moveResizeContainer").css([r,w,g,m,d,"border"],[c,t.EW.x+t.eQ-n.x,t.EW.y+t.eQ-n.y,i.outerWidth()-2,i.outerHeight()-2,"gray solid thin"]),t.fK?(0,S.GC$)(t.fK).remove():t.fK=e(f),(o=(0,S.GC$)(t.fK)).bind("mousemove",function(n){t.pg(n)}).bind(rt,function(n){t.bg(n)}).css([r,a,g,w,m,d,"background",Nn],[c,jn,n.y,n.x,O(n),I(n),"rgba(255,255,255,0.01)",901]),o.append(t.eW),t.YW&&t.YW.appendChild(t.fK)},R.prototype.lK=function(n){var t,o,i,e,r,c,a,n,c,u,s,u,f,f,t=this,o=t.eQ,i=t._zoomFactor,e,r=t.NW.RW;r.BW&&(c=t.hK(),a=n.pageX/i-r.x+c.x,n=n.pageY/i-r.y+c.y,0===a&&0===n||(c=t.KQ(t.AW,t.IW),s=(0,S.GC$)(t.eW),r.FW<0?(u=r.LW.x+a,f=r.LW.y+n,u=t.bQ(D(u,f)),s.css([w,g],[u.x+o-c.x,u.y+o-c.y])):(f=t.dK(a,n,r.FW),u=t.bQ(D(f.x,f.y)),s.css([w,g,m,d],[u.x+o-c.x,u.y+o-c.y,O(f)*i-2*o-2,I(f)*i-2*o-2]))))},R.prototype.tK=function(){var n,t,o,n=this,t=n.TZ;n.uQ()||(o=n.NW.kW,(0,S.GC$)(n.Ti).remove(),n.dQ(),(0,S.GC$)(o).remove(),(0,S.GC$)(n.TW).append(o),n.vK(o),n.ZQ(o),(0,S.GC$)(o).focus(),o.selectionStart=o.value.length,n.sQ(),2!==t.commentState()&&t.commentState(2,!0))},R.prototype.$Q=function(){var n,t,o,i,n=this,t=n.TZ,o=t.Mf;n.uQ()&&(i=n.NW.kW,n.mQ(),(0,S.GC$)(i).remove(),(0,S.GC$)(n.TW).append(n.Ti),n.vK(n.Ti),n.cQ(),R.et(n,"detachEditor",n.Ti),2===t.commentState()&&t.commentState(3),(0,S.GC$)(i).val()!==t.text())&&o.Qy().execute({cmd:"changeComment",sheetName:o.name(),row:t.bZ,col:t.yZ,oldValue:t.text(),newValue:(0,S.GC$)(i).val(),propertyName:Pn})},R.prototype.mK=function(n){var t,o,i,t,o=this.TZ.Mf,i=-1;return 0===n||2===n?i=o.getViewportHeight(n):1===n&&(i=j(o,o.getViewportBottomRow(0)+1,Kt(o,2)+1,!0)),i},R.prototype.gK=function(n){var t,o,i,t,o=this.TZ.Mf,i=-1;return 0===n||2===n?i=o.getViewportWidth(n):1===n&&(i=j(o,o.getViewportRightColumn(0)+1,Yt(o,2)+1,!1)),i},R.prototype.KQ=function(n,t){var o,i,e,r,c,i,o,i=this.TZ.Mf,e=i.Fi(),r=e.c9(n,t),c=i.Gy(e),i=i.Sy(e);return 0===n&&0===t||0===n&&2===t||2===n&&0===t||2===n&&2===t?r=V(0,0,e.F6+c+e.zy,e.L6+i+e.Iy):0===n&&1===t||2===n&&1===t?r=V(e.F6,0,c,e.L6+i+e.Iy):1===n&&0===t||1===n&&2===t?r=V(0,e.L6,e.F6+c+e.zy,i):1===n&&1===t&&(r=V(e.F6,e.L6,c,i)),r},R.prototype.vK=function(n){var t=this,o=t.TZ,i=(0,S.GC$)(n);n!==t.li&&n!==t.Ti||(n===t.li?n.value=o.text():n.innerHTML=$.j0(o.text()),i.css([Hn,Xn,Yn,Kn,qn,tt,ot,at],[o.fontFamily(),o.fontStyle(),o.fontSize(),o.fontWeight(),o.foreColor(),o.backColor(),o.horizontalAlign(),o.textDecoration()]),o.padding()?i.css(Tn,o.padding().toString()):i.css(Tn,"0px"))},R.prototype.LQ=function(){return!(!this.qW||!this.qW.parentNode)},R.prototype.uQ=function(){var n=this;return n.LQ()&&n.TZ===n.NW.pZ()&&0<(0,S.GC$)(n.TW).find($n).length},R.prototype.pK=function(){var n,t,o,t,n=this,t=n.TZ.Mf,o=l;return n.LQ()&&(t=t.Fi(),o=V(n.EW.x+t.BA+t.XC,n.EW.y+t.LA+t.qC,n.gQ(),n.pQ())),o},R.prototype.bK=function(){var n,t,o,i,e,r,c,a,n,u,n=this,t=n.TZ,o=n._zoomFactor;return n.LQ()&&(i=n.pK())?(a=c=r=e=void 0,n=(n.eQ+t.borderWidth())*o,V(e=i.x+n,r=i.y+n,c=O(i)-2*n,a=I(i)-2*n)):l},R.prototype.yK=function(n){var t,o,i,e,r,c,a,r,t=this,o=t.TZ,i=o.Mf,e=n.target,r=t.NW.RW,c=e.style,a=G;r.BW?e[F]!==t.JW&&e[F]!==t.QW&&e[F]!==t.XW&&e[F]!==y+"floatPanel"||(a=0<=r.FW?"crosshair":yn):e[F]===t.JW?!Nt(i)&&o.lockText()?o.locked()||(a=yn):a=Pn:e[F]!==t.QW&&e[F]!==t.KW||Nt(i,o)&&(a=0<=(r=t.wK(n))&&r<t.nQ.length?t.nQ[r].cursor:yn),c[Rn]=a},R.prototype.lW=function(n){var t,o,i,e,t=this,o=t.TZ,i=o&&o.Mf;if(i&&i.endEdit()&&o&&i.comments.get(o.bZ,o.yZ)&&(R.et(t,"preProcessMouseDownEdit",e={e:n,r:l}),!e.r))return i.ki(s.FloatingElementSelected,{type:"comments"}),t.NW.qQ(o),o.commentState(2,!0),t.bg(n),X(n)},R.prototype.XZ=function(n){var t,o,i,e,r,c,a,a,e,r,o,t=this,o=t.TZ,i=o&&o.Mf,e=t._zoomFactor,r=t.NW,c=r.RW;i.endEdit()&&(R.et(t,"preProcessMouseDownDragResize",a={e:n,r:l}),a.r||(i.ki(s.FloatingElementSelected,{type:"comments"}),c.x=n.pageX/e,c.y=n.pageY/e,c.LW=V(o.location().x,o.location().y,o.width(),o.height()),c.FW=t.wK(n),t.Fg(),c.BW=!0,t.yK(n),r.qQ(o),o.commentState(T.active,!0),Nt(i,o)&&(t.CK={},t.CK.SK=Kt(i,t.AW),t.CK.TK=Yt(i,t.IW),t.cK(),c.FW<0?t.iQ=!0:t.Eb=!0),a=i.rt,e=i.uw(),r=D(n.pageX-e.left,n.pageY-e.top),o=i.hitTest(r.x,r.y),a.Rk={e9:o.rowViewportIndex,r9:o.colViewportIndex,Bk:o.hitTestType},a.fk=r,a.Ok(),a.s9=!0,n.stopPropagation()))},R.prototype.DW=function(n,t,o){var i,e,r,c,a,u,s,f,t,o,h,l,v,m,d,n,m,p,w,g,b,_,b,u,b,C,e,y,k,u,i=this,e=i.TZ,r=e&&e.Mf,c=i.eQ,a=i._zoomFactor,u=i.IW,s=i.AW,f=i.KQ(s,u),t=void 0!==t?t*a:i.gQ(),o=void 0!==o?o*a:i.pQ(),h=n.x,l=n.y,v=r.Fi(),m=i.wQ(r,0,0,s,u),d=n.x+(0-(m.x-v.XC))+t-c,n=n.y+(0-(m.y-v.qC))+o-c,m=0,p=0,w=0,g=0;return 0===u?(m=0-c,w=O(v)-v.XC):1===u?(b=j(r,r.getViewportRightColumn(0)+1,Yt(r,1),!1),m=f.x-c-b,w=_=i.gK(2)):2===u&&(m=0-c),h<m&&(i.Eb?t-=m-h:d+=m-h,h=m),1!==u&&2!==u||(w+=j(r,0,r.getColumnCount(),!1,d)),w<d&&(i.Eb?t-=d-w:i.iQ?h-=d-w:(b=i.NW.PW&&!e.ignoreDefaultLocation()?9:e.location().x,m<(b=h-(u=2*x(b)+Xt(r,e.yZ)+e.width()))?h=b:h<w?t-=d-w:(b=h-u,h=m<(C=d-u)?b<m?(t-=m-b,m):b:(b=h-(d-w))<m?(t-=m-b,m):b))),0===s?(p=0-c,g=I(v)-v.qC):1===s?(e=j(r,r.getViewportBottomRow(0)+1,Kt(r,1),!0),p=f.y-c-e,g=y=i.mK(2)):p=0-c,l<p&&(i.Eb?o-=p-l:n+=p-l,l=p),1!==s&&2!==s||(g+=j(r,0,r.getRowCount(),!0,n)),g<n&&(i.Eb?o-=n-g:i.iQ?l-=n-g:g<n&&(l=(u=l-(k=n-g))<p?(o-=p-u,p):u)),V(h,l,t/a,o/a)},R.prototype.hK=function(){var n,t,o,i,e,r,e,c,n,a,t,n=this,t=n.TZ.Mf,e=n.CK,r=e.SK,e=e.TK,c=Kt(t,n.AW),n=Yt(t,n.IW),a=j(t,r,c,!0),t=j(t,e,n,!1),o,i;return D(e<n?t:-t,r<c?a:-a)},R.prototype.AK=function(n){var t,o,i,e,r,c,a,u,s,n,e,u,f,f,h,h,s,t=this,o=t.TZ,i=o&&o.Mf,e=t._zoomFactor,r,c=t.NW.RW,a=L.ChangeComment;c.BW&&(u=t.hK(),s=n.pageX/e-c.x+u.x,n=n.pageY/e-c.y+u.y,0===s&&0===n||(u=e=void 0,c.FW<0?(f=c.LW.x+s,h=c.LW.y+n,e=t.bQ(D(f,h)),u=t.DW(e),(f=t.MQ(D(u.x,u.y))).x===o.location().x&&f.x===o.location().y||i.Qy().execute({cmd:"moveComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.location().clone(),newValue:f,propertyName:"location"})):(o.autoSize(!1),h=t.dK(s,n,c.FW),e=t.bQ(D(h.x,h.y)),u=t.DW(e,O(h),I(h)),s=[],(f=t.MQ(D(u.x,u.y))).x===o.location().x&&f.y===o.location().y||s.push(new a(i,{cmd:"changeComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.location().clone(),newValue:f,propertyName:"location"})),O(u)!==o.width()&&s.push(new a(i,{cmd:"changeComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.width(),newValue:u.width,propertyName:m})),I(u)!==o.height()&&s.push(new a(i,{cmd:"changeComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.height(),newValue:u.height,propertyName:d})),0<s.length&&i.Qy().execute({cmd:"changeCommentTransaction",sheetName:i.name(),commands:s}))))},R.prototype.pg=function(n){var t,o,i,i,e,r,o,o,t=this,o=t.TZ.Mf,i={e:n,r:l};if(R.et(t,"preProcessMouseMove",i),!(i.r||(this.yK(n),o.getSelections()&&0<o.getSelections().length)))return i=t.NW,e=n.target,r=o.rt,o=o.uw(),o=D(n.pageX-o.left,n.pageY-o.top),e&&i.RW.BW&&(t.eW&&t.lK(n),1===t.AW&&(r.fk.y=o.y),1===t.IW&&(r.fk.x=o.x),r.a9()),X(n)},R.prototype.bg=function(n){var t,o,i,i,e,o,t=this,o=t.TZ.Mf,i={e:n,r:l};if(R.et(t,"preProcessMouseUp",i),!(i.r||o.getSelections()&&0<o.getSelections().length))return i=n.target,e=t.NW,(o=o.rt).s9=!1,o.l9(),i&&(t.AK(n),t.fK&&((0,S.GC$)(t.fK).remove(),t.fK=null,t.iQ=!1,t.Eb=!1),t.u2(),e.RW.BW=!1,t.yK(n)),X(n)},R.prototype.wK=function(n){var t,o,t,i,e,r,c,t=this,o=t.nQ;if(0<o.length&&(t.rK===T.active||t.rK===T.edit))for(t=t.SW,i=n.pageX-(0,S.GC$)(t).offset().left,e=n.pageY-(0,S.GC$)(t).offset().top,r=0;r<o.length;r++)if((c=o[r])&&c.contains(i,e))return r;return-1},R.prototype.dK=function(n,t,o){var i,e,r,o,n,i=this,e=-1,r=-1;switch(o){case 0:r=e=0;break;case 1:e=2,r=0;break;case 2:e=0,r=2;break;case 3:r=e=2;break;case 4:e=0,r=1;break;case 5:e=2,r=1;break;case 6:e=1,r=0;break;case 7:e=1,r=2}return o=i.IK(n,e),n=i.oh(t,r),V(o.x,n.y,o.w,n.h)},R.prototype.IK=function(n,t){var o,i,o,e,r,n,o=this,i=2*o.eQ,o=o.NW.RW,e=O(o.LW)-i;return 0===t?e-=n:2===t&&(e+=n),r=o.LW.x,0<=e?0===t&&(r+=n):0===t?r+=O(o.LW)-i:2===t&&(r+=e),n=O(o.LW),{x:r,w:n=1!==t?x(e)+i:n}},R.prototype.oh=function(n,t){var o,i,o,e,r,n,o=this,i=2*o.eQ,o=o.NW.RW,e=I(o.LW)-i;return 0===t?e-=n:2===t&&(e+=n),r=o.LW.y,0<=e?0===t&&(r+=n):0===t?r=I(o.LW)-i:2===t&&(r+=e),n=I(o.LW),{y:r,h:n=1!==t?x(e)+i:n}},R.prototype.XQ=function(n){var t,o,i,t,t=this,o=t.TZ.Mf;if(n){switch(i=v,n){case t.SW:i=Vn;break;case t.TW:i=In;break;case t.$W:i=On;break;case t.Ti:i=_;break;case t.li:i=C}i&&((0,S.GC$)(n).unbind(ct+i).unbind(kn+i),t=function(n){o.P_(n),X(n)},(0,S.GC$)(n).bind(ct+i,t).bind(kn+i,t))}},R.prototype.aQ=function(n,t){var o,i,e,i,o=this,i=o.TZ,e=i&&i.Mf;o.hQ(n,t),i=function(n){io(e,n)},(0,S.GC$)(n).bind(it+t,function(n){o.XZ(n)}).bind(et+t,function(n){o.pg(n)}).bind(rt+t,function(n){o.bg(n)}).bind(ct+t,i).bind(kn+t,i)},R.prototype.hQ=function(n,t){(0,S.GC$)(n).unbind(t)},R.prototype.oQ=function(){var r,n,c,a,u,n,r=this,n=r.TZ,c=n&&n.Mf,a=r.NW;r.vQ(),c&&(u=c.uw(),n=function(n){c.P_(n)},(0,S.GC$)(r.tQ).bind(it+Qn,function(n){var t,o,o,t=c.Ut.pI.hitTest(n.pageX-u.left,n.pageY-u.top);t?(o=t.comment,o=a.mW(o),t.area===Bn?o.lW(n):t.area===Jn&&o.XZ(n),(0,S.GC$)(o.qW).css(Nn,parseInt((0,S.GC$)(r.$W).css(Nn)+1,10))):c.B_(n)}).bind(et+Qn,function(n){var t,o,i,e,i,t=c.Ut.pI.hitTest(n.pageX-u.left,n.pageY-u.top),o=r.tQ.style;t?(i=t.comment,(e=a.mW(i)).pg(n),t.area===Bn?o.cursor=Pn:t.area===Jn&&(o.cursor=yn)):(c.L_(n),r.NW.wW(l),(i=c.Dg())&&(o.cursor=i.style.cursor))}).bind(rt+Qn,function(n){var t,t,o,t=c.Ut.pI.hitTest(n.pageX-u.left,n.pageY-u.top);t?(t=t.comment,(o=a.mW(t)).bg(n)):c.F_(n)}).bind("dblclick"+Qn,function(n){c.U_(n)}).bind(ct+Qn,n).bind(kn+Qn,n))},R.prototype.vQ=function(){var n;(0,S.GC$)(this.tQ).unbind(Qn)},R.prototype.cQ=function(){var t,n,o,n,t=this,n=t.TZ,o=n&&n.Mf;n.commentState()!==T.edit&&t.Ti&&(t.dQ(),n=function(n){io(o,n)},(0,S.GC$)(t.Ti).bind(it+_,function(n){t.lW(n)}).bind(et+_,function(n){t.pg(n)}).bind(rt+_,function(n){t.bg(n)}).bind(ct+_,n).bind(kn+_,n))},R.prototype.dQ=function(){var n=this,t;n.TZ.commentState()!==T.edit&&n.Ti&&(0,S.GC$)(n.Ti).unbind(_)},R.prototype.sQ=function(){var n,t,o,i,n=this,t=n.TZ,o=t&&t.Mf,i=n.li;t.commentState()===T.edit&&i&&(this.mQ(),(0,S.GC$)(i).bind(it+C,function(n){n.stopPropagation()}).bind(et+C,function(n){n.stopPropagation()}).bind(rt+C,function(n){n.stopPropagation()}).bind("keydown"+C,function(n){27!==n.keyCode&&9!==n.keyCode||(t.commentState(T.active,!0),X(n),J.F1(o))}).bind("focusout"+C,function(){(0,S.GC$)(i).val()!==t.text()&&o.Qy().execute({cmd:"changeComment",sheetName:o.name(),row:t.bZ,col:t.yZ,oldValue:t.text(),newValue:(0,S.GC$)(i).val(),propertyName:Pn})}))},R.prototype.JQ=function(n,t){var o,i,e,r,e,c,a,u,s,f,h,l,h,v,m,d,p,w,g,b,_,C,y,k,x,v,o=this,i=o.TZ,e=o.eQ,r=i.padding(),e=2*(e+i.borderWidth());if(!(!i.autoSize()||o.Eb||o.xK||t<=0)){if(o.xK=!0,a=(c=i.Mf).Fi(),u=c.qc()&&c.qc().getBoundingClientRect(),f=i.commentState()===T.edit?(s=o.li).value:(s=o.Ti,$.dI(s.innerHTML)),l="",(h=s.style).font?l+=h.font:(i.fontStyle()&&(l+=En+i.fontStyle()),i.fontWeight()&&(l+=En+i.fontWeight()),i.fontSize()&&(l+=En+parseInt(i.fontSize(),10)*o._zoomFactor+"pt"),i.fontFamily()&&(l+=En+i.fontFamily())),h=s.getBoundingClientRect(),v=i.location().x<0,m=!1,w=d=K("M",l),g=p=5,b=a.x+a.width-(h.left-u.left),_=a.y+a.height-(h.top-u.top),v&&(b=h.left-u.left+h.width-a.x,m=!0),(C=S.q.un(f,b,l))&&0<C.length){for(k=y=0;k<C.length;k++)y<(x=c.Gi(C[k],l))&&(y=x);v=oo(C,l),r&&(y+=(r.left||0)+(r.right||0),v+=(r.top||0)+(r.bottom||0)),g=N(M(b,A(y,5))),w=N(M(_,v))}return 2===i.commentState()&&i.text(s.value),t=w+e,n=g+e,i.width(g,!1),i.height(w,!1),m&&i.location().x+g<=0&&(m=!1),o.xK=!1,{adjustedWidth:n,adjustedHeight:t,needReposition:m}}},R.prototype.mQ=function(){var n,t=this.li;t&&(0,S.GC$)(t).unbind(C)},R.prototype.Fg=function(){var t=this,n=t.NW.RW;n.BW||((0,S.GC$)(mn).bind(et+Zn,function(n){t.pg(n)}).bind(rt+Zn,function(n){t.bg(n)}),n.BW=!0)},R.prototype.u2=function(){var n=this.NW.RW;n.BW&&(n.BW=!1,S.GC$)(mn).unbind(Zn)},yt=R,n.hW=yt,u.$e(yt),o.prototype.getUsedRange=function(){var n,t,o,i,e,r,c,a,n,t=this.all(),o={};if(t)for(e=i=void 0,r=0,c=t;r<c.length;r++)i=(a=c[r]).bZ,e=a.yZ,pn(o,{minRow:i,minCol:e,maxRow:i,maxCol:e});return o},o.prototype.dispose=function(n){var t,o,t=this,o;t.all().forEach(function(n){t.NK(n)}),t.kK(),!1!==n&&(t.Mf=l)},o.prototype.add=function(n,t,o){var i,e,r,r,o,i=this,e=i.Mf,r=e.getSpan(n,t);return!r||r.row===n&&r.col===t?(r=i.get(n,t),o="string"==typeof o?new pt(o):o,i.WB(n,t,o),e.Rj("comment",n,t,S.SheetArea.viewport,r,o),o):l},o.prototype.WB=function(n,t,o,i){var e=this,r=e.Mf,c=e.wB;e.DK(n,t),o&&(o.bZ=n,o.yZ=t,o.Mf=r,c.push(o),o.lp=e.GW,r.Ut.MW({type:"add",row:n,col:t,comment:o}),e.GW++,e._K(n,t,o),i||r.zw())},o.prototype.get=function(n,t){return this.cE[n+"_"+t]||l},o.prototype._K=function(n,t,o){this.cE[n+"_"+t]=o},o.prototype.EK=function(n,t,o){var i=n.bZ,e=n.yZ;this.get(i,e)===n&&this._K(i,e,v),this.Mf.Ut.MW({type:"rowcol",comment:n,row:i,col:e,newRow:t,newCol:o}),n.bZ=t,n.yZ=o,this._K(t,o,n)},o.prototype.remove=function(n,t){var o=this,i=o.DK(n,t),o=o.Mf;i&&(o.Rj(B,n,t,S.SheetArea.viewport,i,v),o.zw())},o.prototype.DK=function(n,t){var o,i,e,i,o=this,i=o.Mf,e=o.get(n,t);return e&&(i.Ut.MW({type:"remove",row:n,col:t,comment:e}),o.NK(e),W.VP(o.wB,e),(i=o.mW(e))&&(yt.et(i,"dispose"),W.VP(o.UW,i)),o._K(n,t,v)),e},o.prototype.clear=function(n){var t,o,i,e,r,c,r,t=this,o=t.Mf,i=t.wB;for(o.suspendPaint(),e=i.length-1;0<=e;e--)c=(r=i[e]).bZ,r=r.yZ,(!n||c>=n.row&&c<n.row+n.rowCount&&r>=n.col&&r<n.col+n.colCount)&&t.remove(c,r);o.resumePaint()},o.prototype.all=function(){return this.wB.concat()},o.prototype.CB=function(n,t,o,i,e,r){(n||i)&&(n&&this.EK(n,e,r),i)&&this.EK(i,t,o)},o.prototype.getOuterContainer=function(n){var n=this.mW(n);return n?n.qW:l},o.prototype.HW=function(){var n=e($n);(0,S.GC$)(n).addClass("gc-comment-editor").css(w,0).css(g,0).css(r,c).css("margin",0).css(Tn,0).css("word-wrap","break-word").css("word-break","normal").css(a,jn).css("resize","none").css("outline","none").css("border","0px").css(Fn,zn).css(nt,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.kW=n},o.prototype.zW=function(){var i=this,n=i.Mf;n&&(n.D3(s.ColumnChanged+b,function(n,t){var t=t.propertyName;t!==m&&"isVisible"!==t||i.jK()}),n.D3(s.RowChanged+b,function(n,t){var t=t.propertyName;t!==d&&"isVisible"!==t||i.jK()}),n.D3(s.ColumnWidthChanged+b,function(){i.jK()}),n.D3(s.RowHeightChanged+b,function(){i.jK()}),n.D3(s.CommentChanged+b,function(n,t){var o,t,t;t&&(o=t.propertyName,t=t.comment,t=i.mW(t))&&("location"===o?t.CQ():o!==m&&o!==d||t.SQ())}))},o.prototype.kK=function(){var n,t=this.Mf;t&&t._3(b)},o.prototype.mW=function(n){var t,o,i,e,t,o=this.UW;if(n)for(i=0;i<o.length;i++)if((e=o[i]).TZ===n)return e;return l},o.prototype.Oy=function(){return 0===this.wB.length},o.prototype.RK=function(){var n,t,o,i,e,n,t=this.wB;if(0<t.length){for(o=t[0].zIndex(),i=1;i<t.length;i++)o<(e=t[i]).zIndex()&&(o=e.zIndex());return o}return 0},o.prototype.JO=function(n,t){for(var o,i,e,r,c,a,u,o=this,i=o.wB,e=o.UW,r=0;r<i.length;r++)n<=(c=i[r]).bZ&&o.EK(c,c.bZ+t,c.yZ);for(a=0;a<e.length;a++)(u=e[a]).LQ()&&u.JO(n,t)},o.prototype.qO=function(n,t){for(var o,i,e,r,c,a,u,o=this,i=o.wB,e=o.UW,r=0;r<i.length;r++)n<=(c=i[r]).yZ&&o.EK(c,c.bZ,c.yZ+t);for(a=0;a<e.length;a++)(u=e[a]).LQ()&&u.qO(n,t)},o.prototype.xP=function(n,t){for(var o,i,e,r,c,a,u,s,o=this,i=o.wB,e=o.UW,r=i.length-1;0<=r;r--)a=(c=i[r]).bZ,u=c.yZ,n<=a&&a<n+t&&o.remove(a,u);for(r=0;r<i.length;r++)n<(c=i[r]).bZ&&o.EK(c,c.bZ-t,c.yZ);for(r=0;r<e.length;r++)(s=e[r]).LQ()&&s.xP(n,t)},o.prototype.NP=function(n,t){for(var o,i,e,r,c,a,u,s,o=this,i=o.wB,e=o.UW,r=i.length-1;0<=r;r--)a=(c=i[r]).bZ,n<=(u=c.yZ)&&u<n+t&&o.remove(a,u);for(r=0;r<i.length;r++)n<(c=i[r]).yZ&&o.EK(c,c.bZ,c.yZ-t);for(r=0;r<e.length;r++)(s=e[r]).LQ()&&s.NP(n,t)},o.prototype.pZ=function(){return this.MZ},o.prototype.qQ=function(n){var t=this;n&&n!==t.MZ&&(t.CZ(),t.MZ=n)},o.prototype.CZ=function(){var n,t,o,n=this,t=n.MZ;t&&(o=n.mW(t))&&!o.iQ&&!o.Eb&&(o.uQ()&&o.$Q(),t.commentState(T.normal),n.MZ=l)},o.prototype.$c=function(n){var t,o,t=this,o=t.mW(n);o||(o=new yt(n,t),t.UW.push(o)),o.rQ()},o.prototype.wW=function(n){var t=this,o=t.MZ;if(o)if(1===o.displayMode()){if(o.commentState()===T.edit)return}else if(o.commentState()===T.edit||o.commentState()===T.active)return;n!==t.PW&&(t.PW&&t.NK(t.PW),n&&2===n.displayMode()?t.RW.BW||n.BK||((t.PW=n).BK=dn.setTimeout(function(){t.$c(n)},200)):t.PW=l)},o.prototype.NK=function(n){var t=this,o=t.mW(n);o&&o.LQ()&&(o.lQ(),n===t.MZ)&&t.Mf.cR(),clearTimeout(n.BK),delete n.BK},o.prototype.LK=function(){var n=this.Mf.pW&&this.Mf.pW();n&&(0,S.GC$)(n.YW).show()},o.prototype.FK=function(){var n=this.Mf.pW&&this.Mf.pW();n&&(0,S.GC$)(n.YW).hide()},o.prototype.PK=function(n,t,o){var n,n,n=this.mW(n);return!(!n||!(n=n.pK()))&&n.contains(t,o)},o.prototype.GK=function(n,t,o){var n,n,n=this.mW(n);return!(!n||!(n=n.bK()))&&n.contains(t,o)},o.prototype.hitTest=function(n,t){for(var o,i,e,r,o=this,i=l,e=0;e<o.wB.length;e++)r=o.wB[e],Nt(o.Mf,r)&&o.PK(r,n,t)&&(!i||r.zIndex()>i.zIndex())&&(i=r);return i?{x:n,y:t,comment:i,area:o.GK(i,n,t)?Bn:Jn}:l},o.prototype.nK=function(n){var t=this,o=t.RK();return n===t.PW?o+2:n===t.MZ?o+1:n.zIndex()},o.prototype.jK=function(){this.UW.forEach(function(n){n.TQ()})},o.prototype.fromJSON=function(n,t){var o,i,e,r,o=this;if(n&&0!==n.length){for(i=o.GW=0;i<n.length;i++)e=n[i],(r=new pt).fromJSON(e,t),3!==r.commentState()&&(o.MZ=r),o.Mf.Ut.pI.WB(r.bZ,r.yZ,r,!0);o.Mf.zw()}},o.prototype.yh=function(n,t,o,i){var e,r,c,a,u,s,f,h,l,e=this;if(n&&t){for(e.GW=0,r=k(n,"commentList"),c=en(t,"shape"),r=r.c_,a=0;a<r.length;a++)u=r[a],l=It(c,f=(s=new pt).bZ=S.IndexHelper.qi(u.ref),h=s.yZ=S.IndexHelper.$i(u.ref)),u.lossless&&(s.showShadow(u.lossless.showShadow),s.indicatorSize(u.lossless.indicatorSize),s.indicatorColor(u.lossless.indicatorColor),s.ignoreDefaultLocation(u.lossless.ignoreDefaultLocation),s.commentState(u.lossless.commentState)),s.yh(e.Mf,u,l,o,i),3!==s.commentState()&&(e.MZ=s),e.Mf.Ut.pI.WB(s.bZ,s.yZ,s,!0);e.Mf.zw(),e.Pfe=k(n,"authors")}},o.prototype.toJSON=function(){var n,t,o,n=this.wB;if(!n||0===n.length)return v;for(t=[],o=0;o<n.length;o++)t.push(n[o].toJSON());return 0===t.length?v:t},kt=o,co.prototype.L0=function(){this.Mf=l},co.prototype.ZW=function(){var n=e(f);return(0,S.GC$)(n).addClass("gc-comment-layoutPanel"+En+An).css([r,w,g,d,m,a,Nn,Gn],[c,0,0,0,0,Mn,Un,Wn]),n},co.prototype.bW=function(n){var t,o,i,o,t=this;n.Ut.pI.Oy()||(o=n.Fi(),(0,S.GC$)(t.YW).css(w,o.x+o.XC).css(g,o.y+o.qC),t.Mf!==n&&(t.Mf&&(o=(i=t.Mf.Ut).pI.pZ())&&o.commentState()===T.edit&&o.commentState(T.active,!0),t.Mf=n))},co.prototype.yW=function(n,t,o){var i,e,r,c,a,o,u,t,u,i,i=o.row,e=o.col,r=o.x,c=o.y,a=O(o),o=I(o),u=this;t===S.SheetArea.viewport&&u.Mf&&(t=u.Mf.Ut.pI.get(i,e))&&(u=this.Mf,i=(t.indicatorSize()||6)*(u?u.zoom():1),n)&&0<a&&0<o&&(n.save(),n.rect(r,c,a,o),n.clip(),n.fillStyle=t.indicatorColor()||"red",n.beginPath(),n.moveTo(r+a-i,c),n.lineTo(r+a,c),n.lineTo(r+a,c+i),n.lineTo(r+a-i,c),n.fill(),n.restore())},co.prototype.WW=function(n){var t,o,i,e,r,c,c;if(this.VW){for(n.LK(),t=this.Mf,o=n.all(),i=0;i<o.length;i++)e=o[i],r=n.mW(e),this.UK(n,e)?(1===e.displayMode()&&e===n.PW&&(n.PW=l),r&&r.LQ()?r.fQ():n.$c(e)):r&&r.LQ()&&n.NK(e);(c=n.pZ())&&(c=n.mW(c))&&c.LQ()&&0<t.getSelections().length&&t.Ut.do("clearSelection")}else n.FK()},co.prototype.UK=function(n,t){var o=n.Mf;if(o&&Xt(o,t.yZ)&&Ht(o,t.bZ))switch(t.displayMode()){case 1:return!0;case 2:if(3!==t.commentState())return n&&t!==n.PW&&(n.PW=t),!0;if(t===n.PW)return!0}return!1},xt=co,t=u.Y8,u.GC$.extend(t.prototype,{MW:function(n){var t,o,t=this.G8;t&&(o=(o=t.commentChanges)||(t.commentChanges=[])).push(n)},HK:function(n,t){var o,i,e,r,c,a,a,u,o,i=this.pI;if(n)for(e=0;e<n.length;e++)c=(r=n[e]).comment,"add"===r.type?((a=new pt).fromJSON(c),(c=a).commentState(3)):c=i.get(c.rowIndex,c.colIndex),"add"===r.type?i.WB(r.row,r.col,c):"remove"===r.type?i.DK(r.row,r.col):"property"===r.type?(a=r.name,u=r.newValue,"commentState"!==a&&c[a](u)):"rowcol"===r.type&&i.EK(c,r.newRow,r.newCol);else t&&"changeComment"===t.cmd&&"commentState"!==t.propertyName&&(c=i.get(t.row,t.col))[t.propertyName](t.newValue)},zK:function(n){var t,o,i,e,r,c,a;if(n)for(o=(t=this).pI,i=n.length-1;0<=i;i--)r=(e=n[i]).comment,"add"===e.type?o.DK(e.row,e.col):"remove"===e.type?o.WB(e.row,e.col,e.comment):"property"===e.type?(c=e.name,a=e.value,r[c](a)):"rowcol"===e.type&&o.EK(r,e.row,e.col)},OL:function(n,t,o,i){for(var e,r,c,e=this,r=0;r<o;r++)for(c=0;c<i;c++)0===r&&0===c||e.getCell(n+r,t+c).comment()&&e.comments.remove(n+r,t+c)}}),t.ch("comments",{init:function(){this.pI=new kt(this.Mf)},applyChanges:function(n){var t,o,i,n,i,t=this,o=n.command,i=n.changes,n=n.isUndo,i=i&&i.commentChanges;(i||o)&&(n?t.zK(i):t.HK(i,o))},undo:function(n){var n=n.commentChanges;n&&this.zK(n)},dispose:function(n){var t=this,n=n&&n.clearCache;t.pI&&t.pI.dispose(n),!1!==n&&(t.pI=l)}}),S.Worksheet.ch("comments",St={getUsedRange:function(n){var t,o,i;n.type&S.UsedRangeType.comment&&(i=(o=(t=this).comments).getUsedRange(),pn(n.range,i))},init:function(){var t=this;t.comments=t.Ut.pI,t.pW=function(){var n=t.parent;if(n)return n.VK||(n.VK=new xt(n.j2())),(n.VK.Mf=t).parent.VK}},dispose:function(n){!1!==n.clearCache&&(this.pW=l,this.comments=l),vt(this,(0,S.GC$)(this.Dg()))},setHost:function(n){var t;n&&((t=this.Ut.pI)&&t.zW(),lt(n,this))},onLayoutChanged:function(n){var t,o,i,e,r,c,a;!on(n.sheetArea)&&3!==n.sheetArea||(o=(t=this).Ut.pI,i=n.changeType,e=n.row,r=n.rowCount,c=n.col,a=n.colCount,"addRows"===i?o.JO(e,r):"deletingRows"===i?o.xP(e,r):"addColumns"===i?o.qO(c,a):"deletingColumns"===i?o.NP(c,a):n.sheetArea===S.SheetArea.viewport&&("clear"===i?4==(4&n.type)&&o.clear(new u.Range(e,c,r,a)):"addSpan"===i?Gt.call(t,!0,e,c,r,a):"removeSpan"===i&&Gt.call(t,!1,e,c)))},paint:function(n){this.Ut.pI.Oy()||(Wt.call(this),this.CW(n.clipRect))},paintCell:function(n){n.isPrinting||n.sheetArea!==S.SheetArea.viewport||Bt.call(this,n.ctx,n.sheetArea,n.cell)},toJson:function(n,t){var o;t&&t.ignoreStyle||(n.comments=this.Ut.pI.toJSON())},fromJson:function(n,t,o){var i,o,i;o&&o.ignoreStyle||n&&(o=t?n.commentManager:n.comments)&&this.Ut.pI.fromJSON(o,t)},lastNonNullRowAndCol:function(){var n,t,o,i,e,r,c,n=0,t=0,o=this.Ut.pI;if(o&&(i=o.UW)&&0<i.length)for(e=0,r=i.length;e<r;e++)(c=i[e])&&c.TZ&&(c.RQ>n&&(n=c.RQ),c.jQ>t)&&(t=c.jQ);return{lastNonNullRow:n,lastNonNullCol:t}},clearSelection:function(){this.Ut.pI.CZ()},processKeyDown:function(n){var t=this,o=t.Ut.pI.pZ();o&&t.rt.Pi(n.e)&&jt(t,o)&&(o.commentState(2,!0),n.r=!0)},yh:function(n,t,o){var i,n,e,e,r,i,c,a,u,s,f,r,n,h,i=k(n,"legacyDrawing"),n=n.rels,e=o&&!1===o.includeStyles;if(i&&!e){for(e=this,r=n.c_,i=i&&i["r:id"],a=0,u=r;a<u.length;a++)if(0<(f=(s=u[a]).Target).indexOf(bn)){c=f.split("/").pop().slice(0,-4);break}r=S.Util.Gr(n,i,t),n=t.comments&&t.comments[c],(h=e.comments).yh(n,r,o,t)}},wh:function(n,t,o){var o,i,e,i,r,c;!n||o&&!1===o.includeStyles||(o=n.rels,i=this.comments&&this.comments.all(),e=this.parent.Cp,o&&i&&0<i.length&&(i=hn(o),c=this.wp,o.c_.push({n_:gn,Id:r=wn+i,Type:S.RelationshipConstants.hc,Target:"../"+S.XFileConstants.ou+c+"."+S.XFileConstants.Cr}),S.Util.Hr(n,e)))}}),u.Workbook.ch("comments",Mt={init:function(){L.SZ(this.commandManager())},dispose:function(){this.VK&&(this.VK.L0(),this.VK=l)},wh:function(n,t,o){var i,e,r,c,a,u,s,f,a,h,l,v,m,d,i,e=this.sheets;if(!o||!1!==o.includeStyles)for(r=0;r<e.length;r++)if(c=e[r],a=ln(n,c.name()),(s=(u=c.comments)&&u.all())&&0<s.length)for((f=S.Util.Ur(n,a)).c_.push({n_:"shapetype",id:"_x0000_t202",coordsize:"21600,21600",spt:"202",path:"m,l,21600r21600,l21600,xe",c_:[{n_:"stroke",joinstyle:"miter"},{n_:"path",gradientshapeok:"t","o:connecttype":"rect"}]}),a=u.Pfe||{n_:"authors",c_:[{n_:"author",c_:["Author"]}]},h=n[bn+c.wp]={n_:bn,r_:[13,14,15,16],c_:[a,{n_:"commentList",c_:[]}]},l=S.Util.qr(c.wp,f),v=0;v<s.length;v++)(d=(m=s[v]).wh(l)).commentData&&(d.commentData.lossless={showShadow:m.showShadow(),indicatorSize:m.indicatorSize(),indicatorColor:m.indicatorColor(),ignoreDefaultLocation:m.ignoreDefaultLocation(),commentState:m.commentState()}),l++,f.c_.push(d.vmlDrawingData),h.c_[1].c_.push(d.commentData)}})},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},Touch:function(n){n.exports=GC.Spread.Sheets.Touch}},i={},n=e("./dist/plugins/comment/comment.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Comments=n}();