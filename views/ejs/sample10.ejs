<div class="content_top">
    <div class="cont_tit">인사평가 진행 현황</div>
    <div class="div">
      <button class="btn_search">
        <span id="addRow">행추가</span>
      </button>
      <button class="btn_search">
        <span id="saveRow">저장</span>
      </button>
      <button class="btn_search">
        <i class="ico_srch"></i>
        <span>search</span>
      </button>
    </div>
  </div>
          
  <div class="search_box active">
    <table class="srch_tbl">
        <colgroup>
        <col width="10.9%">
        <col width="*">
        <col width="10.9%">
        <col width="*">
        <col width="10.9%">
        <col width="*">
        </colgroup>
        <tbody>
        <tr>
            <th>조회일자</th>
            <td class="ipt_date_wrap">
                <div class="ipt_date_div">
                    <input type="text" class="ipt_date datepicker">
                </div>
                <span class="line">-</span>
                <div class="ipt_date_div">
                    <input type="text" class="ipt_date datepicker">
                </div>
            </td>
            <th>영업담당자</th>
            <td>
                <select>
                    <option>선택</option>
                    <option>박OO</option>
                    <option>김OO</option>
                    <option>이OO</option>
                    <option>차OO</option>
                </select>
            </td>
            <th>파트</th>
            <td>
                <select>
                    <option>선택</option>
                    <option>서울 남부</option>
                    <option>서울 북부</option>
                    <option>경기 북부</option>
                    <option>경기 남부</option>
                    <option>강원 전지역</option>
                </select>
            </td>
        </tr>
        </tbody>
    </table>
  </div>

<div class="content_box" style="height: calc(100vh - 360px);">
    <div class="sample-tutorial">
        <div id="ss" class="sample-spreadsheets"></div>
        <div id="optionContainer" class="optionContainer">
        </div>
    </div>
</div>


<style>
.sample-tutorial {
   position: relative;
   height: 100%;
   overflow: hidden;
}

body {
   position: absolute;
   top: 0;
   bottom: 0;
   left: 0;
   right: 0;
}

.sample-spreadsheets {
   width: 100%;
   height: 100%;
   overflow: hidden;
   float: left;
}

</style>
<script>
  /*REPLACE_MARKER*/
/*DO NOT DELETE THESE COMMENTS*/
var sheet, data;
window.onload = function() {
    data = getData();
    var spread = new GC.Spread.Sheets.Workbook(document.getElementById("ss"), { sheetCount: 0 });
    initSpread(spread);

    $('#saveRow').on('click', function() {
        if(sheet.getChanges().length == 0) {
            alert('변경 사항이 없습니다.');
        } else {
            alert(sheet.getChanges().length + '개의 행이 저장되었습니다.');
        }
    });

    $('#addRow').on('click', function() {
        sheet.addRow({c1:'',c2:'',c3:'',c4:''});
    });
};


function initSpread(spread) {
    spread.suspendPaint();
    spread.options.autoFitType = GC.Spread.Sheets.AutoFitType.cellWithHeader;

    //init a data manager
    var dataManager = spread.dataManager();
    //add product table
    var productTable = dataManager.addTable("productTable", {
        data: data,
        schema: {
            columns: {
                c1: { lookup: ["서울 남부", "서울 북부", "경기 북부", "경기 남부", "강원 전지역"] },
                c2: { lookup: ["박OO", "김OO", "이OO", "차OO"] }
            }
        }
    });

    //init a table sheet
    sheet = spread.addSheetTab(0, "TableSheet1", GC.Spread.Sheets.SheetType.tableSheet);
    sheet.applyTableTheme(GC.Spread.Sheets.Tables.TableThemes.professional4);
    sheet.options.allowAddNew = false; //hide new row
    sheet.setDefaultRowHeight(40, GC.Spread.Sheets.SheetArea.colHeader);

    //bind a view to the table sheet
    var style = { formatter: 'yyyy/MM/dd' };
    var myView = productTable.addView("myView", [
        { value: "c1", width: 200, caption :"파트" },
        { value: "c2", width: 200, caption :"영업담당자" },
        { value: "c3", width: '*', caption :"금주업무" },
        { value: "c4", width: '*', caption :"차주업무" },
    ]);
    myView.fetch().then(function() {
        sheet.setDataView(myView);
    });

    spread.resumePaint();
}

function getData() {
  let arr = [];

  for(var i = 1; i < 6; i++) {
    let obj = {};
    obj.c1 = getRandomArrayElement(["서울 남부", "서울 북부", "경기 북부", "경기 남부", "강원 전지역"]);
    obj.c2 = getRandomArrayElement(["박OO", "김OO", "이OO", "차OO"]);
    obj.c3 = getRandomArrayElement(['GO건설 바닥 시공 공수 산정', '지역 대리점 방문', 'GO건설 영업 일지 문서화', '신입 OJT 교육', '금년 계획 PT']);
    obj.c4 = getRandomArrayElement(['GO건설 바닥 시공 공수 산정', '지역 대리점 방문', 'GO건설 영업 일지 문서화', '신입 OJT 교육', '금년 계획 PT']);

    arr.push(obj);
  }

  function getRandomDate(start, end) {
      const startDate = start.getTime();
      const endDate = end.getTime();
          
      return new Date(startDate + Math.random() * (endDate - startDate));
  }

  function getRandomArrayElement(arr) {
      return arr[Math.floor(Math.random() * arr.length)]
  }


  return arr;
}

function traverseSelectionsRowsWithOperation(operation) {
    if (selections) {
        selections.sort(function(a, b){
            return b.row - a.row;
        });
        for (var i = 0; i < selections.length; i++) {
            var selection = selections[i];
            var row = selection.row;
            var rowCount = selection.rowCount;
            for (var r = row + rowCount - 1; r >= row; r--) {
                operation(r);
            }
        }
    }
}
</script>