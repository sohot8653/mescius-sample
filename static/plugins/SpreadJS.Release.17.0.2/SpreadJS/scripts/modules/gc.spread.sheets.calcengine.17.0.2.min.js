/*!
 * 
 * SpreadJS Library 17.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var i,r,n;function e(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,e)),t.exports}i={"./dist/plugins/sheetsCalc/calc-extra-save.js":function(n,t,i){var u,s,e,r,a,c,h,l,v,d,w;function f(n){var t,i,r,e;if(Array.from)return Array.from(n.keys());for(t=[],i=0,r=n.keys();i<r.length;i++)e=r[i],t.push(e);return t}function o(f,o,s){for(var n,t,n=function(n){var t,n,e,i,r,t=o[n];if(t.l)for(n=m(t.k),e=f.oT(n[1],n[2],!0),t.v&&f.nbt(e),t.b,e.aT=t.l.map(function(n){return parseInt(n,10)}),i=function(n){var r=t.l[n];e[r]=(0,u.createMap)(),t[r].map(function(n){var t,i,i,t=m(n),i=t[0];"?"!==i[0]&&"!"!==i[0]||(i=i.slice(1)),i=s[i],e[r].set(n,i.oT(t[1],t[2],!0))})},r=0;r<t.l.length;r++)i(r)},t=0;t<o.length;t++)n(t)}function m(n){return n.split(",").map(function(n,t){return n=0<t?parseInt(n,10):n})}function C(n,t,i){var r,e,f,o,s,u,a,c,h,c,r=n.uT(!0);for(e in t.l)if(t.l.hasOwnProperty(e))for(o in f=t[e])if(f.hasOwnProperty(o))for(s=o.split(",").map(function(n,t){return"?"!==n[0]&&"!"!==n[0]||(n=n.slice(1)),parseInt(n,10)}),u=0;u<f[o].length;u++)c=(h=i[c="?"!==(c=(a=m(f[o][u]))[0])[0]&&"!"!==c[0]?c:c.slice(1)]).oT(a[1],a[2],!0),r.processListener(parseInt(e,10),s[0],s[1],s[2],s[3],c,!0)}function _(n){var t,i,t=null;return(n.isVolatile||n.ebt||n.aT&&0<n.aT.length)&&((t={}).k=n.getKey(),n.isVolatile&&(t.v=!0),n.ebt&&(t.b=!0),n.aT)&&n[0]&&(i="0",t[0]=f(n[0]),t.l=n.aT),t}function p(n){var t,i,r,e,f,o,r,n,t=[],i=n.dataTable;for(f in i)if(i.hasOwnProperty(f)&&(o=i[f]))for(e in o)o.hasOwnProperty(e)&&(r=o[e])&&(r=_(r.calc))&&t.push(r);return(n=g(n))&&t.push(n),t}function g(n){var n,t,i,r,e,n=n.uT();if(n)return t={k:"rangeCalc"},i="0",r=n[0],e={},r&&r.forEach(function(n,t){e[t]=f(n.content)}),t[0]=e,t.l=n.aT,t}function b(n,t){var i,r,e,f,o,s,i={};if(t&&t.idMap){for(f in e={},r=n.rO)r.hasOwnProperty(f)&&(e[r[f].getSource().getName()]=r[f]);for(f in o=t.idMap)o.hasOwnProperty(f)&&(s=o[f],i[f]=e[s])}return i}function x(n){var t,i,r,t=n.rO,i={};for(r in t)t.hasOwnProperty(r)&&(i[r]=t[r].getSource().getName());return i}function y(n,t){return R(n,t)}function R(n,t){var i,r,e,f,o,i,i,r=n.t;if(4===r||2===r||3===r||8===r||100===r)(e=new u.Expression(r)).value=n.v;else{if(5===r)(e=new u.Expression(5)).value=u.CalcError.ibt(n.v);else if(6===r)(e=new u.Expression(6)).value=new u.CalcArray(n.v);else if(9===r)e=(0,u.rbt)(n.o,R(n.v,t),n.w&&R(n.w,t));else if(10===r)(e=new u.Expression(10)).value=R(n.v,t);else if(11===r)e=new u.Expression(11);else if(7===r)for(e=new u.Expression(7),n.f&&(e.function=R(n,t)),n.n&&(e.function=t.getFunction(n.n),e.functionName=n.n),f=e.arguments=[],o=0;o<n.p.length;o++)n.p[o]&&(f[o]=R(n.p[o],t));else 1===r?(e=new u.ReferenceExpression(1),(i=n.v.split("*"))[0]&&(e.source=t.getExternalSource("",i[0])),i[1]&&(e.endSource=t.getExternalSource("",i[1])),i[2]&&(e.row=parseInt(i[2],10)),i[3]&&(e.column=parseInt(i[3],10)),i[4]&&(e.endRow=parseInt(i[4],10)),i[5]&&(e.endColumn=parseInt(i[5],10)),i=parseInt(i[6],10),e.rowRelative=!!(i&a),e.columnRelative=!!(i&c),e.endRowRelative=!!(i&h),e.endColumnRelative=!!(i&l),e.isFullRow=!!(i&v),e.isFullColumn=!!(i&d),e.isArrayReference=!!(i&w),e.isFullRow&&(e.column=e.endColumn=u.BAND_INDEX_CONST),e.isFullColumn&&(e.row=e.endRow=u.BAND_INDEX_CONST)):13===r?(e=new s.obt,i=n.v,e.abt=i[0],e.source=i[1],e.ubt=i[2],e.sbt=i[3],e.cbt=i[4],e.fbt=i[5],e.lbt=i[6],e.hbt=i[7],e.source=t.getExternalSource("",e.source),e.abt=t.getTableByName(e.abt)):e&&e.type;n.es&&(e.ensureSingle=!0)}return e}function j(n){return N(n)}function N(n){var t,i,r,r;if(!n)return n;if(t={t:n.type},n.ensureSingle&&(t.es=1),4===n.type||2===n.type||3===n.type||8===n.type||100===n.type)t.v=n.value;else if(5===n.type)t.v=n.value._code;else if(6===n.type)t.v=n.value.array;else if(9===n.type)t.o=n.operatorType,t.v=N(n.value),t.w=n.value2&&N(n.value2);else if(10===n.type)t.v=N(n.value);else if(7===n.type)for((0,u.isExpression)(n.function)?t.f=N(n.function):n.functionName&&(t.n=n.functionName),t.p=[],i=0;i<n.arguments.length;i++)t.p[i]=N(n.arguments[i]);else 1===n.type?(r=(n.rowRelative&&a)|(n.columnRelative&&c)|(n.endRowRelative&&h)|(n.endColumnRelative&&l)|(n.isFullRow&&v)|(n.isFullColumn&&d)|(n.isArrayReference&&w),r=[n.source&&n.source.getName(),n.endSource&&n.endSource.getName(),n.row,n.column,n.endRow,n.endColumn,r],n.isFullRow&&(r[3]=r[5]=e),n.isFullColumn&&(r[2]=r[4]=e),t.v=r.join("*")):13===n.type?t.v=[n.abt.name(),n.source.getName(),n.ubt,n.sbt,n.cbt,n.fbt,n.lbt,n.hbt]:n.type;return t}Object.defineProperty(t,"__esModule",{value:!0}),t.exprToJSON=t.exprFromJSON=t.dbt=t.vbt=t.mbt=t.gbt=t.pbt=void 0,u=i("CalcEngine"),s=i("./dist/plugins/sheetsCalc/parser-sheets.js"),e=null,r=void 0,a=1,c=2,h=4,l=8,v=16,d=32,w=64,t.pbt=o,t.gbt=C,t.mbt=p,t.vbt=b,t.dbt=x,t.exprFromJSON=y,t.exprToJSON=j},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(j,n,t){var i,G,r,p,g,P,m,$,N,F,u,b,T,L,Y,V,X,J,x,H,W,U,K,Q,y,k,A,I,O,R,t,t,e,E,s,a,c,S,M,D,f,e,Z,o,h,q,z;function l(n,t,i,r,e,f){var o=this;o.Zc=n,o.FY=i,o.jpt=r,o.WK=t,H(e)||(o.TZ=e),o.t1e="boolean"==typeof f&&f}function v(n,t,i,r,e,f,o){var n,r,n=Z.call(this,n,r,e,f,o)||this,r=n;return r.bbt=t,r.ybt=i,n}function nn(n){var t=o.call(this,L)||this;return t.references=n,t}function tn(n){var t,i,r,e,f,o;if(!(n<0||(t=a[n]))){for(i=n,e=(r="").length,n+=1;0<n;n=Math.floor((n-1)/26))f=r.substring(0,e),o=r.substring(e),r=f+String.fromCharCode(65+(n-1)%26)+o;t=r.toString(),a[i]=t}}function d(n,t,i,r){var e,t,f,o;for(void 0===r&&(r={}),e=h.call(this,n&&n.Uw(r.sheetArea),t,i,r)||this,n||(n=d.wbt=d.wbt||new G.Worksheet,e.source)||(e.source=n.Uw(r.sheetArea)),e.Mf=n,e.row=i&&i.row||0,e.column=i&&i.col||0,f=(t=n.getCalcService()).getResolvers(),o=0;o<f.length;o++)if(f[o]instanceof g.SheetReferenceResolver)return e;return t.addResolver(new g.SheetReferenceResolver(n)),t.addResolver(new g.StructureReferenceResolver(n)),e}function rn(n){n.indexOf("LET(")}function w(n,t,i){var i=q.call(this,i)||this;return i.getCalcSourceModel=function(){return this.Mbt},i.createSourceModel=function(n){var n=new P.CalcSourceModel(n,this);return n.usedRange=new G.BaseUsedRange,n},i.getRangeKey=function(n,t){return n.id+","+t.row+","+t.col+","+t.rowCount+","+t.colCount},i.getSheetRangeReference=function(n){var t,t,i,r,e,f,o,t=this.Mf,t=t&&t.parent;if(n.endSource&&t&&t.sheets&&n.endSource instanceof w){for(i=t.sheets,r=!1,e=void 0,f=[],o=0;o<i.length;o++){if((e=i[o].Uw())===this)r=!0;else if(e===n.endSource){f.push(e.getReference(n));break}r&&f.push(e.getReference(n))}return new s(f)}},i.Mf=n,i.t8=new N.Z8(i),i.nT=t||3,i}function C(n){var t=z.call(this,L)||this;return t.createSourceModel=function(n){return new P.CalcSourceModel(n,this)},t.vpt=n,t.Cbt={},t}function en(n,t,i,r,e,f){var n,o,n,n=n&&n instanceof G.Worksheet&&n,o=new P.Parser;return i=i===Y?0:i,r=r===Y?0:r,n=new c(n,!!e,(0,P.eV)(i,r)),f&&(n.culture=!0),o.parse(n,t)}function B(n,t,i,r,e,f){var n,o,e,n=n&&n instanceof G.Worksheet&&n,o=new P.Parser;return i=i===Y?0:i,r=r===Y?0:r,(e=new c(n,!!e,(0,P.eV)(i,r))).Sbt=f,e.Nme=n&&n.vle,o.unparse(e,t)}function fn(n,t,i,r,e){var f;return on(n,en(n,t,i=i===Y?0:i,r=r===Y?0:r,e,!0),i,r)}function on(n,t,i,r,e){var f,o,n,f=n.op();return i===Y&&(i=n.getActiveRowIndex()),r===Y&&(r=n.getActiveColumnIndex()),o=!0,e&&e.convertNullToZero!==Y&&(o=e.convertNullToZero),n=n.Uw(e&&e.sheetArea),f.evaluateParsedFormula(n,t,(0,P.eV)(i,r),!1,o)}function sn(n,t,i,r,e){var f,o,e,n,f=n.op();return i===Y&&(i=n.getActiveRowIndex()),r===Y&&(r=n.getActiveColumnIndex()),o=!0,e&&e.convertNullToZero!==Y&&(o=e.convertNullToZero),e=n.Uw(),(n=(0,P.eV)(i,r)).Tbt=Math.random().toString(36).substring(2),f.Abt(e,t,n,o)}function _(n,t,i,r,e){var f,o,s,u,a,c,h,l,v,d,w,f=n.row,o=n.col,s=n.row+n.rowCount-1,u=n.col+n.colCount-1,a=!1,c=!1,h=!1,l=!1;return 4<=arguments.length&&(f-=(a=0!=(1&r))?t:0,s-=(c=0!=(4&r))?t:0,o-=(h=0!=(2&r))?i:0,u-=(l=0!=(8&r))?i:0),e&&(d=an(n,e,t),w=cn(n,e,t),d)&&w?g.StructureReferenceResolver.create(e,d,w,n.col-e.dataRange().col,n.col+n.colCount-e.dataRange().col-1):1===n.rowCount&&1===n.colCount?(0,P.knt)(L,L,f,o,a,h):(n.row<0&&(f=s=m.BAND_INDEX_CONST),n.col<0&&(o=u=m.BAND_INDEX_CONST),(0,P.lJ)(L,L,f,o,s,u,a,h,c,l,t,i))}function un(n){return 0<=n.indexOf("[")&&1<n.indexOf("]")}function an(n,t,i){if(1===n.rowCount){if(t.hasHeadersRow()&&n.row===t.startRow())return 2;if(t.hasTotalsRow()&&n.row===t.endRow())return 8;if(i===n.row)return 1}else{if(t.hasHeadersRow()&&n.row===t.startRow()){if(n.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1+1)return 14}if(n.row===t.dataRange().row){if(n.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1)return 12}}return Y}function cn(n,t,i){return n.col===t.startColumn()&&n.colCount===t.dataRange().colCount?1:1===n.colCount?2:n.col>=t.startColumn()&&n.col+n.colCount-1<=t.endColumn()?4:Y}function hn(n,t,i,r,e){var n,r,f,e,n=_(n,t,i,r),r=new c(L,!!e,(0,P.eV)(t,i)),f,e=(new P.Parser).unparse(r,n);return r.L0(),e}function ln(n,t,i,r,e,f,o){var t,e,s,t=_(t,i,r,e,o),e=new c(n,!!f,(0,P.eV)(i,r)),s;return(new P.Parser).unparse(e,t)}function vn(n,t,i,r){var e,t,f,o,s,u,a,c,h,s,u;if(!t)return null;if(i=i||0,r=r||0,o=!1,(t=(e=n.op()).parse(n.Uw(),t,i,r,!0,!0))&&(7===t.type&&"ANCHORARRAY"===t.functionName&&(t=t.arguments[0],o=!0),!(f=t.source)||13!==t.type)&&1===t.type&&t.endSource){for(s=t.source,u=t.endSource,a=s.getSources(u),c=!1,h=0;h<a.length;h++)if(a[h]===n.Uw()){c=!0;break}t=c&&t}return t&&t.getRange&&(!f||f===n.Uw())&&(s=t.getRange(i,r))?(o&&(u=new P.CalcReference(n.qgt,[s]).getSpillRef())&&u.$gt&&(s=u.$gt[0]),new G.Range(s.row,s.col,s.rowCount,s.colCount)):null}function dn(n,t,i,r,e,f,o){var s,u,a,c,h,o,l,v,d,w,m,C,_,p,s=[],u=[];if(t)if(i=i||0,r=r||0,o)try{a=en(n,t,i,r),(c=n.Lp.evaluateExpression(n.qgt,a,{row:i,col:r},!1,!0))&&c.$gt&&(c.$gt.forEach(function(n){u.push(new G.Range(n.row,n.col,n.rowCount,n.colCount))}),s.push({sheetName:c.rT.getName(),ranges:u}))}catch(n){}else for(h={},o=new P.Parser,l=g.Vgt(o,t,n,i,r,Y,e,f),v=0;v<l.length;v++)if((d=l[v].sheetRanges)&&!T(d))for(w=0;w<d.sheets.length;w++)for(m=d.sheets[w],(u=h[m])||(h[m]=u=[],s.push({sheetName:m,ranges:u})),C=d[m],_=0;_<C.length;_++)p=C[_],H(p)||u.push(new G.Range(p.row,p.col,p.rowCount,p.colCount));return s}function wn(n,t,i,r,e){var f,e,f,f=new P.Parser,e=new c(L,!!e,(0,P.eV)(t,i)),f=mn(f,e,n,t,i,r);return e.L0(),f}function mn(n,t,i,r,e,f,o){for(var s,u,a,a,c,s="",u=0;u<i.length;u++)a=_(i[u],r,e,f),a=n.unparse(t,a),s+=0<u?(c=o&&p.Common.CultureManager.Fe().NumberFormat.listSeparator||",")+" "+a:a;return s}function Cn(n,t,i,r,e,f,o){var s,u,a,c,h,l,v,d,w,m,C,_,s=r.getValue(t,i),v=!1,d=100,w=.001,m=.01,a=(y(s)?+s:0)-o,u=r.getValue(e,f),h=(y(u)?+u:0)-o;if(y(u)&&Math.abs(h)<w)v=!0;else if(x(u))v=!1;else for(c=a+(0===a?m:m*a),C=0;!v&&C<d;C++)c=p.Common.st.E8(c,13),n.setValue(t,i,c),u=r.getValue(e,f),l=(y(u)?+u:0)-o,y(u)&&Math.abs(l)<w?v=!0:c=x(u)?(a+c)/2:a-c==0?a+(0===a?m:m*a):h-l==0?a+2*(c-a):(_=c-l*(a-c)/(h-l),a=c,h=l,_);return v||n.setValue(t,i,s),v}i=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}f(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.goalSeek=n.RangeReferenceRelative=n.Ibt=n.rangesToFormula=n.formulaToRanges=n.formulaToRange=n.rangeToFormulaWithStructReference=n.rangeToFormula=n.isValidExternalReference=n.rangeToExpression=n.xbt=n.evaluateExpression=n.evaluateFormula=n.expressionToFormula=n.formulaToExpression=n.SpreadSource=n.SheetSource=n.SheetParserContext=n.SheetRangeReference=n.FormatterNameInfo=n.NameInfo=n.ReferenceStyle=void 0,G=t("Core"),r=t("Core"),p=t("Common"),g=t("./dist/plugins/sheetsCalc/parser-sheets.js"),P=t("CalcEngine"),m=t("./dist/plugins/sheetsCalc/calc.ns.js"),$=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),N=t("./dist/plugins/sheetsCalc/dynamic-array.js"),F=p.Common.lt,u=p.Common.zf,b=F.Dh,T=F._h,L=null,Y=void 0,(V=["v","n","s","b","d","sn"])[11]="an",X=P.Errors.Value,J=p.Formatter&&p.Formatter.GeneralFormatter,x=P.Convert.BJ,H=F.ht,W=G.mt.xr,U=G.range_parser.jc,K=G.mt.vo,Q=G.Util.addXLFNPrefix,y=function(n){return P.Convert.q8(n,!0)},k=G.Range.prototype.contains,A=u.Gmt,I="number",O=G.UsedRangeUtil.updateUsedRangeByData,R="__hyperlink__",(t=P.CalcSource.prototype).referenceToArray=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,y,R,u=this,h=1,l=1,m=[],w=n.getRangeCount();if(0===w)m.isError=!0;else{for(p=u.getRowCount(),g=u.getColumnCount(),i=i===Y||i,b=0;b<w;b++){if(i||m.push(_=[]),0===(h=n.getRowCount(b)))return m.isError=!0,m;if(0===(l=n.getColumnCount(b)))return m.isError=!0,m;if(v=n.getRow(b),d=n.getColumn(b),2!==i){if(p<=v||g<=d)return(m=[L]).rowCount=1,m.colCount=1,m.rangeCount=1,m;g<d+l&&(l=g-d)}for(p<v+h&&(h=p-v),x=void 0,y=0;y<h;y++)for(a=v+y,i||_.push(x=[]),R=0;R<l;R++){if(C=u.getValue(a,c=d+R),r&&P.Convert.BJ(C))return(m=[C]).isError=!0,m;if(C=P.Convert.Nbt(C,t,!P.ExcelCompatibleCalcMode,f,s),e&&C===P.Convert.CalcConvertedError)return(m=[X]).isConvertError=!0,m;C===L&&f||(2===i?m[y*l+R]=C:(i?m:x).push(C))}}(m=i||1!==w?m:m[0]).rowCount=h,m.colCount=l,m.rangeCount=w}return m},t.getSheetReference=function(){var n=this;return n.kbt=n.kbt||new P.CalcReference(n),n.kbt},(e=t=n.ReferenceStyle||(n.ReferenceStyle={}))[e.a1=0]="a1",e[e.r1c1=1]="r1c1",r.ReferenceStyle=t,l.prototype.getName=function(){return this.Zc},l.prototype.getRow=function(){return this.FY},l.prototype.getColumn=function(){return this.jpt},l.prototype.getExpression=function(){return this.WK},l.prototype.getComment=function(){return this.TZ},l.prototype.SB=function(n,t){t&&t.push({type:"customName",nameInfo:this,expr:this.WK}),this.WK=n},l.prototype.isReadOnly=function(n){return"boolean"==typeof n&&(this.t1e=n),this.t1e},n.NameInfo=e=l,r.NameInfo=e,i(v,Z=e),v.prototype.getFormatter=function(){return this.bbt},v.prototype.getSheetTabName=function(){return this.ybt},n.FormatterNameInfo=v,P.CalcSource.prototype.createSourceModel=function(n){return new P.CalcSourceModel(n,this)},o=P.CalcReference,i(nn,o),nn.prototype.toArray=function(n,t,i,r,e){for(var f,o,s,u,f=this.references,o=[],s=0;s<f.length;s++){if((u=f[s].rT.referenceToArray(f[s],n,t,i,r,e)).isError&&i)return u;t?Array.prototype.push.apply(o,u):o.push(u),s||(o.rowCount=u.rowCount,o.colCount=u.colCount)}return o.rangeCount=f.length,o},s=nn,n.SheetRangeReference=s,a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],h=P.ParserContext,i(d,h),d.prototype.getExternalSource=function(n,t){var i,r,e,f,o,s,i=this,r=i.Mf.parent,e=i.Mf.Uw();if(n&&(!r||r.name!==n))return L;if(!r)return u.Dbt(i.Mf.name(),t)?e:L;if(un(t))return r._p.parseSource(t,e.G3);if((f=r.sheets)&&0<f.length)for(o=0;o<f.length;o++)if(s=f[o],u.Dbt(s.name(),t))return s.Uw();return P.ParserContext.prototype.getExternalSource.call(this,n,t)},d.prototype.getExternalSourceToken=function(n){return n.getName(this)},d.prototype.getTableByName=function(n){var t,i,r,e,f,t=this.Mf.tables,i=!0,r=t?t._bt(n,!0):L;if(!r&&(e=this.Mf.parent&&this.Mf.parent.sheets))for(f=0;f<e.length&&(!(t=e[f].tables)||!(r=t._bt(n,!0)));f++);return r||this.Mf.parent&&this.Mf.parent.Ofe(n)},d.prototype.getTableByIndex=function(n,t){var i=this.Mf.tables;return i?i.Hq(n,t,!0):L},d.prototype.setSource=function(n){var n=this.source=n;n&&n.getSheet&&(this.Mf=n.getSheet())},d.prototype.L0=function(){this.Mf&&this.Mf!==d.wbt&&this.Mf.L0(),this.Mf=L},c=d,n.SheetParserContext=c,S=new p.Common.ResourceManager(G.SR),q=P.CalcSource,i(w,q),w.prototype.getReferenceSheetNames=function(){return this.Ebt||{}},w.prototype.addReferenceSheetName=function(n){var t=this;t.Ebt||(t.Ebt={}),t.Ebt[n]=1},w.prototype.setReferenceSheetNames=function(n){this.Ebt=n},w.prototype.startCalculation=function(){this.jbt||(this.Obt(),this.K5=[])},w.prototype.endCalculation=function(n){this.jbt=L,this.Rbt=L,!1!==n&&this.Bbt(),this.K5=L},w.prototype._F=function(){var n=this;n.Fbt?n.K5&&(n.Pbt=n.Pbt.concat(n.K5),n.K5=[]):(n.Pbt=n.K5||[],n.Fbt=setTimeout(function(){n.Bbt(n.Pbt),delete n.Pbt,delete n.Fbt},0))},w.prototype.Bbt=function(n){var t,n,i,t,n=n||this.K5;n&&0<n.length&&(t=null==(t=(i=this.Mf).Ut)?void 0:t.W_(3).B8,i.Ut)&&i.ki(G.Events.RangeChanged,{isUndo:!H(t&&t.vE),sheet:i,sheetName:i.name(),row:0,col:0,rowCount:i.getRowCount(),colCount:i.getColumnCount(),changedCells:n,action:6},i.QI)},w.prototype.clearValueCache=function(){this.Obt()},w.prototype.Obt=function(){var n=this.getRowCount(),t=this.getColumnCount();this.jbt={rowCount:n,colCount:t},this.Rbt={arrayInfo:[]}},w.prototype.Gw=function(){this.jbt=L,this.Rbt=L,this.K5=L},w.prototype.getValue=function(n,t){for(var i,r,e,f,o,s,u,n,a,c,h,l,v,d,w,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(f=(e=this).Mf,typeof n==I)o=n,s=arguments[1],t=arguments[2],u=arguments[3];else if(n.row!==Y)o=n.row,s=n.col;else if(n.name)return null;return n=e.nT,o<0||s<0?X:f.Gbt&&f.Ubt===o&&f.Hbt===s?f.zbt:(a=e.jbt,c=V[t=t||0],a?(h=a.rowCount,l=a.colCount,w=d=v=void 0,h<=o||l<=s?L:((w=(d=(d=(v=(v=a[o])||(a[o]={}))[s])||(v[s]={v:u?f.getValueIgnoreDefault(o,s,n):f.getValue(o,s,n)}))[c])===Y&&(w=P.Convert.Nbt(d.v,t,!P.ExcelCompatibleCalcMode),d[c]=w),G.mt.V0(w))):o>=e.getRowCount()||s>=e.getColumnCount()?L:u?e.Mf.getValueIgnoreDefault(o,s,n):e.Mf.getValue(o,s,n))},w.prototype.getIdentity=function(n,t){var i,r,e,f,t,i=this,r=t.row,e=t.rowCount||1,f=t.column,t=t.columnCount||1;return-1===r&&(r=0,e=i.getRowCount()),-1===f&&(f=0,t=i.getColumnCount()),i.getName()+"."+r+"."+e+"."+f+"."+t},w.prototype.getReference=function(n){var t=this,i=n.row,r=n.col;return-1===i&&(n.row=0,n.rowCount=t.getRowCount(),n.rowUndefine=!0),-1===r&&(n.col=0,n.colCount=t.getColumnCount(),n.colUndefine=!0),new P.CalcReference(t,[n])},w.prototype.getSources=function(n){var t,i,r,e,f;if(this.Mf&&this.Mf.parent&&this.Mf.parent.sheets&&n instanceof w){for(t=this.Mf.parent.sheets,i=!1,r=void 0,e=[],f=0;f<t.length;f++){if((r=t[f].Uw())===this&&(i=!0),r===n){e.push(r);break}i&&e.push(r)}return e}},w.prototype.Vbt=function(r,e){var n,f,o,s,n,f=this.Rbt,o=f&&f.arrayInfo;o&&(s=!1,o.forEach(function(n,t){var i,n;n&&(i=n.reference,n=n.key,k.call(i.$gt[0],r,e))&&(delete f[n],o[t]=Y,s=!0)}),s)&&(f.arrayInfo=[],o.forEach(function(n){n&&f.arrayInfo.push(n)}))},w.prototype.referenceToArray=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,A,I,O,E,S,M,D,l=h=1,m=[],p=(u=this).Mf,g=u.jbt,b=u.Rbt,R=V[t=t||0];if(0===(w=n.getRangeCount()))m.isError=!0;else{if(b&&(C=b[y=n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+i]))return C;for(j=this.getRowCount(),N=this.getColumnCount(),i=i===Y||i,k=0;k<w;k++){if(i||m.push(_=[]),0===(h=n.getRowCount(k)))return m.isError=!0,m;if(0===(l=n.getColumnCount(k)))return m.isError=!0,m;if(v=n.getRow(k),d=n.getColumn(k),2!==i){if(j<=v||N<=d)return(m=i?[L]:[[L]]).rowCount=1,m.colCount=1,m.rangeCount=1,m;N<d+l&&(l=N-d)}for(j<v+h&&(h=j-v),I=A=void 0,O=p.Gbt,E=0;E<h;E++)for(a=v+E,i||_.push(A=[]),g&&(g[a]||(g[a]={}),x=g[a]),S=0;S<l;S++){if(c=d+S,O&&p.Ubt===a&&p.Hbt===c)C=p.zbt,O=!1;else{if(g?(I=x[c])?C=I.v:(C=p.getValue(a,c,u.nT),I=x[c]={v:C}):C=p.getValue(a,c,u.nT),o&&(D=void 0,"@"===(D=(M=p.getFormatter())instanceof J?M.formatString():M)?C=p.getText(a,c):C instanceof Date&&(C=F.uJ(C)),T(I)||(I=x[c]={v:C})),r&&P.Convert.BJ(C))return(m=[C]).isError=!0,m;if(I&&I[R]!==Y)C=I[R];else if(C=P.Convert.Nbt(C,t,!P.ExcelCompatibleCalcMode,f,s),I&&(I[R]=C),e&&I===C)return(m=[X]).isConvertError=!0,m}P.Convert.Ybt(C,f)||(2===i?m[E*l+S]=C:(i?m:A).push(C))}}(m=i||1!==w?m:m[0]).rowCount=h,m.colCount=l,m.rangeCount=w,b&&(n.Zbt&&b.arrayInfo.length<200||!isNaN(w)&&!isNaN(h)&&!isNaN(l)&&100<w*h*l&&w*h*l<1e6&&b.arrayInfo.length<50)&&(b[y]=m,b[y].rowCount=h,b[y].colCount=l,b[y].rangeCount=w,b.arrayInfo.push({reference:n,key:y}))}return m},w.prototype.getColumnCount=function(){var n=this.Mf;return n.xT?0:n.getColumnCount(this.nT)},w.prototype.getRowCount=function(){var n=this.Mf;return n.xT?0:n.getRowCount(this.nT)},w.prototype.isHiddenRow=function(n,t){var i=this.Mf,r;return!!(i.iA&&i.iA()||!t)&&0===i.getRowHeight(n)},w.prototype.getName=function(){var n,t,n=this.nT,t=H(this.Wbt)?this.Mf.name():this.Wbt;return n===G.SheetArea.colHeader?t+"CH":n===G.SheetArea.rowHeader?t+"RH":t},w.prototype.setArray=function(n,t,i,r,e){return this.t8.setArray(n,t,i,r,e)},w.prototype.updateItem=function(n,t,i){return this.t8.updateItem(this,n,t)},w.prototype.HE=function(n,t){this.t8.HE(n,t)},w.prototype.setValue=function(n,t,i,r,e,f){var o,s,u,a,c,c,c,h,l,v,v,d,w,d,v,w,m,a,a,m,C,_,o=this,s=o.Mf,u=o.nT,a=o.jbt;!a||i&&i[R]||(c=a[n])&&(c=c[t])&&(c.v=i,c.b!==Y&&(c.b=Y),c.d!==Y&&(c.d=Y),c.n!==Y&&(c.n=Y),c.s!==Y&&(c.s=Y),c.sn=Y,c.an=Y),c=G.mt.Z0(i),h=s.Ut,l=!1,v=(v=s.tables)&&v.find(n,t),3===u&&v&&(d=v.showHeader()&&n===v.headerIndex(),w=v.showFooter()&&n===v.footerIndex(),d||w||(l=v.Kbt(n,t,c))),d=s.H3,3===u&&!l&&d&&d._dataSource&&(w=!1,(v=d.getValue(n,t)).hasBinding&&(m=void 0,m=a?(m=(a=a.bindingRows=a.bindingRows||{})[n])||(a[n]=b({},s.getDataItem(n))):b({},s.getDataItem(n)),h.dE(n,t,{gE:m,d6:v.value}),w=d.setValue(n,t,c,h.G8)),l="dataManagerBindingSource"===d.K$?w:v.hasBinding),a=s.pivotTables,3===u&&!l&&a&&(l=a.eJt(n,t,c)),!o.Qpe||f?(l||(!H(c)&&c[R]&&(m=c[R],h.setHyperlink&&h.do("setHyperlink",n,t,C={url:m}),c=c.toString()),h.do("setValue",n,t,c,u,!0,!0,e,!0,!0)),s.iL=!0,this.K5?this.K5.push({row:n,col:t,sheetArea:u}):s.ki(G.Events.CellChanged,{sheet:s,sheetName:s.name(),row:n,col:t,sheetArea:u,propertyName:"value",oldValue:r,newValue:i,KO:!0})):o.Qpe[_=u+" "+n+" "+t]=[n,t,u,c]},w.prototype.startIterativeCalc=function(){this.Qpe={}},w.prototype.endIterativeCalc=function(){var n,t,i,r,e,f,o,s,e,u,a,n=this,t=n.Mf,i=t.Ut;for(r in n.Qpe)Object.prototype.hasOwnProperty.call(n.Qpe,r)&&(f=(e=n.Qpe[r])[3],o=e[0],s=e[1],e=e[2],!H(f)&&f[R]&&(u=f[R],i.setHyperlink&&i.do("setHyperlink",o,s,a={url:u}),f=f.toString()),i.do("setValue",o,s,f,e,!0,!0,!1,!0,!0),t.iL=!0,this.K5?this.K5.push({row:o,col:s,sheetArea:e}):t.ki(G.Events.CellChanged,{sheet:t,sheetName:t.name(),row:o,col:s,sheetArea:e,propertyName:"value",KO:!0}));delete n.Qpe},w.prototype.getCustomFunction=function(n){return this.Mf?this.Mf.Jbt(n):L},w.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():L},w.prototype.getCustomNameInfo=function(n){return n=A(n),this.Mf?this.Mf.getCustomName(n):L},w.prototype.getSheet=function(){return this.Mf},w.prototype.setFormula=function(n,t,i,r,e){var f,o,s,u,a,o,a,f=this;if(f.Mf.Ut.G8&&(u=f.Mf.Ut.G8.formulas,s=f.getCalcSourceModel(),u=u||(f.Mf.Ut.G8.formulas={}),-1<=n)&&-1<=t){if((a=f.getCalcService()).backupR1C1Formula&&(o=f.Mbt.pB(n,t),i=B(f.Mf,o,n,t,!0,!1)),!r&&a.allowDynamicArray&&(r=f.Mbt.sT(n,t)),o=(o=u[n])||(u[n]={}),i&&"="===i[0]&&(i=i.substring(1)),a=o[t]&&o[t].formula,e){if(o[t]&&o[t].oldFormula)return void delete o[t].formula;r=b({},r),o[t]=b({},o[t],{oldFormula:i,oldArrayInfo:r}),i||delete o[t].oldArrayInfo}else o[t]=b({},o[t],{formula:i,arrayInfo:r}),i||delete o[t].arrayInfo;s.usedRange&&O(s.usedRange,n,t,a,i)}},w.prototype.setArrayFormula=function(n,t,i,r,e){var f;this.setFormula(n,t,e,{row:n,col:t,rowCount:i,colCount:r})},w.prototype.setFormulaByName=function(n,t,i){var r,e,r,r=this;r.Mf.Ut.G8&&((r=(r=(e=(e=r.Mf.Ut.G8.formulas)||(r.Mf.Ut.G8.formulas={})).names)||(e.names={}))[n]=b({},r[n],{formula:t,oldFormula:i}))},w.prototype.refresh=function(){var n=this.Mf.parent;n&&n.repaint()},w.prototype.toJSON=function(n,t,i,r,e){var f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,c,y,R,j,N,k,A,I,O,E,E,S,o=t,h=this.Mf,l=n.data||{},v=!0,d=this.op(),w=this===h.qgt,_=0;for(w&&(m=(0,P.createMap)(),h.Xbt=C={}),p=d.forceR1C1Formula,g=0;g<=i;g++)if(f=l.dataTable||{},s=o[g]){for(v=!(a=f[g]),a=a||{},b=0;b<=r;b++)if(x=(u=s[b])&&u.WK,c=u&&u.calc&&u.calc.isDefault(),u&&!c&&(x||u.qbt)){c=a[b]||{};try{R=y=void 0,w&&x&&!u.$bt&&(j=x.tyt=x.tyt||B(h,x,g,b,!0,!1)).indexOf("!")<0&&(!(N=m.get(j))||N.baseColumn>b?(R=d.unparse(this,u.WK,g,b,!1,!0)).indexOf("[")<0&&(p&&(R=j),m.set(j,{formula:R,baseRow:g,baseColumn:b})):(y=N.obj)?((A=C[y.si]).lastRow=g,A.lastColumn=Math.max(b,A.lastColumn)):(y=N.obj={si:_},C[_]={formula:N.formula,baseRow:N.baseRow,baseColumn:N.baseColumn,lastRow:g,lastColumn:b},(k=g===N.baseRow?a:f[N.baseRow])[N.baseColumn].formula=N.obj,_++)),R=p&&x?y||x.tyt||B(h,x,g,b,!0,!1):u.qbt||y||R||d.unparse(this,x,g,b,!1,!0),u.$bt?u.$bt.row===g&&u.$bt.col===b&&(c.arrayInfo=u.$bt,c.formula=R):c.formula=R,v=!1,a[b]=c}catch(n){}}if(v){if(f!==l.dataTable)continue}else f[g]=a;l.dataTable=f}if(C&&(C.nextIndex=_),e){for(I=l.columnDataArray||[],O=0;O<e.length;O++)(E=e[O])&&E.WK&&(E=this.op().unparse(this,E.WK,0,O,!1,!0),(S=I[O]||{}).formula=E,I[O]=S);0<I.length&&(l.columnDataArray=I)}T(l)||(n.data=l)},w.prototype.wh=function(n,T,L,Y,V,t){var r,i,e,f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,g,X,J,b,x,y,R,j,N,k,A,I,O,E,S,M,D,F,r=W(n,G.XFileConstants.bo),i=this.op();for(i.nyt=!0,u=G.Util.ko(t),v=0,(c=this===(a=this.Mf).qgt)&&(h=(0,P.createMap)(),a.Xbt=l={}),d=n.lossless.exprs=[],w=[],n.richValueDataArray=[],m=0;m<=L;m++)if(e=T[m],o=r[m],e)for(o=o||(r[m]={}),C=0;C<=Y;C++)if(f=e[C],s=o[C],_=f&&f.WK,g=!(p=[]),X=f&&f.calc&&f.calc.isDefault(),f&&!X&&_){s=s||{},u||7!==_.type||"IMAGE"!==_.functionName||(g=!0,3<(J=_.arguments).length&&(p=_.arguments.splice(5)));try{y=x=b=void 0,R=-1,(j=f.$bt)||(N=this.t8.Pme(m,C))&&(j={row:m,rowCount:N.maxX-m+1,col:C,colCount:N.maxY-C+1,isDynamicArray:!0},N.isValid||(j.isInvalid=!0)),c&&!j&&(k=_.tyt=_.tyt||B(a,_,m,C,!0,!1),u||k.indexOf("!")<0)&&(!(A=h.get(k))||A.baseColumn>C?(x=i.unparse(this,_,m,C,!1,!0)).indexOf("[")<0&&h.set(k,{formula:x,baseRow:m,baseColumn:C}):((b=A.obj)?((I=l[b.si]).lastRow=m,I.lastColumn=Math.max(C,I.lastColumn)):(b=A.obj={si:v},l[v]={formula:A.formula,baseRow:A.baseRow,baseColumn:A.baseColumn,lastRow:m,lastColumn:C},v++),y=b.si,x=void 0)),H(y)&&(x=f.qbt||x||i.unparse(this,_,m,C,!1,!0),t&&t.includeCalcModelCache&&(O=(0,$.exprToJSON)(_),f.eyt||(O.nw=1),d.push(O),R=d.length-1),x=K(Q(x))),j?(j.row===m&&j.col===C&&(E=U(j),(j.isInvalid||!j.rowCount)&&0<E.indexOf(":")&&(E=E.substring(0,E.indexOf(":"))),s.f=x,s.r=E),j.isDynamicArray&&(s.a="1",j.isInvalid||t.fileType!==G.OpenSaveFileType.excel||w.push(j))):(s.f=x,s.d="shared",s.g=y,s.c=1,g&&(S=s.v&&s.v.value.imageBase64Data,H(S)||(M={url:_.arguments[0]&&_.arguments[0].value,ref:G.IndexHelper.nr(C)+(m+1),f:x,structureMap:{}},_.arguments[1]&&!H(_.arguments[1].value)&&(M.structureMap.a=_.arguments[1].value),_.arguments[2]&&!H(_.arguments[2].value)&&(M.structureMap.s=_.arguments[2].value),_.arguments[3]&&!H(_.arguments[3].value)&&(M.structureMap.h=_.arguments[3].value),_.arguments[4]&&!H(_.arguments[4].value)&&(M.structureMap.w=_.arguments[4].value),M.imageBase64Data=S,n.richValueDataArray.push(M)),s.v="#VALUE!",s.t="e")),-1!==R&&(s.x=R)}catch(n){}g&&0<p.length&&(_.arguments=_.arguments.concat(p)),o[C]=s}for(D in l)Object.prototype.hasOwnProperty.call(l,D)&&(F=l[D],E=U(new G.Range(F.baseRow,F.baseColumn,F.lastRow-F.baseRow+1,F.lastColumn-F.baseColumn+1)),(s=r[F.baseRow][F.baseColumn]).r=E,s.g=parseInt(D,10));w.forEach(function(n){for(var t,i,t=n.row;t<n.row+n.rowCount;t++)for(i=n.col;i<n.col+n.colCount;i++)(s=r[t]&&r[t][i])&&(s.t2=!0)}),delete i.nyt},(n.SheetSource=M=w).prototype.getParserContext=function(n,t,i){return t=t||(0,P.eV)(0,0),new c(this.Mf,n,t,i)},z=P.CalcSource,i(C,z),C.prototype.addUsedCustomName=function(n){this.Cbt[n]=1},C.prototype.getUsedCustomNames=function(){return this.Cbt||{}},C.prototype.getCustomFunction=function(n){return this.vpt?this.vpt.getCustomFunction(n):L},C.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():L},C.prototype.getCustomNameInfo=function(n){return this.vpt?this.vpt.getCustomName(n)||this.vpt.xO(n):L},n.SpreadSource=C,n.formulaToExpression=en,n.expressionToFormula=B,n.evaluateFormula=fn,n.evaluateExpression=on,n.xbt=sn,n.rangeToExpression=_,n.isValidExternalReference=un,n.rangeToFormula=hn,n.rangeToFormulaWithStructReference=ln,n.formulaToRange=vn,n.formulaToRanges=dn,n.rangesToFormula=wn,n.Ibt=mn,n.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},n.goalSeek=Cn},"./dist/plugins/sheetsCalc/calc.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_COLUMN_COUNT=t.MAX_ROW_COUNT=t.BAND_INDEX_CONST=void 0;var i=i("Core");t.BAND_INDEX_CONST=-2147483648,t.MAX_ROW_COUNT=i.XmlConstants.Io,t.MAX_COLUMN_COUNT=i.XmlConstants.xo},"./dist/plugins/sheetsCalc/dynamic-array.js":function(n,t,i){var w,r,l,v,e,m,C,f;function a(n){return n.isValid}function o(n){return{row:n.minX,col:n.minY,rowCount:n.maxX-n.minX+1,colCount:n.maxY-n.minY+1,isValid:n.isValid}}function s(n){this.Gme=new r.Common.rbush,this.rT=n}Object.defineProperty(t,"__esModule",{value:!0}),t.Z8=void 0,w=i("Core"),r=i("Common"),l=i("CalcEngine"),v=i("CalcEngine"),e=null,m=void 0,C=r.Common.lt.ht,s.prototype.Ume=function(){return this.rT.Mf.Ut},s.prototype.L0=function(){this.rT=e,this.Gme=e},s.prototype.Fme=function(){var n=this.Gme.data;if(n&&isFinite(n.minX))return{minRow:n.minX,minCol:n.minY,maxRow:n.maxX,maxCol:n.maxY}},s.prototype.jme=function(n,t,i,r){return this.Gme.search({minX:n,minY:t,maxX:n+(i=void 0===i?1:i)-1,maxY:t+(r=void 0===r?1:r)-1})},s.prototype.Pme=function(t,i){return this.jme(t,i).filter(function(n){return n.minX===t&&n.minY===i})[0]},s.prototype.Hme=function(n,t){return this.jme(n,t).filter(a)[0]},s.prototype.zme=function(){var n,n,n=this.Ume();return n.G8?(n.G8.calc=n.G8.calc||[],(n=n.G8.calc).Vme=n.Vme||[],n.Vme):[]},s.prototype.Fgt=function(t,i,r,e){var f,o,s,n,u,f=this;void 0===r&&(r=1),void 0===e&&(e=1),o=this.jme(t,i,r,e),s=this,n=o.filter(function(n){return n.minX>=t&&n.minX<t+r&&n.minY>=i&&n.minY<i+e}),u=this.b3(),n.forEach(function(n){n.isValid&&u.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1),s.Rme(n),s.Lme(n,!0)}),o.filter(a).forEach(function(n){s.Rme(n),o=o.concat(f.jme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1))}),o.forEach(function(n){n.isValid||(s.Yme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1)?u.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1):u.gF(n.minX,n.minY,1,1))})},s.prototype.getAnchorCell=function(t,i){var n=this.jme(t,i).filter(function(n){return n.minX===t&&n.minY===i})[0];return n&&o(n)},s.prototype.getAnchorInfo=function(t,i,n){var r,r,r=this.jme(t,i),r=r.filter(function(n){return n.minX===t&&n.minY===i})[0]||r.filter(a)[0];return r&&o(r)},s.prototype.setValue=function(n,t,i,r){r?this.Ume().setValue(n,t,i,3,!0,!0,!1,!1,!0):this.pBt().setValue(n,t,i)},s.prototype.b3=function(){return this.rT.Mbt},s.prototype.pBt=function(){return this.rT},s.prototype.Rme=function(n,t,i,r){var e,f;if(n){if(n.isValid){for(e=n.minX;e<=n.maxX;e++)for(f=n.minY+(e===n.minX?1:0);f<=n.maxY;f++)this.setValue(e,f,m,i);n.isValid=!1,i&&this.zme().push([n,"isValid",!0]),t||this.setValue(n.minX,n.minY,v.Errors.Spill,i)}t&&(this.Lme(n,i),r||this.setValue(n.minX,n.minY,m,i))}},s.prototype.Lme=function(n,t){this.Gme.remove(n),t&&this.zme().push([n])},s.prototype.Bme=function(n,t){this.Gme.insert(n),t&&this.zme().push([m,n])},s.prototype.HE=function(n,t){this.Pme(n,t).isValid=!1},s.prototype.Yme=function(n,t,i,r,e){for(var f,o,s,u,a,c,h,c,l,v,d,f=this.Gme.search({minX:n,minY:t,maxX:n+i-1,maxY:t+r-1}),o=this.pBt(),s=this.b3(),u=0;u<f.length;u++)if((a=f[u]).isValid&&(a.minX!==n||a.minY!==t))return!1;if(t+r>o.getColumnCount()||n+i>o.getRowCount())return!1;if(c=(0,w.Ec)(n,t,i,r),(h=o.Mf).Ut.getSpans(c).length)return!1;if((c=h.tables)&&c.Pl&&c.Pl(n,t,i,r))return!1;for(l=n;l<n+i;l++)for(v=t+(l!==n||e?0:1);v<t+r;v++)if(d=o.getValue(l,v,m,!0),!C(d)||s.hasFormula(l,v,!0))return!1;return!0},s.prototype.Zme=function(n,t,i,r,e){var f;this.Gme.insert({minX:n,minY:t,maxX:n+i-1,maxY:t+r-1,isValid:e})},s.prototype.setArray=function(n,t,i,r,e,f,o){var s,u,a,c,h,s=this,u=this.Pme(n,t);if(u&&u.maxX===n+i-1&&u.maxY===t+r-1&&u.isValid||(s.Rme(u,!0,o),u={minX:n,minY:t,maxX:n+i-1,maxY:t+r-1,isValid:!0},f||(u.isValid=s.Yme(n,t,i,r)),s.Bme(u,o)),u.isValid)for(a=n;a<n+i;a++)for(c=t;c<t+r;c++)e&&e[a-n]&&(h=e[a-n][c-t],C(h)?h=0:(l.Convert.Nh(h)||l.Convert.LE(h))&&(h=1===h.getRowCount()&&1===h.getColumnCount()?l.Convert.Nh(h)?h.getValue(0,0):h.getValue(0,0,0):v.Errors.Calc),this.setValue(a,c,h,o));else this.setValue(n,t,v.Errors.Spill,o);return u.isValid},s.prototype.updateItem=function(n,t,i){var t=this.Pme(t,i);if(t)return this.Rme(t,!0),!0},s.prototype.rE=function(r,e){var f=this,n;f.jme(r,-1,l.MAX_ROW_COUNT,-1).forEach(function(n){var t,i;if(n.minX>=r)f.Gme.remove(n),n.minX+=e,n.maxX+=e,f.Gme.insert(n);else if(n.maxX>=r&&n.isValid){for(t=r;t<=n.maxX;t++)for(i=n.minY;i<=n.maxY;i++)f.pBt().setValue(t,i,f.pBt().getValue(t+e,i));for(t=n.maxX+1;t<=n.maxX+e;t++)for(i=n.minY;i<=n.maxY;i++)f.pBt().setValue(t,i,m)}})},s.prototype.aE=function(f,o,s){var u=this,n;u.jme(f,-1,l.MAX_ROW_COUNT,-1).forEach(function(n){var t,i,r,e;if(n.minX>=f+o)u.Gme.remove(n),n.minX-=o,n.maxX-=o,u.Gme.insert(n);else if(n.minX>=f)u.Rme(n,!0,s);else if(n.maxX>=f&&n.isValid)if(t=n.maxX>f+o-1?n.maxX+1:f+o,i=n.maxX>f+o-1?o:n.maxX-f+1,u.Yme(t,n.minY,i,n.maxY-n.minY+1,!0))for(r=n.maxX;f<=r;r--)for(e=n.minY;e<=n.maxY;e++)u.setValue(r+o,e,u.pBt().getValue(r,e),s);else u.Rme(n,!1,s)})},s.prototype.Eme=function(t,i){var r=this,n;r.jme(t,-1,l.MAX_ROW_COUNT,-1).forEach(function(n){n.minX>=t&&(r.Gme.remove(n),n.minX+=i,n.maxX+=i,r.Gme.insert(n))})},s.prototype.oE=function(r,e){var f=this,n;this.jme(-1,r,-1,l.MAX_COLUMN_COUNT).forEach(function(n){var t,i;if(n.minY>=r)f.Gme.remove(n),n.minY+=e,n.maxY+=e,f.Gme.insert(n);else if(n.maxY>=r&&n.isValid){for(t=n.minX;t<=n.maxX;t++)for(i=r;i<=n.maxY;i++)f.pBt().setValue(t,i,f.pBt().getValue(t,i+e));for(t=n.minX;t<=n.maxX;t++)for(i=n.maxY+1;i<=n.maxY+e;i++)f.pBt().setValue(t,i,m)}})},s.prototype.uE=function(f,o,s){var u=this,n;this.jme(-1,f,-1,l.MAX_COLUMN_COUNT).forEach(function(n){var t,i,r,e;if(n.minY>=f+o)u.Gme.remove(n),n.minY-=o,n.maxY-=o,u.Gme.insert(n);else if(n.minY>=f)u.Rme(n,!0,s);else if(n.maxY>=f&&n.isValid)if(t=n.maxY>f+o-1?n.maxY+1:f+o,i=n.maxY>f+o-1?o:n.maxY-f+1,u.Yme(n.minX,t,n.maxX-n.minX+1,i,!0))for(r=n.minX;r<=n.maxX;r++)for(e=n.maxY;f<=e;e--)u.setValue(r,e+o,u.pBt().getValue(r,e),s);else u.Rme(n,!1,s)})},s.prototype.Ome=function(t,i){var r=this,n;this.jme(-1,t,-1,l.MAX_COLUMN_COUNT).forEach(function(n){n.minY>=t&&(r.Gme.remove(n),n.minY+=i,n.maxY+=i,r.Gme.insert(n))})},s.prototype.Wme=function(n){for(var t,i,r,e,r,t=this,i=n.length-1;0<=i;i--)e=(r=n[i])[0],2<r.length?e[r[1]]=r[2]:1<r.length?t.Gme.remove(r[1]):(r=t.Pme(e.minX,e.minY),t.Rme(r,!0),t.Gme.insert(e))},t.Z8=s},"./dist/plugins/sheetsCalc/external-reference.js":function(n,t,i){var r,j,c,A,o,i,N,k,I,O,E,h,S,M,e,f,s,u,a;function l(n,t){var i,r;if(Array.isArray(n))n.forEach(t);else if("object"==typeof n)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&t(r=n[i],i)}function v(n){return n}function d(n){var n,t,n=n.value;return n&&n.richText?(t="",n.richText.forEach(function(n){t+=n.text}),t):n}function w(n,t,i){var r,n,e,i,r=a.call(this,O)||this;return r.getSheetRangeReference=function(n){var t,i,r,e,f,t=this.rT.sheetNames;if(n.endSource&&t&&n.source instanceof w){for(i=!1,r=[],e=0;e<t.length&&((i=t[e]===n.source.oyt?!0:i)&&(f=new w("["+this.rT.i+"]"+t[e],this.ayt,!0),r.push(f.getReference(n))),t[e]!==n.endSource.oyt);e++);return new o.SheetRangeReference(r)}return A.Errors.Name},n=n.split("]"),i&&(e=n[0].substring(1)),t.iyt[e]?r.rT=t.iyt[e]:(i=n[0].indexOf("["),r.rT=t.ryt(n[0].substring(i+1),n[0].substring(0,i),!0)),r.oyt=n[1],r.ayt=t,r}function m(n,t){var i,r,e;if(n)for(i in n)E(n,i)&&(e=(r=n[i]).getExpression())&&e.forEachNodes(function(n){(1===n.type||5===n.type||8===n.type)&&n.source instanceof f&&(t[n.source.rT.i]=!0)})}function C(n,t){var t=n.getRange(t.row,t.column);return t.sheetName=n.source.oyt,t}function _(n){this.iyt=n||{},this.uyt={},this.syt()}r=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}u(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalReferenceManager=t.ExternalSource=void 0,j=i("Core"),c=i("Common"),A=i("CalcEngine"),o=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c.Common.lt,N=j.XFileConstants.Rr,k=j.XFileConstants.Lr,I=void 0,O=null,E=c.Common.kh,h=i.ht,S=j.Util.wr,M=j.Util.Mr,e=/^'?\[\d+\]/,a=A.CalcSource,r(w,a),w.prototype.cyt=function(n,t,i){var r,e,r=n.getKey();this.rT=this.ayt.fyt(this.rT),this.eme(),e=this.ayt.uyt[this.rT.i]=this.ayt.uyt[this.rT.i]||{},t?e[r]?e[r][1].push(i):e[r]=[n,[i]]:e[r]&&delete e[r]},w.prototype.eme=function(){this.rT.data=this.rT.data||{};var n=this.rT.data[this.oyt];return n||(this.rT.sheetNames.push(this.oyt),n=this.rT.data[this.oyt]={isNew:!0}),n},w.prototype.getValue=function(n,t){var i,n,i,i=this.eme(),n=i[n];return!n||h(n[t])?i.isNew?A.Errors.Reference:0:(i=n[t])&&i._code&&(i._error||i._calcError)?new A.CalcError(i._error||i._calcError):i},w.prototype.getRowCount=function(){return A.MAX_ROW_COUNT},w.prototype.getColumnCount=function(){return A.MAX_COLUMN_COUNT},w.prototype.createSourceModel=function(){return O},w.prototype.getCalcSourceModel=function(){return O},w.prototype.setCalcSourceModel=function(){},w.prototype.getPeerSource=function(n){return new w("["+this.rT.i+"]"+n,this.ayt,!0)},w.prototype.getSources=function(n){var t,i,r,e,f,t=this.rT.sheetNames,i=[];if(n&&t&&n.oyt)for(r=!1,e=0;e<t.length&&((r=t[e]===this.oyt?!0:r)&&(f=new w("["+this.rT.i+"]"+t[e],this.ayt,!0),i.push(f)),t[e]!==n.oyt);e++);return i},w.prototype.referenceToArray=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,u=this,h=1,l=1,m=[],p=u.rT.Rbt,g=u.oyt+n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+i;if(p){if(p.has(g))return p.get(g)}else p=u.rT.Rbt=(0,A.createMap)();if(0===(w=n.getRangeCount()))m.isError=!0;else if(b=Math.max.apply(null,Object.keys(u.eme()))+1,x=u.getColumnCount(),isNaN(b))(m=[A.Errors.Reference]).isError=!0;else{for(i=i===I||i,y=0;y<w;y++){if(i||m.push(_=[]),v=n.getRow(y),d=n.getColumn(y),0===(h=n.getRowCount(y)))return m.isError=!0,m;if(-1===h&&(v=0,h=b),0===(l=n.getColumnCount(y)))return m.isError=!0,m;if(-1===l&&(d=0,l=x),b<=v||x<=d)return(m=i?[O]:[[O]]).rowCount=1,m.colCount=1,m.rangeCount=1,m;for(b<v+h&&(h=b-v),x<d+l&&(l=x-d),R=void 0,j=!1,N=0;N<h;N++)for(a=v+N,i||_.push(R=[]),k=0;k<l;k++)C=u.getValue(a,c=d+k),j||(C=A.Convert.Nbt(C,t,!A.ExcelCompatibleCalcMode,f,s),r&&A.Convert.BJ(C)&&(j=(m=[C]).isError=!0),A.Convert.Ybt(C,f))||(i?m:R).push(C);if(j)return m}(m=i||1!==w?m:m[0]).rowCount=h,m.colCount=l,m.rangeCount=w,p&&p.set(g,m)}return m},w.prototype.getName=function(n){var n,n=this.Dfe?"":this.ayt.uyt[this.rT.i]&&(!this.rT||n&&n.lyt)?"[".concat(this.rT.i,"]"):"".concat(this.rT.option.path,"[").concat(this.rT.option.name,"]");return n+this.oyt},w.prototype.getIdentity=function(n,t){var i,r,e,f,t,i=this,r=t.row,e=t.rowCount||1,f=t.column,t=t.columnCount||1;return-1===r&&(r=0,e=i.getRowCount()),-1===f&&(f=0,t=i.getColumnCount()),i.getName(n)+"."+r+"."+e+"."+f+"."+t},f=w,t.ExternalSource=f,_.prototype.parseSource=function(n,t){return new f(n,this,t)},_.prototype.ryt=function(n,t,i,r){var e,f;for(e in this.iyt)if(E(this.iyt,e)&&(f=this.iyt[e])&&f.option.name===n&&f.option.path===t)return f;if(!i)for(e in this.iyt)if(E(this.iyt,e)&&(f=this.iyt[e]).option.name===n&&""===t)return f;return r?I:{option:{name:n,path:t},sheetNames:[],data:{}}},_.prototype.syt=function(){for(var n in this.iyt)this.iyt[n]&&(this.iyt[n].i=n)},_.prototype.fyt=function(n){var t,t,t=this.ryt(n.option.name,n.option.path,!0,!0);return t||(t=Object.keys(this.iyt).length+1,(this.iyt[t]=n).i=t,n)},_.prototype.Ep=function(n){var t,i,r,e,f,o,i={},r={},e=1;for(f in this.iyt)E(this.iyt,f)&&(this.uyt[f]&&!j.GC$.isEmptyObject(this.uyt[f])||(t||(t={},m(n.hyt,t),n.sheets.forEach(function(n){m(n.hyt,t)})),t[f]))&&(i[(o=this.iyt[f]).i=e]=o,r[e]=this.uyt[f],e++);this.iyt=i,this.uyt=r},_.prototype.toJSON=function(){var n,t,i,n={};for(t in this.iyt)E(this.iyt,t)&&(i=this.iyt[t],n[t]={option:{name:i.option.name,path:i.option.path},sheetNames:i.sheetNames,data:i.data});return n},_.prototype.wh=function(n){var g,b,t,x,y,R,i,r,g=this.iyt,b=[],t={n_:"externalReferences",c_:b},x={},y=n.workbook.rels,R=0,i=function(n){var t,i,r,n,e,f,o,s,u,a,c,h,l,v,d,w,m,C,_,p;if(E(g,n)){for(R++,i=(t=g[n]).option.id=N+S(y),y.c_.push({n_:k,Id:i,Type:j.RelationshipConstants.uc,Target:M(j.XFileConstants.nu+"/"+j.XFileConstants.tu+n)}),b.push({n_:"externalReference","r:id":i}),n={n_:"sheetNames",c_:r=[]},e={n_:"sheetDataSet",c_:[]},(f=t.sheetNames)&&f.forEach(function(n){r.push({n_:"sheetName",val:j.mt.Nfe(n)})}),o=t.data,s=0,u=f.length;s<u;s++){if(a=o[f[s]],c={n_:j.XFileConstants.bo,sheetId:s},a){for(l in a.isNew&&(c.refreshError=1),h=[],a)if(a.hasOwnProperty(l)&&(v=parseInt(l,10)+1,!isNaN(v))){for(C in m={n_:"row",r:v,c_:w=[]},d=a[l])d.hasOwnProperty(C)&&d[C]!==I&&(_=d[C],(p={n_:"cell"}).r=j.IndexHelper.nr(parseInt(C,10))+v,"string"==typeof _?p.t="str":"boolean"==typeof _?(p.t="b",_=_?"1":"0"):_&&_.code&&(p.t="e","#SPILL!"!==(_=_._calcError||_.error)&&"#CALC!"!==_||(_="#VALUE!")),p.c_=[{n_:"v",c_:[_]}],w.push(p));h.push(m)}c.c_=h}e.c_.push(c)}x[i]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[n,e]}],option:t.option}}};for(r in g)i(r);return{externalReferencesNode:t,externalLinks:x,count:R}},_.prototype.dyt=function(n,i,t){var r,e,f,r,n,o,s,u,a,r=i&&i.sheets&&Object.keys(i.sheets),e=r&&i.sheets[r[0]].data&&i.sheets[r[0]].data.dataTable,f=e?d:v,r=this.ryt(n,t||"",I,!0);if(!h(r)){for(a in n=r.i,delete(o=this.iyt[n]).Rbt,s=this.uyt[n]||{},o.ime=new c.Common.rbush,u=function(n){var t;E(s,n)&&((t=s[n][0]).vyt(),s[n][1].forEach(function(n){var n=n.getRange(t.row,t.column);o.ime.insert({minX:n.row,minY:n.col,maxX:n.row+n.rowCount-1,maxY:n.col+n.colCount-1})}))},s)u(a);o.sheetNames.forEach(function(n){var t,r,t=e?i.sheets[n]&&i.sheets[n].data.dataTable:i&&i[n];t&&(r=o.data[n]={},l(t,function(n,i){o.ime.collides({minX:i,minY:-1,maxX:i,maxY:-1})&&(r[i]=r[i]||{},l(n,function(n,t){o.ime.collides({minX:i,minY:t,maxX:i,maxY:t})&&(r[i][t]=f(n))}))}))})}},_.prototype._6=function(t,n,i){var r,e,r=this;"string"==typeof t?r.dyt(t,n,i):t&&(e=r.myt(!0)).forEach(function(n){t[n.filePath+n.name]&&r.dyt(n.name,t[n.filePath+n.name],n.filePath)})},_.prototype.myt=function(n){var t,i,r,e,f,o,s,t=[];for(i in this.iyt)if(E(this.iyt,i)){if(r=this.iyt[i],e={name:r.option.name,filePath:r.option.path},n)for(s in f=this.uyt[i]||{},e.items=[],o=function(n){var t,i,n,n;E(f,n)&&(i={row:(t=f[n][0]).row,col:t.column,sheetName:t.w3.rT.getName()},n=1===(n=f[n][1]).length?C(n[0],t):n.map(function(n){return C(n,t)}),e.items.push({target:i,source:n}))},f)o(s);t.push(e)}return t},t.ExternalReferenceManager=_},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(f,n,t){var rn,s,en,j,y,fn,V,t,A,on,w,sn,un,C,g,S,L,a,i,o,m,t;function c(n,t){var i,r,e,n,i=w(n.row,(t=t||this).row),r=w(n.column,t.column),e=on(n.row+n.rowCount,t.row+t.rowCount),n=on(n.column+n.columnCount,t.column+t.columnCount);return e<=i||n<=r?un:{row:i,column:r,rowCount:e-i,columnCount:n-r,intersectWith:c}}function r(n,t,i,r,e,f,o,s){var u=this;u.gyt=n,u.pyt=t,u.byt=i,u.yyt=r,u.wyt=e,u.Myt=f,u.Sx=o,u.Cyt=s}function M(n,t,i,r){return(!r||n<t)&&i}function P(n){return[n.row,n.col,n.rowCount,n.colCount].join(",")}function Y(n,t,i,r,e){var t=t.rT.id+" "+i+" "+r;n.set(t,e)}function X(n,t,i,r){var t;if(0!==n.size)return t=t.rT.id+" "+i+" "+r,n.has(t)}function u(n,t){var t=new rn.Expression(t);return t.value=n,t}function e(n,t){if(n){for(;10===n.type||12===n.type;)n=n.value;if(1===n.type||13===n.type)t(n);else if(9===n.type)e(n.value,t),n.value2&&e(n.value2,t);else if(7===n.type)for(var i=0;i<n.arguments.length;i++)e(n.arguments[i],t)}}function cn(n,t,i,r,e){var f,o,f,o,n,f=!n&&V(t),o=!i&&V(r);if(f&&!o&&(t=0),o&&!f&&(r=0),!f||!o)return t instanceof Date&&(t=s.Common.ct.o0(t)),r instanceof Date&&(r=s.Common.ct.o0(r)),f=n&&!e.useValue?u(n,rn.ExpressionType.parentheses):u(t,rn.ExpressionType.number),o=i?u(i,rn.ExpressionType.parentheses):u(r,rn.ExpressionType.number),(n=new rn.Expression(rn.ExpressionType.operator)).operatorType=a(e.option),n.value=o,n.value2=f,n}function hn(n){e(n,function(n){var t,t,t,t,t;1===n.type&&(n.rowRelative&&n.columnRelative||n.endRowRelative&&n.endColumnRelative)&&(t=[n.row,n.column],n.column=t[0],n.row=t[1],t=[n.endColumn,n.endRow],n.endRow=t[0],n.endColumn=t[1],t=[n.columnRelative,n.rowRelative],n.rowRelative=t[0],n.columnRelative=t[1],t=[n.endColumnRelative,n.endRowRelative],n.endRowRelative=t[0],n.endColumnRelative=t[1],t=[n.isFullColumn,n.isFullRow],n.isFullRow=t[0],n.isFullColumn=t[1])})}function an(){}function I(n,t,i,r,e,f,o,s,u,a,c,h){var l,v,d,n;return 0<=i||!e?(l=r+(e?i:0),v=f+(o?i:0),d=c&&_(s,n,c),n=!c&&_(s,n,c),h&&-1===f?e?u+a<=l&&u<=i&&i<u+a?i-u+u+a<=l&&(l+=a):u<=l&&!(u<=i&&i<u+a)&&(l+=a):u<=l&&(l+=a):((d||n)&&(!h&&u+a<=i||h&&u<=i)&&(l-=e?a:0,v-=o?a:0),d=c&&_(s,t,c),n=!c&&_(s,t,c),(d||n)&&(!h&&u<=l||h&&(e&&u<=i+r||!e&&u<=r)?(l+=a,v+=a):(!h&&u<=v||h&&(o&&u<=i+f||!o&&u<=f))&&(v+=a)),h&&u+a<=i&&(l+=e?a:0,v+=o?a:0)),{index:l-=e?i:0,endIndex:v-=o?i:0}):{index:r,endIndex:f}}function O(n,t,i,r,e,f,o,s,u,a,c,h,l){var l,v,d,w,m;if(t&&!l){if(l=u?e.row:e.column,v=u?e.rowRelative:e.columnRelative,d=void 0,w=e.row+(e.rowRelative&&i),m=e.column+(e.columnRelative&&r),h&&!h(w,m))return e;if(e.rowRelative&&e.columnRelative&&0===e.row&&0===e.column&&0===o&&c&&(u&&c.Tge||!u&&c.Age))return e;if(u&&0<=i||!u&&0<=r||!v){if(a)d=I(n,t,u?i:r,l,v,-1,!1,f,o,s,u,h).index;else if(d=B(n,t,u?i:r,l,v,f,o,s,u,h),C(d))return(0,rn.Syt)(d);d!==l&&(e=e.offset(u?d-l:0,u?0:d-l,!0))}}return e}function E(n,t,i,r,e,f,o,s,u,a,c,h){var h,h,l,v,d,w,a,n;if(t&&!h){if(3===(h=e.Tyt())||u&&2===h||!u&&1===h)return e;if(h=u?e.rowRelative:e.columnRelative,l=u?e.endRowRelative:e.endColumnRelative,v=u?e.row:e.column,d=u?e.endRow:e.endColumn,w=void 0,u&&0<=i||!u&&0<=r||!h||!l){if(a)w=I(n,t,u?i:r,v,h,d,l,f,o,s,u,c);else if(w=$(n,t,u?i:r,v,h,d,l,f,o,s,u,c),C(w))return(0,rn.Syt)(w);a=w.index,n=w.endIndex,a===v&&n===d||(e=e.offset2(u?a-v:0,u?0:a-v,u?n-d:0,u?0:n-d,i,r))}}return e}function F(n,t,i,r,e,f,o,s,u,a){if(t){var t=e;if(t&&f===t.source)return t.offsetWhenInsertRemoveColumn(o,s,u,a)}return e}function x(n,t,i,r,e,f,o,s,u,a,c,h){var l,v,d,w,m,C,_,p,g,b,l=x,v=r;if(r){if(1===r.type&&r.hmt())v=O(n,r.source||n,t,i,r,e,f,o,s,u,a,c,h);else if(1===r.type)v=E(n,r.source||n,t,i,r,e,f,o,s,u,c,h);else if(10===r.type)(d=l(n,t,i,r.value,e,f,o,s,u,a,c,h))!==r.value&&(v=(0,rn.Ayt)(d));else if(9===r.type)w=l(n,t,i,r.value,e,f,o,s,u,a,c,h),m=r.value2&&l(n,t,i,r.value2,e,f,o,s,u,a,c,h),w===r.value&&m===r.value2||(v=(0,rn.rbt)(r.operatorType,w,m));else if(7===r.type){for(C=un,p=_=void 0,b=(g=r).arguments.length,p=0;p<b;p++)if((d=l(n,t,i,_=g.arguments[p],e,f,o,s,u,a,c,h))!==_){(C=[])[p]=d;break}if(C){for(p=0;p<b;p++)_=g.arguments[p],C[p]!==sn&&C[p]!==un||(C[p]=l(n,t,i,_,e,f,o,s,u,a,c,h));v=(0,rn.YJ)(g,C)}}else c&&!n.Iyt||s||13!==r.type||(v=F(n,n,t,i,r,e,f,o,u,c));return v}}function h(f,o,s,u,n,t,i,r,a,c,h){var e,l,v,l,e=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,s,u,a,c,e,h)},l=f.getSheet();l&&(v=l.b8&&(l.parent||l).xyt(),l=l.Ut&&l.Ut.pj(),d(v,e,a,l))}function d(n,t,i,r){var e,e,f,o,s,u,a,c,h,l,v,d,w,s,m,C,_,p,g,b,x;if(n)for(u=0;u<n.length;u++){for(c=a=!0,h=y.maxRowCount-1,l=y.maxColumnCount-1,d=0,w=(v=(e=n[u].validator)._S).length;d<w&&(m=(s=v[d]).rowCount,C=s.colCount,o=s.row,s=s.col,-1!==m&&(c=!1,h=o<h?o:h),-1!==C&&(a=!1,l=s<l?s:l),a||c);d++);if(!(i&&c||!i&&a)&&(_=(f=n[u].sheet).Uw(),e=e.condition(),p=void 0,v&&v[0]&&(-1===v[0].row&&(p={Tge:1}),-1===v[0].col)&&(p={Age:1}),(g=e.getExpressions())&&0<g.length)){for(b=0;b<g.length;b++)x=g[b],g[b]=t(_,x,h,l,p);e.setExpressions(g,r)}}}function l(n){var i,t,r,i=[],t=n.parent,r;return(t&&t.sheets||[n]).forEach(function(t){var n=t.conditionalFormats,n=n&&n.getRules();n&&n.length&&n.forEach(function(n){n.KK&&i.push({rule:n,sheet:t})})}),i}function v(f,o,s,u,a,c){var n,t,i,r,n=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,s,u,a,c,e)},t=f.getSheet();t&&T(i=l(t),n,r=t.Ut&&t.Ut.pj(),a,c)}function T(n,t,i,r,e){var f,o,s,u,a,c,h,a,l,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,R,A,I,O,E;if(n)for(f=0,o=n.length;f<o;f++){if(u=(s=n[f].rule).ranges(),c=(a=S(u)).r,h=a.c,l=(a=n[f].sheet).Uw(),v=s.condition(),(d=a.tables)&&u&&1===u.length&&(m=(w=u[0]).row,C=w.col,_=w.rowCount,p=w.colCount,g=void 0,e&&r?g=d.AJ(m,C,_,p):a.EB&&a.Nyt&&(g=[a.Nyt]),g)&&g.length){for(b=!1,x=0,y=g.length;x<y;x++)if(j=(R=g[x]).row,N=R.col,k=R.rowCount,R=R.colCount,m===j&&_===k&&N<=C&&C+p<=N+R){b=!0;break}if(b)continue}if(v||(s.initCondition(),v=s.condition()),A=v&&v.getExpressions(),I=void 0,u&&u[0]&&(-1===u[0].row&&(I={Tge:1}),-1===u[0].col)&&(I={Age:1}),A&&0<A.length){for(O=0;O<A.length;O++)E=A[O],A[O]=t(l,E,c,h,I);v.setExpressions(A,i)}}}function H(n,e,f){var t,n,i,t=function(n,t,i,r){return J.call(this,n,i,r,t,e,f)},n=n.getSheet(),i;T(l(n),t,n.Ut.pj())}function U(n,t,i,r,e,f,o){var s,u,o,a,c,h,l,v,d,w,m,C,_,v,_;if(!o&&(a=(o=(u=(s=n.getSheet()).Ut)&&u.yle())&&o.gle()))for(c in a)if(a.hasOwnProperty(c)&&(h=a[c]))for(l in h)h.hasOwnProperty(l)&&(d=+c,w=+l,v=h[l])&&v.expr&&!V(s.getValueIgnoreDefault(d,w))&&(m=s.op(),C=v.expr,_=v.oldRow,v=v.oldCol,m)&&_&&v&&C&&(C=t.call(self,n,d,w,C,n,i,r,e,f,sn),_=m.unparse(n,C,d,w),u.setDefaultValue(d,w,_,un,fn.DefaultChangeValueType.Expression,un,!0))}function B(n,t,i,r,e,f,o,s,u,a){var c,h,n;if(0<=i||!e){if(c=r+(e?i:0),a&&c<i&&c<o)return r;if(h=u&&_(f,n,u),n=!u&&_(f,n,u),(h||n)&&o<=i&&(c+=e?s:0),h=u&&_(f,t,u),n=!u&&_(f,t,u),h||n)if(o+s<=c)c-=s;else if(o<=c)return g;return a&&o<=i&&e&&o<(c-=s)+s&&c<o?g:c-=e?i:0}return r}function _(n,t,i){var i=i?{2:!0}:{1:!0};return n===t||n.Mf===t.Mf&&(3===n.nT&&i[t.nT]||i[n.nT]&&3===t.nT)}function $(n,t,i,r,e,f,o,s,u,a,c,h){var l,v,d,w,n,s,t;if(0<=i||!e){if(l=r+(e?i:0),v=f+(o?i:0),d=u+a-1,w=c&&_(s,n,c),n=!c&&_(s,n,c),(w||n)&&u<=i&&(l+=e?a:0,v+=o?a:0),w=c&&_(s,t,c),n=!c&&_(s,t,c),w||n)if(s=i+r,t=i+f,!h&&d<l||h&&d<s)l-=a,v-=a;else{if(!h&&u<=l&&v<=d||h&&u<=s&&t<=d)return g;!h&&v<u||h&&t<u||(!h&&d<=v||h&&d<=t?(l=!h&&l<=u||h&&s<=u?l:u,v-=a):v=u-1)}return l-=e?i:0,v-=o?i:0,h&&u<=i&&(l-=e?a:0,v-=e?a:0),{index:l,endIndex:v}}return{index:r,endIndex:f}}function W(n,t,i){var r,e,f,o,s,u,a,c,a,a,c,a,h,l,c,a,v,d,r=W,e=t;if(t)if(t.source)if(u=t.source,(a=t.endSource)&&u!==a){if(!(c=u.Mf&&u.Mf.parent))return rn.kyt;a===i?(a=i.S3,e.endSource=c.getSheet(a-1).Uw()):u===i&&(a=i.S3,e.source=c.getSheet(a).Uw()),delete i.S3,e.source===e.endSource&&delete e.endSource}else(n!==i&&u===i||n===i&&u!==i)&&(e=rn.kyt);else if(10===t.type)(f=r(n,t.value,i))!==t.value&&(e=(0,rn.Ayt)(f));else if(9===t.type)c=r(n,t.value,i),a=t.value2&&r(n,t.value2,i),c===t.value&&a===t.value2||(e=(0,rn.rbt)(t.operatorType,c,a));else if(7===t.type){for(h=un,l=t.arguments.length,s=0;s<l;s++)if((f=r(n,o=t.arguments[s],i))!==o){(h=[])[s]=f;break}if(h){for(s=0;s<l;s++)o=t.arguments[s],h[s]!==sn&&h[s]!==un||(h[s]=r(n,o,i));e=(0,rn.YJ)(t,h)}}else 8===t.type&&(c=n||i,a=A(t.value),u=(v=c.getCustomName(a))&&v.source||(v=(d=c.Lbt.getGlobalSourceModel()||c.getCalcSourceModel()).getSource().getCustomName(a))&&v.source?v.source:u)&&(n!==i&&u===i||n===i&&u!==i)&&(e=rn.kyt);return e}function D(n,t,i,r,e){return W(n,r,e)}function K(n,t){return n.yyt===n.gyt&&t!==n.yyt}function Q(n,t,i,r,e,f){var o,s,u,a,c,h,l,v,d,l,w,m,C,m,w,C,d,o=!!r.source,s=r.source||n,u=r.rowRelative,a=r.columnRelative,d=t,l=i,w=e.yyt.Mf;if(e.R0i&&(m=r.row,C=r.column,d=e.wyt+(m-e.pyt)+w.lT(e.wyt,m-e.pyt+1,!0),l=e.Myt+(C-e.byt)+w.lT(e.Myt,C-e.byt+1)),m=e.Dyt(d),w=e._yt(l),(0<=t||!u)&&(0<=i||!a)){if(c=r.row+(u?t:0),h=r.column+(a?i:0),f&&f.isNameID||n===e.gyt&&(v=n===e.yyt?e.Eyt(e.yyt,t,i,1,1)&&!e.R0i:(C=t,d=i,f&&f.crossSheetMoved&&(C-=m,d-=w),e.jyt(e.gyt,C,d,1,1))),s===e.yyt&&e.Eyt(s,c,h,1,1)&&!e.jyt(s,c,h,1,1)&&(!u&&!a||!v))return rn.kyt;if(l=(o&&s===e.gyt||!o&&n===e.gyt)&&(!v&&e.jyt(e.gyt,c,h,1,1)||v&&e.Eyt(e.yyt,u?c:c+m,a?h:h+w,1,1)),v&&(c-=u?m:0,h-=a?w:0),l&&(c+=m,h+=w),h-=a?i:0,s=r.source,e.gyt!==e.yyt&&(l&&v?o&&(s=e.yyt):l?s=e.yyt:v&&!o&&(s=e.gyt)),(c-=u?t:0)!==r.row||h!==r.column||s!==r.source)return(0,rn.knt)(s,un,c,h,u,a)}else if((0<=t||!u)&&-1===i){if(c=r.row+(u?t:0),e.Eyt(n,t,i,1,1)&&(c-=u?m:0),e.jyt(s,c,-1,1,-1))c+=m;else if(e.Eyt(s,c,-1,1,-1))return rn.kyt;if((c-=u?t:0)!==r.row)return(0,rn.knt)(r.source,un,c,r.column,u,r.columnRelative)}else if(-1===t&&0<=i&&!a){if(h=r.column+(a?i:0),e.Eyt(n,t,i,1,1)&&(h-=a?w:0),e.jyt(s,c,h,1,1))h+=w;else if(e.Eyt(s,c,h,1,1))return rn.kyt;if(h-=a?i:0,c!==r.row||h!==r.column)return(0,rn.knt)(r.source,r.endSource,r.row,h,r.rowRelative,a)}return r}function b(n,t){var i,r,e,f;return(t=n.getIntersect(t,0,0))?(i=n.row,r=n.col,e=n.rowCount,f=n.colCount,n.rowCount===t.rowCount&&n.colCount===t.colCount||(n.rowCount===t.rowCount?(n.col===t.col&&(r=n.col+t.colCount),f=n.colCount-t.colCount):n.colCount===t.colCount&&(n.row===t.row&&(i=n.row+t.rowCount),e=n.rowCount-t.rowCount)),(0,fn.Ec)(i,r,e,f)):un}function Z(n,t,i,r,e){var n,f;return t&&n&&(!(n=t.getIntersect(n,0,0))&&(f=t.getIntersect(i,0,0))||!!(n&&n.rowCount===t.rowCount&&0!==e||n.colCount===t.colCount&&0!==r))}function q(n,t,i){var n=n.getRange(t,i);return(0,fn.Ec)(n.row,n.col,n.rowCount,n.colCount)}function R(n,t,i,r){var t,e,t=b(n,t);return t?(e=t.union(i),r?(e.col=n.col,e.colCount=n.colCount):(e.row=n.row,e.rowCount=n.rowCount)):e=i,{startRow:e.row,endRow:e.row+e.rowCount-1,startColumn:e.col,endColumn:e.col+e.colCount-1}}function N(n,t,i,r,e){var f,n,t,f=b(n,t),n=n.getIntersect(t,0,0);return n?(n.row+=r,n.col+=e,{startRow:(t=f?f.union(n):i).row,endRow:t.row+t.rowCount-1,startColumn:t.col,endColumn:t.col+t.colCount-1}):un}function z(n,t){var i,r,e,n,f,o,s,t,i=n.row,r=n.col,e=n.rowCount,n=n.colCount,f=t.row,o=t.col,s=t.rowCount,t=t.colCount;return 1===e&&1!==n?o<r&&r<=o+t-1||o<=r+n-1&&r+n-1<o+t-1:1!==n||1===e||f<i&&i<=f+s-1||f<=i+e-1&&i+e-1<f+s-1}function nn(n,t,i,r,e,f){var r,e,f,o,s,u,a,c,h,l,v,d,n,w,m,C,_,p,r=q(r,e,f),e=r.row,f=r.row+r.rowCount-1,o=r.col,s=r.col+r.colCount-1,u=n.pyt,a=u+n.Sx-1,c=n.byt,h=c+n.Cyt-1,l=n.wyt,v=n.Myt,d=(0,fn.Ec)(u,c,n.Sx,n.Cyt),n=(0,fn.Ec)(l,v,n.Sx,n.Cyt),w=r.getIntersect(n,0,0);if(Z(d,r,n,t,i))if(p=_=void 0,C=0!==t)if(p=u<=f&&f<=a,(_=u<=e&&e<=a)&&p)e+=t,f+=t;else if(_&&!p){if(t<=0)e+=t;else if(!(f<u+t)){if(!(a+t<f))return N(r,d,n,t,i);if(u===e)return R(r,d,n,C);e+=t}}else if(!_&&p){if(0<=t)f+=t;else if(!(a+t<e)){if(!(e<l))return N(r,d,n,t,i);if(a===f)return R(r,d,n,C);f+=t}}else w&&!w.equals(n)&&z(r,n)&&(e=(m=b(r,w)).row,f=m.row+m.rowCount-1,o=m.col,s=m.col+m.colCount-1);else if(p=c<=s&&s<=h,(_=c<=o&&o<=h)&&p)o+=i,s+=i;else if(_&&!p){if(i<0)o+=i;else if(!(s<c+i)){if(!(h+i<s))return N(r,d,n,t,i);if(c===o)return R(r,d,n,C);o+=i}}else if(!_&&p){if(0<i)s+=i;else if(!(h+i<o)){if(!(o<v))return N(r,d,n,t,i);if(h===s)return R(r,d,n,C);s+=i}}else w&&!w.equals(n)&&z(r,n)&&(e=(m=b(r,w)).row,f=m.row+m.rowCount-1,o=m.col,s=m.col+m.colCount-1);return{startRow:e,endRow:f,startColumn:o,endColumn:s}}function tn(n,t,i,r){return t<i||i+r-1<n}function ln(n,t,i,r){return i<=n&&t<=i+r-1}function vn(n,t,i,r){return n<i&&i+r-1<t}function dn(n,t,i,r){return i===n&&i+r-1<t||n<i&&i+r-1===t}function wn(n,t,i,r){return i<n&&n<=i+r-1&&i+r-1<t||n<i&&i<=t&&t<i+r-1}function p(n,t,i,r,e){return i<=n&&e<=n||t<=i+r-1&&t<=e+r-1}function mn(n,t,i,r,e){for(var f,o,s,f=[tn,ln,vn,dn,wn],s=0;s<f.length;s++)if(f[s](n,t,i,r)){o=s+"_";break}if(i===e)o+="9";else for(s=0;s<f.length;s++)if(i!==e&&f[s](n,t,e,r)){o+=s;break}return o}function Cn(n,t,i,r,e){return{row:w(n.startRow,t),col:w(n.startColumn,i),endRow:on(n.endRow,r),endCol:on(n.endColumn,e)}}function _n(n,t,i,r,e){return!e.R0i&&n===e.yyt&&e.wyt<=t&&t<=e.Sx+e.wyt-1&&e.Myt<=i&&i<=e.Cyt+e.Myt-1&&(t=t+e.pyt-e.wyt,i=i+e.byt-e.Myt),{startRow:r.row+(r.rowRelative?t:0),endRow:r.endRow+(r.endRowRelative?t:0),startColumn:r.column+(r.columnRelative?i:0),endColumn:r.endColumn+(r.endColumnRelative?i:0)}}function k(n,t,i,r,e,f,o,s,u){return V(f)&&(f=t.startRow),V(o)&&(o=t.startColumn),V(s)&&(s=t.endRow),V(u)&&(u=t.endColumn),(0,rn.lJ)(e||n.source,un,n.rowRelative?f-i:f,n.columnRelative?o-r:o,n.endRowRelative?s-i:s,n.endColumnRelative?u-r:u,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,i,r)}function pn(n,t,i,r,e){var f,n,o,s,n,u,a,c,h,l,v,d,f=_n(n,t,i,r,e),n=r.source||n;if(e.gyt===n&&e.yyt===n)switch(n=(o=mn(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))+"-"+(s=mn(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt)),u=e.wyt-e.pyt,a=e.Myt-e.byt,c=Cn(f,e.pyt,e.byt,e.pyt+e.Sx-1,e.byt+e.Cyt-1),d=v=l=h=void 0,n){case m.outToCover+"-"+m.outToCover:case m.crossToCover+"-"+m.outToCover:case m.outToCover+"-"+m.crossToCover:case m.crossToCover+"-"+m.crossToCover:case m.coverToCover+"-"+m.outToCover:case m.outToCover+"-"+m.coverToCover:case m.coverNoMove+"-"+m.outToCover:case m.outToCover+"-"+m.coverNoMove:return rn.kyt;case m.outToCross+"-"+m.outToCover:case m.coverToCross+"-"+m.outToCover:case m.insideToCross+"-"+m.outToCover:case m.partToCross+"-"+m.outToCover:case m.crossToCross+"-"+m.outToCover:case m.crossNoMove+"-"+m.outToCover:case m.outToCross+"-"+m.coverNoMove:case m.outToCross+"-"+m.coverToCover:case m.outToCross+"-"+m.crossToCover:case m.insideToCross+"-"+m.coverNoMove:case m.insideToCross+"-"+m.coverToCover:case m.insideToCross+"-"+m.crossToCover:return e.wyt<=f.startRow?k(r,f,t,i,un,e.wyt+e.Sx):k(r,f,t,i,un,un,un,e.wyt-1);case m.outToCover+"-"+m.outToCross:case m.outToCover+"-"+m.coverToCross:case m.outToCover+"-"+m.insideToCross:case m.outToCover+"-"+m.partToCross:case m.outToCover+"-"+m.crossToCross:case m.outToCover+"-"+m.crossNoMove:case m.coverNoMove+"-"+m.outToCross:case m.coverToCover+"-"+m.outToCross:case m.crossToCover+"-"+m.outToCross:case m.coverNoMove+"-"+m.insideToCross:case m.coverToCover+"-"+m.insideToCross:case m.crossToCover+"-"+m.insideToCross:return e.Myt<f.startColumn?k(r,f,t,i,un,un,e.Myt+e.Cyt):k(r,f,t,i,un,un,un,un,e.Myt-1);case m.partToOut+"-"+m.coverNoMove:case m.crossToOut+"-"+m.coverNoMove:if(!p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return k(r,f,t,i);case m.coverNoMove+"-"+m.partToOut:case m.coverNoMove+"-"+m.crossToOut:if(o===m.coverNoMove&&!p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return k(r,f,t,i);case m.crossToInside+"-"+m.coverNoMove:case m.coverNoMove+"-"+m.crossToInside:return f.startRow>=e.pyt&&s===m.coverNoMove||f.startColumn>=e.byt&&o===m.coverNoMove?k(r,f,t,i,un,c.row+u,c.col+a):k(r,f,t,i,un,un,un,c.endRow+u,c.endCol+a);case m.partToInside+"-"+m.coverNoMove:return f.startRow>=e.pyt?k(r,f,t,i,un,on(c.row+u,c.endRow+1)):k(r,f,t,i,un,un,un,w(c.endRow+u,c.row-1));case m.coverNoMove+"-"+m.partToInside:return f.startColumn>=e.byt&&o===m.coverNoMove?k(r,f,t,i,un,un,on(c.col+a,c.endCol+1)):k(r,f,t,i,un,un,un,un,w(c.endCol+a,c.col-1));case m.partToCross+"-"+m.coverNoMove:case m.crossToPart+"-"+m.coverNoMove:case m.crossToCross+"-"+m.coverNoMove:if(p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return f.startRow>=e.pyt?k(r,f,t,i,un,c.row+u):k(r,f,t,i,un,un,un,c.endRow+u);case m.crossToCover+"-"+m.coverNoMove:case m.partToPart+"-"+m.coverNoMove:return e.pyt<e.wyt?k(r,f,t,i,un,on(c.row+u,c.endRow+1),un,c.endRow+u):k(r,f,t,i,un,c.row+u,un,w(c.endRow+u,c.row-1));case m.coverNoMove+"-"+m.partToCross:case m.coverNoMove+"-"+m.crossToPart:case m.coverNoMove+"-"+m.crossToCross:if(p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return f.startColumn>=e.byt?k(r,f,t,i,un,un,c.col+a):k(r,f,t,i,un,un,un,un,c.endCol+a);case m.coverNoMove+"-"+m.crossToCover:case m.coverNoMove+"-"+m.partToPart:return e.byt<e.Myt?k(r,f,t,i,un,un,on(c.col+a,c.endCol+1),un,c.endCol+a):k(r,f,t,i,un,un,c.col+a,un,w(c.endCol+a,c.col-1));case m.crossToCross+"-"+m.coverToCover:case m.crossToPart+"-"+m.coverToCover:case m.partToCross+"-"+m.coverToCover:if(p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return k(r,f,t,i);case m.coverToCover+"-"+m.crossToCross:case m.coverToCover+"-"+m.crossToPart:case m.coverToCover+"-"+m.partToCross:if(o===m.coverToCover&&p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return k(r,f,t,i);case m.coverToCover+"-"+m.partToPart:case m.partToPart+"-"+m.coverToCover:case m.coverToCover+"-"+m.crossToCover:case m.crossToCover+"-"+m.coverToCover:return k(r,f,t,i,un,c.row+u,c.col+a,c.endRow+u,c.endCol+a);case m.partToPart+"-"+m.crossToCover:case m.partToCross+"-"+m.crossToCover:case m.crossToPart+"-"+m.crossToCover:case m.crossToCross+"-"+m.crossToCover:return p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt)?k(r,f,t,i):(l=c.row===f.startRow?c.col===f.startColumn?(v=f.endColumn,d=c.col+a,h=c.endRow+u,c.row+u):(v=f.startColumn,d=c.endCol+a,h=o===m.partToCross||o===m.crossToCross?e.pyt+u-1:f.endRow,f.startRow):c.col===f.startColumn?(v=f.endColumn,d=c.col+a,h=f.endRow,o===m.partToCross||o===m.crossToCross?e.pyt+e.Sx-1+u+1:f.startRow):(v=f.startColumn,d=c.endCol+a,h=o===m.partToCross||o===m.crossToCross?c.row+u:f.startRow,c.endRow+u),k(r,f,t,i,un,on(h,l),on(v,d),w(h,l),w(v,d)));case m.crossToCover+"-"+m.partToPart:case m.crossToCover+"-"+m.partToCross:case m.crossToCover+"-"+m.crossToPart:case m.crossToCover+"-"+m.crossToCross:return p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt)?k(r,f,t,i):(l=c.row===f.startRow?(h=(d=c.col===f.startColumn?(v=c.endCol+a,c.col+a):(v=f.endColumn,s===m.partToCross||s===m.crossToCross?e.byt+e.Cyt-1+a+1:f.startColumn),f.endRow),c.row+u):c.col===f.startColumn?(v=f.startColumn,d=s===m.partToCross||s===m.crossToCross?e.byt+a-1:f.endColumn,h=c.endRow+u,f.startRow):(v=s===m.partToCross||s===m.crossToCross?c.col+a:f.startColumn,d=c.endCol+a,h=f.startRow,c.endRow+u),k(r,f,t,i,un,on(h,l),on(v,d),w(h,l),w(v,d)));case m.coverToOut+"-"+m.coverToOut:case m.coverToOut+"-"+m.coverToCross:case m.coverToOut+"-"+m.coverToCover:case m.coverToOut+"-"+m.coverNoMove:case m.coverToCross+"-"+m.coverToOut:case m.coverToCross+"-"+m.coverToCross:case m.coverToCross+"-"+m.coverToCover:case m.coverToCross+"-"+m.coverNoMove:case m.coverToCover+"-"+m.coverToOut:case m.coverToCover+"-"+m.coverToCross:case m.coverToCover+"-"+m.coverToCover:case m.coverToCover+"-"+m.coverNoMove:case m.coverNoMove+"-"+m.coverToOut:case m.coverNoMove+"-"+m.coverToCross:case m.coverNoMove+"-"+m.coverToCover:return k(r,f,t,i,un,f.startRow+u,f.startColumn+a,f.endRow+u,f.endColumn+a);default:return k(r,f,t,i)}}function gn(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,A,g,I,O,g,b,E,S,f,g,b,x,E,S,f,b,x,u=!!r.source,a=u?r.source:n,g=f&&f.isDataValidator,b=K(e,n),x=!1,c=r.rowRelative,h=r.columnRelative,l=r.endRowRelative,v=r.endColumnRelative;if(0<=t||!c||!l||0<=i||!h||!v){if(d=r.row+(c?t:0),w=r.endRow+(l?t:0),m=r.column+(h?i:0),_=w-d+1,p=(C=r.endColumn+(v?i:0))-m+1,!g&&b){if(O=e.jyt(a,d,m,_,p))return r.offset(o,s,!0,t,i);if(e.Eyt(a,d,m,_,p))return rn.kyt;if(a!==e.gyt||a!==e.yyt||0!==o&&0!==s)return r;x=!0}if(f&&f.isNameID||n===e.gyt&&(I=n===e.yyt?e.Eyt(e.yyt,t,i,1,1):(g=t,b=i,f&&f.crossSheetMoved&&(g-=o,b-=s),e.jyt(e.gyt,g,b,1,1))),(x||n===a&&n===e.gyt&&n===e.yyt)&&(E=t,S=i,I&&(E-=o,S-=s),0===o||0===s)){if(!(f=nn(e,o,s,r,E,S)))return rn.kyt;if(0===s&&o&&f.endColumn>=C&&f.startColumn<=m||0===o&&s&&f.endRow>=w&&f.startRow<=d)return g=f.startRow,b=f.startColumn,x=f.endRow,E=f.endColumn,g===d&&x===w&&b===m&&E===C?r:(c&&(g-=t),l&&(x-=t),h&&(b-=i),v&&(E-=i),(0,rn.lJ)(r.source,un,g,b,x,E,c,h,l,v,t,i))}if(I&&(S=e.wyt-e.pyt,f=e.Myt-e.byt,_+=(c?-S:0)+(l?S:0),p+=(h?-f:0)+(v?f:0)),a===e.yyt&&e.Eyt(a,d,m,_,p)&&!p&&(!c&&!h&&!l&&!v||!I))return rn.kyt;if(g=(u&&a===e.gyt||!u&&n===e.gyt)&&(!I&&e.jyt(e.gyt,d,m,_,p)||I&&e.Eyt(e.yyt,c?d:d+o,h?m:m+s,_,p)),I&&(d-=j=c?o:0,w-=N=l?o:0,m-=k=h?s:0,C-=A=v?s:0),b=!1,g)d+=o,w+=o,m+=s,C+=s;else if(e.Eyt(a,d,m,_,p)){if(!(x=e.intersectWith(a,d,m,_,p))||x.rowCount!==_&&x.colCount!==p)return rn.kyt;d=x.row+o,m=x.col+s,w=d+x.rowCount,C=m+x.colCount,b=!0}return w-=l?t:0,m-=h?i:0,C-=v?i:0,e.gyt===e.yyt?a=u?r.source:sn:(a=r.source,g&&I&&u?a=e.yyt:g&&I||(g?a=e.yyt:I&&!u&&(a=e.gyt))),(d-=c?t:0)!==r.row||m!==r.column||w!==r.endRow||C!==r.endColumn||b||a!==r.source?(0,rn.lJ)(a,un,d,m,w,C,c,h,l,v,t,i):void 0}}function bn(n,t,i,r,e,f){var o,s,u,a,c,h,l,v,d,w,m,C,v,d,_,p,g,p,_,g,f,g,b,x,m,y,b,x,y,b,g,v,f,d,o,s=!!r.source?r.source:n,u=r.Tyt(),v=t,d=i,_=e.yyt.Mf;if(e.R0i&&(p=r.row,g=r.column,v=e.wyt+(p-e.pyt)+_.lT(e.wyt,p-e.pyt+1,!0),d=e.Myt+(g-e.byt)+_.lT(e.Myt,g-e.byt+1)),p=e.Dyt(v),_=e._yt(d),0===u){if(g=!e.Oyt&&pn(n,t,i,r,e))return g;if(g=gn(n,t,i,r,e,f,p,_))return g}else if(1===u){if(a=r.rowRelative,h=r.endRowRelative,0<=t||!a||!h){if(v=r.row+(a?t:0),(d=r.endRow+(h?t:0))<v)return rn.kyt;if(C=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,i,1,1),s===e.gyt&&s===e.yyt&&0===e.byt&&0===e.Myt&&e.Cyt===s.getColumnCount()){if(f=e.pyt,g=e.wyt,C&&(v-=p,d-=p),x=f+(b=e.Sx),y=f<=d&&d<x,(m=f<=v&&v<x)&&y)return C?r:r.offset(p,_,!0,t,i);if(b=g+b,m&&g<=d?(v+=p,d<b&&g<=d&&(d=b-1,v=x)):y&&v<=b&&(d+=p,g<=v)&&w<b&&(v=g,d=f-1),d-=h?t:0,(v-=a?t:0)!==r.row||d!==r.endRow)return(0,rn.lJ)(r.source,r.endSource,v,j.BAND_INDEX_CONST,d,j.BAND_INDEX_CONST,a,c,h,l,t,i)}if(C)return r.offset(-p,_,!0,t,i)}}else if(2===u){if(c=r.columnRelative,l=r.endColumnRelative,w=r.column+(c?i:0),(m=r.endColumn+(l?i:0))<w)return rn.kyt;if(C=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,i,1,1),s!==e.gyt||s!==e.yyt)return r.offset(p,-_,!1,t,i);if(0===e.pyt&&0===e.wyt&&e.Sx===s.getRowCount()){if(x=e.byt,y=e.Myt,C&&(w-=c?_:0,m-=l?_:0),g=x+(b=e.Cyt),f=x<=m&&m<g,(v=x<=w&&w<g)&&f)return C&&c&&l?r:r.offset(p,_,!0,t,i);if(d=y+b,v&&y<=m)w+=_,m<d&&y<=m&&(m=d-1,w=g);else if(f&&w<=d)m+=_,y<=w&&w<d&&(w=y,m=x-1);else if(C)return r.offset(-p,-_,!1,t,i);if(m-=l?i:0,(w-=c?i:0)!==r.column||m!==r.endColumn)return(0,rn.lJ)(r.source,r.endSource,j.BAND_INDEX_CONST,w,j.BAND_INDEX_CONST,m,a,c,h,l,t,i)}if(C)return r.offset(p,-_,!0,t,i)}return r}function J(n,t,i,r,e,f,o){var s,u,a,c,h,l,v,d,w,s=J,u=r;if(1===r.type&&r.hmt())u=f?Q(n,t,i,r,e,o):yn(n,t,i,r,e);else if(1===r.type)u=f?bn(n,t,i,r,e,o):Rn(n,t,i,r,e);else if(10===r.type)(a=s(n,t,i,r.value,e,f,o))!==r.value&&(u=(0,rn.Ayt)(a));else if(9===r.type)c=s(n,t,i,r.value,e,f,o),h=r.value2&&s(n,t,i,r.value2,e,f,o),c===r.value&&h===r.value2||(u=(0,rn.rbt)(r.operatorType,c,h));else if(7===r.type){for(l=un,d=v=void 0,w=r.arguments.length,d=0;d<w;d++)if((a=s(n,t,i,v=r.arguments[d],e,f,o))!==v){(l=[])[d]=a;break}if(l){for(d=0;d<w;d++)v=r.arguments[d],l[d]!==sn&&l[d]!==un||(l[d]=s(n,t,i,v,e,f,o));u=(0,rn.YJ)(r,l)}(0,rn.isExpression)(r.function)&&(u.function=s(n,t,i,r.function,e,f,o))}return u}function xn(n,t,i){var r,e,f,o,s,s,u,a,c,h,s,l,v,d,r=t.gyt.getSheet();if(!0!==r.EB)for(e=r.Ut.pj(),f=0;f<n.length;f++)if((o=n[f].validator).Epe)delete o.Epe;else if(s=o._S,u=(s=S(s)).r,a=s.c,h=(c=n[f].sheet).Uw(),(l=(s=o.condition()).getExpressions())&&0<l.length){for(v=0;v<l.length;v++)d=l[v],l[v]=J(h,u,a,d,t,i,{isDataValidator:!0});s.setExpressions(l,e)}}function yn(n,t,i,r,e){var f,o,s,u,a,c,h,f=r.source||n,o=r.rowRelative,s=r.columnRelative,c=e.Dyt(t),h=e._yt(i);if((0<=t||!o)&&(0<=i||!s)){if(u=r.row+(o?t:0),a=r.column+(s?i:0),e.Eyt(n,t,i,1,1)?(u-=o?c:0,a-=s?h:0):e.jyt(n,u,a,1,1)&&(u+=o?c:0,a+=s?h:0),e.jyt(f,u,a,1,1)?(u+=c,a+=h):e.Eyt(f,u,a,1,1)&&(u-=c,a-=h),a-=s?i:0,(u-=o?t:0)!==r.row||a!==r.column)return(0,rn.knt)(r.source,un,u,a,o,s)}else if((0<=t||!o)&&-1===i){if(u=r.row+(o?t:0),e.Eyt(n,t,-1,1,-1)?u-=o?c:0:e.jyt(n,u,-1,1,-1)&&(u+=o?c:0),e.jyt(f,u,-1,1,-1)?u+=c:e.Eyt(f,u,-1,1,-1)&&(u-=c),(u-=o?t:0)!==r.row||a!==r.column)return(0,rn.knt)(r.source,un,u,r.column,o,r.columnRelative)}else if(-1===t&&0<=i&&!s&&(a=r.column+0,e.Eyt(n,-1,i,-1,1)?a-=0:e.jyt(n,-1,a,-1,1)&&(a+=0),e.jyt(f,-1,a,-1,1)?a+=h:e.Eyt(f,-1,a,-1,1)&&(a-=h),a-=0,u!==r.row||a!==r.column))return(0,rn.knt)(r.source,un,r.row,a,r.rowRelative,s);return r}function Rn(n,t,i,r,e){var f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,y,R,f=r.source||n,o=r.Tyt(),y=e.Dyt(t),R=e._yt(i);if(0===o){if(v=r.rowRelative,d=r.columnRelative,w=r.endRowRelative,m=r.endColumnRelative,!(0<=t)&&v&&w||!(0<=i)&&d&&m)if(!(0<=t)&&v&&w||-1!==i){if(-1===t&&(0<=i||!d||!m)){if((a=r.column+(d?i:0))<(c=r.endColumn+(m?i:0)))return rn.kyt;if(e.Eyt(n,-1,i,-1,1)?(a-=g=d?R:0,c-=x=m?R:0):e.jyt(n,-1,i,-1,1)&&(a+=g=d?R:0,c+=x=m?R:0),e.jyt(f,-1,a,-1,l=c-a)?(a+=_=R,c+=_):e.Eyt(f,-1,a,-1,l)&&(a-=_=R,c-=_),c-=m?i:0,(a-=d?i:0)!==r.column||c!==r.endColumn)return(0,rn.lJ)(r.source,un,a,r.endRow,c,r.rowRelative,d,r.endRowRelative,m,t,i)}}else{if((s=r.row+(v?t:0))<(u=r.endRow+(w?t:0)))return rn.kyt;if(e.Eyt(n,t,-1,1,-1)?(s-=p=v?y:0,u-=b=v?y:0):e.jyt(n,t,-1,1,-1)&&(s+=p=v?y:0,u+=b=v?y:0),e.jyt(f,s,-1,h=u-s,-1)?(s+=C=y,u+=C):e.Eyt(f,s,-1,h,-1)&&(s-=C=y,u-=C),u-=w?t:0,(s-=v?t:0)!==r.row||u!==r.endRow)return(0,rn.lJ)(r.source,un,s,r.column,u,r.endColumn,v,r.columnRelative,w,r.endColumnRelative,t,i)}else if(s=r.row+(v?t:0),u=r.endRow+(w?t:0),a=r.column+(d?i:0),h=u-s,l=(c=r.endColumn+(m?i:0))-a,e.Eyt(n,t,i,1,1)?(s-=p=v?y:0,u-=b=w?y:0,a-=g=d?R:0,c-=x=m?R:0):e.jyt(n,s,a,h,l)&&(s+=p=v?y:0,u+=b=w?y:0,a+=g=d?R:0,c+=x=m?R:0),e.jyt(f,s,a,h,l)?(s+=C=y,u+=C,a+=_=R,c+=_):e.Eyt(f,s,a,h,l)&&(s-=C=y,u-=C,a-=_=R,c-=_),u-=w?t:0,a-=d?i:0,c-=m?i:0,(s-=v?t:0)!==r.row||a!==r.column||u!==r.endRow||c!==r.endColumn)return(0,rn.lJ)(r.source,un,s,a,u,c,v,d,w,m,t,i)}else if(1===o){if(v=r.rowRelative,w=r.endRowRelative,0<=t||!v||!w){if((s=r.row+(v?t:0))<(u=r.endRow+(w?t:0)))return rn.kyt;if(e.Eyt(n,t,-1,1,-1)?(s-=p=v?y:0,u-=b=w?y:0):e.jyt(n,t,-1,1,-1)&&(s+=p=v?y:0,u+=b=w?y:0),e.jyt(f,s,-1,h=u-s,-1)?(s+=C=y,u+=C):e.Eyt(f,s,-1,h,-1)&&(s-=C=y,u-=C),u-=w?t:0,(s-=v?t:0)!==r.row||u!==r.endRow)return(0,rn.lJ)(r.source,un,s,j.BAND_INDEX_CONST,u,j.BAND_INDEX_CONST,v,!1,w,!1,t,i)}}else if(2===o){if(d=r.columnRelative,m=r.endColumnRelative,a=r.column+(d?i:0),(c=r.endColumn+(m?i:0))<a)return rn.kyt;if(e.Eyt(n,-1,i,-1,1)?(a-=g=d?R:0,c-=x=m?R:0):e.jyt(n,-1,i,-1,1)&&(a+=g=d?R:0,c+=x=m?R:0),e.jyt(f,-1,a,-1,l=c-a)?(a+=_=R,c+=_):e.Eyt(f,-1,a,-1,l)&&(a-=_=R,c-=_),c-=m?i:0,(a-=d?i:0)!==r.column||c!==r.endColumn)return(0,rn.lJ)(r.source,un,j.BAND_INDEX_CONST,a,j.BAND_INDEX_CONST,c,!1,d,!1,m,t,i)}return r}function G(n,t,i,r,e,f){n.Ryt(t,i,r,e,!0,!1,f)}function jn(n,t,i){var r,e,f,o,s,u,a,c,h,r=jn,e=t;if(8===t.type){if(t.value===i&&(!t.source||t.source===n.getSource()))return(0,rn.Syt)(g,t.source)}else if(10===t.type)(f=r(n,t.value,i))!==t.value&&(e=(0,rn.Ayt)(f));else if(9===t.type)u=r(n,t.value,i),a=t.value2&&r(n,t.value2,i),u===t.value&&a===t.value2||(e=(0,rn.rbt)(t.operatorType,u,a));else if(7===t.type){for(c=un,h=t.arguments.length,s=0;s<h;s++)if((f=r(n,o=t.arguments[s],i))!==o){(c=[])[s]=f;break}if(c){for(s=0;s<h;s++)o=t.arguments[s],c[s]!==sn&&c[s]!==un||(c[s]=r(n,o,i));e=(0,rn.YJ)(t,c)}}return e}Object.defineProperty(n,"__esModule",{value:!0}),n.adjustFormulaOnMoveSwap=n.CalcOperatorAdjustor=n.MoveSwapInfo=void 0,rn=t("CalcEngine"),s=t("Common"),en=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),j=t("./dist/plugins/sheetsCalc/calc.ns.js"),y=t("./dist/plugins/sheetsCalc/parser-sheets.js"),fn=t("Core"),V=s.Common.lt.ht,t=s.Common.zf,A=t.Gmt,on=Math.min,w=Math.max,sn=void 0,un=null,C=rn.Convert.BJ,g=rn.Errors.Reference,S=fn.util.z0,r.prototype.Dyt=function(n){var t,i,n,i,t=this,i=t.yyt.Mf;return t.Oyt=i&&i.o5(),t.Oyt&&0<=n?(n=n-t.wyt+1,i=i.ix(t.wyt,n,!0),t.wyt-t.pyt+i):t.wyt-t.pyt},r.prototype._yt=function(n){var t,i,n,i,t=this,i=t.yyt.Mf;return t.Oyt=i&&i.o5(),t.Oyt&&0<=n?(n=n-t.Myt+1,i=i.ix(t.Myt,n),t.Myt-t.byt+i):t.Myt-t.byt},r.prototype.jyt=function(n,t,i,r,e){var f=this;return f.gyt===n&&(-1===f.pyt||f.pyt<=t&&t+r<=f.pyt+f.Sx)&&(-1===f.byt||f.byt<=i&&i+e<=f.byt+f.Cyt)},r.prototype.Eyt=function(n,t,i,r,e){var f,o,s,u,a,c,h,f=this,o=f.yyt.Mf,s=o&&o.o5(),u=f.wyt,a=f.Myt,c=f.Sx,h=f.Cyt;return s&&(c+=o.lT(u,c,!0),h+=o.lT(a,h)),f.yyt===n&&(-1===u||u<=t&&t+r<=u+c)&&(-1===a||a<=i&&i+e<=a+h)},r.prototype.intersectWith=function(n,t,i,r,e){var f,t,o,f=this;return f.yyt!==n?un:(t=f.Byt(n,t,i,r,e),(o=f.Byt(n,f.pyt,f.byt,r,e)).intersectWith(t))},r.prototype.Byt=function(n,t,i,r,e){var f,o,s,u,f,o,s,u;return{row:-1===t?0:t,column:-1===i?0:i,rowCount:-1===t||-1===r?n.rowCount:r,columnCount:-1===i||-1===e?n.colCount:e,intersectWith:c}},L=r,n.MoveSwapInfo=L,a=function(n){switch(n){case fn.PasteOperationOptions.add:return 3;case fn.PasteOperationOptions.subtract:return 4;case fn.PasteOperationOptions.multiply:return 5;case fn.PasteOperationOptions.divide:return 6}},an.gB=function(n,t,i,r,e,f,o,s,u,a,c){var h,l,v,d,w,m,C,_,p,h=i,l=an,v=this.gB;if(i)if(10===(m=i.type))h=(0,rn.Ayt)(v.call(l,n,t,i.value,r,e,f,o,s,u,a,c));else if(1===m&&i.hmt()){if(d=on((i.source||t).getRowCount(),j.MAX_ROW_COUNT),w=on((i.source||t).getColumnCount(),j.MAX_COLUMN_COUNT),i.rowRelative&&(i.row+r<0||i.row+r>=d)||i.columnRelative&&(i.column+e<0||i.column+e>=w))return(0,rn.Syt)(g,i.source);h=i.offset(0,0,!1)}else if(1===m){if(d=on((i.source||t).getRowCount(),j.MAX_ROW_COUNT),w=on((i.source||t).getColumnCount(),j.MAX_COLUMN_COUNT),i.rowRelative&&!i.isFullColumn&&(i.row+r<0||i.row+r>d)||i.columnRelative&&!i.isFullRow&&(i.column+e<0||i.column+e>w)||i.endRowRelative&&!i.isFullColumn&&(i.endRow+r<0||i.endRow+r>d)||i.endColumnRelative&&!i.isFullRow&&(i.endColumn+e<0||i.endColumn+e>w))return(0,rn.Syt)(g,i.source,i.endSource);h=i.offset(0,0,!1,r,e)}else if(9===i.type)h=(0,rn.rbt)(i.operatorType,v.call(l,n,t,i.value,r,e,f,o,s,u,a,c),i.value2&&v.call(l,n,t,i.value2,r,e,f,o,s,u,a,c));else if(7===m){if(_=[],i.arguments&&0<i.arguments.length)for(p=0;p<i.arguments.length;p++)_[p]=v.call(l,n,t,i.arguments[p],r,e,f,o,s,u,a,c);h=(0,rn.YJ)(i,_)}else 13===m&&(h=i.offsetWhenCopy(n,t,r,e,f,o,s,u,a,c));return h},an.copyFormula=function(T,L,n,t,i,r,Y,V,X,J,G,e){var f,o,P,s,H,u,U,a,c,h,l,v,d,w,m,C,_,p,g,b,x,B,$,W,K,Q,Z,q,z,y,R,j,nn,tn,N,k,A,I,I,I,I,O,E,I,S,M,S,M,D,F,F,f=T.b3(),o=t.b3(),P=f.getSource(),s=o.getSource(),H=an;if(f&&o){for(e&&(u=e.transpose,U=e.operationOptions),a=s&&s.getSheet().Ut.pj(),h=n,l=i,v=r,d=Y,w=V,(c=L)<0&&(c=0,d=on(f.rC(),o.rC())),n<0&&(h=0,w=on(f.cC(),o.cC())),i<0&&(l=0),r<0&&(v=0),m=new rn.CalcSourceModel(f.op(),P),b=s.getSheet(),x=!J&&b.o5(),B=d,$=w,W=b.getRowCount(),K=b.getColumnCount(),C=0;C<d;C++)for(_=0;_<w;_++)Q=C+c,Z=_+h,u&&(Q=c+_,Z=h+C),f.Lyt(m,Q,Z,C,_);for(q={},z=o.op(),p=C=0;C<d&&C+l<W;C++)if(y=C+l,x&&0===b.getRowHeight(y))d++;else{if(!X||!s.isHiddenRow(y,!0))for(g=_=0,w=$;_<w&&_+v<K;_++)if(R=_+v,x&&0===b.getColumnWidth(R))w++;else{if((j=m.pB(p,g))||e){if(j===q)continue;if(j=H.gB(P,s,j,y,R,nn=i+C-L-p,tn=r+_-n-g,i,r,B,$),N=m.sT(p,g),s){if(x&&N)continue;if(N&&!N.isDynamicArray){for(k=N.rowCount,A=N.colCount,0<(I=c-N.row)&&(k-=I),(I=d-C)<k&&(k=I),0<(I=h-N.col)&&(A-=I),(I=w-_)<A&&(A=I),O=0;O<k;O++)for(E=0;E<A;E++)m.bB(C+O,_+E,q);o.setArrayFormula(y,R,k,A,z.unparse(s,j,y,R),sn,a)}else{if(I=m.Ile(p,g),G&&b&&I&&(b.vle=I),U&&(S=p+c,M=g+h,u&&(S=g+c,M=p+h),j=cn(j,T.getValue(S,M),o.pB(y,R),t.getValue(y,R),U))&&j.value.type===rn.ExpressionType.number&&j.value2.type===rn.ExpressionType.number){(S=(0,en.evaluateExpression)(t,j))instanceof rn.CalcError||t.setValue(y,R,S),g++;continue}j&&u&&hn(j),M=j?z.unparse(s,j,y,R):sn,s.setFormula(y,R,M,sn),I&&b.Ut.setDefaultValue(y,R,M,un,fn.DefaultChangeValueType.Expression,un,!0),(D=m.Fyt(p,g))&&(F=new rn.EvaluateContext(s,(0,rn.eV)(y,R),!1),D=(D=o.Lbt.allowDynamicArray?(0,rn.h0t)(F,j,!1,0,0,!0,!0):(0,rn.Pyt)(F,j,!1,0,0,!1,!1))===j?sn:D),o.Gyt(y,R,j,D,N,a),I&&(delete b.vle,F=o.oT(y,R))&&F.isDefault(I)}}else o.bB(y,R,j),o.Uyt(y,R,N)}else o&&o.pB(y,R)&&o.Gyt(y,R,sn,sn,sn,a);g++}p++}}},an.moveFormula=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,T,v,d,w,m,n,C,_,p,g,b,x,y,R,j,L,N,k,A,I,O,Y,E,S,M,D,F,D,m,n,u=n.b3(),a=r.b3(),c=u.op();if(u&&a){for(h=r.getRowCount(),l=r.getColumnCount(),T=u.pj(),v=a.pj(),d=c.Hyt(),t<0&&(t=0,o=on(n.getRowCount(),h)),e<0&&(e=0),i<0&&(i=0,s=on(n.getColumnCount(),l)),f<0&&(f=0),w=!(n===r&&n.name()===r.name()),n=s,C=m=o,(p=r.o5())&&(m+=r.lT(e,o,!0),n+=r.lT(f,s)),u.mF(t,i,o,s),G(u,t,i,o,s),a.mF(e,f,m,n),G(a,e,f,m,n),g=[],b=0;b<o;b++)for(I=b+t,x=0;x<s;x++)y=u.pB(I,O=x+i),R=u.sT(I,O),j=u.Fyt(I,O),N=(L=u.oT(I,O))&&L.isDefault(),y&&(g[b*s+x]={WK:y,$bt:R,eyt:j,xle:N},u.zyt(I,O,T),R&&(I!==R.row||O!==R.col)||u.rT.setFormula(I,O,un,sn));for(E=w?{}:null,k=b=0;b<C&&b+e<h;b++)if(S=b+e,p&&0===r.getRowHeight(S))C++;else{for(A=x=0,_=s;x<_&&f+x<l;x++)if(M=x+f,p&&0===r.getColumnWidth(M))_++;else{if(D=g[k*s+A]){if(y=D.WK,R=D.$bt,p&&R){A++;continue}c&&R&&!R.isDynamicArray&&R.row===t+b&&R.col===i+x&&(Y=(0,fn.Ec)(S,M,R.rowCount,R.colCount)),F=R&&!R.isDynamicArray?Y:sn,j=D.eyt,(N=D.xle)&&(r.vle=N),a.Vyt(v,S,M),a.bB(S,M,y),a.Uyt(S,M,F),a.Yyt(S,M,j),a.Nle(S,M,N),(!F||F.row===S&&F.col===M)&&(D=a.getFormula(S,M),a.rT.setFormula(S,M,D,F),N)&&r.Ut.setDefaultValue(S,M,D,un,fn.DefaultChangeValueType.Expression,un,!0),w&&(E[S+", "+M]=y),N&&delete r.vle}else V(a.pB(S,M))||(a.Vyt(v,S,M),a.bB(S,M,sn),a.Uyt(S,M,sn));A++}k++}d.Zyt(u,t,i,o,s),d.Zyt(a,e,f,m,n),n=(m=u.getSource().getSheet()).b8&&(m.parent||m).xyt(),d.Wyt(n,u.getSource(),t,i,a.getSource(),e,f,o,s,!0,E),!0==w&&d.Wyt(n,u.getSource(),t,i,a.getSource(),e,f,o,s,!0,E)}},an.prototype.isAdjustCell=function(n){return n.preAdj||this.y3&&n===this.y3[0]},an.prototype.isAdjust=function(n){return n.preAdj||this.y3&&n===this.y3[0]},an.prototype.Qyt=function(n,t){var i=this,r,e;isNaN(t)||(i.y3||(i.y3={},i.Kyt={}),r=i.y3[t],e=i.Kyt[t],n&&!n.preAdj&&n!==r&&(r?e.nextAdj=n:i.y3[t]=n,n.preAdj=e,n.nextAdj=un,i.Kyt[t]=n))},an.prototype.Jyt=function(n,t){var i,r,r,e,i=this;isNaN(t)||(r=i.y3&&i.y3[t],n&&(n.preAdj||n===r)&&(r=n.preAdj,e=n.nextAdj,r?r.nextAdj=e:i.y3[t]=e,e?e.preAdj=r:i.Kyt[t]=r,n.preAdj=un,n.nextAdj=un))},an.prototype.Xyt=function(n,t,i,r,e,f,o){this.qyt(n,x,t,i,r,e,f,o);var s=0,u=0,a=0,c=0;0===t&&(r&&e?a=i:r?s=i:e?c=i:u=i),h(n,x,t,i,s,u,a,c,r,e,f),v(n,x,t,i,r,e),U(n,x,t,i,r,e,o)},an.prototype.qyt=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,g,u,y,R,j,N,k,A,I,O,E,a=this,c=a.y3;if(c){for(_=(0,rn.createMap)();c[0];){if(C=(h=(w=c[0]).w3).pj(),m=h.getSource(),X(_,h,l=w.row,v=w.column));else{if(!(d=h.pB(l,v))||t===D&&m===n)(h.getRowExpression&&h.getRowExpression(l)||h.getColumnExpression&&h.getColumnExpression(v))&&h.gF(l,v,1,1);else if(d=t.call(a,m,l,v,d,n,i,r,e,f,sn,o,s),p=h.sT(l,v)){if(m===n&&(g=f?r:-r,e?i<=p.row&&(p.row+=g):i<=p.col&&(p.col+=g)),l===p.row&&v===p.col)if(p.isDynamicArray)h.SB(l,v,d,p,!0,M(e?l:v,i,C,n.id===m.id));else for(b=l;b<l+p.rowCount;b++)for(x=v;x<v+p.colCount;x++)h.SB(b,x,d,p,b===l&&x===v,M(e?b:x,i,C,n.id===m.id)),Y(_,h,b,x,!0)}else g=m.Mf,(u=!s&&(null==(u=h.oT(l,v))?void 0:u.isDefault()))&&(g.vle=u),h.SB(l,v,d,p,!0,M(e?l:v,i,C,n.id===m.id),un,un,s),u&&(y=m.nT,R=h.op().unparse(m,d,l,v),g.Ut.setDefaultValue(l,v,R,y,fn.DefaultChangeValueType.Expression,un,!0),delete g.vle)}a.Jyt(w,0)}for(;c[1];)C=(h=(w=c[1]).w3).pj(),l=w.row,h.getRowExpression&&(d=h.getRowExpression(l))&&h.SB&&(m=h.getSource(),h.SB(l,-1,t.call(a,m,l,-1,d,n,i,r,e,f),sn,!0,M(l,i,C,n.id===m.id))),a.Jyt(w,1);for(;c[2];)C=(h=(w=c[2]).w3).pj(),v=w.column,h.getColumnExpression&&(d=h.getColumnExpression(v))&&h.SB&&(m=h.getSource(),h.SB(-1,v,t.call(a,m,-1,v,d,n,i,r,e,f),sn,!0,M(v,i,C,n.id===m.id))),a.Jyt(w,2);for(;c[3];)N=(j=c[3]).name,d=(h=j.w3).$yt(N),k=t.call(a,h.getSource(),0,0,d,n,i,r,e,f,{isNameID:!0}),h.twt(N,k),a.Jyt(j,3);for(A in c)if(3<(I=+A)&&c.hasOwnProperty(A))for(;c[A];)E=(O=c[A]).w3,d=t.call(a,E,0,0,O.expression,n,i,r,e,f),E.setExpression(O.id,O.name,d),a.Jyt(O,I)}},an.prototype.nwt=function(n){var t=this,i,r,e;G(n.getCalcSourceModel(),0,0,n.getRowCount(),n.getColumnCount()),t.qyt(n,D),h(n,D,0,0,0,0,0,0,!0,!1),v(n,D,0,0,!0,!1)},an.prototype.Wyt=function(n,t,i,r,e,f,o,s,T,u,a){var c,h,l,v,d,w,m,C,_,p,g,b,x,y,R,j,R,N,k,R,c,A,I,O,E,S,M,D,F,h=this,l=J,v=new L(t,i,r,e,f,o,s,T),p=(0,rn.createMap)();if(n&&xn(n,v,u),H(t,v,u),y={},b=h.y3){for(;b[0];){if(d=(w=b[0]).w3,m=w.row,C=w.column,g=d.pj(),X(p,d,m,C));else{if(_=d.pB(m,C),x=d.getSource(),_)if(R=sn,a&&a[m+", "+C]&&(x=t,R={crossSheetMoved:!0}),_=l.call(h,x,m,C,_,v,u,R),R=void 0,(j=d.sT(m,C))&&!j.isDynamicArray)if(R=P(j),m===j.row&&C===j.col)for(y[R]=!0,N=m;N<m+j.rowCount;N++)for(k=C;k<C+j.colCount;k++)d.SB(N,k,_,j,N===m&&k===C,g),Y(p,d,N,k,!0);else y[R]||(d.SB(m,C,_,j,!1,g),Y(p,d,m,C,!0));else R=e.Mf,(c=null==(c=d.oT(m,C))?void 0:c.isDefault())&&(R.vle=c),d.SB(m,C,_,j,!0,g),c&&delete R.vle;else(d.getRowExpression&&d.getRowExpression(m)||d.getColumnExpression&&d.getColumnExpression(C))&&d.gF(m,C,1,1)}h.Jyt(w,0)}for(;b[1];)d=(w=b[1]).w3,m=w.row,g=d.pj(),d.getRowExpression&&(_=d.getRowExpression(m))&&d.ewt&&d.ewt(m,l.call(h,x,m,-1,_,v,u),sn,g),h.Jyt(w,1);for(;b[2];)d=(w=b[2]).w3,C=w.column,g=d.pj(),d.getColumnExpression&&(_=d.getColumnExpression(C))&&d.iwt&&d.iwt(C,l.call(h,x,-1,C,_,v,u),sn,g),h.Jyt(w,2);for(;b[3];)I=(A=b[3]).name,_=(d=A.w3).$yt(I),O=l.call(h,x,0,0,_,v,u),d.twt(I,O),h.Jyt(A,3);for(E in b)if(3<(S=+E)&&b.hasOwnProperty(E))for(;b[E];)F=(D=(M=b[E]).w3).getSource(),_=l.call(h,F,0,0,M.expression,v,u),D.setExpression(M.id,M.name,_),h.Jyt(M,S)}},an.prototype.Zyt=function(n,t,i,r,e){for(var f,o,s,u,a,c,h,l,f=this,o=t+r,s=i+e,c=t;c<o;c++)if(n.dataTable[c])for(h=i;h<s;h++)u=n.rwt(c,h),a=n.pB(c,h),(u||a)&&(f.Jyt(u,0),l=this.zCe(n,u,c,h),u&&a&&(u.row!==l.row||u.column!==l.column||u.isDefault())&&(l.oldRow=u.row,l.oldColumn=u.column,l.isDefault(u.isDefault())),f.Qyt(l,0))},an.prototype.zCe=function(n,t,i,r){var e,t;return t&&t.aT&&t[3]&&(e={aT:[3],3:t[3]}),n.owt(i,r,0),t=n.oT(i,r,!0),e&&(t[3]=e[3],t.aT=e.aT),t},an.prototype.awt=function(n,t,i){for(var r,e,f,r=this,e=t;-1!==e&&e<t+i;e++)(n.rwt(-1,e)||n.pB(-1,e))&&(n.owt(-1,e,2),f=n.uwt(e,!0),r.Qyt(f,2))},an.prototype.swt=function(n,t,i){for(var r,e,f,r=this,e=t;-1!==e&&e<t+i;e++)(n.rwt(e,-1)||n.pB(e,-1))&&(n.owt(e,-1,1),f=n.cwt(e,!0),r.Qyt(f,1))},an.prototype.fwt=function(n){for(var t,i,r,e,f,o,s,t=this,i=n.op().getAllSourceModels(),f=0;f<i.length;f++)if((o=i[f]).lwt)for(r=o.lwt(),s=0;s<r.length;s++)(e=r[s])&&e.isVolatile&&e instanceof rn.CellCalc&&!t.isAdjustCell(e)&&t.Qyt(e,0)},an.prototype.onBeforeAddRemoveRows=function(n,r,t){[n,t].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),n.mF(r,0,t-r,i),n.hwt(r,t-r),G(n,r,-1,t-r,-1,!0))})},an.prototype.onAfterAddRemoveRows=function(n,r,e,f,t,i){var o=this;[n,i].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),f?n.gF(r,0,e,i):t+=e,o.Zyt(n,r,0,t-r,i),o.swt(n,r,t-r),o.fwt(n))}),o.Xyt(n.getSource(),r,e,!0,f,sn,t),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},an.prototype.onAfterAddRemoveColumns=function(n,r,e,f,t,i){var o=this;[n,i].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),f?n.gF(0,r,t,e):i+=e,o.Zyt(n,0,r,t,i-r),o.awt(n,r,i-r),o.fwt(n))}),o.Xyt(n.getSource(),r,e,!1,f,sn,t),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},an.prototype.onBeforeAddRemoveColumns=function(n,r,t){[n,t].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),n.mF(0,r,t,i-r),n.dwt(r,i-r),G(n,-1,r,-1,i-r,!0))})},an.prototype.onAfterRemoveName=function(n,t){var n=n.vwt(t,!1);n&&(n.updateListening(!0,!1),n.vyt(),n.updateListeningOnRemoved())},an.prototype.adjustFormulaOnRemoveName=jn,an.prototype.invalidName=function(n,t){var i,n;t&&(n=(i=n.getCalcSourceModel()).vwt(t.toUpperCase(),!0))&&n.mB()},an.prototype.onAfterRemoveTable=function(n,t){for(var i,r,e,f,o,s,u,a,c,h,l,v,d,i=this,s=0;s<n.length;s++)G((u=n[s]).source().getCalcSourceModel(),u.startRow(),u.startColumn(),u.endRow()-u.startRow()+1,u.endColumn()-u.startColumn()+1);if(a=i.y3)for(c=(0,rn.createMap)();a[0];){if(X(c,r=(h=a[0]).w3,e=h.row,f=h.column));else{if(o=r.pB(e,f))if(o=an.adjustExpressionOnRemoveTable(o,n,e,f,t),(l=r.sT(e,f))&&!l.isDynamicArray)for(l=(0,fn.Ec)(e,f,l.rowCount,l.colCount),v=e;v<e+l.rowCount;v++)for(d=f;d<f+l.colCount;d++)r.SB(v,d,o,l,v===e&&d===f),Y(c,r,v,d,!0);else r.SB(e,f,o,l,!0);else(r.getRowExpression&&r.getRowExpression(e)||r.getColumnExpression&&r.getColumnExpression(f))&&r.gF(e,f,1,1)}i.Jyt(h,0)}},an.adjustExpressionOnRemoveTable=function(n,t,i,r,e){var f,o,s,u,a,c,h,l,v,d,w,o,s,m,C,_,p,g,f=an.adjustExpressionOnRemoveTable;if(9===n.type){if(o=n.value,s=n.value2,u=f(o,t,i,r,e),a=s&&f(s,t,i,r,e),o!==u||s!==a)return(0,rn.rbt)(n.operatorType,u,a)}else if(7===n.type){for(c=!1,h=[],l=0;l<n.arguments.length;l++)d=f(v=n.arguments[l],t,i,r,e),c=c||v!==d,h.push(d);if(c)return(0,rn.YJ)(n,h)}else if(10===n.type){if((o=n.value)!==(s=f(o,t,i,r,e)))return(0,rn.Ayt)(s)}else if(13===n.type)for(m=n,l=0;l<t.length;l++)if(m.baseTable===t[l])return e?rn.kyt:(C=m.getRange(-1===i?0:i,-1===r?0:r,!0),_=-1===i||1===m.referencePortions(),p=1===C.rowCount&&1===C.colCount,g=m.source,p?(0,rn.knt)(g,un,_?C.row-i:C.row,C.col,_,!1):(0,rn.lJ)(g,un,_?C.row-i:C.row,C.col,C.row+C.rowCount-1,C.col+C.colCount-1,_,!1,_,!1));return n},i=an,n.CalcOperatorAdjustor=i,(o=rn.CalcService.prototype).mwt=function(){return new i},(t=m=m||{}).outToOut="0_0",t.outToCover="0_1",t.outToInside="0_2",t.outToPart="0_3",t.outToCross="0_4",t.outNoMove="0_9",t.coverToOut="1_0",t.coverToCover="1_1",t.coverToCross="1_4",t.coverNoMove="1_9",t.insideToOut="2_0",t.insideToInside="2_2",t.insideToPart="2_3",t.insideToCross="2_4",t.insideNoMove="2_9",t.partToOut="3_0",t.partToInside="3_2",t.partToPart="3_3",t.partToCross="3_4",t.partNoMove="3_9",t.crossToOut="4_0",t.crossToCover="4_1",t.crossToInside="4_2",t.crossToPart="4_3",t.crossToCross="4_4",t.crossNoMove="4_9",n.adjustFormulaOnMoveSwap=J},"./dist/plugins/sheetsCalc/parser-sheets.js":function(T,d,n){var t,v,b,I,m,x,y,R,i,n,r,w,C,j,c,_,L,o,s,a,Y,h,e,f,n,n,u,l;function V(n){return i(n+1).split("")}function p(n,t){var i=t+1;return n<0?n%i+i:t<n?n%i:n}function X(n){return new I.ErrorSource(n)}function J(n,t,i,r,e,f,o){return 3===o||0<=i&&0<=r||1===o&&0<=i||2===o&&0<=r}function G(n,t,i,r,e){var f,f,o,o,o,f=x.BAND_INDEX_CONST,f={Ky:f,iw:f,gwt:!0,pwt:!0,bwt:!1,ywt:0,wwt:!0},o=t?B(n,i,r,0):U(n,0,e);if(o.DX?(f.Ky=o.Mwt,f.gwt=o.Cwt):(f.iw=o.Mwt,f.pwt=o.Cwt),f.ywt=o.ywt,f.bwt=o.bwt,o.bwt&&!(o.ywt>=n.length)){if(!t&&o.DX||t&&!o.DX)return{bwt:!1};if(o=n[f.ywt],(t||!(0,I.isNumber)(o)&&"$"!==o)&&(!t||"C"!==o&&"c"!==o))return{bwt:!1};o=t?B(n,i,r,f.ywt):U(n,f.ywt,e),f.ywt=o.ywt,!o.bwt||!t&&!o.DX||t&&o.DX?f.bwt=!1:(f.ywt<n.length&&(f.wwt=!1),t?(f.iw=o.Mwt,f.pwt=o.Cwt):(f.Ky=o.Mwt,f.gwt=o.Cwt),f.bwt=!0)}return f}function P(n){return(0,I.Swt)(n)||95===n.charCodeAt(0)}function H(n,t,i){for(var r=n,e=t[n],n=!1;r<i&&!P(e);)++r<i&&(e=t[r]);if(r<i){for(;r<i&&P(e);)++r<i&&(e=t[r]);r<i&&(n=!0)}return n}function U(n,t,i){var r,e,f,o,s,u,a,c,h,l,v,r={Cwt:!0,bwt:!1},e=n.length;if(!(e<=t||("$"===n[t]&&(r.Cwt=!1,t++),e<=t)))if(s=n[f=t],(o=0,I.isNumber)(s)&&"0"!==s){for(r.DX=!0;f<e&&(0,I.isNumber)(s);)++f<e&&(s=n[f]);if(7<f-t)return r;for(u=f-1,a=0;t<=u;u--,a++)o+=(n[u].charCodeAt(0)-48)*_[a];if(o<=d.maxRowCount)r.Mwt=o-1,r.ywt=f,r.bwt=!0}else if((0,I.Swt)(s)){for(r.DX=!1;f<e&&(0,I.Swt)(s);)++f<e&&(s=n[f]);if(3<(c=f-t)||H(f,n,e))return r;for(l=h=f-1;t<=l;l--){if(!(65<=(v=n[l].charCodeAt(0))&&v<=90||97<=v&&v<=122))return r;o+=((32|v)-96)*w[h-l]}if(o<=d.maxColumnCount)r.Mwt=o-1,r.ywt=f,r.bwt=!0}return r}function B(n,t,i,r){var e,f,o,s,u,a,t,i,e,f={ywt:r,Mwt:x.BAND_INDEX_CONST,DX:!0,Cwt:!1,bwt:!1},o=n.length;if(o<=r)return f;if("R"===(u=n[s=r])||"r"===u)f.DX=!0,a=t;else{if("C"!==u&&"c"!==u)return f;f.DX=!1,a=i}if(s++,o<=++r)return f.ywt=r,f.Mwt=a,f.Cwt=!0,f.bwt=!0,f;if("["===(u=n[s])&&(r++,s++,f.Cwt=!0),o<=r)return f;if(t=!1,u=n[s],f.Cwt&&"-"===u&&(r++,s++,t=!0),o<=r)return f;if(u=n[s],!(0,I.isNumber)(u))return f.Cwt||(f.ywt=r,f.Mwt=a,f.Cwt=!0,f.bwt=!0),f;for(;s<o&&(0,I.isNumber)(u);)++s<o&&(u=n[s]);if(i=parseInt(n.slice(r,s).join(""),10),f.Cwt){if(o<=s||"]"!==n[s])return f;s++}return i<(f.DX?d.maxRowCount:d.maxColumnCount)?(f.Mwt=f.Cwt?(i=t?-i:i)+a:i-1,f.ywt=s,f.bwt=!0,f):void 0}function $(n,t,i,r){var e,f,o,s,e=n.row||0,f=n.column||0,o=i.type;if(i.source){if(!(s=K(n,r,i.source,i.endSource)))return void r.push("#","R","E","F","!")}else!i.source&&n.addSheetName&&1===o&&(2===n.addSheetName?r.push("!"):K(n,r,n.source,C));8===o||5===o||i.value&&i._error?r.push(i.value.toString()):i.hmt()?g(n.useR1C1,e,f,i.row,i.column,i.rowRelative,i.columnRelative,r):W(n.source,n.useR1C1,e,f,i.row,i.column,i.endRow,i.endColumn,i.rowRelative,i.columnRelative,i.endRowRelative,i.endColumnRelative,r,i.Tyt())}function g(n,t,i,r,e,f,o,s,u){var a,a,a=d.maxRowCount-1;(0===(u=u||0)||1===u)&&-a<r&&r<=2*a&&(r=p(r+=f?t:0,a)),a=d.maxColumnCount-1,J(t,i,r,e=(0===u||2===u)&&-a<e&&e<=2*a?p(e+=o?i:0,a):e,f,o,u)?n?2!==u&&(s.push("R"),0<=r&&(t!==r||!f)&&(f?s.push("["+(r-t)+"]"):s.push(++r+"")),e<0)||1!==u&&(s.push("C"),i===e&&o||(o?s.push("["+(e-i)+"]"):s.push(++e+""))):(0<=e&&(o||s.push("$"),s.push.apply(s,V(e))),r<0||(r++,f||s.push("$"),s.push(r+""))):s.push(I.Errors.Reference.toString())}function W(n,t,i,r,e,f,o,s,u,a,c,h,l,v){3===(v=v||0)&&(e=0,o=d.maxRowCount-1,v=1),g(t,i,r,e,f,u,a,l,v);var u=x.BAND_INDEX_CONST;t&&e===o&&f===s&&(o===u||s===u)||o===u&&s===u||(l.push(":"),g(t,i,r,o,s,c,h,l,v))}function K(n,t,i,r){if(n.getExternalSourceToken){if(i){var i=(0,I.Mge)(n,n.getExternalSourceToken(i).split(""),r&&n.getExternalSourceToken(r).split(""));if(!(0<i.length))return!1;t.push.apply(t,i)}return t.push("!"),!0}return!1}function N(n){var t=new I.Expression(8);return t.value=n,t}function Q(n){var t=n;return t=n&&3<=n.length&&"["===n[0]&&"0"===n[1]&&"]"===n[2]?3===n.length?"":n.substring(3):t}function Z(n,t,i){var r,n,e,f,o,s,n=n.source;return r=n&&(e=n.G3,f=n.S8,o=n.T8,e)&&(s=0<=t&&t<f&&o<=i||f<=t&&0<=i&&i<o)?n:r}function k(n){var t=f.call(this,8e3)||this;return t.Mf=n,t}function q(n,t,i,r,e){return 0===t.uit&&0===t.Twt||!r&&0===t.uit&&4===t.Twt&&(!e||i<n.length-2&&":"===n[i+1].Awt&&0===n[i+2].uit&&4===n[i+2].Twt)}function z(n,t,i,r,e){return t<=n.startRow()&&i<=n.startColumn()&&t+r>n.endRow()&&i+e>n.endColumn()}function A(){return u.call(this,13)||this}function nn(n,t){this.abt.Iwt(n,this,t)}function O(n){var t=l.call(this,7900)||this;return t.Mf=n,t}function tn(n,t,i){var r,e,f,i,o,s,o,u,a,c,h,l,v,v,d,r=i,e=0,f=t[e],i=ln(n,t,e,f),o=i.nM;if(!o){if(s=n.keepUnknownFormulas)return;M()}for(r.baseTable=o,e=i.xwt,f=t[++e],o=e;" "===f;)f=t[++e];for("@"!==f&&"["!==f&&(f=t[e=o]),c=a=!(u=1),h=t.length;0!==u&&e<h;)if("["===f&&(u++,f=t[++e]),"#"===f)a&&u<=1&&M(),v=(l=hn(t,e,f,u)).Nwt,e=l.xwt,f=l.kwt,u=l.Dwt,a?2===r.hbt&&3===v||2===v&&3===r.hbt?r.hbt=6:3===r.hbt&&8===v||3===v&&8===r.hbt?r.hbt=12:M():r.hbt=v,a=!0;else if("@"===f){for((1<u||a)&&M(),a=!0,r.hbt=1,f=t[++e];" "===f;)f=t[++e];"["===f&&"#"===t[e+1]&&"this row"===E(t,e+2,e+10).toLowerCase()&&(a=!1),","===f&&M()}else{for(v=e;!R(f)&&"]"!==f&&"["!==f;)if("'"===f&&e++,","===f){for(f=t[++e],d=e;" "===f;)f=t[++e];if("["===f){e=d,f=",";break}}else f=t[++e];if(v<e&&((c||"["===f&&1<u)&&M(),e=(l=rn(r,t,e,f,u,v)).xwt,f=l.kwt,u=l.Dwt,c=!0),"]"===f){if(0===--u)break;e>=t.length&&M(),f=t[++e]}","===f&&(f=t[++e])}a||(r.hbt=n._wt?1:16),c||(r.cbt=0,r.fbt=r.abt.endColumn()-r.abt.startColumn(),r.lbt=1)}function E(n,t,i){return n.slice(t,i).join("")}function rn(n,t,i,r,e,f){var n,o,s,u,a,c,h,h,f,l,h,n=n,o=[],u=!1,a=!1;if(1<e)u=!0,e--,o=t.slice(f,i),":"===(r=t[++i])&&(a="["===(r=t[++i]),s=(h=an(t,i,r,e)).sbt,i=h.xwt,r=h.kwt,e=h.Dwt);else if("["===r){for(a=!0,r=t[c=i-1];" "===r;)r=t[--c];":"!==r&&M(),o=en(o=t.slice(f,c)),s=(h=an(t,i,r=t[i],e)).sbt,i=h.xwt,r=h.kwt,e=h.Dwt}else n.hbt!==C&&16!==n.hbt||(u=!0),0<(c=(h=t.slice(f,i)).indexOf(":"))?(o=h.slice(0,c),"["!==(s=h.slice(c+1))[0]&&M()):o=h;if(f=on(n,o,u),n.ubt=o.join(""),n.sbt=n.ubt,s?(l=on(n,s,a),n.lbt=4,n.sbt=s.join("")):(l=f,n.lbt=2),l<f&&(h=f,f=l,l=h),n.cbt=f,n.fbt=l,++i<t.length)for(r=t[i];" "===r;)r=t[++i];return{xwt:i,kwt:r,Dwt:e}}function en(n){for(var t=n.length-1;0<=t&&" "===n[t];)t--;for(;0<=t&&" "!==n[t];)t--;return 0<=t?n.slice(t+1,n.length-t-1):n}function fn(n){for(var t=0,i=n.length,r=0;t<i&&" "===n[t];)t++;for(r=t,t=i-1;r<t&&" "===n[t];)t++;return r<=t?n.slice(r,t+1):n}function on(n,t,i){var r,e,f,i;if(t&&sn(t,i)){for(r=[],e=0,f=t.length;e<f;e++)"'"===t[e]&&e<f-1&&e++,r.push(t[e]);return t=r,(i=n.abt.getColumnIndexInTable(t.join("")))<0&&M(),i}return-1}function sn(n,t){var i,r,e;if(t)return 1;if(i="","#"!==(r=i=n[0])&&"@"!==i&&" "!==i&&","!==i&&":"!==i&&"["!==i&&"]"!==i){for(e=1;e<n.length;e++){if(","===(i=n[e])||":"===i||"["===i&&"'"!==r||"]"===i&&"'"!==r||"@"===i&&"'"!==r||"#"===i&&"'"!==r)return;r=i}return 1}}function S(n){for(var t,i,r,t=[],r=0;r<n.length;r++)"["!==(i=n[r])&&"]"!==i&&"@"!==i&&"#"!==i&&"'"!==i||t.push("'"),t.push(i);return t.join("")}function un(n){var t,i,t="";if("#"===(t=n[0])||" "===t||"@"===t||" "===t||","===t||":"===t||"["===t||"]"===t)return 1;for(i=1;i<n.length;i++)if(" "===(t=n[i])||","===t||":"===t||"["===t||"]"===t||"@"===t||"#"===t)return 1}function an(n,t,i,r){var e,f,f,e=!1;if("["===i)for(e=!0,r++,i=n[++t];" "===i;)i=n[++t];for(f=t;"]"!==i&&(","!==i||1<r);)"'"===i&&t++,i=n[++t];return t<=f&&M(),f=n.slice(f,t),1<r&&r--,{sbt:f=e?f:fn(f),xwt:t,kwt:i,Dwt:r}}function cn(n){var t,i,t=(0,I.getMapping)()&&(0,I.getMapping)().tableFunctionsMapping;if(!R(t))for(i in t)if(t[i].toLowerCase()===n)return i.toLowerCase();return n}function hn(n,t,i,r){for(var e,f,o,s,u,a,e=14,f=t;"]"!==i;)"'"===i&&t++,i=n[++t];for(o=cn(o=E(n,f,t).toLowerCase().trim()),s=!1,u=0;u<c.length;u++)if(o===(a=c[u])){e=h[o],s=!0;break}if(s||M(),++t>=n.length)r--;else{for(i=n[t];" "===i;)i=n[++t];if(","===i){for(r<=1&&M(),i=n[++t];" "===i;)i=n[++t];"["===i&&(r++,i=n[++t])}1<r&&r--}return{Nwt:e,xwt:t,kwt:i,Dwt:r}}function ln(n,t,i,r){for(var e,f,o,s,f=0,o=t.length;"["!==r&&i<o;)r=t[++i];return{nM:e=0<i?(s=E(t,0,i),n.getTableByName(s)):n.getTableByIndex(n.row,n.column),xwt:i,kwt:r}}function M(){throw r().Exp_FormulaInvalid}function vn(n,t,i){var r,e,f,o,s,u,a,r=(0,I.getMapping)()&&(0,I.getMapping)().tableFunctionsMapping,e=(0,I.sR)().d2t,f=r?r["#All"]:e.All.name,o=r?r["#This row"]:e.thisRow.name,s=r?r["#Headers"]:e.Headers.name,u=r?r["#Data"]:e.Data.name,a=r?r["#Totals"]:e.Totals.name;switch(n){case 1:return i?"["+o+"]":"@";case 2:return t?"["+s+"]":s;case 3:return t?"["+u+"]":u;case 8:return t?"["+a+"]":a;case 6:return"["+s+"], ["+u+"]";case 12:return"["+u+"], ["+a+"]"}return t?"["+f+"]":f}function dn(n,t){var i,r,e,f,o,s,u,a,i,c,h;for(n.unshift(new I.FormulaToken("=",1,0,0,0)),f=[],o=0,e=n.length-1;0<e;e--)n[e].lp===n[e-1].lp&&n[e].Awt===n[e-1].Awt||(f[o]=n[e],o++);for(f[o]=n[e],f.reverse(),s=[],a=u=0;a<f.length;a++,u++)r=wn(f[a]),s[u]=f[a],(i=a+1<f.length?f[a+1].lp:t.length)>f[a].lp+r&&(i=new I.FormulaToken(t.slice(f[a].lp+r,i),7,f[a].lp+r),f[a].ywt=f[a].lp+r-1,s[++u]=i);for(c=0;c<s.length;c++)h=s[c].Awt.trim(),3===s[c].Twt?s[c].Awt='"'+s[c].Awt+'"':"("===h||"{"===h?(s[c].uit=1,s[c].Twt=1):")"!==h&&"}"!==h||(s[c].uit=1,s[c].Twt=2);return s}function wn(n){return 1===n.uit&&"ARRAY"===n.Awt?1:0===n.uit&&3===n.Twt?(n.Ewt||n.Awt).length+2:0===n.uit&&12===n.Twt?n.Awt.length+3:n.Awt.length}function D(n,t,i){var t,r;n&&t&&((r=n[t=t.getName&&t.getName()||"!"])||(r=n[t]=[],n.sheets||(n.sheets=[]),n.sheets.push(t)),r.push(i))}function F(n,t,i,r,e,f){var o,s,o,u;if(n){for(;10===n.type;)n=n.value;if(!(2<=(n=12===n.type?n.value:n).type&&n.type<=6))if(1===n.type)o=n.getRange(e,f),!r.source||n.source&&n.source!==r.source||t.push(o),D(i,n.source||r.source,o);else if(13===n.type)o=n.getRange(e,f),n.source===r.source&&o&&t.push(o),D(i,n.source||r.source,o);else if(8===n.type)n.jwt||(n.jwt=!0,o=j,n.source?n.source.op()&&(o=new I.EvaluateContext(n.source,(0,I.eV)(e,f))):o=r,F(o.getName(n.value),t,i,o,e,f),n.jwt=C);else if(9===n.type)F(n.value,t,i,r,e,f),n.value2&&F(n.value2,t,i,r,e,f);else if(7===n.type)for(u=0;u<n.arguments.length;u++)F(n.arguments[u],t,i,r,e,f)}}function mn(n,t,i,r,e,f,o,s,u){var f,t,a,c;n.setParserOption(f),f=[],t=t.split(""),R(u)&&(u=v.SheetArea.viewport);try{a=!!s||i.op().useR1C1,c=i.Uw(u).getParserContext(!o&&a,(0,I.eV)(r,e),{sheetArea:u}),f=n.parseToTokens(c,t,!1)}catch(n){}return Cn(n,f=dn(f,t),t,i,r,e,o,s,u)}function Cn(n,t,i,r,e,f,o,s,u){var a,c,h,l,s;return void 0===u&&(u=v.SheetArea.viewport),c=C,h=r.Uw(u),l=r.op(),s=!!s||l.useR1C1,l?(a=new m.SheetParserContext(r,!o&&s,(0,I.eV)(e,f),{sheetArea:u}),c=new I.EvaluateContext(h,(0,I.eV)(e,f),!1)):a=new I.ParserContext(j,!1,(0,I.eV)(0,0)),a.ignoreError=!0,_n(n,h,a,c,t,i,e,f)}function _n(n,t,i,r,e,f,o,s){for(var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,A,u=[],c=0;c<e.length;c++)try{if("["===(a=e[c]).Awt||"#"===a.y4[0]||3===a.Twt)u.push({index:a.lp,endIndex:a.ywt,text:a.Ewt||a.Awt,type:a.uit,subType:a.Twt,canDrag:!1,ranges:a.ranges,value:a.Awt});else if(c=pn(n,i,e,c,h=[]),d=v=l=void 0,0<h.length){for(w=0;w<h.length;w++)if((m=h[w])instanceof I.FormulaToken)u.push({index:m.lp,endIndex:m.ywt,text:f.slice(m.lp,m.ywt+1).join(""),type:m.uit,subType:m.Twt,canDrag:l,ranges:[],value:m.Awt});else if(m.WK){if(_=(C=m.WK).type,p=C.source,g=f.slice(m.lp,m.ywt+1).join(""),b=[],x={},l=!0,y=C.getRange&&C.getRange(o,s),8===_)d=v=!(l=!1),r&&(R=r,F(j=(R=C.source?new I.EvaluateContext(C.source,(0,I.eV)(o,s),!1):R).getName(C.value),b,x,r,o,s));else if(13===_||22===_)d=!(l=!1),p&&t&&p.Mf===t.Mf&&y?b.push(y):b=null,D(x,p,y);else if(1===_)if(d=!0,C.endSource)for(k=C.endSource,A=p.getSources(k),w=0;w<A.length;w++){if(A[w]===t){b.push(y);break}D(x,A[w],y)}else D(x,p||t,y),(!p||t&&p.Mf===t.Mf)&&b.push(y);else d=!1,b=null;b&&0<b.length||d?u.push({index:m.lp,endIndex:m.ywt,text:g,type:0,subType:7,canDrag:l,ranges:b,value:g,sheetRanges:x,sheetArea:p&&p.nT||t.nT,isName:v}):u.push({index:m.lp,endIndex:m.ywt,text:g,type:a.uit,subType:a.Twt,canDrag:l,ranges:b,value:g,sheetRanges:x,isName:v})}}else u.push({index:a.lp,endIndex:a.ywt,text:a.Awt,type:a.uit,subType:a.Twt,canDrag:!1,ranges:a.ranges,value:a.Awt})}catch(n){u.push({index:a.lp,endIndex:a.ywt,text:a.Awt,type:a.uit,subType:a.Twt,canDrag:!1,ranges:a.ranges,value:a.Awt})}return u}function pn(n,t,i,r,e){var f,n,t,n,o,o,i,f=i[r];return f&&"function"!=typeof f&&0===f.uit&&(t=n.resolveToken(t,i,n=[],r)-1,1===(o=(n=n[0]).type)||13===o||8===o||5===o||22===o&&n.source)?(o=i[t],i={lp:f.lp,ywt:o.ywt,WK:n},e.push(i),t):r}t=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(d,"__esModule",{value:!0}),d.getExpressTokenImp=d.Vgt=d.fillBlankToTokens=d.getValidaColumnName=d.StructureReferenceResolver=d.obt=d.StructReferenceColumnSpecifier=d.StructReferencePortions=d.SheetReferenceResolver=d.validateSheetName=d.maxColumnCount=d.maxRowCount=void 0,v=n("Core"),b=n("Common"),I=n("CalcEngine"),m=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),x=n("./dist/plugins/sheetsCalc/calc.ns.js"),y=n("./dist/plugins/sheetsCalc/external-reference.js"),R=b.Common.lt.ht,i=v.util.Vf,n=new b.Common.ResourceManager(v.SR),r=n.getResource.bind(n),d.maxRowCount=v.XmlConstants.Io,d.maxColumnCount=v.XmlConstants.xo,w=[1,26,676],C=void 0,j=null,c=["#all","#data","#headers","#totals","#this row"],_=[1,10,100,1e3,1e4,1e5,1e6,1e6],d.validateSheetName=I.Cmt,f=I.TokenResolver,t(k,f),k.prototype.resolveToken=function(n,t,i,r){var e,f,o,s,u,a,c,h,l,v,d,w,h,m,C,w,C,l,h,m,l,w,h,_,p,g,e=n.useR1C1,f=n.row||0,o=n.column||0,u=i.length,a=i[r],c=a.Awt,h=a.uit,l=a.Twt;if(0!==h&&6!==l)return!1;if(0===h&&0===l&&r<u-2&&":"===i[r+1].Awt&&12===i[r+2].Twt&&i[r+2].Awt.indexOf(":")<0||0===h&&12===l){if(m=h=void 0,C=c.lastIndexOf(":"),w=c.lastIndexOf("]"),(c=b.Common.zf.fJ(c,"'")&&b.Common.zf.dT(c,"'")?c.substring(1,c.length-1):c)&&(w<C?(h=c.substring(0,C-1),m=c.substring(C)):("'"===(h=c).charAt(0)&&(h=h.substring(1,h.length-1)),0===l&&(m=i[r+2].Awt,r+=2,"'"===m.charAt(0))&&(m=m.substring(1,m.length-1)))),r++,w=!!h,(h=Q(h))&&(v=(v=n.getExternalSource("",h))||X(h),m=Q(m))&&(v instanceof y.ExternalSource?(d=v.getPeerSource(m)).Dfe=!0:d=(d=n.getExternalSource("",m))||X(m)),(a=i[r])&&"["===a.y4[0])return!1;if(!a)return N(c);c=a.Awt}if(C=r===u-1?j:i[r+1],q(i,a,r,e,!0)){if(l=n&&n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray,!(h=G(a.y4,e,f,o,l)).bwt&&!w)return!1;if(a.Twt=7,h.bwt&&h.wwt){if(m=h.Ky,l=h.iw,w=h.gwt,h=h.pwt,r<u-2&&5===C.uit&&":"===C.Awt&&q(i,C=i[r+2],r+2,e,!1)&&(_=G(C.y4,e,f,o)).bwt&&m===x.BAND_INDEX_CONST==(_.Ky===x.BAND_INDEX_CONST)&&l===x.BAND_INDEX_CONST==(_.iw===x.BAND_INDEX_CONST))return f=m===x.BAND_INDEX_CONST?0:f,o=l===x.BAND_INDEX_CONST?0:o,{index:r+3,expr:(0,I.lJ)(v,d,m-(w?f:0),l-(h?o:0),_.Ky-(_.gwt?f:0),_.iw-(_.pwt?o:0),w,h,_.gwt,_.pwt,f,o)};if(m===x.BAND_INDEX_CONST||l===x.BAND_INDEX_CONST){if(e)return m-=m!==x.BAND_INDEX_CONST&&w?f:0,l-=l!==x.BAND_INDEX_CONST&&h?o:0,{index:r+1,expr:(0,I.lJ)(v,d,m,l,m,l,w,h,w,h,f,o)};if(!v)return!1;s=N(c)}if(!s)return R(v)&&(v=Z(n,f,o)),{index:r+1,expr:s=(0,I.knt)(v,d,p=m-(w?f:0),g=l-(h?o:0),w,h)}}else s=N(c)}else if(6===a.Twt)(s=new I.Expression(5)).value=I.CalcError.parse(a.Awt);else{if(!v||1===a.uit)return!1;s=N(c)}return v&&(s.source=v),d&&(s.endSource=d),{index:r+1,expr:s}},k.prototype.unparse=function(n,t,i,r){var e=i&&i.type;return(1===e||8===e||5===e)&&($(n,t,i,r),!0)},d.SheetReferenceResolver=k,(n=o=d.StructReferencePortions||(d.StructReferencePortions={}))[n.ThisRow=1]="ThisRow",n[n.Headers=2]="Headers",n[n.Data=3]="Data",n[n.Totals=8]="Totals",n[n.HeadersAndData=6]="HeadersAndData",n[n.DataAndTotals=12]="DataAndTotals",n[n.All=14]="All",n[n.NotSpecific=16]="NotSpecific",(n=s=d.StructReferenceColumnSpecifier||(d.StructReferenceColumnSpecifier={}))[n.All=1]="All",n[n.NotSpecific=1]="NotSpecific",n[n.SingleColumn=2]="SingleColumn",n[n.ColumnRange=4]="ColumnRange",u=I.Expression,t(A,u),A.prototype.tableName=function(){return this.abt.tableName()},Object.defineProperty(A.prototype,"baseTable",{get:function(){return this.abt},set:function(n){this.abt=n,this.source=n.source()},enumerable:!1,configurable:!0}),A.prototype._K=function(){this.Owt=this.abt.startColumn()},A.prototype.columnReferenceStart=function(){return this.cbt+this.abt.startColumn()},A.prototype.columnReferenceEnd=function(){return this.fbt+this.abt.startColumn()},A.prototype.referencePortions=function(){return this.hbt},A.prototype.referenceColumnSpecifier=function(){return this.lbt},A.prototype.getRange=function(n,t,i){var r,e,f,o,s,u,a,c,h,l,v,d,e,r=this,e=r.abt;switch(r._K(),h=e.startRow(),l=e.endRow(),v=e.hasTotalsRow(),d=e.hasHeadersRow(),r.hbt){case 3:case 16:f=d?h+1:h,s=v?l-1:l;break;case 2:if(d)s=f=h;else{if(!i)return j;s=f=h-1}break;case 8:if(v)s=f=l;else{if(!i)return j;s=f=l+1}break;case 1:s=f=n;break;case 6:f=h+(i&&!d?-1:0),s=v?l-1:l;break;case 12:f=d?h+1:h,s=l+(i&&!v?1:0);break;default:f=h+(i&&!d?-1:0),s=l+(i&&!v?1:0)}if(22===r.type){if(o=r.abt.getColumnIndexInTable(r.ubt),u=r.abt.getColumnIndexInTable(r.sbt),-1===o||-1===u)return j}else o=r.columnReferenceStart(),u=r.columnReferenceEnd();return e=e.endColumn(),1===r.lbt&&(u=e),e<o||e<u?(r._error=!0,j):s<f||!i&&f<h||!i&&l<s?j:(0,I.Rwt)(f,o,a=s-f+1,c=u-o+1)},A.prototype.offsetWhenInsertRemoveColumn=function(n,t,i,r){var e,f,r,i,e=this,f=e.Owt;return R(f)&&(e._K(),f=e.Owt),R(f)||n<f||n===f&&i&&!r||n>e.fbt+f?e:(t=i?t:-t,r=n-f,(i=new A).baseTable=e.abt,i.fbt=e.fbt+t,i.cbt=e.cbt,n<=f+e.cbt&&(i.cbt+=t,i.cbt<r)&&(i.cbt=r),i.lbt=e.lbt,i.hbt=e.hbt,i.fbt<i.cbt?I.kyt:i)},A.prototype.offsetWhenCopy=function(n,t,i,r,e,f,o,s,u,a){var c,h,l,v,i,r,e,f,d,w,c=this,h=new m.SheetParserContext(t.Mf,t.Lbt.useR1C1,(0,I.eV)(i,r)),l=h.getTableByIndex(i,r),v=c.offset();return l&&(i=i-e,r=r-f,e=o-e,f=s-f,d=void 0,(d=(n===t?h:w=new m.SheetParserContext(n.Mf,n.Lbt.useR1C1,(0,I.eV)(i,r))).getTableByIndex(i,r))!==l)&&d===c.abt&&z(d,e,f,u,a)&&z(l,o,s,u,a)&&(v.baseTable=l),v},A.prototype.Bwt=function(n){var t,i,r,t=this,i=new A;return i.baseTable=t.abt,i.fbt=t.fbt,i.cbt=t.cbt,2===t.lbt&&n&&(r=t.abt.endColumn()-t.abt.startColumn()+1,i.cbt+=n%=r,i.cbt<0&&(i.cbt+=r),i.fbt=i.cbt),i.lbt=t.lbt,i.hbt=t.hbt,i},A.prototype.offset=function(n,t,i){var r,e,r=this,e=new A;return e.baseTable=r.baseTable,e.hbt=r.hbt,e.cbt=r.cbt,e.fbt=r.fbt,e.lbt=r.lbt,e},A.prototype.Lwt=function(n,t){var i=this.abt;return n>=i.startRow()&&t>=i.startColumn()&&n<=i.endRow()&&t<=i.endColumn()},A.prototype.Fwt=function(n,t,i){this.abt.Pwt(n,t,i)},a=A,d.obt=a,l=I.TokenResolver,t(O,l),O.prototype.resolveToken=function(n,t,i,r){var e,i,f,o,e,s,u,e,e=i[r],i=i[r+1];if(0===e.uit){if(o=f=void 0,0===e.Twt||7===e.Twt)f=e.Awt;else{if(12!==e.Twt||!i||0!==i.uit||0!==i.Twt||"["!==i.y4[0])return j;f=(e="'"===(e=e.Awt)[0]?e.substr(1,e.length-2):e)+i.Awt,o=!0}if("]"===f.charAt(f.length-1))try{return s=new a,tn(n,f.split(""),s),s.baseTable?(s.abt.Mf.NMi&&((u=s).type=22,u.Iwt=nn),o?{index:r+2,expr:s}:s):new I.Expression(0)}catch(n){}else if(e=n.getTableByName&&n.getTableByName(f))return O.create(e)}return j},O.prototype.unparse=function(n,t,i,r){var e,f,o,s,u,a,t,c,s,o,f,o,s;if(13!==i.type&&22!==i.type)return!1;if(f=(e=i).abt.Gwt,o=R(f)?e.abt.tableName():f,n.Sbt)s=e.getRange(n.row,n.column,!0),$(n,t,u=(0,I.lJ)(e.source,j,s.row,s.col,s.row+s.rowCount-1,s.col+s.colCount-1,!1,!1,!1,!1),r);else{if(t=r.length,22===e.type&&e.baseTable.Mf.xT)a=!0;else if(16===e.hbt&&1===e.lbt)return r.push(o),void(n.lyt&&r.push("[]"));(c=n.source===e.abt.source()&&e.Lwt(n.row,n.column))&&!n.lyt&&!e.abt.Mf.NMi||(s=R(f)?e.abt.tableName():f,(o=e.abt.Mf)&&o.NMi&&!(0,I.Cmt)(s.split(""))&&(s=(0,I.Mge)(n,s.split(""),null).join("")+"!"),r.push(s)),r.push("["),16!==e.hbt&&(f=vn(e.hbt,1!==e.lbt,n.lyt),r.push(f)),1!==e.lbt&&(1===e.hbt&&!n.lyt||16===e.hbt||r.push(", "),(o=22===i.type?e.abt.getColumnName(e.cbt)||e.ubt:e.abt.getColumnName(e.cbt))?o=S(o):a=!0,a||(4===e.lbt?(s=22===i.type?e.abt.getColumnName(e.fbt)||e.sbt:e.abt.getColumnName(e.fbt))?(s=S(s),r.push("[",o,"]:[",s,"]")):a=!0:1===e.hbt&&!n.lyt&&!un(o)||16===e.hbt?r.push(o):r.push("[",o,"]"))),a?(r.length=t,r.push("#REF!")):r.push("]")}return!0},O.create=function(n,t,i,r,e){void 0===t&&(t=o.NotSpecific),void 0===i&&(i=s.NotSpecific),void 0===r&&(r=0),void 0===e&&(e=n.endColumn()-n.startColumn());var f=new a;return f.baseTable=n,f.hbt=t,f.cbt=r,f.fbt=e,f.lbt=i,f},d.StructureReferenceResolver=O,d.getValidaColumnName=S,h={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},d.fillBlankToTokens=dn,d.Vgt=mn,d.getExpressTokenImp=_n},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(n,t,i){var r,e,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),e=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),e(i("./dist/plugins/sheetsCalc/calc.ns.js"),t),e(i("./dist/plugins/sheetsCalc/parser-sheets.js"),t),e(i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),t),e(i("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),t),e(i("./dist/plugins/sheetsCalc/worksheet-formula.js"),t),i("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(n,t,i){var X,t,r,w,h,J,x,R,e,l,i,y,j,N,f,k,d,A,G,P,I,H,O,E,o,S,c,M,U,i;function D(n){n.forEach(function(n){var t;delete n.Uw().G3})}function m(n,a,c,h){X.GC$.each(n,function(n,t){var i,r,e,f,o,s,t,u,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.getComment(),s=t.getFormatter&&t.getFormatter(),t=t.getSheetTabName&&t.getSheetTabName();f&&(i={name:i,formula:u=s||a.unparse(c,f,r,e,!1,!0),sheetTabName:t,row:r,col:e},o&&(i.comment=o),h.push(i))})}function B(n,t){var n,i,r,n=A(n);if("str"===t)i=n;else if("b"===t)i="1"===n;else if("e"===t){switch(r=N,n){case"#DIV/0!":r=7;break;case"#N/A":r=42;break;case"#NAME?":r=29;break;case"#NULL!":r=0;break;case"#NUM!":r=36;break;case"#REF!":r=23;break;case"#VALUE!":r=15}i=r!==N?{error:n,code:r}:N}else i=parseFloat(n);return i}Object.defineProperty(t,"__esModule",{value:!0}),X=i("Core"),t=i("Common"),r=i("CalcEngine"),w=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),J=i("./dist/plugins/sheetsCalc/external-reference.js"),x=i("./dist/plugins/sheetsCalc/calc-extra-save.js"),R=i("./dist/plugins/sheetsCalc/worksheet-formula.js"),e=w.SpreadSource,l=t.Common.zf.Gmt,i=new t.Common.ResourceManager(X.SR),y=i.getResource.bind(i),j=void 0,N=null,f=t.Common.kh,k=t.Common.lt.ht,d=X.mt.o1,A=X.mt.c1,G=X.mt.xr,P=X.mt.go,I=X.Util.Sr,H=X.IndexHelper.$i,O=X.Util.mr,E=X.mt.n1,o=X.mt.vo,S=X.Util.io,c=X.mt.St,M=X.XFileConstants.mo,U=X.XFileConstants.Ki,(i=X.Workbook.prototype).Qp=function(n){var t,i,t=this,i=t.Lp;t.Lp=new r.CalcService,t.Lp.useR1C1=1===t.options.referenceStyle,t.Lp.allowDynamicArray=t.options.allowDynamicArray,t.Lp.iterativeCalculation=t.options.iterativeCalculation,t.Lp.iterativeCalculationMaximumIterations=t.options.iterativeCalculationMaximumIterations,t.Lp.calculationMode=t.options.calculationMode,t.Lp.iterativeCalculationMaximumChange=t.options.iterativeCalculationMaximumChange,n&&i&&t.Lp.cloneFrom(i),t.yC=new e(t),t.wC=t.Lp.getGlobalSourceModel(t.yC)},i.addCustomFunction=function(n){this.Uwt(n)},i.Uwt=function(n){if(!(n&&n instanceof r.Functions.Function))throw new Error(y().Exp_InvalidCustomFunction);n.name=l(n.name),this.Amt[n.name]=n},i.getCustomFunction=function(n){return n?this.Amt[l(n)]:j},i.removeCustomFunction=function(n){n&&delete this.Amt[l(n)]},i.clearCustomFunctions=function(){this.Amt={}},i.addCustomName=function(n,t,i,r,e,f){this.zwt(this.hyt,n,t,i,r,!1,e,f)},i.Vwt=function(n){return!this.hyt[l(n)]},i.isValidCustomName=function(n){return n&&X.mt.P0(n)&&this.Vwt(n)},i.pp=function(n,t,i,r,e,f,o,s){var u,a,u=this;if(!t||!i)throw new Error(y().Exp_InvalidCustomName);s&&u.Lp&&c(i)?(a=s.Ywt(i,r,e),n[l(t)]=new h.FormatterNameInfo(t,i,s.name(),a,r,e)):u.zwt(n,t,i,r,e,f,o)},i.zwt=function(n,t,i,r,e,f,o,s){var u,a,a,c,u,u=this;if(!t||!i||!f&&!u.isValidCustomName(t))throw new Error(y().Exp_InvalidCustomName);if(u.Lp){if(a=(a=(0,X.jf)(this))?a.Uw():N,c=void 0,f)try{c=u.Lp.parse(a,i,r,e,!1,!0,!0)}catch(n){}else c=u.Lp.parse(a,i,r,e);n[l(t)]=new h.NameInfo(t,c,r,e,o,s),f||((u={})[t]=t,this.Zwt(u,!0))}},i.Wwt=function(n,t,i,r,e,f,o,s){var u,i,u=this;if(!t||!i||!o&&!u.isValidCustomName(t))throw new Error(y().Exp_InvalidCustomName);u.Lp&&(n[l(t)]=new h.NameInfo(t,r,e,f,s),o||((i={})[t]=t,this.Zwt(i,!0)))},i.getCustomName=function(n){return n?this.hyt[l(n)]:j},i.xO=function(n){return n?this.bp[l(n)]:j},i.getCustomNames=function(){var i=[];return X.GC$.each(this.hyt,function(n,t){i.push(t)}),i},i.Qwt=function(){var i=[];return X.GC$.each(this.bp,function(n,t){i.push(t)}),i},i.removeCustomName=function(n){var t;n&&(delete this.hyt[l(n)],(t={})[n]=n,this.Zwt(t,!1))},i.o3=function(n){var t;n&&(delete this.bp[l(n)],(t={})[n]=n,this.Zwt(t,!1))},i.clearCustomNames=function(){var n=this.hyt;this.hyt={},this.Zwt(n,!1)},i.getNameInfos=function(){return this.hyt},i.setNameInfos=function(n){k(n)||(this.hyt=n)},i.Kwt=function(){var n=this.bp;this.bp={},this.Zwt(n,!1)},i.Zwt=function(n,t){var i,r,n;if(n){for(r in i=this.wC,n)i&&i.updateNameCalc(r,t);this.Lp&&!this.Lp.IsSuspended()&&(n=this.getActiveSheet())&&(n.suspendPaint(),this.Lp.recalculateAll(!1),n.resumePaint()),this.ki(X.Events.CustomNameChangedInternal,{})}},i.calculate=function(n,t){var i,r,e,f,o,s,u,a,c,h,l,v,d,n,i=this,r=i.op();if(r){switch(f=!(e=j),n){case X.CalculationType.rebuild:e=!0;break;case X.CalculationType.minimal:f=e=!1;break;case X.CalculationType.regular:e=!1}if(this.suspendPaint(),k(t)){if(r.suspend(!0),e)for(o=void 0,o=i.sheets||[],(0,R.resetCustomName)(i&&i.hyt,N,r),s=0;s<o.length;s++)for(a=(u=o[s]).Uw(),(0,R.resetCustomName)(u.hyt,a,r),h=(c=a.getCalcSourceModel()).getAllNodes(),l=0;l<h.length;l++)(d=(v=h[l]).calc)&&v.WK&&(0,R.adjustOneFormula)(r,d);r.resume(e,!f,!0)}else(u=i.getSheetFromName(t))?u.c3n(e,f):0<i.sheets.length&&(n=w.formulaToRanges(i.sheets[0],t,0,0,!0)[0]||w.formulaToRanges(i.sheets[0],t,0,0)[0])&&(u=i.getSheetFromName(n.sheetName)).c3n(e,f,n.ranges[0]);this.resumePaint()}},i.getCalcService=function(){return this.Lp},i.op=function(){return this.Lp},i.suspendCalcService=function(n){this.Lp&&this.Lp.suspend(n)},i.resumeCalcService=function(n){this.Lp&&this.Lp.resume(n)},i.getCircularReference=function(){var n,t,i,r,n=this.Jwt(),t=[];for(i in n=this.Xwt(n))f(n,i)&&(r=i.split("\\"),t.push({row:+r[1],col:+r[2],rowCount:1,colCount:1,sheetName:r[0]}));return t},i.updateExternalReference=function(n,t,i){this.suspendPaint(),this.suspendCalcService(),this._p._6(n,t,i),this.resumeCalcService(!1),this.resumePaint()},i.getExternalReferences=function(n){return this._p.myt(n)},i.Jwt=function(){var s={};return this.sheets.forEach(function(f){var n,o,n=f.b3();n&&(o=f.name(),n.MMt(function(n){var t,i,r,e,e;if(n.node.WK)for(t=o+"\\"+n.row+"\\"+n.column,i=f.qwt(n.row,n.column),!s[t]&&0<i.length&&(s[t]={from:[],to:[]}),r=0;r<i.length;r++)e=(e=i[r]).sheetName+"\\"+e.row+"\\"+e.col,s[e]||(s[e]={from:[],to:[]}),s[e].from.push(t),s[t].to.push(e)}))}),s},i.Xwt=function(i){var r,n,t;function e(n,t){n.splice(n.indexOf(t),1)}for(r=!0;0<Object.keys(i).length&&r;)for(t in r=!1,n=function(t){var n;f(i,t)&&(0===(n=i[t]).from.length?(n.to.forEach(function(n){e(i[n].from,t)}),delete i[t],r=!0):0===n.to.length&&(n.from.forEach(function(n){e(i[n].to,t)}),delete i[t],r=!0))},i)n(t);return i},X.Workbook.ch("calc",{priority:1e3,init:function(){this.Amt={},this.hyt={},this.bp={},this._p=new J.ExternalReferenceManager},toJson:function(n){var t,i,i,u,i,r,e,a,t,c,t=this,i=t.Amt;X.GC$.isEmptyObject(i)||(n.customFunctions=i),i=t._p.toJSON(t),X.GC$.isEmptyObject(i)||(n.externalReference=i),u=[],i=[],r=t.getCustomNames(),e=t.Qwt(),a=t.Lp,t=(0,X.Sp)(this),c=t?t.Uw():N,r&&a&&(X.GC$.each(r,function(n,t){var i,r,e,f,o,t,s,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(i={name:i,formula:s=a.unparse(c,f,r,e,!1,!0,2),row:r,col:e},t&&(i.comment=t),"boolean"==typeof o&&(i.isReadOnly=o),u.push(i))}),m(e,a,c,i),0<u.length&&(n.names=u),0<i.length)&&(n.formatStringNames=i)},wh:function(n,t,s){var i,r,r,e,f,o,u,r,e,a,f,c,f,h,l,v,f,r,i=this,r=i.Amt;X.GC$.isEmptyObject(r)||(n.workbook.lossless.customFunctions=r),i._p&&(e=(r=i._p.wh(n)).externalReferencesNode,f=r.externalLinks,0<(o=r.count))&&(n.workbook.c_.push(e),n.externalLinks=f),u=[],r=d(n.workbook,"definedNames"),e=i.getCustomNames(),a=i.Lp,f=(0,X.Sp)(this),c=f?f.Uw():N,f=i.yC,h=f&&f.getUsedCustomNames()||{},e&&0<e.length&&a&&(r||n.workbook.c_.push(r={n_:"definedNames",c_:[]}),l=r.c_,v=!s||!1!==s.includeUnusedNames,X.GC$.each(e,function(n,t){var i,r,e,f,o,t,r,e,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(v||h[i])&&(r=a.unparse(c,f,r,e,!1,!0,2),e=X.Util.Oge({name:i,comment:t,isReadOnly:o},r),s&&s.includeCalcModelCache&&(i=(0,x.exprToJSON)(f),u.push(i),e.e=u.length-1),l.push(e))})),0<u.length&&(n.workbook.lossless.exprs=u),f=[],(r=i.Qwt())&&0<r.length&&a&&(m(r,a,c,f),0<f.length)&&(n.workbook.lossless.formatStringNames=f),n.workbook.lossless.idMap=(0,x.dbt)(a)},preFromSJSFormat:function(n,T,L){var t,i,r,e,f,o,s,u,a,c,h,l,v,s,d,w,m,C,_,p,g,b,x,y,R,j,Y,N,k,A,I,O,E,S,S,O,M,D,F,V,t=G(n.workbook,"externalReferences"),i=n.externalLinks;if(t&&i&&t.c_&&0<t.c_.length){for(e in r={},i)if(i.hasOwnProperty(e)){if(f=i[e],o={},s=G(f,"externalBook")){if(a=[],(u=G(s,"sheetNames"))&&u.c_&&u.c_.length){for(c=0,h=u.c_.length;c<h;c++)(l=u.c_[c])&&(v=l.val)&&(v=X.mt.kfe(v),a.push(v));o.sheetNames=a}if(s=G(s,"sheetDataSet")){if(d={},w=P(s,X.XFileConstants.bo))for(m=0,C=w.length;m<C;m++)if(p=+(_=w[m]).sheetId,g="1"===_.refreshError,b=d[v=a[p]]={},g&&(b.isNew=!0),x=P(_,"row"))for(y=0,R=x.length;y<R;y++)if((j=x[y])&&(N=b[Y=j.r-1]={},k=P(j,"cell")))for(A=0,I=k.length;A<I;A++)E=void 0,(O=k[A])&&((S=O.r)&&(E=H(S)),S=O.t,M=void 0,(O=G(O,"v"))&&(M=B(O,S)),N[E]=M);o.data=d}}o.option=f.option,r[e]=o}for(D={},V=(F=t.c_).length,c=0;c<V;c++)D[c+1]=r[F[c][U]];this._p=new J.ExternalReferenceManager(D)}},yh:function(e,i,r){var f,t,o,s,n,u,a,c,h,l,v,d,w,m,C,C,_,p,g;function b(){var n,n;return t||(n=(n=(0,X.jf)(f)||f.sheets[0])?n.Uw():N,t=n&&n.getParserContext(!1)),t}if(o=(f=this).Lp,s=r&&!r.fullRecalc,n=X.Util.wo(r,f.v2),o&&(o.suspend(),o.lb=s),f.clearCustomNames(),(u=f.sheets).forEach(function(n){n.Uw().G3=!0}),a=e.workbook.lossless,r&&(r.$wt=(0,x.vbt)(o,a)),(c=i.workbookNames)&&0<c.length&&c.forEach(function(n){var t=E(n.name),i=A(n),r=E(n.comment),e=n.isReadOnly;a&&a.exprs&&a.exprs[n.e]?f.Wwt(f.hyt,(0,R.convertBuiltInNameToDisplayName)(t),""+O(E(i)),(0,x.exprFromJSON)(a.exprs[n.e],b()),0,0,!0,r,!0):i&&f.zwt(f.hyt,(0,R.convertBuiltInNameToDisplayName)(t),""+O(E(i)),0,0,!0,r,e)}),f.Kwt(),h=a&&a.formatStringNames)for(l=0;l<h.length;l++)v=h[l],k(v.sheetTabName)&&f.pp(this.bp,v.name,v.formula,v.row,v.col,!0,v.comment,j,!0);if(f.clearCustomFunctions(),d=a&&a.customFunctions)for(w in d)d.hasOwnProperty(w)&&(m=d[w],C=(0,X.getTypeFromString)(m.typeName))&&((C=new C).fromJSON(m),f.Uwt(C));n||(_=[],p=e.workbook.rels&&e.workbook.rels.c_,(g=G(e.workbook,M).c_).forEach(function(n){var t,t,n,n,n,i,r,t=S(E(n.name)),t=f.getSheetFromName(t)||f.Gm(t),n=n[U],n=I(p,n),n=n&&n.Target;t&&n&&(i=f.getSheetRelsName(n),r=void 0,r=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[i],_.push({sheet:3===t._gi?t.getTemplate():t,sheetData:r}))}),_.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.nameFunctionFromSJSFormat&&t.nameFunctionFromSJSFormat(n,i,r)}),_.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.formulaFromSJSFormat&&t.formulaFromSJSFormat(n,i,r)})),r.incrementLoadTask.addTask(function(n,t,i){o&&(s?o.resumeWithoutCalc():o.resume(!1,!1,!o.calcOnDemand),delete o.lb),D(u)},[o,e,r],s?j:y().STEP.startCalc,function(){return s?X.STEP_RATE.end:X.STEP_RATE.loadFileData+X.STEP_RATE.parseFile+X.STEP_RATE.loadSheetDataWithCalc+X.STEP_RATE.loadSheetFormulaWithCalc})},Mb:function(e,i,r){var f,o,s,n,u,t,a,c,h,l,v,d,w,m,m,C,_,p,f=this,o=f.Lp,s=r&&!r.fullRecalc,n=X.Util.wo(r,f.v2);if(o&&(o.suspend(),o.lb=s),f.clearCustomNames(),(u=f.sheets).forEach(function(n){n.Uw().G3=!0}),t=e.workbook.lossless,(a=i.workbookNames)&&0<a.length&&a.forEach(function(n){var t=E(n.name),i=A(n),r=E(n.comment),n=n.isReadOnly;i&&f.zwt(f.hyt,(0,R.convertBuiltInNameToDisplayName)(t),""+O(E(i)),0,0,!0,r,n)}),f.Kwt(),c=t&&t.formatStringNames)for(h=0;h<c.length;h++)l=c[h],k(l.sheetTabName)&&f.pp(this.bp,l.name,l.formula,l.row,l.col,!0,l.comment,j,!0);if(f.clearCustomFunctions(),v=t&&t.customFunctions)for(d in v)v.hasOwnProperty(d)&&(w=v[d],m=(0,X.getTypeFromString)(w.typeName))&&((m=new m).fromJSON(w),f.Uwt(m));n||(C=[],_=e.workbook.rels&&e.workbook.rels.c_,(p=G(e.workbook,M).c_).forEach(function(n){var t,t,n,n,n,i,r,t=S(E(n.name)),t=f.getSheetFromName(t)||f.Gm(t),n=n[U],n=I(_,n),n=n&&n.Target;t&&n&&(i=f.getSheetRelsName(n),r=void 0,r=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[i],C.push({sheet:3===t._gi?t.getTemplate():t,sheetData:r}))}),C.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.nameFunctionFromSJSFormat&&t.nameFunctionFromSJSFormat(n,i,r)}),C.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.formulaFromSJSFormat&&t.formulaFromSJSFormat(n,i,r)})),r.incrementLoadTask.addTask(function(n,t,i){var r;o&&(s?o.resumeWithoutCalc():(o.resume(!1,!1,!o.calcOnDemand),delete o.tMt,(r=f.getActiveSheet())&&r.zw()),delete o.lb),D(u)},[o,e,r])},preFromJson:function(n,t,i){this._p=new J.ExternalReferenceManager(n.externalReference)},fromJson:function(n,t,i){var r,e,f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,g,g,b,x,y,r=this,e=r.Lp,f=n.noRecalc||i&&i.doNotRecalculateAfterLoad;if(e&&(e.suspend(),e.lb=f),r.clearCustomNames(),a=[],u=n.sheets)for(h in u)"string"==typeof h&&(l=u[h],s=r.getSheetFromName(l.name||h))&&(s.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],r.zwt(this.hyt,(0,R.convertBuiltInNameToDisplayName)(w.name),w.formula,w.row,w.col,!0,w.comment,w.isReadOnly);if(r.Kwt(),m=n.formatStringNames)for(d=0;d<m.length;d++)w=m[d],k(w.sheetTabName)&&r.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(r.clearCustomFunctions(),C=n.customFunctions)for(_ in C)C.hasOwnProperty(_)&&(p=C[_],g=(0,X.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),r.Uwt(g));if(u){for(h in o=0,u)"string"==typeof h&&(l=u[h],s=r.getSheetFromName(l.name||h))&&(a.push(s),s.nameFunctionsFromJSON(l,t,i),o++);for(c=a.length,o=0;o<c;o++)(s=a[o]).formulaFromJSON(u[s.name()],t,i)}for(e&&(f?e.resumeWithoutCalc():(e.resume(!1,!1,!e.calcOnDemand),delete e.tMt),delete e.lb),b=0,x=a;b<x.length;b++)delete(y=(s=x[b]).Uw()).G3},Yp:function(n,t,i){var s,u,a,r,c,e,h,f,o,l,v,d,w,m,C,_,p,g,g,s=this,u=s.Lp,a=n.noRecalc||i&&i.doNotRecalculateAfterLoad;if(u&&(u.suspend(),u.lb=a),s.clearCustomNames(),e=n.sheets,h=[],e)for(o in e)"string"==typeof o&&(l=e[o],c=s.getSheetFromName(l.name||o))&&(c.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],s.zwt(this.hyt,(0,R.convertBuiltInNameToDisplayName)(w.name),w.formula,w.row,w.col,!0,w.comment,w.isReadOnly);if(s.Kwt(),m=n.formatStringNames)for(d=0;d<m.length;d++)w=m[d],k(w.sheetTabName)&&s.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(s.clearCustomFunctions(),C=n.customFunctions)for(_ in C)C.hasOwnProperty(_)&&(p=C[_],g=(0,X.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),s.Uwt(g));if(e){for(o in r=0,e)"string"==typeof o&&(l=e[o],c=s.getSheetFromName(l.name||o))&&(h.push(c),c.nameFunctionsFromJSON(l,t,i),r++);for(f=h.length,r=0;r<f;r++)(c=h[r]).formulaFromJSON(e[c.name()],t,i)}i.incrementLoadTask.addTask(function(n,t,i){var r,e,f,o;for(u&&(a?u.resumeWithoutCalc():(u.resume(!1,!1,!u.calcOnDemand),delete u.tMt,(r=s.getActiveSheet())&&r.zw()),delete u.lb),e=0,f=h;e<f.length;e++)delete(o=(c=f[e]).Uw()).G3},[u,n,i])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(e,n,t){var i,g,r,I,h,p,w,O,b,C,l,x,t,y,R,f,X,o,J,G,m,_,j,N,t,u;function s(n){return"="===n.charAt(0)}function P(n){var t,i;return{left:n.indexOf("["),right:n.indexOf("]")}}function H(n){var n=P(n),t=n.left,n=n.right;return 0<=t&&t<n}function U(n){var t=P(n),i=t.left,t=t.right,n=n.indexOf("@");return i<n&&n<t}function B(n){return s(n)&&U(n)}function $(n){return s(n)&&H(n)}function W(n,t){var i,r;if(n.NMi){if($(t=t.trim()))return 1;if(0<=t.indexOf("{{")&&0<=t.indexOf("}}"))for(i=t.split(/{{|}}/),r=0;r<i.length;r++)if($(i[r].trim()))return 1}}function K(n,t,i,r){return i===b&&(i=n.getActiveRowIndex()),n.NMi.nMt(t,i,r)}function Q(n){return n.columnRelative}function Z(n){return n.endColumnRelative}function q(n){return n.rowRelative}function z(n){return n.endRowRelative}function k(n){return n.op()}function nn(n){n.column}function v(n){return n.toUpperCase()===f?o:n}function tn(){var n=this;n.eMt?n.eMt=!1:(n.Amt={},n.hyt={},n.iMt?n.iMt.clearAll():n.T3=new h.SheetSource(n,g.SheetArea.colHeader),n.rMt?n.rMt.clearAll():n.A3=new h.SheetSource(n,g.SheetArea.rowHeader),n.oMt?n.oMt.clearAll():n.qgt=new h.SheetSource(n,g.SheetArea.viewport))}function rn(n,t){var n,i,n=n.Uw(),i;(n&&n.t8.jme(-1,-1,-1,-1)).forEach(function(n){n.isValid||(t.spillCells=t.spillCells||{},t.spillCells[n.minX+","+n.minY]=1)})}function a(n,t,i,r,e,f){var n=n.iT(t,i,r,e,f),t=n&&n.formulas;return t&&0<t.length}function en(n,t,i,r,e,f,o){var s=a(n,t,i,r,e,3);return!s&&f&&(e=n.getColumnCount(2),s=a(n,t,0,r,e,2)),!s&&o&&(r=n.getRowCount(1),s=a(n,0,i,r,e,1)),s}function fn(n){for(var t,i,r,e,f,t=[],i=[],r=0;r<n.length;r++)f=""+(e=n[r]).row+e.col+e.rowCount+e.colCount+e.sheetName,t.indexOf(f)<0&&(t.push(f),i.push(e));return i}function on(n,t){var n=n.formulaLoad/n.total;return t?.4*n+.5:.3*n+.4}function sn(n,t,i,r,e,f){var o,s,u,a,c,a,c,o=r.Uw(),s=n&&n.formula;s&&(u=void 0,"object"==typeof s&&(a=r.b3(f),(c=r.Xbt[s.si]).baseRow===t&&c.baseColumn===i?(s=c.formula,c.$fe=!0):c.$fe?(u=a.pB(c.baseRow,c.baseColumn))?(u.aMt=s.si,r.Lp.tMt&&r.Lp.tMt[o.id+","+c.baseRow+","+c.baseColumn]&&(r.Lp.tMt[o.id+","+t+","+i]={id:o.id,row:t,col:i})):(s=c.formula,c.baseRow=t,c.baseColumn=i):(s=c.formula,c.$fe=!0,c.baseRow=t,c.baseColumn=i)),(a=n.arrayInfo)&&!a.isDynamicArray?r.uMt(t,i,j(a.rowCount,10),j(a.colCount,10),s,!0,f):(c=o.getCalcSourceModel(),a&&o.t8.Zme(a.row,a.col,a.rowCount,a.colCount,!a.isInvalid),r.zI(t,i,s,u,!0,f,!0,!a,b,!0),a&&c.Uyt(t,i,a)))}function A(n,t,i,r,e,f,o){var s,u,a,c,h,l,v,d,s,f,s=e&&e.incrementLoadTask;if(s&&!s.isTerminated){for(u=s.isBusyFunc,a=f=f||0,n.suspendPaint(),c=30,h=new Date;a<i;){if(l=t[a])for(v=0;v<r;v++)sn(l[v],a,v,n,!0,o);if(a++,u&&u())break;if(30<(d=new Date)-h)break}n.resumePaint(),(s=(e=e||{})&&e.incrementalLoading)&&(s.loadStatus.formulaLoad+=a-f,f=on(s.loadStatus,e.doNotRecalculateAfterLoad),n.parent&&n.parent.ki(g.Events.ProgressChanged,{loadStatus:s.loadStatus,progress:f,sheet:n}),s.loading)&&s.loading(f,{sheet:n}),a<i&&e.incrementLoadTask.pushTask(A,[n,t,i,r,e,a])}}function c(n,t,i,r,e){for(var f,o,s,f=0;f<i;f++)if(o=t[f])for(s=0;s<r;s++)sn(o[s],f,s,n,!0,e)}function un(n,t){var i,r,e,f,o,s;if(t)for(i in t)if(t.hasOwnProperty(i))for(e in r=t[i])r.hasOwnProperty(e)&&(o=+i,s=+e,(f=r[e]).f)&&R(n.getValueIgnoreDefault(o,s))&&!n.getFormula(o,s)&&!n.getBindingPath(o,s)&&n.Ut.setDefaultValue(o,s,m(f.f),b,g.DefaultChangeValueType.Expression)}function an(n,t,i,r,e,f,o){var s,u,a,u,c,h,l,v,d,l,l,s=n.Uw(),u=n.Ut,a=u.ap||0,u=u.fp||0;t===b||(c=m(t.f),h=t.g,(l=t.r)!==b&&(v=G(l).toJSON()),"shared"===t.d&&0<=h&&(c=(c&&(l={formula:c},v&&(l.lastRow=v.rowCount+v.row-1,l.lastColumn=v.colCount+v.col-1,l.baseRow=v.row,l.baseColumn=v.col,v=O),f[h]||(f[h]=l,f.nextIndex=Math.max(f.nextIndex,h+1))),{si:h}),(l=n.Xbt[c.si]).baseRow===i&&l.baseColumn===r?(c=l.formula,l.$fe=!0):l.$fe?(d=e.pB(l.baseRow,l.baseColumn))?(d.aMt=c.si,n.Lp.tMt&&n.Lp.tMt[s.id+","+l.baseRow+","+l.baseColumn]&&(n.Lp.tMt[s.id+","+i+","+r]={id:s.id,row:i,col:r})):(c=l.formula,l.baseRow=i,l.baseColumn=r):(c=l.formula,l.$fe=!0,l.baseRow=i,l.baseColumn=r)),R(c))||(1==+t.a&&v&&(v.isDynamicArray=!0,o)&&o.spillCells&&o.spillCells[i+","+r]&&(v.isInvalid=!0),c=_(c),v&&!v.isDynamicArray?a<=i&&r<u?n.uMt(i,r,j(v.rowCount,10),j(v.colCount,10),c,!0,2):i<a&&u<=r?n.uMt(i,r,j(v.rowCount,10),j(v.colCount,10),c,!0,1):a<=i&&u<=r&&n.uMt(i,r,j(v.rowCount,10),j(v.colCount,10),c,!0,3):(v&&s.t8.Zme(v.row,v.col,v.rowCount,v.colCount,!v.isInvalid),!d&&o&&o.exprs&&o.exprs[t.x]&&(d=(0,w.exprFromJSON)(o.exprs[t.x],s.getParserContext(!1)),o.exprs[t.x].nw)&&(d.sMt=!0),a<=i&&r<u?n.zI(i,r,c,d,!0,2,!0,!v):i<a&&u<=r?n.zI(i,r,c,d,!0,1,!0,!v):a<=i&&u<=r&&n.zI(i,r,c,d,!0,3,!0,!v,b,!0),v&&e.Uyt(i,r,v)))}function E(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,o,o,u,a=(f&&f.incrementLoadTask).isBusyFunc,c=o=o||0;for(n.suspendPaint(),n.suspendCalcService(),l=30,(h=f.openMode===g.OpenMode.incremental)&&(v=new Date),d=n.Xbt=n.Xbt||{nextIndex:0},w=n.b3(3);c<i;){if(m=t[c])for(C=0;C<r;C++)an(n,m[C],c,C,w,d,e);if(c++,!s&&a&&a())break;if(h&&(_=new Date,!s)&&30<_-v)break}n.resumeCalcService(),n.resumePaint(),f.loadStatus.formulaLoad+=c-o,h&&(o=f.loadStatus.formulaLoad/f.loadStatus.total,o=+(f.fullRecalc?.3*o+.5:.4*o+.6).toFixed(5),f.incrementLoadTask.progress)&&f.incrementLoadTask.progress({progress:o,sheetName:n.name(),step:x.I5(y().STEP.loadSheetFormula,[n.name()])}),c<i&&f.incrementLoadTask.pushTask(E,[n,t,i,r,e,f,c])}function cn(i,r,e,f){var n=g.Worksheet.fh;n&&C(n,function(n,t){var t=t.fromJsonAfterFormula;t&&t.call(i,r,e,f)})}function hn(i,r,e,f){var n=g.Worksheet.fh;n&&C(n,function(n,t){var t=t.fromJsonAfterSJSFormula;t&&t.call(i,r,e,f)})}function ln(t,i,r,n,e,f){var o,s,u,a,c,h,l,o=g.Worksheet.fh,s=!1,u=[],a=n.getReferenceSheetNames(),c=t&&t.v2,h=function(n){var r;a.hasOwnProperty(n)&&(s=!0,r=(0,g._f)(t,n),c.sheetsState[n]||c.refSheetsState[n]||!r||(c.refSheetsState[n]=1,c.getSheet(n,function(i){var n,n,n=r.NMi;n?(n.yh(i,e,f),R(i.order)||(n.E0i=i.order),(n=(0,g.Ip)(n,i.lossless.addition,t.dataManager()))&&u.push(n)):(r.yh(i,e,f,!0),R(i.order)||(r.E0i=i.order)),o&&C(o,function(n,t){t.refSheetLazyLoaded&&t.refSheetLazyLoaded.call(r,i,e,f)})})))};for(l in a)h(l);s&&o&&C(o,function(n,t){t.afterRefSheetLazyLoaded&&t.afterRefSheetLazyLoaded.call(i,r,e,f)}),0<u.length&&f&&f.fullRecalc&&Promise.all(u).then(function(){t.suspendPaint(),t.mp[0].Mf.recalcAll(!0),t.resumePaint()})}function d(n,t,i){var r,e,f,f;if(n)for(r in n)(f=(e=n[r]).WK)!==b&&(f=i.unparse(t,f,0,0),e.WK=i.parse(t,f,0,0))}function vn(r,e){return function(n){var t,i,t,t=n.w3.rT;t&&t.Mf.xT||(i=(t?t.Mf:e).name(),t=(t?t.Mf:e)._id,r[t+" "+n.row+" "+n.column]={row:n.row,col:n.column,rowCount:1,colCount:1,sheetName:i})}}function dn(n){var t,i,t=[];for(i in n)n.hasOwnProperty(i)&&t.push(n[i]);return t}function S(n,e,t,i,f,r,o,s){var r,t;r&&n.lossless&&([n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){var t,n,i,r;n&&n.dataTable&&(n=n.dataTable,i=e.getRowCount(t=t+1),r=e.getColumnCount(t),o&&!s?A(e,n,i,r,f,0,t):c(e,n,i,r,t))}),n.lossless.defaultData)&&un(e,n.lossless.defaultData),r&&t.cMt&&n.lossless.tree&&0<n.lossless.tree.length&&(delete t.cMt,r=null,"rangeCalc"===(t=n.lossless.tree)[t.length-1].k&&(r=t.pop()),(0,w.pbt)(e.b3(),t,f.$wt),r)&&(0,w.gbt)(e.b3(),r,f.$wt),o&&!s?f.incrementLoadTask.pushTask(hn,[e,n,i,f]):hn(e,n,i,f),g.Util.ume(e,i)}function M(n,t,i){n&&"function"==typeof n.onCustomNameFormulaChanged&&n.onCustomNameFormulaChanged([{nameInfo:t.nameInfo,oldExpr:i,newExpr:t.expr}])}function wn(n){var t=i([],n.sheets,!0);return n.mp&&0<n.mp.length&&n.mp.forEach(function(n){n.Mf&&t.push(n.Mf)}),t}function D(n,t,i,r){var e,f,o,o,s,o=null==n?void 0:n.baseTable;n&&o&&16===n.hbt&&1===n.lbt?(e=o.range(),f=o.Mf&&o.Mf.name()):9===n.type?(D(n.value,t,i,r),D(n.value2,t,i,r)):(o=i.MX.evaluateExpression(n,t.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof I.CalcReference&&(f=o.getSource().getName(),0<o.getRangeCount())&&(e=(0,g.Ec)(o.getRow(s=0),o.getColumn(0),o.getRowCount(0),o.getColumnCount(0))),e&&r.push({sheetName:f,range:e})}function F(n,t){var i,r,e,n;return!t||(i=n.getRow(),r=n.getColumn(),(n=n.getExpression().getRange(i,r))&&!(n=n instanceof g.Range?n:new g.Range(n.row,n.col,n.rowCount,n.colCount)).containsRange(t))}function T(e,f,o,s,u,a){var n,c,h,l,v,d,t,i,r,w,m,l=!s&&e.Ut.pj(),v=!!a;if(e.parent&&e.parent.sheets)for(d=wn(e.parent),t=e.parent.getCustomNames(),i=e.parent.Qwt(),r=!R(e.parent.fMt)&&e.parent.wJt(),t&&C(t,function(n,t){F(t,a)&&(c=t.getExpression(),(h=L(null,e,f,o,s,u,c,v))!==c)&&t.SB(h,l)}),i&&C(i,function(n,t){F(t,a)&&(c=t.getExpression(),(h=L(null,e,f,o,s,u,c,v))!==c)&&t.SB(h,l)}),r&&C(r,function(n,t){F(t,a)&&(c=t.getExpression(),(h=L(null,e,f,o,s,u,c,v))!==c)&&t.SB(h,l)}),w=function(i){var r;(n=d[i].getCustomNames())&&(r=[],C(n,function(n,t){F(t,a)&&(c=t.getExpression(),(h=L(d[i],e,f,o,s,u,c,v))!==c)&&(t.SB(h,l),r.push({nameInfo:t,oldExpr:c,newExpr:h}))}),0<r.length)&&"function"==typeof d[i].onCustomNameFormulaChanged&&d[i].onCustomNameFormulaChanged(r)},m=0;m<d.length;m++)w(m);else(n=e.getCustomNames())&&C(n,function(n,t){F(t,a)&&(c=t.getExpression(),(h=L(e,e,f,o,s,u,c,v))!==c)&&t.SB(h,l)})}function L(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,h,v,l,d,l,d,h,v,g,b,x,y,R,j,N,k,a,j,A;if(o){if(u=t.Uw(),a=(0,I.Syt)(I.Errors.Reference,u),9===o.type){if(h=o.value,l=o.value2,v=L(n,t,i,r,e,f,h,s),d=l&&L(n,t,i,r,e,f,l,s),h!==v||l!==d)return(0,I.rbt)(o.operatorType,v,d)}else if(7===o.type){for(w=!1,m=[],C=void 0,_=0;_<o.arguments.length;_++)p=L(n,t,i,r,e,f,C=o.arguments[_],s),w=w||C!==p,m.push(p);if(w)return(0,I.YJ)(o,m)}else if(1===o.type&&o.hmt()){if(c=o.source||n&&n.Uw(),l=h=o.row,d=v=o.column,c&&c===u&&(f&&!o.rowRelative||!f&&!o.columnRelative)){if(f&&e)h+=i<=h?r:0;else if(!f&&e)v+=i<=v?r:0;else if(f){if(i+r<=h)h-=r;else if(i<=h)return a}else if(i+r<=v)v-=r;else if(i<=v)return a;if(h!==l||v!==d)return(0,I.knt)(u,O,h,v,o.rowRelative,o.columnRelative)}}else if(1===o.type){if(c=o.source||n&&n.Uw(),l=o.row,d=o.column,h=o.endRow,v=o.endColumn,g=o.rowRelative,b=o.columnRelative,x=o.endRowRelative,y=o.endColumnRelative,R=l,j=d,N=h,k=v,c&&c===u){if(f&&e)l+=!g&&i<=l?r:0,h+=!x&&i<=h?r:0;else if(!f&&e)d+=!b&&i<=d?r:0,v+=!y&&i<=v?r:0;else if(f&&!e){if(!g&&i<=l&&!x&&h<i+r)return a;if(g&&x||h<i)return o;if(!g)if(i+r<=l)l-=r;else if(!(l<i)){if(x)return a;i<l&&(l=i)}if(!x)if(i+r<=h)h-=r;else{if(g)return a;h<i+r&&(h=i-1)}}else{if(!b&&i<=d&&!y&&v<i+r)return a;if(b&&y||v<i)return o;if(!b)if(i+r<=d)d-=r;else if(!(d<i)){if(y)return a;i<d&&(d=i)}if(!y)if(i+r<=v)v-=r;else{if(b)return a;v<i+r&&(v=i-1)}}if(d!==j||v!==k||l!==R||h!==N)return(0,I.lJ)(u,O,l,d,h,v,g,b,x,y)}}else if(10===o.type){if((a=o.value)!==(j=L(n,t,i,r,e,f,a,s)))return(0,I.Ayt)(j)}else 13===o.type&&(c=o.source||n&&n.Uw())&&c===u&&!f&&(o=o.offsetWhenInsertRemoveColumn(i,r,e,s));return o}}function Y(n,t){var i,r,e,f,o,s,u,a,t,c,r,i=t.w3,r=i.getSource(),o=-1,s=-1;t.name?(f=t.name,a=t.id,R(a)?e=i.getNodeByName(f):(e={WK:t.expression},u=!0)):(o=t.row,s=t.column,e=i.getNode(o=void 0===o?-1:o,s=void 0===s?-1:s)),t=e.WK,c=e.$bt,r=n.unparse(r,t,o<0?0:o,s<0?0:s),c&&(!0!==n.allowDynamicArray||!0===n.allowDynamicArray&&!c.isDynamicArray)?o===c.row&&s===c.col&&i.setArrayFormula(c.row,c.col,c.rowCount,c.colCount,r):f?u?i.setFormula(a,f,r):i.setFormulaByName(f,r):i.setFormula(o,s,r,null,!0,!0),e.WK.lMt=t.lMt}function mn(n){for(var t,i,r,e,f,o,s,u,a,c,h,l,v,d,w,t=k(n),i,r,e,f=[n.b3(g.SheetArea.colHeader),n.b3(g.SheetArea.rowHeader),n.b3(g.SheetArea.viewport)],o=0;o<f.length;o++){if(!(s=f[o]))return;for(u=s.getAllNodes(),a=0;a<u.length;a++)if(h=(c=u[a]).calc)for(l=h.aT,v=void 0,d=0;d<l.length;d++)(w=h[l[d]])&&w.forEach(function(n){n&&n instanceof I.PathCalc&&Y(t,n)})}}function Cn(n,t,i,r,e,f,o,s,u,a,c,h){p.CalcOperatorAdjustor.copyFormula(n,t,i,r,e,f,o,s,u,a,c,h)}function _n(n,t){var n=n.offset(0,0,!1,0,0);return n.rowRelative=n.endRowRelative=n.columnRelative=n.endColumnRelative=t,n}function V(n,t,i,r,e,f,o,s,u,a){var c,h,l,v,d,w,m,C,_,c,h,l,v,c,h,v,l,c;if(a){if(9===a.type){if(c=a.value,h=a.value2,l=V(n,t,i,r,e,f,o,s,u,c),v=h&&V(n,t,i,r,e,f,o,s,u,h),c!==l||h!==v)return(0,I.rbt)(a.operatorType,l,v)}else if(7===a.type){for(d=!1,w=[],m=void 0,C=0;C<a.arguments.length;C++)_=V(n,t,i,r,e,f,o,s,u,m=a.arguments[C]),d=d||m!==_,w.push(_);if(d)return(0,I.YJ)(a,w)}else if(1===a.type){if(c=!q(a)&&!Q(a),h=!z(a)&&!Z(a),l=t.Uw(),(!a.source||a.source===l)&&c&&h)return v=e.Uw(),c=new p.MoveSwapInfo(l,i,r,v,f,o,s,u),h=_n(a,!0),c.R0i=!0,(v=(0,p.adjustFormulaOnMoveSwap)(l,0,0,h,c,!0))===h?a:1===v.type&&_n(v,!1)||v}else if(10===a.type&&(l=a.value)!==(c=V(n,t,i,r,e,f,o,s,u,l)))return(0,I.Ayt)(c);return a}}function pn(n,t){var i,r,e,f,o,s,u,a,i=n.printInfo&&n.printInfo();if(i)for(r=t.split(","),e=0;e<r.length;e++)for(f=(0,h.formulaToRanges)(n,r[e],0,0),o=0;o<f.length;o++)for(s=f[o].ranges,u=0;u<s.length;u++)-1===(a=s[u]).col||-1===a.colCount?(i.repeatRowStart(a.row),i.repeatRowEnd(a.row+a.rowCount-1)):-1!==a.row&&-1!==a.rowCount||(i.repeatColumnStart(a.col),i.repeatColumnEnd(a.col+a.colCount-1))}function gn(n,t,i,r,e){var n=n[t];n&&(r=n.rT,R(e)||(r.Wbt=e),n.toJSON({data:i}),delete r.Wbt)}function bn(n,t,i,r,e,f){n&&(t&&!t.fullRecalc?n.resumeWithoutCalc():n.resume(!1,!1,!n.calcOnDemand),delete n.lb),delete i.G3,f.resumePaint()}i=this&&this.__spreadArray||function(n,t,i){if(i||2===arguments.length)for(var r=0,e=t.length,f;r<e;r++)!f&&r in t||((f=f||Array.prototype.slice.call(t,0,r))[r]=t[r]);return n.concat(f||Array.prototype.slice.call(t))},Object.defineProperty(n,"__esModule",{value:!0}),n.QB=n.XB=n.adjustOneFormula=n.hMt=n.resetCustomName=n.dMt=n.convertBuiltInNameToDisplayName=void 0,g=t("Core"),r=t("Common"),I=t("CalcEngine"),h=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),p=t("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),w=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),O=null,b=void 0,C=g.GC$.each,l=r.Common.zf.Gmt,x=r.Common.zf,t=new r.Common.ResourceManager(g.SR),y=t.getResource.bind(t),R=r.Common.lt.ht,f="_XLNM.PRINT_AREA",X="PRINT_AREA",o="Print_Area",J=g.mt.xr,G=g.range_parser._c,m=g.mt.n1,_=g.Util.mr,j=parseInt,N=g.UsedRangeUtil.updateUsedRangeByData,n.convertBuiltInNameToDisplayName=v,n.dMt=c,(t=g.Worksheet.prototype).resetCalc=function(){tn.call(this),this.eMt=!0},t.c3n=function(n,t,i){var r,e,f,o,s,u,a,c,h,l,r=this,e=k(r);if(e){if(this.suspendPaint(),e.suspend(!0),f=this.Uw().getCalcSourceModel(),R(i)){if(n)for(d(r.hyt,r.Uw(),e),o=f.getAllNodes(),s=0;s<o.length;s++)(a=(u=o[s]).calc)&&u.WK&&Y(e,a);r.oMt.Bde(n,!t),r.iMt.Bde(n,!t),r.rMt.Bde(n,!t)}else if(!1!==n||t)for(-1===i.row&&(i.row=0,i.rowCount=r.getRowCount()),-1===i.col&&(i.col=0,i.colCount=r.getColumnCount()),c=0;c<i.rowCount;c++)for(h=0;h<i.colCount;h++)(a=(u=f.getNode(c+i.row,h+i.col))&&u.calc)&&u.WK&&(n&&Y(e,a),!1!==n||t&&a.isVolatile)&&a.vyt();l=!1,1===e.calculationMode&&(l=i?function(n){return n.w3===r.oMt&&i.contains(n.row,n.column)}:function(n){return n.w3===r.oMt||n.w3===r.iMt||n.w3===r.rMt}),e.resume(!1,!0,l),this.resumePaint()}},t.recalcAll=function(n){var t,i,r,e,f,o,s,u,a,c,h,t=k(this);if(t){if(this.suspendPaint(),t.suspend(!0),n)for(r=void 0,r=(i=this.parent)&&i.sheets||[this],d(i&&i.hyt,this.Uw(),t),e=0;e<r.length;e++)for(o=(f=r[e]).Uw(),d(f.hyt,o,t),u=(s=o.getCalcSourceModel()).getAllNodes(),a=0;a<u.length;a++)(h=(c=u[a]).calc)&&c.WK&&Y(t,h);t.resume(n),this.resumePaint()}},n.resetCustomName=d,t.recalcRange=function(n,t,i,r){var e=k(this);e&&e.recalcRange(this.Uw(),n,t,i,r)},t.recalcRows=function(n){var t,i,t=k(this);if(t&&!t.ignoreDirty()){for(t.suspend(),i=0;i<n.length;i++)t.recalculate(this.qgt,n[i],-1);t.resume(!1)}},t.recalcCols=function(n){var t,i,t=k(this);if(t&&!t.ignoreDirty()){for(t.suspend(),i=0;i<n.length;i++)t.recalculate(this.qgt,-1,n[i]);t.resume(!1)}},t.gL=function(n,t,i){var r,e,r=k(this);r&&!r.ignoreDirty()&&(e=this.qgt,1===i?e=this.T3:2===i&&(e=this.A3),r.recalculate(e,n,t))},t.getCalcService=function(){return this.Lp||(this.Lp=new I.CalcService,this.Uw(g.SheetArea.colHeader).setCalcService(this.Lp),this.Uw(g.SheetArea.rowHeader).setCalcService(this.Lp),this.Uw().setCalcService(this.Lp),this.Lp.initParserContext(this.Uw())),this.Lp},t.op=function(){return this.getCalcService()},t.suspendCalcService=function(n){var t=k(this);t&&t.suspend(n)},t.resumeCalcService=function(n){var t=k(this);t&&t.resume(n)},t.Uw=function(n){return R(n)||3===n?this.qgt:1===n?this.T3:2===n?this.A3:O},t.b3=function(n){var t=this;return 1===n?(!t.iMt&&t.T3&&(t.iMt=t.op().getSourceModel(t.T3)),t.iMt):2===n?(!t.rMt&&t.A3&&(t.rMt=t.op().getSourceModel(t.A3)),t.rMt):(!t.oMt&&t.qgt&&(t.oMt=t.op().getSourceModel(t.qgt)),t.oMt)},t.vMt=function(n,t,i,r,e){var e=this.b3(e);return e&&e.mMt(n,t,i,r,!0,!0)},t.KT=function(n,t,i,r,e,f){var o=this.vMt(n,t,i,r,3);return!o&&e&&(r=this.getColumnCount(2),o=this.vMt(n,0,i,r,2)),!o&&f&&(i=this.getRowCount(1),o=this.vMt(0,t,i,r,1)),o},t.iT=function(n,t,i,r,e){var e=this.b3(e);return e&&e.mMt(n,t,i,r,!1,!0)},t.mT=function(n,t,i,r,e,f,o){var s,e,s=(e=void 0===e?!0:e)&&this.KT(n,t,i,r,f,o),e=!e&&en(this,n,t,i,r,f,o);return!s&&!e||(this.jT(4,y().Exp_ChangePartOfArray),!1)},t.addCustomFunction=function(n){this.Uwt(n),this.recalcAll()},t.Uwt=function(n){if(!(n&&n instanceof I.Functions.Function))throw new Error(y().Exp_InvalidCustomFunction);n.name=l(n.name),this.Amt[n.name]=n},t.getCustomFunction=function(n){return n?this.Amt[l(n)]:O},t.removeCustomFunction=function(n){n&&(delete this.Amt[l(n)],this.recalcAll())},t.clearCustomFunctions=function(){this.Amt={},this.recalcAll()},t.Jbt=function(n){var t,i,t;return n?(i=(t=this).parent,!(t=t.getCustomFunction(n))&&i&&i.getCustomFunction?i.getCustomFunction(n):t):O},t.addCustomName=function(n,t,i,r,e,f){this.zwt(n,t,i,r,!1,e,f)},t.getCustomName=function(n){return n?this.hyt[l(n)]:b},t.getCustomNames=function(){var i=[];return C(this.hyt,function(n,t){i.push(t)}),i},t.removeCustomName=function(n){var n,t;n&&(n=l(n),delete this.hyt[n],(t={})[n]=n,this.Zwt(t,!1))},t.clearCustomNames=function(){var n,t,n=this,t=n.hyt;n.hyt={},this.Zwt(t,!1)},t.createNameInfo=function(n,t,i,r,e){var f,o,f,o,f=this,o=k(f),f=f.Uw();return o&&f?(o=o.parse(f,t,r,e),new h.NameInfo(n,o,r,e,i)):O},t.getNameInfos=function(){return this.hyt},t.setNameInfos=function(n){R(n)||(this.hyt=n)},t.Vwt=function(n){var t,i,t,t=this,i=!t.hyt[l(n)];return i=i&&(t=t.tables)?!t.findByName(n):i},t.isValidCustomName=function(n){return n&&g.mt.P0(n)&&this.Vwt(n)},t.zwt=function(n,t,i,r,e,f,o){var s,u,a,c,u,s=this;if(!n||!t||!e&&!s.isValidCustomName(n))throw new Error(y().Exp_InvalidCustomName);if(u=k(s),a=s.Uw(),u&&a){if(c=void 0,e)try{c=u.parse(a,t,i,r,!1,!0,!0)}catch(n){}else c=u.parse(a,t,i,r);s.hyt[l(n)]=new h.NameInfo(n,c,i,r,f,o),e||((u={})[n]=n,this.Zwt(u,!0))}},t.Wwt=function(n,t,i,r,e,f,o,s){var u,t,a,t,u=this;if(!n||!t||!f&&!u.isValidCustomName(n))throw new Error(y().Exp_InvalidCustomName);t=k(u),a=u.Uw(),t&&a&&(u.hyt[l(n)]=new h.NameInfo(n,i,r,e,o),f||((t={})[n]=n,this.Zwt(t,!0)))},t.Zwt=function(n,t){var i,r,i=this.b3();if(i){for(r in n)i.updateNameCalc(r,t);this.recalcAll(!1)}this.ki(g.Events.CustomNameChangedInternal,{})},t.gMt=function(n){var t,i,t;return n?(i=(t=this).parent,!(t=t.getCustomName(n))&&i&&i.getCustomName?i.getCustomName(n):t):O},t.setFormula=function(n,t,i,r){this.zI(n,t,i,O,!1,r)},t.zI=function(n,t,i,r,e,f,o,s,u,a){var c,h,l,v,d,w,m,m,C,w,h,l,s,m,a,v,r,c=this;R(f)&&(f=3),n<0||n>=c.getRowCount(f)||t<0||t>=c.getColumnCount(f)?c.jT(0,y().Exp_IndexOutOfRange):(h=0<=n?n:0,l=0<=t?t:0,v=c.Uw(f),d=c.options.keepUnknownFormulas,(w=c.Lp).forceR1C1Formula?(m=w.useR1C1,w.useR1C1=!0,r=r||(i&&w?w.parse(v,i,h,l,!1,e,!1,d):O),w.useR1C1=m):r=r||(i&&w?w.parse(v,i,h,l,!1,e,e,d):O),r&&s&&(r.ensureSingle=!0),m=c.tables,3===f&&0<=n&&0<=t&&m&&!(C=m.pMt(n,t,1,1,i,r))||(w=d&&i&&!r,h=c.b3(f),l=c.conditionalFormats,h&&(s=h.getFormula(n,t,b,!0),m=c.Ut,a||v.t8.Fgt(n,t),(a=R(c.vle)&&!i)&&(c.vle=!(i||c.Sge&&c.Sge(n,t))),h.FE=!0,v=c.vle&&i===O,h.setFormula(n,t,i,r,e,v,m.pj(),u,d),a&&delete h.FE,delete c.vle,h.usedRange&&N(h.usedRange,n,t,s,i),w&&(r=h.getNode(n,t,!0))&&(r.qbt=i),l&&l.dl(),c.hasFormula(n,t,f)&&m.JE(n,t,f),o?c.Lj(c,[{row:n,col:t}],0):c.Rj("formula",n,t,f,s,i)),c.Q1i&&c.Q1i(n,t,1,1,f),c.zw()))},t.eL=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,u=this,a=this.op();if(n<0||n>=u.getRowCount()||t<0||t>=u.getColumnCount())u.jT(0,y().Exp_IndexOutOfRange);else if(h=u.b3(o))for(l=n;l<i+n;l++)for(v=t;v<r+t;v++)l===n&&v===t&&(u.zI(n,t,e,O,!1,o),c=h.pB(n,t),u.Xbt=u.Xbt||{nextIndex:0},d=u.Xbt.nextIndex,u.Xbt[d]={formula:a.unparse(this.qgt,c,n,t,!1,!0),baseRow:n,baseColumn:t,lastRow:n+i-1,lastColumn:t+r-1},u.Xbt.nextIndex++,c.aMt=d),u.zI(l,v," ",c,!0,o,!0,!0)},t.setArrayFormula=function(n,t,i,r,e,f){this.uMt(n,t,i,r,e,!1,f)},t.uMt=function(n,t,i,r,e,f,o,s){var u,a,c,h,a,l,v,d,w;if(void 0===o&&(o=3),u=this,n<0||n+i>u.getRowCount()||t<0||t+r>u.getColumnCount())u.jT(0,y().Exp_IndexOutOfRange);else if(u.Ut.eE(n,t,i,r))u.jT(0,y().Exp_ArrayFormulaSpan);else if(a=u.tables,!(3===o&&0<=n&&0<=t&&a)||(c=a.pMt(n,t,i,r,e))){if(h=u.b3(o),a=u.conditionalFormats,h){for(l=[],v=n;v<n+i;v++)for(l[v]=[],d=t;d<t+r;d++)l[v][d]=h.getFormula(v,d);for(h.setArrayFormula(n,t,i,r,e,f,u.Ut.pj(),s,!1),v=n;v<n+i;v++)for(d=t;d<t+r;d++)h.usedRange&&N(h.usedRange,v,d,l[v][d],e);if(a&&a.dl(),u.vf<1){for(w=[],v=n;v<n+i;v++)for(d=t;d<t+r;d++)w.push({row:v,col:d});u.SI(n,t,i,r,w,5,o,e)}}u.zw()}},t.getFormula=function(n,t,i,r){var i,e,i=this.b3(i);return!i||(e=i.oT(n,t))&&e.isDefault()?O:i.getFormula(n,t,r)},t.bMt=function(n,t,i){var i=this.b3(i);return i?i.pB(n,t):O},t.getFormulaInformation=function(n,t,i,r){var e,i,f,o,f,s,s,u,a,e={},i=this.b3(i);if(i){if(o=(f=i.oT(n,t))&&f.isDefault())return e;(f=i.pB(n,t))?(s=i.sT(n,t),e.hasFormula=!0,s&&(e.baseRange=new g.Range(s.row,s.col,s.rowCount,s.colCount)),e.isArrayFormula=s&&!s.isDynamicArray,n=s?s.row:n,t=s?s.col:t,r||(e.formula=this.Lp.unparse(this.qgt,f,n,t),e.formulaWithCulture=this.Lp.unparse(this.qgt,f,n,t,!0)),e.hasFormula=!!e.formula):(s=this.Uw().t8.getAnchorInfo(n,t))&&s.isValid&&(u=s.row,a=s.col,e.baseRange=new g.Range(s.row,s.col,s.rowCount,s.colCount),n===u&&t===a||(f=i.pB(u,a),r||(e.formulaWithCulture=this.Lp.unparse(this.qgt,f,u,a,!0)),e.hasFormula=!0,e.isDynamicArray=!0))}return e},t.VI=function(n,t,i,r,e,f){var o,s,u,a,c,h,l,v,d,w,m,C;for(i||(i=this,r=n,e=t,f=[]),o=i.qwt(r,e),s=this.name(),u=0;u<o.length;u++){if(f[c=(a=o[u]).sheetName+"_"+a.row+"_"+a.col+"_"+a.rowCount+"_"+a.colCount])return!1;if(f[c]=!0,(a.row<=n&&n<a.row+a.rowCount||-1===a.rowCount)&&(a.col<=t&&t<a.col+a.colCount||-1===a.colCount)&&s===a.sheetName)return!0;for(h=a.sheetName===s?i:i.parent.getSheetFromName(a.sheetName),l=a.rowCount,v=a.row,d=a.colCount,w=a.col,-1===l&&(l=h.getRowCount(),v=0),-1===d&&(d=h.getColumnCount(),w=0),m=v;m<l+v;m++)for(C=w;C<d+w;C++)if(this.VI(n,t,h,v,w,f))return!0}return!1},t.getCrossSheetReferences=function(r){for(var n,e,t,i,f,o,s,u,a,c,h,l,v,d,n=this,e=(0,I.createMap)(),t=n.getRowCount(),i=n.getColumnCount(),f=n.b3(),o=f.rT.id,u=function(n,t){var i,i,i=n.w3.getSource();i&&i.id!==o&&(r?(i=i.getName())&&0<i.length&&e.set(i,!0):e.set(t,n))},a=0;a<t;a++)for(c=0;c<i;c++)if((h=f.oT(a,c))&&h.aT)for(s=h.aT,l=0;l<s.length;l++)(v=h[s[l]])&&v.forEach(u);if((d=f.uT())&&d.aT)for(s=d.aT,l=0;l<s.length;l++)(v=d[s[l]])&&v.forEach(function(n){n&&n.content.forEach(u)});return e},t.getPrecedents=function(n,t){var i,r,r,e,f,n,f,i=[],r=this.b3();return r&&(r=r.Fyt(n,t)||r.pB(n,t),n=(f=(e=this.getFormulaInformation(n,t,3,!0)).baseRange)?f.row:n,f=f?f.col:t,this.yMt(r,n,f,i),i=fn(i)),i},t.getDependents=function(a,c){var h,n,l,h=[],n=this.parent&&this.parent.sheets||[this],l=this.name();return n.forEach(function(n){for(var t,i,r,e,f,o,s,u,t=n.getRowCount(),i=n.getColumnCount(),r=n.name(),e=0;e<t;e++)for(f=0;f<i;f++)for(o=n.getPrecedents(e,f),s=0;s<o.length;s++)if((u=o[s]).sheetName===l&&(-1===u.row||u.row<=a&&a+1<=u.row+u.rowCount)&&(-1===u.col||u.col<=c&&c+1<=u.col+u.colCount)){h.push({row:e,col:f,rowCount:1,colCount:1,sheetName:r});break}}),h},u={},t.qwt=function(n,t){var i,r,e,r,r,f,o,s,i={},r=this.b3().oT(n,t),e=this.b3().uT();if(r&&(r=r[0])&&r.forEach(vn(i,this)),e&&e[0])for(r=e["0c"],u.minX=t,u.minY=n,u.maxX=t,u.maxY=n,f=r.search(u),o=0;o<f.length;o++)(s=f[o].content).forEach(vn(i,this));return dn(i)},t.yMt=function(n,t,i,r){var e,f,f,o,s,u;if(n)switch(e=n.type){case I.ExpressionType.reference:case I.ExpressionType.structReference:f=n.getRange(t,i),r.push({row:f.row,col:f.col,rowCount:f.rowCount,colCount:f.colCount,sheetName:(n.source&&n.source.Mf?n.source.Mf:this).name()});break;case I.ExpressionType.operator:this.yMt(n.value,t,i,r),this.yMt(n.value2,t,i,r);break;case I.ExpressionType.expand:case I.ExpressionType.parentheses:this.yMt(n.value,t,i,r);break;case I.ExpressionType.name:f=this.gMt(n.value),this.yMt(f.getExpression(),t,i,r);break;case I.ExpressionType.function:for(o=n.arguments,s=0;s<o.length;s++)u=o[s],this.yMt(u,t,i,r)}},t.hasFormula=function(n,t,i,r){var i=this.b3(i);return!!i&&i.hasFormula(n,t,r)},t.wMt=function(){var n=this.b3();n&&n.MMt(function(n){n.CMt(),n.yB()})},t.clearFormula=function(n,t,i,r,e){var f,o,s,f=this;for(n<0&&(n=0,i=f.getRowCount()),t<0&&(t=0,r=f.getColumnCount()),o=0;o<i;o++)if(e(f,o+n))for(s=0;s<r;s++)f.setFormula(o+n,s+t,O)},t.nameFunctionsFromJSON=function(n,t,i,r){var e,f,o,s,u,u,a,c,h;if(n){if(e=this,f=n.customFunctions)for(o in f)f.hasOwnProperty(o)&&(s=f[o],u=(0,g.getTypeFromString)(s.typeName))&&((u=new u).fromJSON(s,t),e.Uwt(u));if((a=n.names)&&0<a.length){for(c=0;c<a.length;c++)h=a[c],e.zwt(v(h.name),h.formula,h.row,h.col,!0,h.comment,h.isReadOnly);e.wMt()}r&&r()}},t.formulaFromJSON=function(n,t,e){var f,o,s;n&&((f=this).Xbt=n.sharedFormulas,o=e&&e.ignoreFormula,s=e&&e.incrementalLoading,[n.colHeaderData,n.rowHeaderData,n.data].forEach(function(n,t){var t,n,i,r;n&&!o&&n.dataTable&&(n=n.dataTable,i=f.getRowCount(t=t+1),r=f.getColumnCount(t),s?A(f,n,i,r,e,0,t):c(f,n,i,r,t))}),n.defaultData&&un(f,n.defaultData),s?e.incrementLoadTask.pushTask(cn,[f,n,t,e]):cn(f,n,t,e))},t.formulaFromSJSFormat=function(n,t,i,r){var e,f,o,s,u,a,f,c,h,e=this,f=e.Uw(),o=!i||!1!==i.includeFormulas,s=g.Util.Mo(i),u=g.Util.wo(i,e.parent&&e.parent.v2),a=e.b3(3);f.G3=!0,o&&n.lossless&&n.lossless.tree&&i.$wt&&(a.cMt=!0,f.setReferenceSheetNames(n.lossless.referenceSheetNames)),(f=J(n,g.XFileConstants.bo))?(c=f.rowCount,h=f.colCount,r?(o&&E(e,f,c,h,n.lossless,i,0,r),S(n,e,a,t,i,o,s,r)):(o&&i.incrementLoadTask.addTask(E,[e,f,c,h,n.lossless,i,0],x.I5(y().STEP.loadSheetFormula,[e.name()]),function(){var n=i.loadStatus.formulaLoad/i.loadStatus.total;return i.fullRecalc?u?.5:n*g.STEP_RATE.loadSheetFormulaWithCalc+g.STEP_RATE.loadSheetDataWithCalc+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData:u?.6:n*g.STEP_RATE.loadSheetFormula+g.STEP_RATE.loadSheetData+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData},e.name()),i.incrementLoadTask.addTask(S,[n,e,a,t,i,o,s]))):r?S(n,e,a,t,i,o,s,r):i.incrementLoadTask.addTask(S,[n,e,a,t,i,o,s])},t.nameFunctionFromSJSFormat=function(n,t,i){var e,f,r,o,s,u,u,a,c,e=this,f=e?e.Uw():O,r=n.lossless&&n.lossless.customFunctions;if(r)for(o in r)r.hasOwnProperty(o)&&(s=r[o],u=(0,g.getTypeFromString)(s.typeName))&&((u=new u).fromJSON(s),e.Uwt(u));a=n.lossless&&n.lossless.definedNames,c=n.lossless&&n.lossless.nExpr,a&&0<a.length&&(a.forEach(function(n){var t=""+n.c_[0],i=m(n.name),r=m(n.comment);"_xlnm.Print_Titles"===i?pn(e,t):c&&c[n.e]?e.Wwt(v(i),_(m(t)),(0,w.exprFromJSON)(c[n.e],f.getParserContext(!1)),0,0,!0,r,"_xlnm.Print_Area"!==i):e.zwt(v(i),_(m(t)),0,0,!0,r,n.isReadOnly)}),e.wMt())},t.SMt=function(n){var t=this,i=t.Lp;i&&!n||(t.Lp=n||new I.CalcService,t.Uw(g.SheetArea.colHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.rowHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.viewport).setCalcService(t.Lp),t.Lp.initParserContext(t.Uw()),i?(n.setSourceModel(t.T3,i.getSourceModel(t.T3)),n.setSourceModel(t.A3,i.getSourceModel(t.A3)),n.setSourceModel(t.qgt,i.getSourceModel(t.qgt))):(t.iMt=t.Lp.getSourceModel(t.T3),t.rMt=t.Lp.getSourceModel(t.A3),t.oMt=t.Lp.getSourceModel(t.qgt)),t.oMt.usedRange=new g.BaseUsedRange)},t.setCalc=function(n,t){this.Lp=n,this.qgt=t||this.qgt,this.oMt=n.getSourceModel(this.qgt),this.parent&&(this.parent.Lp=n)},t.YA=function(){this.ol(!1,1)},t.TMt=function(n,t){var i,r,e,f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,i=this,r=n.changeType,e=n.row,f=n.rowCount,o=n.col,s=n.colCount,u=n.sheetArea,a=R(u)||u===g.SheetArea.viewport,c=i.b3(u),h=c.usedRange;c&&(v=(l=i.Ut).pj(),d=k(c),w=c.rT,m=d.Hyt(),C=d.MX.asyncManager,"addingRows"===r?i.mT(e,0,0,i.getColumnCount(),void 0,!0,!1)?(_=a?i.b3(2):b,m.onBeforeAddRemoveRows(c,e,_),T(i,e,f,!0,!0),[c,_].forEach(function(n){n&&n.addRows(e,f)}),C.addRows(w,e,f)):n.canAdd=!1:"addRows"===r?(d.suspend(),_=a?i.b3(2):b,m.onAfterAddRemoveRows(c,e,f,!0,t,_),d.resume(!1),v&&v.push({type:"addRows",row:e,rowCount:f,sheetArea:u}),h&&h.addHeadInfo(e,f,!0)):"deletingRows"===r?i.mT(e,0,f,i.getColumnCount(),void 0,!0,!1)?(_=a?i.b3(2):b,m.onBeforeAddRemoveRows(c,e,_),T(i,e,f,!1,!0),[c,_].forEach(function(n){n&&n.deleteRows(e,f,t)}),C.deleteRows(w,e,f)):n.canDelete=!1:"setRowCount"===r&&f!==e?(d.suspend(),_=i.b3(2),e<f?(c.gF(e+1,0,f-e,i.getColumnCount()),_.gF(e+1,0,f-e,i.getColumnCount()),c.rT.t8.Fgt(e+1,-1,f-e,-1)):(c.gF(f+1,0,e-f,i.getColumnCount()),_.gF(f+1,0,e-f,i.getColumnCount()),c.rge(f,e),_.rge(f,e)),d.AMt(2),d.resume(!1)):"setColumnCount"===r&&s!==o?(d.suspend(),p=i.b3(1),o<s?(c.gF(0,o+1,i.getRowCount(),s-o),p.gF(0,o+1,i.getRowCount(),s-o),c.rT.t8.Fgt(-1,o+1,-1,s-o)):(c.gF(0,s+1,i.getRowCount(),o-s),p.gF(0,s+1,i.getRowCount(),o-s),c.oge(s,o),p.oge(s,o)),d.AMt(3),d.resume(!1)):"deleteRows"===r?(d.suspend(),_=a?i.b3(2):b,m.onAfterAddRemoveRows(c,e,f,!1,t,_),d.resume(!1),v&&v.push({type:"deleteRows",row:e,rowCount:f,sheetArea:u}),h&&h.removeHeadInfo(e,f,!0)):"addingColumns"===r?i.mT(0,o,i.getRowCount(),0,void 0,!1,!0)?(p=a?i.b3(1):b,m.onBeforeAddRemoveColumns(c,o,p),T(i,o,s,!0,!1),[c,p].forEach(function(n){n&&n.addColumns(o,s)}),C.addColumns(w,e,f)):n.canAdd=!1:"addColumns"===r?(d.suspend(),p=a?i.b3(1):b,m.onAfterAddRemoveColumns(c,o,s,!0,t,p),d.resume(!1),v&&v.push({type:"addColumns",col:o,colCount:s}),h&&h.addHeadInfo(o,s,!1)):"deletingColumns"===r?i.mT(0,o,i.getRowCount(),s,void 0,!1,!0)?(p=a?i.b3(1):b,m.onBeforeAddRemoveColumns(c,o,p),T(i,o,s,!1,!1),[c,p].forEach(function(n){n&&n.deleteColumns(o,s,t)}),C.deleteColumns(w,e,f)):n.canDelete=!1:"deleteColumns"===r&&(d.suspend(),p=a?i.b3(1):b,m.onAfterAddRemoveColumns(c,o,s,!1,t,p),d.resume(!1),v&&v.push({type:"deleteColumns",col:o,colCount:s,sheetArea:u}),h)&&h.removeHeadInfo(o,s,!1))},t.IMt=function(n,t,i,r){var e,f,o,s,u,a,e=i.type,f=this;if(r){if("addRows"===e)i.changeType="addingRows",f.TMt(i),i.changeType="addRows",f.TMt(i);else if("deleteRows"===e)i.changeType="deletingRows",f.TMt(i),i.changeType="deleteRows",f.TMt(i);else if("addColumns"===e)i.changeType="addingColumns",f.TMt(i),i.changeType="addColumns",f.TMt(i);else if("deleteColumns"===e)i.changeType="deletingColumns",f.TMt(i),i.changeType="deleteColumns",f.TMt(i);else if("customName"===e)o=n.parse(f,i.newFormula,0,0),s=i.nameInfo.getExpression(),i.nameInfo.SB(o),M(f,i,s);else if("condition"===e){for(u=[],a=0;a<i.newFormulas.length;a++)o=n.parse(f,i.newFormulas[a],0,0),u.push(o);i.condition.setExpressions(u)}}else if("addRows"===e)i.changeType="deletingRows",f.TMt(i,!0),i.changeType="deleteRows",f.TMt(i,!0);else if("deleteRows"===e)i.changeType="addingRows",f.TMt(i,!0),i.changeType="addRows",f.TMt(i,!0);else if("addColumns"===e)i.changeType="deletingColumns",f.TMt(i,!0),i.changeType="deleteColumns",f.TMt(i,!0);else if("deleteColumns"===e)i.changeType="addingColumns",f.TMt(i,!0),i.changeType="addColumns",f.TMt(i,!0);else if("customName"===e)o=n.parse(f,i.formula,0,0),s=i.nameInfo.getExpression(),i.nameInfo.SB(o),M(f,i,s);else if("condition"===e){for(u=[],a=0;a<i.formulas.length;a++)o=n.parse(f,i.formulas[a],0,0),u.push(o);i.condition.setExpressions(u)}},t.xMt=function(n,t,i){var r,e,f,r=i.type,e=this;"addRows"===r?(i.changeType="deletingRows",e.TMt(i,!0),i.changeType="deleteRows",e.TMt(i,!0)):"deleteRows"===r?(i.changeType="addingRows",e.TMt(i,!0),i.changeType="addRows",e.TMt(i,!0)):"addColumns"===r?(i.changeType="deletingColumns",e.TMt(i,!0),i.changeType="deleteColumns",e.TMt(i,!0)):"deleteColumns"===r?(i.changeType="addingColumns",e.TMt(i,!0),i.changeType="addColumns",e.TMt(i,!0)):"customName"===r?(f=i.nameInfo.getExpression(),i.nameInfo.SB(i.expr),M(e,i,f)):"condition"===r&&i.condition.setExpressions(i.expressions)},t.NMt=function(n,t){var i,r,e,f,o,i=this,r=k(i),e=i.b3();if(r.suspend(),t)for(f=0;f<n.length;f++)(o=n[f]).type?i.IMt(r,e,o,t):o.newValue&&i.setFormula(o[0],o[1],o.formula);else for(f=n.length-1;0<=f;f--)(o=n[f]).type?i.IMt(r,e,o,t):o.newValue||i.setFormula(o[0],o[1],o.formula);r.resume(!1)},t.xj=function(n){var t,t,i,r,e,f,o,s,u,a,c,h,l,v,d,t=n[n.length-1],t=t&&t.sheetArea,i=R(t)||t===g.SheetArea.viewport,r=k(this),e=this.b3(t),f=this.Uw(t);for(r.suspend();n.length;){if(s=(o=n.pop())[0],u=o[1],a=e.pB(s,u),h=[],c=i&&f.t8.getAnchorInfo(s,u)){for(l=c.row;l<c.row+c.rowCount;l++)for(h[l]=[],v=c.col;v<c.col+c.colCount;v++)h[l][v]=this.getValue(l,v);!c.isValid||o[2]||o[3]||f.t8.Rme(f.t8.Pme(s,u),!0,!1,!0)}if(o.type?this.xMt(r,e,o):e.kMt.apply(e,o),(d=i&&e&&e.usedRange)&&(N(d,o[0],o[1],a,o[2]),c))for(l=c.row;l<c.row+c.rowCount;l++)for(v=c.col;v<c.col+c.colCount;v++)l===o[0]&&v===o[1]||N(d,l,v,h[l][v],o[2])}n&&n.Vme&&f.t8.Wme(n.Vme),r.resume(!1)},t.getReferenceRange=function(n){var t,i,r,e,f,o,n,s,t=this.Uw(),i=this.getCalcService(),r=i.parse(t,n,0,0,void 0,!0),o=r.baseTable;return r&&o&&n===o.name()?(e=o.range(),f=o.Mf&&o.Mf.name()):(n=i.MX.evaluateExpression(r,t.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof I.CalcReference&&(f=n.getSource().getName(),0<n.getRangeCount())&&(e=(0,g.Ec)(n.getRow(s=0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))),{sheetName:f,range:e}},t.sCe=function(n){var t,i,n,r,e,f,t=this.Uw(),i=this.getCalcService(),n=i.parse(t,n,0,0,void 0,!0),r=[],e=[],f={};return D(n,t,i,r),r.forEach(function(n){var t=n.sheetName,n=n.range;f[t]||(f[t]={sheetName:t,ranges:[]},e.push(f[t])),f[t].ranges.push(n)}),e},t.dL=function(n,t,i,r){var e,f,f,e=this,f="string"==typeof r&&e.parent&&e.parent.xO(r);return f&&-1!==n&&-1!==t?(f=f.getExpression(),W(e,r)?K(e,f,n,t):(0,h.evaluateExpression)(e,f,n,t,{sheetArea:i})):b},t.TL=function(n,t,i){var r,e,f,o,f,s,u,a,c,r=this,e=!!r.NMi,f=r.getCell(n=-1===n?0:n,t=-1===t?0:t,3),o=(0,h.rangeToFormula)(f,n,t,3);if(0<=(f="="===(f=i.trim()).charAt(0)&&0<=f.indexOf("@")&&!B(f)?f.replace(/@/g,o):f).indexOf("{{")&&0<=f.indexOf("}}")){for(""===(s=f.split(/{{|}}/))[0]&&s.shift(),""===s[s.length-1]&&s.pop(),u=0;u<s.length;u++)-1===s[u].indexOf("=")?s[u]='"'+s[u]+'"':(!e||!B(s[u]))&&(0<=s[u].indexOf("@")&&(s[u]=s[u].replace(/@/g,o)),(a=(0,h.evaluateFormula)(r,s[u]))instanceof I.CalcError)?s[u]='"'+a.toString()+'"':s[u]=s[u].replace(/=/g,"");f="=CONCAT("+s.join(",")+")"}(c=r.parent).xO(i)||c.pp(c.bp,i,f,n,t,!0,"",r.NMi)},t.NO=function(n,t,i,r){var e=this;return(W(e,n)?K:(0,h.evaluateExpression))(e,t,i,r)},n.hMt=T,n.adjustOneFormula=Y,n.XB=Cn,n.QB=V,g.Worksheet.ch("calc",{priority:1e3,init:tn,dispose:function(n){var t,i,i,i,t=this;!1!==n.clearCache&&(t.qgt=O,t.A3=O,t.T3=O,t.Lp=O,(i=t.oMt)&&(!0===n.isSheetDestroy?i.DMt():i._Mt(),t.oMt=O),(i=t.rMt)&&(!0===n.isSheetDestroy?i.DMt():i._Mt(),t.rMt=O),i=t.iMt)&&(!0===n.isSheetDestroy?i.DMt():i._Mt(),t.iMt=O)},attach:function(n){var t=this;n instanceof g.Workbook?t.SMt(n.Lp):t.SMt()},onLayoutChanged:function(n){this.op().isAdjustSuspended()||this.TMt(n)},toJson:function(n,t){var u,i,r,a,i,c,e,f,o,s,u=this,i=u.Amt;g.GC$.isEmptyObject(i)||(n.customFunctions=i),r=t&&t.newWorkSheetName,a=[],i=u.getCustomNames(),c=k(u),e=u.b3(),f=e.rT,i&&c&&(!R(r)&&e&&f&&(f.Wbt=r),C(i,function(n,t){var i,r,e,f,o,t,s,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(i={name:i,formula:s=c.unparse(u.Uw(),f,r,e,!1,!0,1),row:r,col:e},t&&(i.comment=t),"boolean"==typeof o&&(i.isReadOnly=o),a.push(i))}),0<a.length&&(n.names=a),delete f.Wbt),(o=t&&t.ignoreFormula)||(s=[u.oMt,u.iMt,u.rMt],[n.data,n.colHeaderData,n.rowHeaderData].forEach(function(n,t){gn(s,t,n,f,r)}),u.Xbt&&0<u.Xbt.nextIndex&&(n.sharedFormulas=u.Xbt))},fromJson:function(n,t,i,r){var e,f,e=this,f;i&&i.incrementalLoading||(e.clearCustomFunctions(),e.clearCustomNames()),r&&(e.nameFunctionsFromJSON(n,t,i),e.formulaFromJSON(n,t,i))},wh:function(n,t,u){var a,i,r,c,h,i,l,e,f,v,o,d,o,e,s,a=this,i=a.Amt;g.GC$.isEmptyObject(i)||(n.lossless.customFunctions=i),r=u&&u.newWorkSheetName,c=[],h=[],i=a.getCustomNames(),l=k(a),e=a.b3(),f=e.rT,v={},a.parent&&(o=a.parent.yC,v=o&&o.getUsedCustomNames()||{}),i&&l&&!a.NMi&&(!R(r)&&e&&f&&(f.Wbt=r),d=!u||!1!==u.includeUnusedNames,C(i,function(n,t){var i,r,e,f,o,t,s,i,t,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();i.toUpperCase()!==X&&f&&(d||v[i])&&(i={name:i,comment:t,isReadOnly:o,formula:s=l.unparse(a.Uw(),f,r,e,!1,!0,1)},u&&u.includeCalcModelCache&&!a.ctr&&(t=(0,w.exprToJSON)(f),c.push(t),i.e=c.length-1),h.push(i))}),0<h.length&&(n.lossless.definedNames=h),0<c.length&&(n.lossless.nExpr=c),delete f.Wbt),(o=u&&!1===u.includeFormulas)||((e=a.oMt)&&(f=e.rT,R(r)||(f.Wbt=r),e.wh(n,u),delete f.Wbt),s=[a.iMt,a.rMt],n.lossless&&[n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){gn(s,t,n,f,r)})),!o&&g.Util.ko(u)&&(u&&u.includeCalcModelCache&&!a.ctr&&(n.lossless.tree=(0,w.mbt)(a.b3())),f=a.Uw(),n.lossless.referenceSheetNames=f&&f.getReferenceSheetNames(),rn(a,n.lossless))},yh:function(n,t,i,r){var e,f,o,s,u,a,c,e=this,f=e.parent,s=g.Util.wo(i,e.parent&&e.parent.v2),u=i&&!i.fullRecalc,a=e.Uw();e.suspendPaint(),f&&f.Lp&&((o=f.Lp).suspend(),o.lb=u),(c=g.Util.Mo(i))||(e.clearCustomFunctions(),e.clearCustomNames()),s&&(a.G3=!0,e.nameFunctionFromSJSFormat(n,t,i),e.formulaFromSJSFormat(n,t,i,r),r?ln(f,e,n,a,t,i):i.incrementLoadTask.addTask(ln,[f,e,n,a,t,i])),r?bn(o,i,a,s,u,e):i.incrementLoadTask.addTask(function(n,t,i,r,e,f){bn(n,t,i,r,e,f)},[o,i,a,s,u,e])},setName:function(n){var t,i,r;mn(this),(r=(i=k(t=this.b3())).MX.asyncManager).changeSourceName(n.oldName,n.newName)},beforeSetName:function(){this.b8&&(this.parent||this).xyt()},canAddingSpan:function(n){var t,i,r,e,f,o,t=this,i=n.sheetArea,r=n.row,e=n.col,f=n.rowCount,o=n.colCount;3!==i&&!R(i)||t.mT(r,e,f,o,!1)||(n.isAllow=!1)}}),g.Y8.ch("calc",{isInvalidFormula:function(t){var n,i,n=O,i=b;try{t.allowDynamicArray&&(R(h.SheetParserContext.wbt)&&(h.SheetParserContext.wbt=new g.Worksheet),(n=h.SheetParserContext.wbt).getCalcService())&&(i=n.getCalcService().allowDynamicArray,n.getCalcService().allowDynamicArray=!0),(0,h.formulaToExpression)(n,t.value)}catch(n){t.isInvalid=!0}finally{R(n)||R(i)||!n.getCalcService()||n.getCalcService().allowDynamicArray===i||(n.getCalcService().allowDynamicArray=i)}}})},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=e("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CalcEngine=n}();