/*!
    *
    * Wijmo Library 5.20232.939
    * https://developer.mescius.com/wijmo
    *
    * Copyright(c) MESCIUS inc. All rights reserved.
    *
    * Licensed under the End-User License Agreement For MESCIUS Wijmo Software.
    * us.sales@mescius.com
    * https://developer.mescius.com/wijmo/licensing
    *
    */

"use strict";var __importStar=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);e.default=t;return e};Object.defineProperty(exports,"__esModule",{value:!0});const wijmo_1=require("@grapecity/wijmo"),core=__importStar(require("@grapecity/wijmo")),chart=__importStar(require("@grapecity/wijmo.chart")),selfModule=__importStar(require("@grapecity/wijmo.chart.webgl"));class _EarCut{earcut(t,e=null,i=null){i=i||2;var r,s,n,o,a,h,l,u=e&&e.length,f=u?e[0]*i:t.length,c=this.linkedList(t,0,f,i,!0),p=[];if(!c||c.next===c.prev)return p;u&&(c=this.eliminateHoles(t,e,c,i));if(t.length>80*i){r=n=t[0];s=o=t[1];for(var x=i;x<f;x+=i){(a=t[x])<r&&(r=a);(h=t[x+1])<s&&(s=h);a>n&&(n=a);h>o&&(o=h)}l=0!==(l=Math.max(n-r,o-s))?1/l:0}this.earcutLinked(c,p,i,r,s,l);return p}linkedList(t,e,i,r,s){var n,o;if(s===this.signedArea(t,e,i,r)>0)for(n=e;n<i;n+=r)o=this.insertNode(n,t[n],t[n+1],o);else for(n=i-r;n>=e;n-=r)o=this.insertNode(n,t[n],t[n+1],o);if(o&&this.equals(o,o.next)){this.removeNode(o);o=o.next}return o}filterPoints(t,e=null){if(!t)return t;e||(e=t);var i,r=t;do{i=!1;if(r.steiner||!this.equals(r,r.next)&&0!==this.area(r.prev,r,r.next))r=r.next;else{this.removeNode(r);if((r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}earcutLinked(t,e,i,r,s,n,o=null){if(t){!o&&n&&this.indexCurve(t,r,s,n);for(var a,h,l=t;t.prev!==t.next;){a=t.prev;h=t.next;if(n?this.isEarHashed(t,r,s,n):this.isEar(t)){e.push(a.i/i);e.push(t.i/i);e.push(h.i/i);this.removeNode(t);t=h.next;l=h.next}else if((t=h)===l){if(o)if(1===o){t=this.cureLocalIntersections(this.filterPoints(t),e,i);this.earcutLinked(t,e,i,r,s,n,2)}else 2===o&&this.splitEarcut(t,e,i,r,s,n);else this.earcutLinked(this.filterPoints(t),e,i,r,s,n,1);break}}}}isEar(t){var e=t.prev,i=t,r=t.next;if(this.area(e,i,r)>=0)return!1;for(var s=t.next.next;s!==t.prev;){if(this.pointInTriangle(e.x,e.y,i.x,i.y,r.x,r.y,s.x,s.y)&&this.area(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}isEarHashed(t,e,i,r){var s=t.prev,n=t,o=t.next;if(this.area(s,n,o)>=0)return!1;for(var a=s.x<n.x?s.x<o.x?s.x:o.x:n.x<o.x?n.x:o.x,h=s.y<n.y?s.y<o.y?s.y:o.y:n.y<o.y?n.y:o.y,l=s.x>n.x?s.x>o.x?s.x:o.x:n.x>o.x?n.x:o.x,u=s.y>n.y?s.y>o.y?s.y:o.y:n.y>o.y?n.y:o.y,f=this.zOrder(a,h,e,i,r),c=this.zOrder(l,u,e,i,r),p=t.prevZ,x=t.nextZ;p&&p.z>=f&&x&&x.z<=c;){if(p!==t.prev&&p!==t.next&&this.pointInTriangle(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&this.area(p.prev,p,p.next)>=0)return!1;p=p.prevZ;if(x!==t.prev&&x!==t.next&&this.pointInTriangle(s.x,s.y,n.x,n.y,o.x,o.y,x.x,x.y)&&this.area(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;p&&p.z>=f;){if(p!==t.prev&&p!==t.next&&this.pointInTriangle(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&this.area(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;x&&x.z<=c;){if(x!==t.prev&&x!==t.next&&this.pointInTriangle(s.x,s.y,n.x,n.y,o.x,o.y,x.x,x.y)&&this.area(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}cureLocalIntersections(t,e,i){var r=t;do{var s=r.prev,n=r.next.next;if(!this.equals(s,n)&&this.intersects(s,r,r.next,n)&&this.locallyInside(s,n)&&this.locallyInside(n,s)){e.push(s.i/i);e.push(r.i/i);e.push(n.i/i);this.removeNode(r);this.removeNode(r.next);r=t=n}r=r.next}while(r!==t);return this.filterPoints(r)}splitEarcut(t,e,i,r,s,n){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&this.isValidDiagonal(o,a)){var h=this.splitPolygon(o,a);o=this.filterPoints(o,o.next);h=this.filterPoints(h,h.next);this.earcutLinked(o,e,i,r,s,n);this.earcutLinked(h,e,i,r,s,n);return}a=a.next}o=o.next}while(o!==t)}eliminateHoles(t,e,i,r){var s,n,o,a,h,l=[];for(s=0,n=e.length;s<n;s++){o=e[s]*r;a=s<n-1?e[s+1]*r:t.length;(h=this.linkedList(t,o,a,r,!1))===h.next&&(h.steiner=!0);l.push(this.getLeftmost(h))}l.sort(this.compareX);for(s=0;s<l.length;s++){this.eliminateHole(l[s],i);i=this.filterPoints(i,i.next)}return i}compareX(t,e){return t.x-e.x}eliminateHole(t,e){if(e=this.findHoleBridge(t,e)){var i=this.splitPolygon(e,t);this.filterPoints(e,e.next);this.filterPoints(i,i.next)}}findHoleBridge(t,e){var i,r=e,s=t.x,n=t.y,o=-1/0;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var a=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=s&&a>o){o=a;if(a===s){if(n===r.y)return r;if(n===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(s===o)return i;var h,l=i,u=i.x,f=i.y,c=1/0;r=i;do{if(s>=r.x&&r.x>=u&&s!==r.x&&this.pointInTriangle(n<f?s:o,n,u,f,n<f?o:s,n,r.x,r.y)){h=Math.abs(n-r.y)/(s-r.x);if(this.locallyInside(r,t)&&(h<c||h===c&&(r.x>i.x||r.x===i.x&&this.sectorContainsSector(i,r)))){i=r;c=h}}r=r.next}while(r!==l);return i}sectorContainsSector(t,e){return this.area(t.prev,t,e.prev)<0&&this.area(e.next,t,t.next)<0}indexCurve(t,e,i,r){var s=t;do{null===s.z&&(s.z=this.zOrder(s.x,s.y,e,i,r));s.prevZ=s.prev;s.nextZ=s.next;s=s.next}while(s!==t);s.prevZ.nextZ=null;s.prevZ=null;this.sortLinked(s)}sortLinked(t){var e,i,r,s,n,o,a,h,l=1;do{i=t;t=null;n=null;o=0;for(;i;){o++;r=i;a=0;for(e=0;e<l;e++){a++;if(!(r=r.nextZ))break}h=l;for(;a>0||h>0&&r;){if(0!==a&&(0===h||!r||i.z<=r.z)){s=i;i=i.nextZ;a--}else{s=r;r=r.nextZ;h--}n?n.nextZ=s:t=s;s.prevZ=n;n=s}i=r}n.nextZ=null;l*=2}while(o>1);return t}zOrder(t,e,i,r,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*s)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}getLeftmost(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e);e=e.next}while(e!==t);return i}pointInTriangle(t,e,i,r,s,n,o,a){return(s-o)*(e-a)-(t-o)*(n-a)>=0&&(t-o)*(r-a)-(i-o)*(e-a)>=0&&(i-o)*(n-a)-(s-o)*(r-a)>=0}isValidDiagonal(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!this.intersectsPolygon(t,e)&&(this.locallyInside(t,e)&&this.locallyInside(e,t)&&this.middleInside(t,e)&&(this.area(t.prev,t,e.prev)||this.area(t,e.prev,e))||this.equals(t,e)&&this.area(t.prev,t,t.next)>0&&this.area(e.prev,e,e.next)>0)}area(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}equals(t,e){return t.x===e.x&&t.y===e.y}intersects(t,e,i,r){var s=this.sign(this.area(t,e,i)),n=this.sign(this.area(t,e,r)),o=this.sign(this.area(i,r,t)),a=this.sign(this.area(i,r,e));return s!==n&&o!==a||(!(0!==s||!this.onSegment(t,i,e))||(!(0!==n||!this.onSegment(t,r,e))||(!(0!==o||!this.onSegment(i,t,r))||!(0!==a||!this.onSegment(i,e,r)))))}onSegment(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}sign(t){return t>0?1:t<0?-1:0}intersectsPolygon(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&this.intersects(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}locallyInside(t,e){return this.area(t.prev,t,t.next)<0?this.area(t,e,t.next)>=0&&this.area(t,t.prev,e)>=0:this.area(t,e,t.prev)<0||this.area(t,t.next,e)<0}middleInside(t,e){var i=t,r=!1,s=(t.x+e.x)/2,n=(t.y+e.y)/2;do{i.y>n!=i.next.y>n&&i.next.y!==i.y&&s<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(r=!r);i=i.next}while(i!==t);return r}splitPolygon(t,e){var i=new Node(t.i,t.x,t.y),r=new Node(e.i,e.x,e.y),s=t.next,n=e.prev;t.next=e;e.prev=t;i.next=s;s.prev=i;r.next=i;i.prev=r;n.next=r;r.prev=n;return r}insertNode(t,e,i,r){var s=new Node(t,e,i);if(r){s.next=r.next;s.prev=r;r.next.prev=s;r.next=s}else{s.prev=s;s.next=s}return s}removeNode(t){t.next.prev=t.prev;t.prev.next=t.next;t.prevZ&&(t.prevZ.nextZ=t.nextZ);t.nextZ&&(t.nextZ.prevZ=t.prevZ)}deviation(t,e,i,r){var s=e&&e.length,n=s?e[0]*i:t.length,o=Math.abs(this.signedArea(t,0,n,i));if(s)for(var a=0,h=e.length;a<h;a++){var l=e[a]*i,u=a<h-1?e[a+1]*i:t.length;o-=Math.abs(this.signedArea(t,l,u,i))}var f=0;for(a=0;a<r.length;a+=3){var c=r[a]*i,p=r[a+1]*i,x=r[a+2]*i;f+=Math.abs((t[c]-t[x])*(t[p+1]-t[c+1])-(t[c]-t[p])*(t[x+1]-t[c+1]))}return 0===o&&0===f?0:Math.abs((f-o)/o)}signedArea(t,e,i,r){for(var s=0,n=e,o=i-r;n<i;n+=r){s+=(t[o]-t[n])*(t[n+1]+t[o+1]);o=n}return s}flatten(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,s=0;s<t.length;s++){for(var n=0;n<t[s].length;n++)for(var o=0;o<e;o++)i.vertices.push(t[s][n][o]);if(s>0){r+=t[s-1].length;i.holes.push(r)}}return i}}exports._EarCut=_EarCut;class Node{constructor(t,e,i){this.i=t;this.x=e;this.y=i;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=!1}}class WebGLRenderEngine extends chart._SvgRenderEngine{constructor(t){super(t);this.primitives=[];this.clipRects={};this.init()}beginRender(){super.beginRender();this.isIE?this.element.appendChild(this.canvas):this.element.appendChild(this.foCanvas);let t=this.gl;t.viewport(0,0,t.canvas.width,t.canvas.height);t.clearColor(0,0,0,0);t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);t.enable(t.BLEND);t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);this.primitives.forEach(t=>t.beginRender());this.clipRects={}}setViewportSize(t,e){super.setViewportSize(t,e);if(this.foCanvas){this.foCanvas.setAttribute("width",t.toString());this.foCanvas.setAttribute("height",e.toString())}let i=this.gl;i.canvas.width=t;i.canvas.height=e}endRender(){this.primitives.forEach(t=>t.endRender());super.endRender();if(this.isIE){let t=document.createElementNS(WebGLRenderEngine.svgns,"image");t.setAttribute("width",this.gl.canvas.width);t.setAttribute("height",this.gl.canvas.height);t.setAttribute("href",this.canvas.toDataURL());this.element.appendChild(t);this.canvas.parentNode==this.element&&this.element.removeChild(this.canvas)}}drawEllipse(t,e,i,r,s,n){if(this.useSvg)return super.drawEllipse(t,e,i,r,s,n);this.edraw.drawEllipse(new core.Rect(t-i,e-r,2*i,2*r),this.fill);return null}_getGroupClipRect(t=null){let e=t||this.group;if(e){let t=e.getAttribute("clip-path");if(t){let e=t.substring(5,t.length-1);return this.clipRects[e]}if(e.parentElement)return this._getGroupClipRect(e.parentElement)}return null}drawRect(t,e,i,r,s,n,o){if("wj-plot-area"==this._groupCls||this.useSvg)return super.drawRect(t,e,i,r,s,n,o);{let s=o?this.clipRects[o]:this._getGroupClipRect();this.rdraw.drawRect(new core.Rect(t,e,i,r),this.fill,s);return null}}drawLines(t,e,i,r,s,n){this.ldraw.drawLines(t,e,n,this.stroke,s?this.clipRects[s]:null);return null}drawPolygon(t,e,i,r,s){if(this.useSvg)return super.drawPolygon(t,e,i,r,s);{let i=s?this.clipRects[s]:this._getGroupClipRect();this.adraw.drawPolygon(t,e,this.fill,i)}return null}addClipRect(t,e){super.addClipRect(t,e);t&&e&&(this.clipRects[e]=t)}init(){this.canvas=document.createElement("canvas");this.gl=this.canvas.getContext("webgl",{preserveDrawingBuffer:!0});if(this.gl){this.canvas.setAttribute("style","margin:0px;padding:0px;border:none");let t=document.createElementNS("http://www.w3.org/1999/xhtml","div");t.setAttribute("style","margin:0px;padding:0px;border:none");this.foCanvas=document.createElementNS(WebGLRenderEngine.svgns,"foreignObject");t.appendChild(this.canvas);this.foCanvas.appendChild(t)}else{this.gl=this.canvas.getContext("experimental-webgl");this.isIE=!0;this.canvas.setAttribute("style","visibility:hidden;position:absolute;top:-1000px;margin:0px;padding:0px;border:none")}this.rdraw=new _GLDrawRect(this.gl);this.edraw=new _GLDrawEllipse(this.gl);this.ldraw=new _GLDrawLines(this.gl);this.adraw=new _GLDrawAreas(this.gl);this.primitives.push(this.rdraw,this.edraw,this.ldraw,this.adraw)}}WebGLRenderEngine.svgns="http://www.w3.org/2000/svg";exports.WebGLRenderEngine=WebGLRenderEngine;class _GLDrawBase{constructor(t){this._vsSource="\n    attribute vec2 a_position;\n    \n    uniform vec2 u_resolution;\n    \n    void main() {\n      vec2 zeroToOne = a_position / u_resolution;\n      vec2 zeroToTwo = zeroToOne * 2.0;\n      vec2 clipSpace = zeroToTwo - 1.0;\n      gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n    }\n    ";this._fsSource="\n    precision mediump float;\n    uniform vec4 u_color;\n    void main() {\n      gl_FragColor = u_color;\n    }\n    ";this.gl=t}init(){let t=this.gl;this.shaderProgram=this.initShaderProgram(this.vsSource,this.fsSource);this.positionAttributeLocation=t.getAttribLocation(this.shaderProgram,"a_position");this.resolutionUniformLocation=t.getUniformLocation(this.shaderProgram,"u_resolution");this.colorLocation=t.getUniformLocation(this.shaderProgram,"u_color");t.useProgram(this.shaderProgram);this.positionBuffer=t.createBuffer()}beginRender(){let t=this.gl;t.useProgram(this.shaderProgram);t.uniform2f(this.resolutionUniformLocation,t.canvas.width,t.canvas.height)}endRender(){this.flush()}flush(){}initShaderProgram(t,e){let i=this.gl;const r=this.loadShader(i.VERTEX_SHADER,t),s=this.loadShader(i.FRAGMENT_SHADER,e),n=i.createProgram();i.attachShader(n,r);i.attachShader(n,s);i.linkProgram(n);if(!i.getProgramParameter(n,i.LINK_STATUS)){alert("Unable to initialize the shader program: "+i.getProgramInfoLog(n));return null}return n}loadShader(t,e){const i=this.gl,r=i.createShader(t);i.shaderSource(r,e);i.compileShader(r);if(!i.getShaderParameter(r,i.COMPILE_STATUS)){alert("An error occurred compiling the shaders: "+i.getShaderInfoLog(r));i.deleteShader(r);return null}return r}get vsSource(){return this._vsSource}get fsSource(){return this._fsSource}}class _GLDrawRect extends _GLDrawBase{constructor(t){super(t);this.BUFFER_SIZE=1e4;this.bufRects=[];this.bufLen=0;this.init()}initBuffers(){if(!this.buffer){let t=this.gl;this.buffer=new Float32Array(12*this.BUFFER_SIZE);this.bufRects=new Array(this.BUFFER_SIZE);t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);t.bufferData(t.ARRAY_BUFFER,4*this.buffer.length,t.DYNAMIC_DRAW)}}drawRect(t,e,i=null){this.initBuffers();let r=!1;i!==this.previousClip&&(r=null===i||null===this.previousClip||!i.equals(this.previousClip));if(e!==this.previousFill||r){this.flush();this.previousFill=e;this.previousClip=i}this.bufRects[this.bufLen++]=t;this.bufLen>=this.BUFFER_SIZE&&this.flush()}flush(){if(0==this.bufLen)return;let t=this.gl;t.useProgram(this.shaderProgram);let e=this.previousClip;if(e){t.enable(t.SCISSOR_TEST);t.scissor(e.left,t.canvas.height-e.bottom,e.width+1,e.height+1)}let i=new core.Color(this.previousFill);t.uniform4f(this.colorLocation,i.r/255,i.g/255,i.b/255,i.a);t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);this.setData();t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);t.drawArrays(t.TRIANGLES,0,6*this.bufLen);e&&t.disable(t.SCISSOR_TEST);this.bufLen=0}setData(){let t=this.gl,e=this.bufLen,i=this.buffer;for(let t=0;t<e;t++){let e=this.bufRects[t],r=e.left,s=e.right,n=e.top,o=e.bottom,a=12*t;i[a]=r;i[a+1]=n;i[a+2]=s;i[a+3]=n;i[a+4]=r;i[a+5]=o;i[a+6]=r;i[a+7]=o;i[a+8]=s;i[a+9]=n;i[a+10]=s;i[a+11]=o}t.bufferSubData(t.ARRAY_BUFFER,0,i.subarray(0,12*e))}}class _GLDrawEllipse extends _GLDrawBase{constructor(t){super(t);this.NTRIANGLES=12;this.BUFFER_SIZE=1e4;this.bufRects=new Array(this.BUFFER_SIZE);this.bufLen=0;this.sin1=new Float32Array(this.NTRIANGLES);this.sin2=new Float32Array(this.NTRIANGLES);this.cos1=new Float32Array(this.NTRIANGLES);this.cos2=new Float32Array(this.NTRIANGLES);this.data=new Float32Array(this.BUFFER_SIZE*this.NTRIANGLES*6);let e=2*Math.PI/this.NTRIANGLES;for(let t=0;t<this.NTRIANGLES;t++){let i=e*t;this.sin1[t]=Math.sin(i);this.cos1[t]=Math.cos(i);this.sin2[t]=Math.sin(i+e);this.cos2[t]=Math.cos(i+e)}this.init();t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);t.bufferData(t.ARRAY_BUFFER,4*this.data.length,t.DYNAMIC_DRAW)}drawEllipse(t,e){if(e!==this.previousFill){this.flush();this.previousFill=e}this.bufRects[this.bufLen++]=t;this.bufLen>=this.BUFFER_SIZE&&this.flush()}flush(){if(0==this.bufLen)return;let t=this.gl;t.useProgram(this.shaderProgram);let e=new core.Color(this.previousFill);t.uniform4f(this.colorLocation,e.r/255,e.g/255,e.b/255,e.a);t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);this.setData();t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);t.drawArrays(t.TRIANGLES,0,this.bufLen*this.NTRIANGLES*3);this.bufLen=0}setData(){let t=this.gl,e=this.bufLen,i=this.data,r=0;for(let t=0;t<e;t++){let e=this.bufRects[t],s=.5*e.width,n=.5*e.height,o=e.left+s,a=e.top+n;for(let e=0;e<this.NTRIANGLES;e++){i[r=6*(t*this.NTRIANGLES+e)]=o;i[r+1]=a;i[r+2]=o+s*this.sin1[e];i[r+3]=a+n*this.cos1[e];i[r+4]=o+s*this.sin2[e];i[r+5]=a+n*this.cos2[e]}}t.bufferSubData(t.ARRAY_BUFFER,0,i.subarray(0,r+6))}}class _GLDrawPoints extends _GLDrawBase{constructor(t){super(t);this.BUFFER_SIZE=1e5;this.bufferLen=0;this._vsSource1="\n    attribute vec2 a_position;\n    uniform vec2 u_resolution;\n    void main() {\n      vec2 zeroToOne = a_position / u_resolution;\n      vec2 zeroToTwo = zeroToOne * 2.0;\n      vec2 clipSpace = zeroToTwo - 1.0;\n      gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n      gl_PointSize = 5.0;\n    }\n    ";this.init()}initBuffers(){if(!this.buffer){let t=this.gl;this.buffer=new Float32Array(this.BUFFER_SIZE);t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);t.bufferData(t.ARRAY_BUFFER,4*this.buffer.length,t.DYNAMIC_DRAW)}}drawPoint(t,e){this.initBuffers();if(e!==this.previousFill){this.flush();this.previousFill=e}this.buffer[this.bufferLen++]=t.x;this.buffer[this.bufferLen++]=t.y;this.bufferLen>=this.BUFFER_SIZE&&this.flush()}flush(){if(0==this.bufferLen)return;let t=this.gl;t.useProgram(this.shaderProgram);let e=new core.Color(this.previousFill);t.uniform4f(this.colorLocation,e.r/255,e.g/255,e.b/255,e.a>0?1:0);t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);t.bufferSubData(t.ARRAY_BUFFER,0,this.buffer.subarray(0,this.bufferLen));t.drawArrays(t.POINTS,0,this.bufferLen/2);this.bufferLen=0}get vsSource(){return this._vsSource1}}class _GLDrawLines extends _GLDrawBase{constructor(t){super(t);this.BUFFER_SIZE=1e6;this.init()}initBuffers(){if(!this.buffer){let t=this.gl;this.buffer=new Float32Array(4*this.BUFFER_SIZE);t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);t.bufferData(t.ARRAY_BUFFER,4*this.buffer.length,t.DYNAMIC_DRAW)}}drawLines(t,e,i,r,s=null){this.initBuffers();let n=i||t.length,o=this.gl;o.useProgram(this.shaderProgram);if(s){o.enable(o.SCISSOR_TEST);o.scissor(s.left,o.canvas.height-s.bottom,s.width+1,s.height+1)}let a=new core.Color(r);o.uniform4f(this.colorLocation,a.r/255,a.g/255,a.b/255,a.a>0?1:0);o.enableVertexAttribArray(this.positionAttributeLocation);o.bindBuffer(o.ARRAY_BUFFER,this.positionBuffer);o.vertexAttribPointer(this.positionAttributeLocation,2,o.FLOAT,!1,0,0);for(let i=0;i<n;i++){this.buffer[2*i]=t[i];this.buffer[2*i+1]=e[i]}o.bufferSubData(o.ARRAY_BUFFER,0,this.buffer.subarray(0,2*n));o.enableVertexAttribArray(this.positionAttributeLocation);o.bindBuffer(o.ARRAY_BUFFER,this.positionBuffer);o.vertexAttribPointer(this.positionAttributeLocation,2,o.FLOAT,!1,0,0);o.drawArrays(o.LINE_STRIP,0,n);s&&o.disable(o.SCISSOR_TEST)}}class _GLDrawAreas extends _GLDrawBase{constructor(t){super(t);this.earcut=new _EarCut;this.BUFFER_SIZE=1e6;this.init()}initBuffers(){if(!this.buffer){let t=this.gl;this.buffer=new Float32Array(4*this.BUFFER_SIZE);t.enableVertexAttribArray(this.positionAttributeLocation);t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(this.positionAttributeLocation,2,t.FLOAT,!1,0,0);t.bufferData(t.ARRAY_BUFFER,4*this.buffer.length,t.DYNAMIC_DRAW)}}drawPolygon(t,e,i,r=null){this.initBuffers();let s=t.length,n=[];for(let i=0;i<s;i++){n.push(t[i]);n.push(e[i])}let o=this.earcut.earcut(n),a=this.gl;a.useProgram(this.shaderProgram);if(r){a.enable(a.SCISSOR_TEST);a.scissor(r.left,a.canvas.height-r.bottom,r.width,r.height)}let h=new core.Color(i);a.uniform4f(this.colorLocation,h.r/255,h.g/255,h.b/255,h.a>0?1:0);a.enableVertexAttribArray(this.positionAttributeLocation);a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer);a.vertexAttribPointer(this.positionAttributeLocation,2,a.FLOAT,!1,0,0);let l=0;for(let t=0;t<o.length;t++){this.buffer[l++]=n[2*o[t]];this.buffer[l++]=n[2*o[t]+1]}a.bufferSubData(a.ARRAY_BUFFER,0,this.buffer.subarray(0,l));a.enableVertexAttribArray(this.positionAttributeLocation);a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer);a.vertexAttribPointer(this.positionAttributeLocation,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,o.length);r&&a.disable(a.SCISSOR_TEST)}}wijmo_1._registerModule("wijmo.chart.webgl",selfModule);